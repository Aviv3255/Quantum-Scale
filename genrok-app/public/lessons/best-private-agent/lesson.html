<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Who Is the Best Private Agent in the Market Today | Quantum Scale</title>
  <script src="https://cdn.tailwindcss.com" defer></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" defer></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" defer></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js" defer></script>
  <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js" defer></script>
  <script src="../shared/greetings.js" defer></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://unpkg.com" crossorigin>
  <link rel="preconnect" href="https://cdn.tailwindcss.com" crossorigin>
  <link rel="preconnect" href="https://pqvvrljykfvhpyvxmwzb.supabase.co" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;500;600;700;800;900&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root { --accent: #10b981; --accent-dark: #059669; --accent-light: #34d399; --accent-rgb: 16, 185, 129; }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Inter', sans-serif; background: transparent; -webkit-font-smoothing: antialiased; }
    .title-font { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    h1, h2, h3, .slide-title { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    ::selection { background: var(--accent); color: white; }
    .slide-scroll::-webkit-scrollbar { display: none; }
    .slide-scroll { -ms-overflow-style: none; scrollbar-width: none; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { motion, AnimatePresence } = window.Motion;
    const { useState, useEffect, useCallback, useMemo } = React;

    const getUserName = () => { const params = new URLSearchParams(window.location.search); return params.get('userName') || 'Builder'; };
    const getInitialSlide = () => { const params = new URLSearchParams(window.location.search); const slide = params.get('slide'); return slide ? parseInt(slide, 10) : 0; };

    // Animated Counter Component
    const AnimatedCounter = ({ target, suffix = '', duration = 2000 }) => {
      const [count, setCount] = useState(0);
      useEffect(() => {
        let start = 0;
        const increment = target / (duration / 16);
        const timer = setInterval(() => {
          start += increment;
          if (start >= target) { setCount(target); clearInterval(timer); }
          else { setCount(Math.floor(start)); }
        }, 16);
        return () => clearInterval(timer);
      }, [target, duration]);
      return <span>{count.toLocaleString()}{suffix}</span>;
    };

    // Ranking Colors based on position
    const getRankColor = (index) => {
      const colors = ['#FFD700', '#C0C0C0', '#CD7F32', '#EF4444']; // Gold, Silver, Bronze, Red
      return colors[index] || '#EF4444';
    };

    const getRankLabel = (index) => {
      const labels = ['1st', '2nd', '3rd', '4th'];
      return labels[index] || `${index + 1}th`;
    };

    // Elite Ranking Circles Component with glow effects and dark styling
    const RankingCircles = ({ items, showLinks = false }) => (
      <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mt-6">
        {items.map((item, i) => {
          const color = getRankColor(i);
          return (
            <motion.div
              key={i}
              initial={{ opacity: 0, scale: 0.8 }}
              animate={{ opacity: 1, scale: 1 }}
              transition={{ delay: 0.2 + i * 0.1 }}
              className="flex flex-col items-center"
            >
              <div
                className="w-20 h-20 rounded-full border-4 flex items-center justify-center mb-2 relative"
                style={{
                  borderColor: color,
                  background: 'linear-gradient(135deg, #0a0a0a, #1a1a1a)',
                  boxShadow: `0 0 20px ${color}40, 0 0 40px ${color}20, inset 0 1px 0 rgba(255,255,255,0.1)`
                }}
              >
                <span className="text-2xl font-bold" style={{ color: color, textShadow: `0 0 10px ${color}60` }}>{i + 1}</span>
              </div>
              <p className="text-sm font-semibold text-neutral-900 text-center">{item.name}</p>
              <p className="text-xs text-neutral-600 text-center mt-1">{item.value}</p>
              {showLinks && item.url && (
                <a href={item.url} target="_blank" rel="noopener noreferrer" className="text-xs mt-2 px-3 py-1 rounded-full bg-neutral-100 hover:bg-neutral-200 text-neutral-700 transition-colors">
                  Create Account
                </a>
              )}
            </motion.div>
          );
        })}
      </div>
    );

    // Elite Winner Highlight Circles with glow effects
    const WinnerHighlightCircles = ({ items }) => (
      <div className="grid grid-cols-3 gap-6 mt-6">
        {items.map((item, i) => (
          <motion.div key={i} initial={{ opacity: 0, scale: 0.8 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.2 + i * 0.15 }} className="flex flex-col items-center">
            <div className="relative">
              <div
                className="w-24 h-24 rounded-full border-4 flex items-center justify-center"
                style={{
                  borderColor: item.isWinner ? '#10b981' : '#2d2d2d',
                  background: 'linear-gradient(135deg, #0a0a0a, #1a1a1a)',
                  boxShadow: item.isWinner
                    ? '0 0 30px rgba(16, 185, 129, 0.4), 0 0 60px rgba(16, 185, 129, 0.2), inset 0 1px 0 rgba(255,255,255,0.1)'
                    : '0 4px 20px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)'
                }}
              >
                <span
                  className="text-lg font-bold text-center"
                  style={{
                    color: item.isWinner ? '#10b981' : '#ffffff',
                    textShadow: item.isWinner ? '0 0 10px rgba(16, 185, 129, 0.6)' : 'none'
                  }}
                >
                  {item.value}
                </span>
              </div>
              {item.isWinner && (
                <div
                  className="absolute -inset-2 rounded-full pointer-events-none"
                  style={{
                    border: '2px solid transparent',
                    background: 'linear-gradient(135deg, rgba(16, 185, 129, 0.3), transparent) border-box'
                  }}
                />
              )}
            </div>
            <p className="text-sm font-semibold text-neutral-900 text-center mt-3">{item.label}</p>
            <p className="text-xs text-neutral-500 text-center">{item.sublabel}</p>
          </motion.div>
        ))}
      </div>
    );

    const LESSON_CONFIG = {
      id: 'best-private-agent',
      title: 'Who Is the Best Private Agent in the Market Today',
      description: 'We tested everything. This is the absolute best fulfillment partner.',
      accentColor: '#10b981',
      duration: '6 min',
      nextLesson: { id: 'stop-aliexpress', title: 'Stop Using AliExpress Now', teaser: 'Why AliExpress is killing your brand - and what winners use instead.' }
    };

    // ============ ADMIN REPORTER SYSTEM ============
    let __isAdmin = false;

    window.addEventListener('message', function(e) {
      if (e.data?.type === 'ADMIN_STATUS') {
        __isAdmin = e.data.isAdmin;
      }
    });

    if (window.parent !== window) {
      window.parent.postMessage({ type: 'CHECK_ADMIN_STATUS' }, '*');
    }

    const AdminSlideReportButton = ({ slideIndex, slideType }) => {
      const handleReport = (e) => {
        e.stopPropagation();
        e.preventDefault();
        if (window.parent !== window) {
          window.parent.postMessage({
            type: 'ADMIN_REPORT_REQUEST',
            slideIndex: slideIndex,
            slideType: slideType,
            lessonSlug: LESSON_CONFIG.id,
            elementId: slideType + '-' + slideIndex
          }, '*');
        }
      };

      return (
        <button
          onClick={handleReport}
          title={`Report issue on Slide ${slideIndex + 1} (${slideType})`}
          style={{
            position: 'absolute',
            top: '12px',
            right: '12px',
            width: '32px',
            height: '32px',
            borderRadius: '8px',
            backgroundColor: 'rgba(239, 68, 68, 0.9)',
            color: 'white',
            border: 'none',
            cursor: 'pointer',
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
            zIndex: 1000,
            opacity: 0.6,
            transition: 'opacity 0.2s, transform 0.2s',
            boxShadow: '0 2px 8px rgba(0,0,0,0.15)'
          }}
          onMouseEnter={(e) => { e.currentTarget.style.opacity = '1'; e.currentTarget.style.transform = 'scale(1.1)'; }}
          onMouseLeave={(e) => { e.currentTarget.style.opacity = '0.6'; e.currentTarget.style.transform = 'scale(1)'; }}
        >
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
            <path d="m8 2 1.88 1.88"/><path d="M14.12 3.88 16 2"/>
            <path d="M9 7.13v-1a3.003 3.003 0 1 1 6 0v1"/>
            <path d="M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6"/>
            <path d="M12 20v-9"/><path d="M6.53 9C4.6 8.8 3 7.1 3 5"/>
            <path d="M6 13H2"/><path d="M3 21c0-2.1 1.7-3.9 3.8-4"/>
            <path d="M20.97 5c0 2.1-1.6 3.8-3.5 4"/><path d="M22 13h-4"/>
            <path d="M17.2 17c2.1.1 3.8 1.9 3.8 4"/>
          </svg>
        </button>
      );
    };
    // ============ END ADMIN REPORTER SYSTEM ============

    const celebrationGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_doing_a_quick_victory_dance_move_high_energy_c_d03b798b-a518-4e6c-bcae-d69b2dd50486_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_jumping_in_the_air_arms_raised_high_YESSS_cele_201477e8-3df4-405a-bc81-81d1747e5c6c_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_playing_air_guitar_light_headbanging_rockstar__0702007e-9e84-4d9e-8f99-8ee23d0b65f8_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_doing_the_running_man_dance_move_vintage_cool__25682b0f-cf4c-4e93-8dcb-6c3dac8135cd_0.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_standing_and_clapping_enthusiastically_mouth_o_992ac4fd-9a0e-4963-bbcc-a5271f25f4fd_3.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_clapping_very_fast_huge_smile_extreme_exciteme_9a4dde09-55ca-4173-a47d-613bc2924230_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_clapping_above_head_world_champion_celebration_484bd560-f049-41ca-b3d1-c03d7468ab56_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_starting_with_slow_clap_accelerating_to_fast_c_ee478a38-0ee7-437d-bd13-d687f7dd624a_0.mp4'
    ];
    const getRandomCelebrationGif = () => celebrationGifs[Math.floor(Math.random() * celebrationGifs.length)];

    const empathyGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_thumbs_down_with_encouraging_nod_close_keep_go_613e541f-c072-436f-aee7-f99cd6f834fc_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_shaking_head_side_to_side_sadly_disappointed_e_c4a4be22-6a70-4738-8612-3039454fef37_1.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_covering_face_with_palm_facepalm_gesture_disap_211b0566-078f-4d42-9c41-547b14f5827c_0.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_looking_down_sadly_shoulders_slumped_disappoin_790d48bd-e49e-40ea-9979-d3e86fa3a422_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_wiping_away_a_small_tear_sad_but_gentle_disapp_8d78571b-3c36-4502-abee-81683255843c_1.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_sighing_sadly_exhaling_with_disappointment_hea_f6014f2a-3a99-4378-a2a8-414e16b3e72d_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_slouching_with_disappointment_body_curling_inw_caedddbe-413c-492a-9fdf-1e8433f5e2a8_2%20(1).mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_placing_hand_on_forehead_sadly_eyes_closed_fru_3e048895-f365-4ff2-9e88-0d0a35b2a9e1_3.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_nodding_slowly_with_sadness_what_a_shame_expre_377f67ca-63da-41aa-9072-4926fc2f6e82_3.mp4'
    ];
    const getRandomEmpathyGif = () => empathyGifs[Math.floor(Math.random() * empathyGifs.length)];

    const slides = [
      { type: 'welcome', learningGoals: ['Why your fulfillment partner makes or breaks your brand', 'The criteria that actually matter when choosing an agent', 'Which agent won our testing - and how to connect'] },
      { type: 'hook', headline: 'Your customer just received their package. In the next 3 seconds, they decide if they\'ll ever buy from you again.', subtext: 'A thin plastic envelope. No branding. No note. Just... product. Their brain instantly processes: "cheap store." Decision made. Never ordering again. This happens thousands of times daily with AliExpress fulfillment.', brandImage: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/Aliexpress_logo.svg.png', brandName: 'AliExpress' },
      { type: 'example', scenario: 'The Fulfillment Experience Gap', before: { label: 'AliExpress Reality', text: '21-45 day shipping. Thin plastic packaging. Zero branding. No quality check. Customer thinks: "I could have gotten this cheaper on Wish."' }, after: { label: 'Private Agent', text: '5-7 day shipping. Branded packaging. Custom inserts. Quality inspection. Customer thinks: "This feels premium. I\'ll order again."' }, insight: 'Same product. Different experience. One creates customers, the other creates one-time buyers.' },
      { type: 'content', title: 'So Which Private Agent Is Actually the Best?', body: 'For 3 months we worked with the 6 leading companies across 3 different niches: fashion, home decor, and kids clothing. Here\'s what we found.' },
      { type: 'cards', title: 'What We Measured', items: [
        { title: 'Shipping Speed', description: 'The difference between 5-7 days and 21+ days is the difference between repeat customers and one-time buyers. This was our primary metric.', icon: 'truck' },
        { title: 'Quality Control', description: 'When defective products reach customers, you lose money on returns AND lose the customer forever. Proper inspection prevents both.', icon: 'shield' },
        { title: 'Support Response', description: 'When something goes wrong (and it will), you need answers in minutes, not days. Real humans on WhatsApp, not automated tickets.', icon: 'headphones' },
        { title: 'Pricing at Scale', description: 'Here\'s the surprise: the best agents often cost the SAME or LESS than AliExpress when you scale. Price is not the differentiator.', icon: 'dollar' }
      ]},
      { type: 'visual', title: 'Our Testing Results', visualType: 'singleStat', data: { value: 60000, label: 'Orders Tracked', subtext: 'Across 6 leading agents in 3 niches' }, characterVideo: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_pointing_at_a_chart_presentingexplaining_100_p_d3ddf2c8-5905-4952-b8cc-0eaed3e8b732_3.mp4', characterPosition: 'left'},
      { type: 'agentRankings', title: 'The Agents We Tested', agents: [
        { name: 'Mate', url: 'https://erp.matedropshipping.com/login?invite_id=915' },
        { name: 'HyperSKU', url: 'https://www.hypersku.com/campaign/optimize-dropshipping/?ref=nmmwogq' },
        { name: 'AutoDS', url: 'https://autods.com' },
        { name: 'Other Companies', url: null }
      ]},
      { type: 'content', title: 'Finding #1: Shipping Speed', body: 'Customers who receive orders in under 7 days are significantly more likely to order again. The psychology is simple: fast delivery while the excitement is still fresh creates positive associations. Slow delivery lets doubt and regret creep in.', ranking: [
        { name: 'Mate', value: '7 days', url: 'https://erp.matedropshipping.com/login?invite_id=915' },
        { name: 'HyperSKU', value: '9 days', url: 'https://www.hypersku.com/campaign/optimize-dropshipping/?ref=nmmwogq' },
        { name: 'AutoDS', value: '14 days', url: 'https://autods.com' },
        { name: 'Others', value: '14-21 days' }
      ]},
      { type: 'content', title: 'Finding #2: Pricing vs. AliExpress', body: 'Here\'s what surprised us: the best agents often cost the SAME or LESS than AliExpress at scale. The "AliExpress is cheaper" myth only holds for single orders. At volume, private agents match or beat AliExpress pricing - with better service included.', ranking: [
        { name: 'Mate', value: '4% Cheaper', url: 'https://erp.matedropshipping.com/login?invite_id=915' },
        { name: 'HyperSKU', value: '1% Cheaper', url: 'https://www.hypersku.com/campaign/optimize-dropshipping/?ref=nmmwogq' },
        { name: 'AutoDS', value: 'Price Match', url: 'https://autods.com' },
        { name: 'Others', value: '5-15% More' }
      ]},
      { type: 'content', title: 'Finding #3: Support Quality', body: 'When a customer complains about a broken product, you have hours - not days - to fix it. Mate & HyperSKU offer 18/6 personal WhatsApp support with real humans answering in minutes. AutoDS has no personal support - only automated tickets. This is where most agents fail - and where the best ones shine.', ranking: [
        { name: 'Mate', value: '18/6 WhatsApp' },
        { name: 'HyperSKU', value: '18/6 WhatsApp' },
        { name: 'AutoDS', value: 'No Personal' },
        { name: 'Others', value: 'Varies' }
      ]},
      { type: 'visual', title: 'After 3 Months of Testing...', visualType: 'testingResults', data: {
        left: { label: 'Shipping', value: '7 days', sublabel: 'Fastest Consistent' },
        center: { label: 'The Winner', value: 'Mate', sublabel: 'Dropshipping' },
        right: { label: 'Pricing', value: '4%', sublabel: 'Cheaper Than AliExpress' }
      }, characterVideo: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_pointing_at_a_chart_presentingexplaining_100_p_d3ddf2c8-5905-4952-b8cc-0eaed3e8b732_3.mp4', characterPosition: 'left'},
      { type: 'winnerHighlight', title: 'How We Chose the Winner', winners: [
        { label: 'Shipping Speed', sublabel: 'Days to Delivery', value: '7 Days', isWinner: true },
        { label: 'Pricing vs AliExpress', sublabel: 'Cost Difference', value: '4% Less', isWinner: true },
        { label: 'Support Quality', sublabel: 'Response Time', value: '18/6', isWinner: true }
      ]},
      { type: 'cards', title: 'Why Mate Dropshipping Won', items: [
        { title: 'Fastest Consistent Delivery', description: '5-7 day shipping to most destinations. Not "up to 7 days" - actually 5-7 days consistently.', icon: 'zap' },
        { title: 'Quality Inspection', description: 'They check products before shipping. Catches defects before your customer does. Fewer returns, fewer chargebacks.', icon: 'check' },
        { title: 'WhatsApp Support', description: 'Real humans answering in minutes. 18/6 availability. When things go wrong, you get help immediately.', icon: 'message' },
        { title: 'Competitive Pricing', description: 'Pricing that improves as you scale. At volume, often matches or beats AliExpress pricing.', icon: 'trending' }
      ]},
      { type: 'howItWorksFlow', title: 'How It Works', steps: [
        { step: 1, title: 'Connect Your Primary Agent', description: 'Free Shopify app. No monthly fees. No minimums. When an order comes in, the price appears. Pay via PayPal or credit card.', image: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/19%20(1).jpg' },
        { step: 2, title: 'Sync Your Products', description: 'They handle sourcing, quality control, repack, and branded packaging. Products arrive at their warehouse, get inspected, and ship with your branding.', image: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/21.jpg' }
      ]},
      { type: 'images', title: 'Real Warehouses, Real Quality Control', images: [
        'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/19%20(1).jpg',
        'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/21.jpg',
        'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/24.jpg'
      ]},
      { type: 'implementation', title: 'Connecting Your Primary Agent', concept: 'You\'ve seen the data. Mate won on shipping speed, pricing, and support. Here\'s exactly how to set up your fulfillment system - no commitment, no fees, just better operations.', steps: ['Install their free Shopify app - it connects your store automatically. Zero setup fees, no monthly cost.', 'Send a test order for your best-selling product. See the quality inspection process in action before scaling.', 'Set up WhatsApp support with your dedicated agent. Having a real human who knows your store is the real advantage.', 'Gradually migrate products from AliExpress as you verify quality and shipping times meet your standards.'], insight: 'The best operators don\'t switch overnight. They test one product, verify everything works, then scale. That\'s the professional approach.', toolName: 'Mate Dropshipping', toolUrl: 'https://erp.matedropshipping.com/login?invite_id=915' },
      { type: 'content', title: 'Smart Operators Use Two Agents', body: 'Even the best agent can\'t be perfect for every product. Sometimes one has better pricing on specific items. Sometimes stock runs out. Sometimes one shipping route is faster for certain regions. Your primary handles 80-90% of orders. Your backup covers the edge cases.' },
      { type: 'implementation', title: 'Setting Up Backup Fulfillment', concept: 'Professional operations never depend on a single source. Your backup agent handles stock-outs, pricing advantages on specific items, and alternative shipping routes - at zero cost to have ready.', steps: ['Install your backup agent\'s Shopify app alongside your primary. Both watch your store simultaneously.', 'Compare pricing on your top 10 products between agents. Sometimes backups have better rates on specific items.', 'Test shipping routes to your highest-volume regions. Different agents have different carrier relationships.', 'Create a simple rule: primary is out of stock? Backup fulfills. Primary takes too long? Backup ships.'], insight: 'Having a backup costs nothing but saves everything when your primary hits a snag. That\'s the difference between amateurs and professionals.', toolName: 'HyperSKU', toolUrl: 'https://www.hypersku.com/campaign/optimize-dropshipping/?ref=nmmwogq' },
      { type: 'quiz', question: 'What\'s the main reason to have a backup fulfillment agent?', options: ['Backup agents are always cheaper', 'Sometimes one agent has better pricing or stock for specific products', 'You should split every order between agents', 'Primary agents are unreliable'], correctIndex: 1, feedback: { correct: 'Exactly! A backup agent gives you flexibility when one has better pricing, stock, or shipping for specific products. Free to connect, so why not have options?', incorrect: 'Not quite. The key is flexibility: sometimes one agent has better pricing or stock for specific products. And it\'s free to connect - so why not have options?' }},
      { type: 'completion', sources: [{ name: 'Mate Dropshipping', url: 'https://erp.matedropshipping.com/login?invite_id=915' }, { name: 'HyperSKU', url: 'https://www.hypersku.com/campaign/optimize-dropshipping/?ref=nmmwogq' }] }
    ];

    const Icons = {
      Clock: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
      Package: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="16.5" y1="9.4" x2="7.5" y2="4.21"/><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></svg>,
      Check: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><polyline points="20 6 9 17 4 12"/></svg>,
      X: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
      ArrowLeft: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>,
      ArrowRight: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>,
      Zap: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
      ExternalLink: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>,
      Link: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>,
      Truck: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="1" y="3" width="15" height="13"/><polygon points="16 8 20 8 23 11 23 16 16 16 16 8"/><circle cx="5.5" cy="18.5" r="2.5"/><circle cx="18.5" cy="18.5" r="2.5"/></svg>,
      Shield: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>,
      Headphones: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M3 18v-6a9 9 0 0 1 18 0v6"/><path d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z"/></svg>,
      Dollar: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>,
      Message: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>,
      Trending: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>,
    };

    const getCardIcon = (iconName) => {
      switch(iconName) {
        case 'truck': return <Icons.Truck />;
        case 'shield': return <Icons.Shield />;
        case 'headphones': return <Icons.Headphones />;
        case 'dollar': return <Icons.Dollar />;
        case 'zap': return <Icons.Zap />;
        case 'check': return <Icons.Check />;
        case 'message': return <Icons.Message />;
        case 'trending': return <Icons.Trending />;
        default: return <Icons.Zap />;
      }
    };

    const WelcomeSlide = ({ data, onStart, userName, onShowGif, onHideGif }) => {
      const welcomeData = useMemo(() => getTimeBasedWelcome(), []);
      const gifSide = useMemo(() => Math.random() > 0.5 ? 'left' : 'right', []);
      useEffect(() => { onShowGif(welcomeData.gif, '65%', gifSide); return () => onHideGif(); }, [welcomeData.gif, gifSide, onShowGif, onHideGif]);

      return (
        <div className="h-full w-full relative overflow-hidden">
          <div className="h-full flex flex-col items-center justify-center text-center px-6 py-4 relative z-20">
            <motion.h1 initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} className="title-font text-3xl sm:text-4xl md:text-5xl lg:text-6xl text-black mb-2 md:mb-3">{LESSON_CONFIG.title}</motion.h1>
            <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-neutral-600 text-base md:text-lg lg:text-xl mb-2 md:mb-3 max-w-lg leading-relaxed" dangerouslySetInnerHTML={{ __html: formatGreeting(welcomeData.greeting, `<span class="font-bold text-neutral-900">${userName}</span>`) }} />
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="flex items-center justify-center gap-1.5 text-neutral-400 text-[10px] md:text-xs mb-2 md:mb-3"><Icons.Clock /><span>{LESSON_CONFIG.duration}</span></motion.div>
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 }} className="bg-neutral-900 rounded-xl md:rounded-2xl p-3 md:p-5 mb-3 md:mb-4 max-w-sm w-full mx-auto">
              <p className="text-neutral-500 text-[9px] md:text-[11px] uppercase tracking-wider mb-2 md:mb-3">In this lesson</p>
              <ul className="space-y-1.5 md:space-y-2">
                {data.learningGoals.map((goal, i) => (
                  <motion.li key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.25 + i * 0.05 }} className="flex items-start gap-2 text-left">
                    <span className="w-5 h-5 rounded-md flex items-center justify-center text-[9px] font-bold text-white flex-shrink-0 mt-0.5" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>{i + 1}</span>
                    <span className="text-neutral-300 text-[11px] md:text-sm leading-snug">{goal}</span>
                  </motion.li>
                ))}
              </ul>
            </motion.div>
            <motion.button initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.45 }} onClick={onStart} whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }} className="px-6 md:px-7 py-2.5 md:py-3 rounded-xl text-white font-semibold text-sm md:text-base" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>Let's Go</motion.button>
          </div>
        </div>
      );
    };

    const HookSlide = ({ data }) => (
      <div className="h-full relative overflow-hidden">
        <div className="h-full flex flex-col justify-center px-6 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-8 md:py-10 relative z-10">
          <motion.div initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} className="mb-4 md:mb-6">
            <span className="inline-block px-3 py-1 rounded-full text-xs font-semibold mb-3 md:mb-4" style={{ background: `rgba(var(--accent-rgb), 0.1)`, color: 'var(--accent)' }}>The Hook</span>
            <h2 className="slide-title text-2xl md:text-4xl lg:text-5xl text-black leading-tight">{data.headline}</h2>
          </motion.div>
          <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="text-base md:text-xl text-neutral-600 leading-relaxed">{data.subtext}</motion.p>
        </div>
        {data.brandImage && (
          <motion.div initial={{ opacity: 0, x: 30 }} animate={{ opacity: 0.15, x: 0 }} transition={{ delay: 0.3, duration: 0.5 }}
            className="absolute bottom-0 right-0 z-0 pointer-events-none hidden md:block" style={{ height: '18%', maxHeight: '100px', marginRight: '40px', marginBottom: '3%' }}>
            <img src={data.brandImage} alt={data.brandName || ''} className="h-full w-auto object-contain" />
          </motion.div>
        )}
      </div>
    );


    const ContentSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-8 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-10">
        <motion.h2 initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl lg:text-4xl text-black mb-6 relative z-10">{data.title}</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-base md:text-lg text-neutral-600 leading-relaxed relative z-10">{data.body}</motion.p>
        {data.ranking && <RankingCircles items={data.ranking} />}
      </div>
    );

    const ExampleSlide = ({ data }) => {
      const aliexpressItems = [
        '21-45 day shipping',
        'Thin plastic packaging',
        'Zero branding',
        'No quality check'
      ];
      const privateAgentItems = [
        '5-7 day shipping',
        'Branded packaging',
        'Custom inserts',
        'Quality inspection'
      ];

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8">
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6 relative z-10">
            <span className="inline-block px-3 py-1 rounded-full text-xs font-semibold mb-2" style={{ background: `rgba(var(--accent-rgb), 0.1)`, color: 'var(--accent)' }}>Real Example</span>
            <h2 className="slide-title text-xl md:text-2xl text-black">{data.scenario}</h2>
          </motion.div>
          <div className="grid md:grid-cols-2 gap-6 mb-6">
            {/* AliExpress - Dark gradient card with red accent */}
            <motion.div
              initial={{ opacity: 0, x: -20 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ delay: 0.1 }}
              className="rounded-xl p-5 relative overflow-hidden"
              style={{
                background: 'linear-gradient(135deg, #0a0a0a, #1a1a1a)',
                boxShadow: '0 0 30px rgba(239, 68, 68, 0.15), 0 4px 20px rgba(0,0,0,0.3)'
              }}
            >
              {/* Top accent line */}
              <div
                className="absolute top-0 left-0 right-0 h-1"
                style={{ background: 'linear-gradient(90deg, transparent, #ef4444, transparent)' }}
              />
              <h3 className="font-bold text-white text-base mb-4">{data.before.label}</h3>
              <ul className="space-y-2.5">
                {aliexpressItems.map((item, i) => (
                  <li key={i} className="flex items-start gap-2">
                    <span className="text-red-500 mt-0.5 text-lg flex-shrink-0">X</span>
                    <span className="text-neutral-300 text-sm">{item}</span>
                  </li>
                ))}
              </ul>
              <p className="text-neutral-500 text-xs mt-4 italic">Customer thinks: "I could have gotten this cheaper on Wish."</p>
            </motion.div>
            {/* Private Agent - Dark gradient card with green accent */}
            <motion.div
              initial={{ opacity: 0, x: 20 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ delay: 0.2 }}
              className="rounded-xl p-5 relative overflow-hidden"
              style={{
                background: 'linear-gradient(135deg, #0a0a0a, #1a1a1a)',
                boxShadow: '0 0 30px rgba(16, 185, 129, 0.15), 0 4px 20px rgba(0,0,0,0.3)'
              }}
            >
              {/* Top accent line */}
              <div
                className="absolute top-0 left-0 right-0 h-1"
                style={{ background: 'linear-gradient(90deg, transparent, #10b981, transparent)' }}
              />
              <h3 className="font-bold text-white text-base mb-4">{data.after.label}</h3>
              <ul className="space-y-2.5">
                {privateAgentItems.map((item, i) => (
                  <li key={i} className="flex items-start gap-2">
                    <span className="text-green-500 mt-0.5 text-lg flex-shrink-0">âœ“</span>
                    <span className="text-neutral-300 text-sm">{item}</span>
                  </li>
                ))}
              </ul>
              <p className="text-neutral-500 text-xs mt-4 italic">Customer thinks: "This feels premium. I'll order again."</p>
            </motion.div>
          </div>
          <motion.div
            initial={{ opacity: 0, y: 15 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.3 }}
            className="rounded-xl p-4 text-center relative overflow-hidden"
            style={{
              background: 'linear-gradient(135deg, #0a0a0a, #1a1a1a)',
              boxShadow: '0 0 20px rgba(16, 185, 129, 0.1)'
            }}
          >
            <div
              className="absolute top-0 left-0 right-0 h-0.5"
              style={{ background: 'linear-gradient(90deg, transparent, var(--accent), transparent)' }}
            />
            <p className="text-neutral-300 text-sm"><Icons.Zap className="inline mr-2" />{data.insight}</p>
          </motion.div>
        </div>
      );
    };

    const VisualSlide = ({ data }) => {
      if (data.visualType === 'singleStat') {
        return (
          <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8 relative">
            <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">{data.title}</motion.h2>
            <motion.div
              initial={{ opacity: 0, scale: 0.9 }}
              animate={{ opacity: 1, scale: 1 }}
              transition={{ delay: 0.1 }}
              className="rounded-2xl p-8 md:p-12 text-center max-w-lg mx-auto relative overflow-hidden"
              style={{
                background: 'linear-gradient(135deg, #0a0a0a, #1a1a1a)',
                boxShadow: '0 0 60px rgba(16, 185, 129, 0.2), 0 0 100px rgba(16, 185, 129, 0.1), 0 4px 30px rgba(0,0,0,0.4)'
              }}
            >
              {/* Top accent line */}
              <div
                className="absolute top-0 left-0 right-0 h-1"
                style={{ background: 'linear-gradient(90deg, transparent, var(--accent), transparent)' }}
              />
              <div className="text-5xl md:text-7xl font-bold mb-3" style={{ color: 'var(--accent)', textShadow: '0 0 30px rgba(16, 185, 129, 0.5)' }}>
                <AnimatedCounter target={data.data.value} duration={2000} />+
              </div>
              <div className="text-lg md:text-xl font-semibold text-white mb-2">{data.data.label}</div>
              <div className="text-sm text-neutral-400">{data.data.subtext}</div>
            </motion.div>
            {data.characterVideo && (
              <motion.div
                initial={{ opacity: 0, y: 40 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ delay: 0.4, duration: 0.6 }}
                className={`absolute bottom-0 ${data.characterPosition === 'left' ? 'left-6' : 'right-6'} z-0 pointer-events-none hidden md:block`}
                style={{ height: '45%', maxHeight: '350px' }}>
                <video autoPlay loop muted playsInline className="h-full w-auto object-contain object-bottom">
                  <source src={data.characterVideo} type="video/mp4" />
                </video>
              </motion.div>
            )}
          </div>
        );
      }
      if (data.visualType === 'testingResults') {
        return (
          <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8 relative">
            <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">{data.title}</motion.h2>
            <div className="grid grid-cols-3 gap-3 md:gap-6">
              {/* Left card - dark gradient with green glow */}
              <motion.div
                initial={{ opacity: 0, y: 40 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ delay: 0.1 }}
                className="rounded-xl p-4 md:p-6 text-center relative overflow-hidden"
                style={{
                  background: 'linear-gradient(135deg, #0a0a0a, #1a1a1a)',
                  boxShadow: '0 0 30px rgba(16, 185, 129, 0.2), 0 4px 20px rgba(0,0,0,0.3)'
                }}
              >
                <div
                  className="absolute top-0 left-0 right-0 h-1"
                  style={{ background: 'linear-gradient(90deg, transparent, #10b981, transparent)' }}
                />
                <div className="text-3xl md:text-4xl font-bold mb-2" style={{ color: '#10b981', textShadow: '0 0 20px rgba(16, 185, 129, 0.5)' }}>{data.data.left.value}</div>
                <div className="text-xs md:text-sm font-semibold text-white mb-1">{data.data.left.label}</div>
                <div className="text-[10px] md:text-xs text-neutral-400">{data.data.left.sublabel}</div>
              </motion.div>
              {/* Center card - Winner highlight */}
              <motion.div
                initial={{ opacity: 0, scale: 0.9 }}
                animate={{ opacity: 1, scale: 1 }}
                transition={{ delay: 0.2 }}
                className="rounded-xl p-4 md:p-6 text-center transform scale-105 relative overflow-hidden"
                style={{
                  background: 'linear-gradient(135deg, #0a0a0a, #1a1a1a)',
                  boxShadow: '0 0 40px rgba(255, 215, 0, 0.3), 0 0 80px rgba(255, 215, 0, 0.15), 0 4px 30px rgba(0,0,0,0.4)'
                }}
              >
                <div
                  className="absolute top-0 left-0 right-0 h-1"
                  style={{ background: 'linear-gradient(90deg, transparent, #FFD700, transparent)' }}
                />
                <div className="text-3xl md:text-4xl font-bold mb-2" style={{ color: '#FFD700', textShadow: '0 0 20px rgba(255, 215, 0, 0.5)' }}>{data.data.center.value}</div>
                <div className="text-xs md:text-sm font-semibold text-white mb-1">{data.data.center.label}</div>
                <div className="text-[10px] md:text-xs text-neutral-400">{data.data.center.sublabel}</div>
              </motion.div>
              {/* Right card */}
              <motion.div
                initial={{ opacity: 0, y: 40 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ delay: 0.3 }}
                className="rounded-xl p-4 md:p-6 text-center relative overflow-hidden"
                style={{
                  background: 'linear-gradient(135deg, #0a0a0a, #1a1a1a)',
                  boxShadow: '0 0 30px rgba(16, 185, 129, 0.2), 0 4px 20px rgba(0,0,0,0.3)'
                }}
              >
                <div
                  className="absolute top-0 left-0 right-0 h-1"
                  style={{ background: 'linear-gradient(90deg, transparent, #10b981, transparent)' }}
                />
                <div className="text-3xl md:text-4xl font-bold mb-2" style={{ color: '#10b981', textShadow: '0 0 20px rgba(16, 185, 129, 0.5)' }}>{data.data.right.value}</div>
                <div className="text-xs md:text-sm font-semibold text-white mb-1">{data.data.right.label}</div>
                <div className="text-[10px] md:text-xs text-neutral-400">{data.data.right.sublabel}</div>
              </motion.div>
            </div>
            {data.characterVideo && (
              <motion.div
                initial={{ opacity: 0, y: 40 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ delay: 0.5, duration: 0.6 }}
                className={`absolute bottom-0 ${data.characterPosition === 'left' ? 'left-6' : 'right-6'} z-0 pointer-events-none hidden md:block`}
                style={{ height: '40%', maxHeight: '300px' }}>
                <video autoPlay loop muted playsInline className="h-full w-auto object-contain object-bottom">
                  <source src={data.characterVideo} type="video/mp4" />
                </video>
              </motion.div>
            )}
          </div>
        );
      }
      return null;
    };

    // Elite Agent Rankings Slide with dark gradient and glow effects
    const AgentRankingsSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8">
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">{data.title}</motion.h2>
        <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
          {data.agents.map((agent, i) => {
            const color = getRankColor(i);
            return (
              <motion.div
                key={i}
                initial={{ opacity: 0, scale: 0.8 }}
                animate={{ opacity: 1, scale: 1 }}
                transition={{ delay: 0.2 + i * 0.1 }}
                className="flex flex-col items-center"
              >
                <div
                  className="w-20 h-20 rounded-full border-4 flex items-center justify-center mb-3"
                  style={{
                    borderColor: color,
                    background: 'linear-gradient(135deg, #0a0a0a, #1a1a1a)',
                    boxShadow: `0 0 25px ${color}40, 0 0 50px ${color}20, inset 0 1px 0 rgba(255,255,255,0.1)`
                  }}
                >
                  <span
                    className="text-2xl font-bold"
                    style={{ color: color, textShadow: `0 0 15px ${color}60` }}
                  >
                    {i + 1}
                  </span>
                </div>
                <p className="text-sm font-semibold text-neutral-900 text-center mb-2">{agent.name}</p>
                {agent.url && (
                  <a
                    href={agent.url}
                    target="_blank"
                    rel="noopener noreferrer"
                    className="text-xs px-3 py-1.5 rounded-full text-white transition-all hover:scale-105"
                    style={{
                      background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)',
                      boxShadow: '0 2px 10px rgba(0,0,0,0.2)'
                    }}
                  >
                    Create Account
                  </a>
                )}
              </motion.div>
            );
          })}
        </div>
      </div>
    );

    // Elite Winner Highlight Slide
    const WinnerHighlightSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8">
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">{data.title}</motion.h2>
        <WinnerHighlightCircles items={data.winners} />
      </div>
    );

    // Elite How It Works Flow Slide with dark gradient cards
    const HowItWorksFlowSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto slide-scroll overflow-y-auto py-8">
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">{data.title}</motion.h2>
        <div className="grid md:grid-cols-2 gap-6">
          {data.steps.map((step, i) => (
            <motion.div
              key={i}
              initial={{ opacity: 0, y: 40 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ delay: 0.1 + i * 0.15 }}
              className="rounded-xl overflow-hidden relative"
              style={{
                background: 'linear-gradient(135deg, #0a0a0a, #1a1a1a)',
                boxShadow: '0 0 30px rgba(16, 185, 129, 0.1), 0 4px 20px rgba(0,0,0,0.3)'
              }}
            >
              {/* Top accent line */}
              <div
                className="absolute top-0 left-0 right-0 h-1 z-10"
                style={{ background: 'linear-gradient(90deg, transparent, var(--accent), transparent)' }}
              />
              <div className="aspect-video relative">
                <img src={step.image} alt={step.title} className="w-full h-full object-cover opacity-80" />
                <div className="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent" />
              </div>
              <div className="p-5">
                <div className="flex items-center gap-3 mb-3">
                  <span
                    className="w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold text-white"
                    style={{
                      background: 'linear-gradient(135deg, var(--accent), var(--accent-dark))',
                      boxShadow: '0 0 15px rgba(16, 185, 129, 0.4)'
                    }}
                  >
                    {step.step}
                  </span>
                  <h3 className="font-bold text-white">{step.title}</h3>
                </div>
                <p className="text-sm text-neutral-400 leading-relaxed">{step.description}</p>
              </div>
            </motion.div>
          ))}
        </div>
      </div>
    );

    // Elite Cards Slide with dark gradient styling
    const CardsSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8">
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-6">{data.title}</motion.h2>
        <div className={`grid gap-3 relative z-10 ${data.items.length === 3 ? 'md:grid-cols-3' : 'md:grid-cols-2'}`}>
          {data.items.map((item, i) => (
            <motion.div
              key={i}
              initial={{ opacity: 0, y: 40 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ delay: 0.1 + i * 0.08 }}
              className="rounded-xl p-4 relative overflow-hidden group transition-all duration-300 hover:scale-[1.02]"
              style={{
                background: 'linear-gradient(135deg, #0a0a0a, #1a1a1a)',
                boxShadow: '0 0 20px rgba(16, 185, 129, 0.1), 0 4px 15px rgba(0,0,0,0.3)'
              }}
            >
              {/* Top accent line */}
              <div
                className="absolute top-0 left-0 right-0 h-0.5 opacity-60 group-hover:opacity-100 transition-opacity"
                style={{ background: 'linear-gradient(90deg, transparent, var(--accent), transparent)' }}
              />
              {/* Icon */}
              {item.icon && (
                <div
                  className="w-10 h-10 rounded-lg flex items-center justify-center mb-3"
                  style={{
                    background: 'linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(16, 185, 129, 0.1))',
                    color: 'var(--accent)',
                    boxShadow: '0 0 15px rgba(16, 185, 129, 0.2)'
                  }}
                >
                  {getCardIcon(item.icon)}
                </div>
              )}
              <h3 className="font-bold text-white mb-2 text-sm md:text-base">{item.title}</h3>
              <p className="text-neutral-400 text-xs md:text-sm leading-relaxed">{item.description}</p>
            </motion.div>
          ))}
        </div>
      </div>
    );

    // Elite Images Slide with dark gradient overlay
    const ImagesSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto slide-scroll overflow-y-auto py-8">
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">{data.title}</motion.h2>
        <div className="grid md:grid-cols-3 gap-4">
          {data.images.map((img, i) => (
            <motion.div
              key={i}
              initial={{ opacity: 0, scale: 0.9 }}
              animate={{ opacity: 1, scale: 1 }}
              transition={{ delay: 0.1 + i * 0.1 }}
              className="rounded-xl overflow-hidden relative"
              style={{
                boxShadow: '0 0 20px rgba(16, 185, 129, 0.1), 0 4px 15px rgba(0,0,0,0.3)'
              }}
            >
              <img src={img} alt={`Warehouse ${i + 1}`} className="w-full h-auto object-cover" />
              <div
                className="absolute bottom-0 left-0 right-0 h-1"
                style={{ background: 'linear-gradient(90deg, transparent, var(--accent), transparent)' }}
              />
            </motion.div>
          ))}
        </div>
      </div>
    );

    // Elite Implementation Slide with dark gradient styling
    const ImplementationSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-3xl mx-auto slide-scroll overflow-y-auto py-6">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-5">
          <span className="inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-semibold mb-3" style={{ background: `rgba(var(--accent-rgb), 0.1)`, color: 'var(--accent)' }}>
            <Icons.Package />
            Implementation
          </span>
          <h2 className="slide-title text-xl md:text-2xl lg:text-3xl text-black">{data.title}</h2>
        </motion.div>
        <motion.p initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-neutral-600 text-sm md:text-base leading-relaxed text-center mb-6">{data.concept}</motion.p>
        <div className="space-y-3 mb-6">
          {data.steps.map((step, i) => (
            <motion.div
              key={i}
              initial={{ opacity: 0, x: -15 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ delay: 0.15 + i * 0.08 }}
              className="flex items-start gap-3 rounded-xl p-3 relative overflow-hidden"
              style={{
                background: 'linear-gradient(135deg, #0a0a0a, #1a1a1a)',
                boxShadow: '0 2px 10px rgba(0,0,0,0.2)'
              }}
            >
              <span
                className="w-7 h-7 rounded-lg flex items-center justify-center text-xs font-bold text-white flex-shrink-0"
                style={{
                  background: `linear-gradient(135deg, var(--accent), var(--accent-dark))`,
                  boxShadow: '0 0 10px rgba(16, 185, 129, 0.3)'
                }}
              >
                {i + 1}
              </span>
              <p className="text-neutral-300 text-sm leading-relaxed pt-0.5">{step}</p>
            </motion.div>
          ))}
        </div>
        <motion.div
          initial={{ opacity: 0, y: 15 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.5 }}
          className="rounded-xl p-4 text-center mb-4 relative overflow-hidden"
          style={{
            background: 'linear-gradient(135deg, #0a0a0a, #1a1a1a)',
            boxShadow: '0 0 20px rgba(16, 185, 129, 0.15)'
          }}
        >
          <div
            className="absolute top-0 left-0 right-0 h-0.5"
            style={{ background: 'linear-gradient(90deg, transparent, var(--accent), transparent)' }}
          />
          <p className="text-neutral-300 text-sm flex items-center justify-center gap-2"><Icons.Zap className="flex-shrink-0" /><span>{data.insight}</span></p>
        </motion.div>
        {data.toolName && data.toolUrl && (
          <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ delay: 0.6 }} className="text-center">
            <a
              href={data.toolUrl}
              target="_blank"
              rel="noopener noreferrer"
              className="inline-flex items-center gap-2 px-5 py-2.5 rounded-xl text-white font-semibold text-sm transition-all hover:scale-[1.02]"
              style={{
                background: 'linear-gradient(135deg, var(--accent), var(--accent-dark))',
                boxShadow: '0 0 20px rgba(16, 185, 129, 0.3)'
              }}
            >
              <span>Connect {data.toolName}</span>
              <Icons.ExternalLink />
            </a>
          </motion.div>
        )}
      </div>
    );

    const QuizSlide = ({ data, onShowGif, onHideGif }) => {
      const [selected, setSelected] = useState(null);
      const [showFeedback, setShowFeedback] = useState(false);
      const celebrationGif = useMemo(() => getRandomCelebrationGif(), []);
      const empathyGif = useMemo(() => getRandomEmpathyGif(), []);
      const gifSide = useMemo(() => Math.random() > 0.5 ? 'left' : 'right', []);
      const handleSelect = (index) => { if (showFeedback) return; setSelected(index); setShowFeedback(true); };
      const isCorrect = selected === data.correctIndex;

      useEffect(() => { if (showFeedback) { if (isCorrect) { onShowGif(celebrationGif, '60%', gifSide); } else { onShowGif(empathyGif, '60%', gifSide); } } }, [showFeedback, isCorrect, celebrationGif, empathyGif, gifSide, onShowGif]);
      useEffect(() => { return () => onHideGif(); }, [onHideGif]);

      return (
        <div className="h-full w-full relative overflow-hidden">
          <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-2xl mx-auto slide-scroll overflow-y-auto py-8 md:py-10 relative z-30">
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6 relative z-10">
              <p className="text-xs uppercase tracking-wider text-neutral-400 mb-3">Quick Check</p>
              <h2 className="slide-title text-xl md:text-2xl text-black leading-tight">{data.question}</h2>
            </motion.div>
            <div className="space-y-3 mb-6">
              {data.options.map((option, i) => (
                <motion.button
                  key={i}
                  initial={{ opacity: 0, x: -15 }}
                  animate={{ opacity: 1, x: 0 }}
                  transition={{ delay: 0.08 + i * 0.06 }}
                  onClick={() => handleSelect(i)}
                  disabled={showFeedback}
                  className={`w-full p-4 rounded-xl text-left transition-all ${showFeedback ? i === data.correctIndex ? 'border-2 border-green-500' : i === selected ? 'border-2 border-red-400' : 'opacity-40' : 'hover:scale-[1.01]'}`}
                  style={{
                    background: showFeedback
                      ? (i === data.correctIndex ? 'linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(16, 185, 129, 0.1))'
                        : i === selected ? 'linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(239, 68, 68, 0.1))'
                        : 'linear-gradient(135deg, #f5f5f5, #e5e5e5)')
                      : 'linear-gradient(135deg, #0a0a0a, #1a1a1a)',
                    boxShadow: showFeedback ? 'none' : '0 2px 10px rgba(0,0,0,0.2)'
                  }}
                >
                  <div className="flex items-center gap-3">
                    <span
                      className={`w-8 h-8 rounded-lg flex items-center justify-center text-sm font-bold transition-all ${showFeedback && i === data.correctIndex ? 'bg-green-500 text-white' : showFeedback && i === selected && !isCorrect ? 'bg-red-400 text-white' : showFeedback ? 'bg-neutral-200 text-neutral-500' : 'text-neutral-400'}`}
                      style={!showFeedback ? { background: 'linear-gradient(135deg, #2d2d2d, #3d3d3d)' } : {}}
                    >
                      {showFeedback && i === data.correctIndex ? <Icons.Check /> : showFeedback && i === selected && !isCorrect ? <Icons.X /> : String.fromCharCode(65 + i)}
                    </span>
                    <span className={`text-sm md:text-base ${showFeedback ? 'text-neutral-700' : 'text-neutral-300'}`}>{option}</span>
                  </div>
                </motion.button>
              ))}
            </div>
            <AnimatePresence>
              {showFeedback && (
                <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className={`p-5 rounded-xl ${isCorrect ? 'bg-green-50 border border-green-200' : 'bg-amber-50 border border-amber-200'}`}>
                  <p className={`text-sm leading-relaxed ${isCorrect ? 'text-green-800' : 'text-amber-800'}`}>{isCorrect ? data.feedback.correct : data.feedback.incorrect}</p>
                </motion.div>
              )}
            </AnimatePresence>
          </div>
        </div>
      );
    };

    const CompletionSlide = ({ data }) => (
      <div className="h-full flex flex-col items-center justify-center text-center px-8 slide-scroll overflow-y-auto py-8">
        <motion.div
          initial={{ opacity: 0, scale: 0 }}
          animate={{ opacity: 1, scale: 1 }}
          transition={{ type: 'spring', duration: 0.5 }}
          className="w-16 h-16 rounded-xl flex items-center justify-center mb-4 text-white"
          style={{
            background: `linear-gradient(135deg, var(--accent), var(--accent-dark))`,
            boxShadow: `0 0 30px rgba(var(--accent-rgb), 0.5), 0 6px 24px rgba(var(--accent-rgb), 0.35)`
          }}
        >
          <Icons.Check />
        </motion.div>
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="slide-title text-2xl md:text-3xl text-black mb-3">Lesson Complete</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.25 }} className="text-neutral-500 text-sm mb-5 max-w-md leading-relaxed">You now know which private agent wins - and why having a backup costs nothing but gives you smart flexibility. Connect both and you're ahead of most dropshippers.</motion.p>
        <motion.div
          initial={{ opacity: 0, y: 15 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.35 }}
          className="rounded-xl p-5 max-w-md w-full mb-4 relative overflow-hidden"
          style={{
            background: 'linear-gradient(135deg, #0a0a0a, #1a1a1a)',
            boxShadow: '0 0 30px rgba(16, 185, 129, 0.15), 0 4px 20px rgba(0,0,0,0.3)'
          }}
        >
          <div
            className="absolute top-0 left-0 right-0 h-1"
            style={{ background: 'linear-gradient(90deg, transparent, var(--accent), transparent)' }}
          />
          <p className="text-neutral-500 text-xs uppercase tracking-wider mb-2">Up Next</p>
          <h3 className="text-white font-bold text-lg mb-1">{LESSON_CONFIG.nextLesson.title}</h3>
          <p className="text-neutral-400 text-xs">{LESSON_CONFIG.nextLesson.teaser}</p>
        </motion.div>
        {data?.sources && data.sources.length > 0 && (
          <motion.div
            initial={{ opacity: 0, y: 15 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.45 }}
            className="rounded-xl p-4 max-w-md w-full relative overflow-hidden"
            style={{
              background: 'linear-gradient(135deg, #f8f8f8, #f0f0f0)',
              border: '1px solid #e0e0e0'
            }}
          >
            <p className="text-neutral-400 text-xs uppercase tracking-wider mb-2 flex items-center justify-center gap-1"><Icons.Link /> Relevant Sources</p>
            <div className="space-y-1.5">
              {data.sources.map((source, i) => (
                <a key={i} href={source.url} target="_blank" rel="noopener noreferrer" className="flex items-center justify-center gap-2 text-sm font-medium transition-colors hover:underline" style={{ color: 'var(--accent)' }}>
                  {source.name}
                  <Icons.ExternalLink />
                </a>
              ))}
            </div>
          </motion.div>
        )}
      </div>
    );

    const LessonApp = () => {
      const [currentSlide, setCurrentSlide] = useState(getInitialSlide());
      const [direction, setDirection] = useState(1);
      const userName = useMemo(() => getUserName(), []);
      const currentSlideRef = React.useRef(0);
      const [gifConfig, setGifConfig] = useState(null);
      const [isAnimating, setIsAnimating] = useState(false);

      const showGif = useCallback((url, height, side) => setGifConfig({ url, height, side }), []);
      const hideGif = useCallback(() => setGifConfig(null), []);

      React.useEffect(() => { currentSlideRef.current = currentSlide; }, [currentSlide]);

      useEffect(() => {
        window.parent.postMessage({
          type: 'LESSON_SLIDE_UPDATE',
          slideIndex: currentSlide,
          slideType: slides[currentSlide]?.type,
          lessonSlug: LESSON_CONFIG.id
        }, '*');
      }, [currentSlide]);

      const goToSlide = useCallback((newSlide) => {
        if (isAnimating || newSlide < 0 || newSlide >= slides.length) return;
        setIsAnimating(true);
        setDirection(newSlide > currentSlideRef.current ? 1 : -1);
        setCurrentSlide(newSlide);
      }, [isAnimating]);

      const nextSlide = useCallback(() => { if (currentSlideRef.current + 1 < slides.length) goToSlide(currentSlideRef.current + 1); }, [goToSlide]);
      const prevSlide = useCallback(() => { if (currentSlideRef.current - 1 >= 0) goToSlide(currentSlideRef.current - 1); }, [goToSlide]);

      useEffect(() => {
        const handleKeyDown = (e) => {
          if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); nextSlide(); }
          if (e.key === 'ArrowLeft') { e.preventDefault(); prevSlide(); }
        };
        window.addEventListener('keydown', handleKeyDown);
        return () => window.removeEventListener('keydown', handleKeyDown);
      }, [nextSlide, prevSlide]);

      const slideVariants = {
        enter: (dir) => ({ x: dir > 0 ? '100%' : '-100%', opacity: 0 }),
        center: { x: 0, opacity: 1 },
        exit: (dir) => ({ x: dir > 0 ? '-100%' : '100%', opacity: 0 })
      };

      const renderSlide = (slide) => {
        switch (slide.type) {
          case 'welcome': return <WelcomeSlide data={slide} onStart={nextSlide} userName={userName} onShowGif={showGif} onHideGif={hideGif} />;
          case 'hook': return <HookSlide data={slide} />;
          case 'content': return <ContentSlide data={slide} />;
          case 'example': return <ExampleSlide data={slide} />;
          case 'visual': return <VisualSlide data={slide} />;
          case 'cards': return <CardsSlide data={slide} />;
          case 'images': return <ImagesSlide data={slide} />;
          case 'implementation': return <ImplementationSlide data={slide} />;
          case 'agentRankings': return <AgentRankingsSlide data={slide} />;
          case 'winnerHighlight': return <WinnerHighlightSlide data={slide} />;
          case 'howItWorksFlow': return <HowItWorksFlowSlide data={slide} />;
          case 'quiz': return <QuizSlide data={slide} onShowGif={showGif} onHideGif={hideGif} />;
          case 'completion': return <CompletionSlide data={slide} />;
          default: return null;
        }
      };

      const showPrev = currentSlide > 0;
      const showNext = currentSlide < slides.length - 1 && slides[currentSlide].type !== 'welcome';

      return (
        <div className="w-full h-screen bg-white flex flex-col relative">
          <div className="flex-1 relative overflow-hidden z-20">
            <AnimatePresence mode="wait" custom={direction} onExitComplete={() => setIsAnimating(false)}>
              <motion.div key={currentSlide} custom={direction} variants={slideVariants} initial="enter" animate="center" exit="exit" transition={{ duration: 0.3, ease: [0.25, 0.1, 0.25, 1] }} className="absolute inset-0">
                {renderSlide(slides[currentSlide])}
                <AdminSlideReportButton slideIndex={currentSlide} slideType={slides[currentSlide].type} />
              </motion.div>
            </AnimatePresence>
            {showPrev && <button onClick={prevSlide} className="absolute left-2 md:left-5 top-1/2 -translate-y-1/2 w-8 h-8 md:w-12 md:h-12 rounded-full bg-neutral-100/80 md:bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-400 md:text-neutral-500 hover:text-neutral-700 transition-all z-10 backdrop-blur-sm md:backdrop-blur-none"><Icons.ArrowLeft /></button>}
            {showNext && <button onClick={nextSlide} className="absolute right-2 md:right-5 top-1/2 -translate-y-1/2 w-8 h-8 md:w-12 md:h-12 rounded-full bg-neutral-100/80 md:bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-400 md:text-neutral-500 hover:text-neutral-700 transition-all z-10 backdrop-blur-sm md:backdrop-blur-none"><Icons.ArrowRight /></button>}
          </div>
          <div className="px-6 md:px-8 py-5 border-t border-neutral-100 flex-shrink-0 relative z-10">
            <div className="flex items-center justify-center gap-2.5">
              {slides.map((_, i) => <button key={i} onClick={() => goToSlide(i)} className="w-2.5 h-2.5 rounded-full transition-all duration-300" style={{ background: i === currentSlide ? 'var(--accent)' : '#d4d4d4', transform: i === currentSlide ? 'scale(1.3)' : 'scale(1)' }} />)}
            </div>
          </div>
          <AnimatePresence>
            {gifConfig && (
              <motion.div initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: 30 }} transition={{ type: 'spring', stiffness: 100 }} className={`absolute ${gifConfig.side === 'left' ? 'left-4 md:left-8' : 'right-4 md:right-8'} bottom-0 pointer-events-none`} style={{ zIndex: 15, height: gifConfig.height }}>
                <video autoPlay loop muted playsInline className="h-full w-auto object-contain object-bottom" style={{ background: 'transparent', border: 'none', boxShadow: 'none' }}>
                  <source src={gifConfig.url} type="video/mp4" />
                </video>
              </motion.div>
            )}
          </AnimatePresence>
        </div>
      );
    };

    ReactDOM.render(<LessonApp />, document.getElementById('root'));
  </script>
</body>
</html>
