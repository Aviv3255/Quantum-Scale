<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Trust Blueprint | Quantum Scale</title>
  <script src="https://cdn.tailwindcss.com" defer></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" defer></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" defer></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js" defer></script>
  <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js" defer></script>
  <script src="../shared/greetings.js" defer></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;500;600;700;800;900&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root { --accent: #22c55e; --accent-dark: #16a34a; --accent-light: #4ade80; --accent-rgb: 34, 197, 94; }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Inter', sans-serif; background: transparent; -webkit-font-smoothing: antialiased; }
    .title-font { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    h1, h2, h3, .slide-title { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    ::selection { background: var(--accent); color: white; }
    .slide-scroll::-webkit-scrollbar { display: none; }
    .slide-scroll { -ms-overflow-style: none; scrollbar-width: none; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { motion, AnimatePresence } = window.Motion;
    const { useState, useEffect, useCallback, useMemo } = React;

    const getUserName = () => { const params = new URLSearchParams(window.location.search); return params.get('userName') || 'Builder'; };
    const getInitialSlide = () => { const params = new URLSearchParams(window.location.search); const slide = params.get('slide'); return slide ? parseInt(slide, 10) : 0; };

    const LESSON_CONFIG = {
      id: 'trust-blueprint',
      title: 'The Trust Blueprint',
      accentColor: '#22c55e',
      duration: '9 min',
      nextLesson: { id: 'identity-marketing', title: 'Identity Marketing', teaser: 'Sell to who they WANT to be, not who they are.' }
    };

    const AdminSlideReportButton = ({ slideIndex, slideType }) => {
      const handleReport = (e) => {
        e.stopPropagation();
        if (window.parent !== window) {
          window.parent.postMessage({ type: 'ADMIN_REPORT_REQUEST', slideIndex, slideType, lessonSlug: LESSON_CONFIG.id }, '*');
        }
      };
      return (
        <button onClick={handleReport} title={`Report issue on Slide ${slideIndex + 1}`}
          style={{ position: 'absolute', top: '12px', right: '12px', width: '32px', height: '32px', borderRadius: '8px', backgroundColor: 'rgba(239, 68, 68, 0.9)', color: 'white', border: 'none', cursor: 'pointer', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 1000, opacity: 0.6, transition: 'opacity 0.2s' }}
          onMouseEnter={(e) => e.currentTarget.style.opacity = '1'}
          onMouseLeave={(e) => e.currentTarget.style.opacity = '0.6'}>
          <img src="https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/admin-bug-icon.svg" alt="Report" style={{ width: '16px', height: '16px', filter: 'invert(1)' }} />
        </button>
      );
    };

    const celebrationGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_doing_a_quick_victory_dance_move_high_energy_c_d03b798b-a518-4e6c-bcae-d69b2dd50486_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_jumping_in_the_air_arms_raised_high_YESSS_cele_201477e8-3df4-405a-bc81-81d1747e5c6c_2.mp4'
    ];
    const getRandomCelebrationGif = () => celebrationGifs[Math.floor(Math.random() * celebrationGifs.length)];

    const empathyGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_shaking_head_side_to_side_sadly_disappointed_e_c4a4be22-6a70-4738-8612-3039454fef37_1.mp4'
    ];
    const getRandomEmpathyGif = () => empathyGifs[Math.floor(Math.random() * empathyGifs.length)];

    // AnimatedCounter with decimal support
    const AnimatedCounter = ({ value, duration = 2000, suffix = '', prefix = '', decimals = 0 }) => {
      const [count, setCount] = useState(0);
      useEffect(() => {
        let start = 0;
        const end = parseFloat(value);
        const increment = end / (duration / 16);
        const timer = setInterval(() => {
          start += increment;
          if (start >= end) { setCount(end); clearInterval(timer); }
          else { setCount(start); }
        }, 16);
        return () => clearInterval(timer);
      }, [value, duration]);
      return <span>{prefix}{decimals > 0 ? count.toFixed(decimals) : Math.round(count)}{suffix}</span>;
    };

    const slides = [
      { type: 'welcome', learningGoals: ['Why trust is the ultimate conversion currency', 'The 3 Trust Triggers that eliminate skepticism', 'How to build guarantees that actually convert', 'The Trust Pyramid for systematic trust building'] },
      { type: 'hook', headline: 'Your customer carries invisible shields. Protective barriers built from years of being scammed, disappointed, let down.', subtext: 'Their default mode is skepticism. Your job isn\'t to overcome it through force—it\'s to systematically lower those shields through trust architecture.' },
      { type: 'trustCurrency' },
      { type: 'trustControlPanel' },
      { type: 'socialProofGrid' },
      { type: 'trustStackBattle' },
      { type: 'haloRadiance' },
      { type: 'riskMeter' },
      { type: 'guaranteeFormula' },
      { type: 'trustPyramid' },
      { type: 'quiz', question: 'Which guarantee is most likely to convert hesitant buyers?', options: [
        { text: '"30-day money-back guarantee"', correct: false },
        { text: '"Try risk-free"', correct: false },
        { text: '"Double your revenue or we pay you $500"', correct: true },
        { text: '"Satisfaction guaranteed"', correct: false }
      ], explanation: 'Specific, bold guarantees that stake something real convert best. Vague guarantees are forgettable. Putting skin in the game builds trust.' },
      { type: 'trustStats' },
      { type: 'tool', title: 'Implementing Trust Badges', intro: 'Here\'s how to add trust signals to your store:', steps: [
        { step: 1, title: 'Install Essential Trust Badges', description: 'Get the app from the Shopify App Store. Most offer free trials.' },
        { step: 2, title: 'Choose badge styles', description: 'Select designs that match your brand aesthetic.' },
        { step: 3, title: 'Strategic placement', description: 'Place near Add to Cart buttons and at checkout for maximum impact.' },
        { step: 4, title: 'Add payment icons', description: 'Enable Visa, Mastercard, PayPal, and secure checkout badges.' }
      ], toolUrl: 'https://platform.shoffi.app/r/rl_uUHJkiZx', cta: 'Get Started Free' },
      { type: 'eliteInsight' },
      { type: 'completion', title: 'Trust Blueprint: Mastered', message: 'You now know how to turn skeptical strangers into confident buyers. Trust isn\'t built by accident—it\'s engineered.' }
    ];

    const Icons = {
      Clock: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
      Check: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><polyline points="20 6 9 17 4 12"/></svg>,
      X: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
      ArrowLeft: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>,
      ArrowRight: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>,
      Shield: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>,
      Star: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>,
      Users: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>,
      Sparkles: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/></svg>,
      Zap: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
      Eye: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>,
      Target: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>,
      DollarSign: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>,
      Lock: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>,
      Lightbulb: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M15.09 14c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 18 8 6 6 0 0 0 6 8c0 1 .23 2.23 1.5 3.5A4.61 4.61 0 0 1 8.91 14"/></svg>,
      TrendingUp: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>,
      ExternalLink: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
    };

    // ========== WELCOME SLIDE ==========
    const WelcomeSlide = ({ data, onStart, userName }) => {
      const welcomeData = useMemo(() => getTimeBasedWelcome(), []);
      return (
        <div className="h-full w-full relative overflow-hidden">
          <div className="h-full flex flex-col items-center justify-center text-center px-6 py-4 relative z-20">
            <motion.h1 initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} className="title-font text-3xl sm:text-4xl md:text-5xl lg:text-6xl text-black mb-2 md:mb-3">{LESSON_CONFIG.title}</motion.h1>
            <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-neutral-600 text-base md:text-lg lg:text-xl mb-2 md:mb-3 max-w-lg leading-relaxed" dangerouslySetInnerHTML={{ __html: formatGreeting(welcomeData.greeting, `<span class="font-bold text-neutral-900">${userName}</span>`) }} />
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="flex items-center justify-center gap-1.5 text-neutral-400 text-[10px] md:text-xs mb-2 md:mb-3"><Icons.Clock /><span>{LESSON_CONFIG.duration}</span></motion.div>
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 }} className="bg-neutral-900 rounded-xl md:rounded-2xl p-3 md:p-5 mb-3 md:mb-4 max-w-sm w-full mx-auto">
              <p className="text-neutral-500 text-[9px] md:text-[11px] uppercase tracking-wider mb-2 md:mb-3">In this lesson</p>
              <ul className="space-y-1.5 md:space-y-2">
                {data.learningGoals.map((goal, i) => (
                  <motion.li key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.25 + i * 0.05 }} className="flex items-start gap-2 text-left">
                    <span className="w-5 h-5 rounded-md flex items-center justify-center text-[9px] font-bold text-white flex-shrink-0 mt-0.5" style={{ background: 'linear-gradient(135deg, var(--accent), var(--accent-dark))' }}>{i + 1}</span>
                    <span className="text-neutral-300 text-[11px] md:text-sm leading-snug">{goal}</span>
                  </motion.li>
                ))}
              </ul>
            </motion.div>
            <motion.button initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.45 }} onClick={onStart} whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }} className="px-6 md:px-7 py-2.5 md:py-3 rounded-xl text-white font-semibold text-sm md:text-base" style={{ background: 'linear-gradient(135deg, var(--accent), var(--accent-dark))' }}>Let's Go</motion.button>
          </div>
        </div>
      );
    };

    // ========== HOOK SLIDE ==========
    const HookSlide = ({ data }) => (
      <div className="h-full relative overflow-hidden">
        <div className="h-full flex flex-col justify-center px-6 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-8 md:py-10 relative z-10">
          <motion.div initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} className="mb-4 md:mb-6">
            <span className="inline-block px-3 py-1 rounded-full text-xs font-semibold mb-3 md:mb-4" style={{ background: 'rgba(var(--accent-rgb), 0.1)', color: 'var(--accent)' }}>The Hook</span>
            <h2 className="slide-title text-2xl md:text-4xl lg:text-5xl text-black leading-tight">{data.headline}</h2>
          </motion.div>
          <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="text-base md:text-xl text-neutral-600 leading-relaxed">{data.subtext}</motion.p>
        </div>
      </div>
    );

    // ========== TRUST CURRENCY SLIDE - Big Statement with animated glow ==========
    const TrustCurrencySlide = ({ data }) => {
      const [glowing, setGlowing] = useState(0);
      useEffect(() => {
        const timer = setInterval(() => setGlowing(prev => (prev + 1) % 3), 2000);
        return () => clearInterval(timer);
      }, []);

      return (
        <div className="h-full flex flex-col justify-center items-center px-6 md:px-16 max-w-4xl mx-auto text-center">
          <motion.div initial={{ opacity: 0, scale: 0.8 }} animate={{ opacity: 1, scale: 1 }} transition={{ type: 'spring', damping: 15 }}
            className="mb-6 relative" style={{ width: '120px', height: '120px' }}>
            <div style={{
              width: '100%', height: '100%', borderRadius: '50%',
              background: 'linear-gradient(135deg, #22c55e, #16a34a)',
              display: 'flex', alignItems: 'center', justifyContent: 'center',
              boxShadow: glowing === 0 ? '0 0 60px rgba(34, 197, 94, 0.6)' : '0 0 30px rgba(34, 197, 94, 0.3)',
              transition: 'box-shadow 0.5s ease'
            }}>
              <Icons.DollarSign />
              <span style={{ color: 'white', fontSize: '40px', fontWeight: 900 }}>$</span>
            </div>
          </motion.div>
          <motion.p initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 }} className="text-xl md:text-2xl text-neutral-500 mb-2">Trust is the ultimate</motion.p>
          <motion.h2 initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.3 }} className="slide-title text-4xl md:text-5xl lg:text-6xl mb-6" style={{ color: 'var(--accent)' }}>Conversion Currency.</motion.h2>
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.5 }}
            style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '16px', padding: '20px 32px', maxWidth: '500px' }}>
            <p className="text-neutral-300 text-sm md:text-base">Without it, nothing else matters.<br/>With it, <span style={{ color: '#22c55e', fontWeight: 600 }}>price becomes secondary.</span></p>
          </motion.div>
        </div>
      );
    };

    // ========== TRUST CONTROL PANEL SLIDE - 3 triggers with animated meters ==========
    const TrustControlPanelSlide = ({ data }) => {
      const [activeIndex, setActiveIndex] = useState(0);
      const triggers = [
        { name: 'Social Proof', description: '"People like me do this"', level: 90, icon: Icons.Users },
        { name: 'Halo Effect', description: 'First impressions matter', level: 85, icon: Icons.Sparkles },
        { name: 'Risk Reversal', description: 'Eliminate fear completely', level: 95, icon: Icons.Shield }
      ];

      useEffect(() => {
        const timer = setInterval(() => setActiveIndex(prev => (prev + 1) % triggers.length), 3000);
        return () => clearInterval(timer);
      }, []);

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8">
          <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">The Trust Control Panel</motion.h2>
          <div className="space-y-4">
            {triggers.map((trigger, i) => {
              const Icon = trigger.icon;
              const isActive = activeIndex === i;
              return (
                <motion.div key={i} initial={{ opacity: 0, x: -30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.1 + i * 0.1 }}
                  style={{
                    background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)',
                    borderRadius: '16px', padding: '20px 24px',
                    border: isActive ? '2px solid #22c55e' : '2px solid transparent',
                    boxShadow: isActive ? '0 0 30px rgba(34, 197, 94, 0.3)' : 'none',
                    transition: 'all 0.4s ease'
                  }}>
                  <div className="flex items-center justify-between mb-3">
                    <div className="flex items-center gap-3">
                      <div style={{ width: '40px', height: '40px', borderRadius: '10px', background: 'linear-gradient(135deg, #22c55e, #16a34a)', display: 'flex', alignItems: 'center', justifyContent: 'center', color: 'white' }}>
                        <Icon />
                      </div>
                      <div>
                        <h3 className="font-bold text-white text-lg">{trigger.name}</h3>
                        <p className="text-neutral-400 text-sm">{trigger.description}</p>
                      </div>
                    </div>
                    <span className="text-2xl font-bold" style={{ color: '#22c55e' }}>{trigger.level}%</span>
                  </div>
                  <div style={{ width: '100%', height: '8px', background: '#374151', borderRadius: '4px', overflow: 'hidden' }}>
                    <motion.div initial={{ width: 0 }} animate={{ width: `${trigger.level}%` }} transition={{ delay: 0.3 + i * 0.1, duration: 1 }}
                      style={{ height: '100%', background: 'linear-gradient(90deg, #22c55e, #4ade80)', borderRadius: '4px' }} />
                  </div>
                </motion.div>
              );
            })}
          </div>
        </div>
      );
    };

    // ========== SOCIAL PROOF GRID SLIDE ==========
    const SocialProofGridSlide = ({ data }) => {
      const [activeIndex, setActiveIndex] = useState(0);
      const elements = [
        { type: 'Reviews', example: '4.9/5 from 2,341 reviews', impact: 'High', icon: Icons.Star },
        { type: 'Testimonials', example: '"This changed my business" - Sarah L.', impact: 'Very High', icon: Icons.Users },
        { type: 'Numbers', example: 'Join 50,000+ marketers', impact: 'High', icon: Icons.TrendingUp },
        { type: 'Live Activity', example: 'John from NYC just purchased...', impact: 'Medium', icon: Icons.Zap }
      ];

      useEffect(() => {
        const timer = setInterval(() => setActiveIndex(prev => (prev + 1) % elements.length), 2500);
        return () => clearInterval(timer);
      }, []);

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8">
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
            <span style={{ display: 'inline-block', padding: '4px 12px', borderRadius: '20px', fontSize: '12px', fontWeight: 600, background: 'rgba(34, 197, 94, 0.1)', color: '#22c55e', marginBottom: '8px' }}>Trigger #1</span>
            <h2 className="slide-title text-2xl md:text-3xl text-black">Social Proof</h2>
            <p className="text-neutral-600 mt-2">We look to others to determine our own actions.</p>
          </motion.div>
          <div className="grid md:grid-cols-2 gap-4">
            {elements.map((el, i) => {
              const Icon = el.icon;
              const isActive = activeIndex === i;
              return (
                <motion.div key={i} initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 + i * 0.1 }}
                  style={{
                    background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)',
                    borderRadius: '16px', padding: '20px',
                    border: isActive ? '2px solid #22c55e' : '2px solid transparent',
                    boxShadow: isActive ? '0 0 25px rgba(34, 197, 94, 0.25)' : 'none',
                    transition: 'all 0.4s ease'
                  }}>
                  <div className="flex items-center justify-between mb-3">
                    <div className="flex items-center gap-2">
                      <div style={{ color: '#22c55e' }}><Icon /></div>
                      <h3 className="font-bold text-white">{el.type}</h3>
                    </div>
                    <span style={{
                      fontSize: '11px', padding: '4px 10px', borderRadius: '12px',
                      background: el.impact === 'Very High' ? 'rgba(34, 197, 94, 0.2)' : el.impact === 'High' ? 'rgba(59, 130, 246, 0.2)' : 'rgba(156, 163, 175, 0.2)',
                      color: el.impact === 'Very High' ? '#22c55e' : el.impact === 'High' ? '#3b82f6' : '#9ca3af'
                    }}>{el.impact}</span>
                  </div>
                  <p className="text-neutral-400 text-sm italic">"{el.example}"</p>
                </motion.div>
              );
            })}
          </div>
        </div>
      );
    };

    // ========== TRUST STACK BATTLE SLIDE ==========
    const TrustStackBattleSlide = ({ data }) => {
      const [showWinner, setShowWinner] = useState(false);
      useEffect(() => {
        const timer = setTimeout(() => setShowWinner(true), 2000);
        return () => clearTimeout(timer);
      }, []);

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8">
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
            <span style={{ display: 'inline-block', padding: '4px 12px', borderRadius: '20px', fontSize: '12px', fontWeight: 600, background: 'rgba(34, 197, 94, 0.1)', color: '#22c55e', marginBottom: '8px' }}>Real Example</span>
            <h2 className="slide-title text-2xl md:text-3xl text-black">Trust Stack Showdown</h2>
          </motion.div>
          <div className="grid md:grid-cols-2 gap-6">
            <motion.div initial={{ opacity: 0, x: -30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.1 }}
              style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '16px', padding: '24px', border: '2px solid #ef4444' }}>
              <div className="flex items-center gap-2 mb-4">
                <div style={{ width: '28px', height: '28px', borderRadius: '50%', background: '#ef4444', display: 'flex', alignItems: 'center', justifyContent: 'center', color: 'white' }}><Icons.X /></div>
                <span className="font-bold text-red-400">Weak Trust</span>
              </div>
              <div style={{ background: '#374151', borderRadius: '12px', padding: '16px', marginBottom: '16px' }}>
                <p className="text-neutral-300 text-sm">Great Product</p>
                <p className="text-neutral-300 text-sm mt-2">Buy Now</p>
              </div>
              <div style={{ background: 'rgba(239, 68, 68, 0.1)', borderRadius: '8px', padding: '12px', textAlign: 'center' }}>
                <span className="text-red-400 text-2xl font-bold">2.1%</span>
                <p className="text-neutral-400 text-xs">conversion</p>
              </div>
            </motion.div>
            <motion.div initial={{ opacity: 0, x: 30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.2 }}
              style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '16px', padding: '24px', border: '2px solid #22c55e', position: 'relative' }}>
              {showWinner && (
                <motion.div initial={{ scale: 0, rotate: -10 }} animate={{ scale: 1, rotate: 0 }}
                  style={{ position: 'absolute', top: '-12px', right: '-12px', background: '#22c55e', color: 'white', padding: '6px 12px', borderRadius: '8px', fontSize: '12px', fontWeight: 700 }}>WINNER</motion.div>
              )}
              <div className="flex items-center gap-2 mb-4">
                <div style={{ width: '28px', height: '28px', borderRadius: '50%', background: '#22c55e', display: 'flex', alignItems: 'center', justifyContent: 'center', color: 'white' }}><Icons.Check /></div>
                <span className="font-bold text-green-400">Trust Stack</span>
              </div>
              <div style={{ background: '#374151', borderRadius: '12px', padding: '16px', marginBottom: '16px' }}>
                <p className="text-yellow-400 text-sm mb-1">★★★★★ 4.9/5 (2,341 reviews)</p>
                <p className="text-neutral-300 text-sm italic mb-2">"This tool changed the game for our ROI."</p>
                <p className="text-neutral-400 text-xs mb-2">- Sarah L., Head of Growth</p>
                <p className="text-neutral-300 text-sm">Join 50,000+ Marketers Who Trust Us</p>
              </div>
              <div style={{ background: 'rgba(34, 197, 94, 0.1)', borderRadius: '8px', padding: '12px', textAlign: 'center' }}>
                <span className="text-green-400 text-2xl font-bold">8.4%</span>
                <p className="text-neutral-400 text-xs">conversion</p>
              </div>
            </motion.div>
          </div>
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.5 }}
            style={{ marginTop: '24px', textAlign: 'center', background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '12px', padding: '16px' }}>
            <span style={{ color: '#22c55e', fontWeight: 700, fontSize: '18px' }}>+300% LIFT</span>
            <span className="text-neutral-400 text-sm ml-2">— Full trust stack outperforms minimal copy</span>
          </motion.div>
        </div>
      );
    };

    // ========== HALO RADIANCE SLIDE ==========
    const HaloRadianceSlide = ({ data }) => {
      const [activeIndex, setActiveIndex] = useState(0);
      const applications = [
        { area: 'Design', impact: 'Professional design = trustworthy business', icon: Icons.Eye },
        { area: 'First Touch', impact: 'First ad/email must be exceptional quality', icon: Icons.Zap },
        { area: 'Load Speed', impact: 'Fast = modern = reliable', icon: Icons.TrendingUp }
      ];

      useEffect(() => {
        const timer = setInterval(() => setActiveIndex(prev => (prev + 1) % applications.length), 2500);
        return () => clearInterval(timer);
      }, []);

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-3xl mx-auto slide-scroll overflow-y-auto py-8">
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
            <span style={{ display: 'inline-block', padding: '4px 12px', borderRadius: '20px', fontSize: '12px', fontWeight: 600, background: 'rgba(34, 197, 94, 0.1)', color: '#22c55e', marginBottom: '8px' }}>Trigger #2</span>
            <h2 className="slide-title text-2xl md:text-3xl text-black">The Halo Effect</h2>
            <p className="text-neutral-600 mt-2">A positive first impression colors ALL future judgments.</p>
          </motion.div>
          <div className="space-y-4 mb-6">
            {applications.map((app, i) => {
              const Icon = app.icon;
              const isActive = activeIndex === i;
              return (
                <motion.div key={i} initial={{ opacity: 0, x: -20 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.1 + i * 0.1 }}
                  style={{
                    background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)',
                    borderRadius: '16px', padding: '20px',
                    display: 'flex', alignItems: 'center', gap: '16px',
                    border: isActive ? '2px solid #22c55e' : '2px solid transparent',
                    boxShadow: isActive ? '0 0 30px rgba(34, 197, 94, 0.25)' : 'none',
                    transition: 'all 0.4s ease'
                  }}>
                  <div style={{ width: '48px', height: '48px', borderRadius: '12px', background: 'linear-gradient(135deg, #22c55e, #16a34a)', display: 'flex', alignItems: 'center', justifyContent: 'center', color: 'white', flexShrink: 0 }}>
                    <Icon />
                  </div>
                  <div>
                    <h3 className="font-bold text-white text-lg">{app.area}</h3>
                    <p className="text-neutral-400 text-sm">{app.impact}</p>
                  </div>
                </motion.div>
              );
            })}
          </div>
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.5 }}
            style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '16px', padding: '20px', textAlign: 'center' }}>
            <p className="text-white text-sm">One strong positive impression creates a <span style={{ color: '#22c55e', fontWeight: 600 }}>"halo"</span> that protects against minor issues.</p>
          </motion.div>
        </div>
      );
    };

    // ========== RISK METER SLIDE ==========
    const RiskMeterSlide = ({ data }) => {
      const [activeIndex, setActiveIndex] = useState(0);
      const levels = [
        { level: 'Standard', example: '30-Day Money-Back Guarantee', strength: 60 },
        { level: 'Strong', example: '"Love it or it\'s FREE"', strength: 80 },
        { level: 'Ultimate', example: '"Make $X or we refund 2X"', strength: 100 }
      ];

      useEffect(() => {
        const timer = setInterval(() => setActiveIndex(prev => (prev + 1) % levels.length), 2500);
        return () => clearInterval(timer);
      }, []);

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8">
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
            <span style={{ display: 'inline-block', padding: '4px 12px', borderRadius: '20px', fontSize: '12px', fontWeight: 600, background: 'rgba(34, 197, 94, 0.1)', color: '#22c55e', marginBottom: '8px' }}>Trigger #3</span>
            <h2 className="slide-title text-2xl md:text-3xl text-black">Risk Reversal</h2>
            <p className="text-neutral-600 mt-2">The closer to zero perceived risk, the higher the conversion rate.</p>
          </motion.div>
          <div className="space-y-4">
            {levels.map((lvl, i) => {
              const isActive = activeIndex === i;
              return (
                <motion.div key={i} initial={{ opacity: 0, x: -20 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.1 + i * 0.1 }}
                  style={{
                    background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)',
                    borderRadius: '16px', padding: '20px',
                    border: isActive ? '2px solid #22c55e' : '2px solid transparent',
                    boxShadow: isActive ? '0 0 30px rgba(34, 197, 94, 0.25)' : 'none',
                    transition: 'all 0.4s ease'
                  }}>
                  <div className="flex items-center justify-between mb-3">
                    <div className="flex items-center gap-3">
                      <span style={{ width: '32px', height: '32px', borderRadius: '8px', background: 'linear-gradient(135deg, #22c55e, #16a34a)', display: 'flex', alignItems: 'center', justifyContent: 'center', color: 'white', fontWeight: 700, fontSize: '14px' }}>{i + 1}</span>
                      <span className="font-bold text-white text-lg">{lvl.level}</span>
                    </div>
                    <span className="text-xl font-bold" style={{ color: '#22c55e' }}>{lvl.strength}%</span>
                  </div>
                  <p className="text-neutral-400 text-sm italic mb-3">"{lvl.example}"</p>
                  <div style={{ width: '100%', height: '10px', background: '#374151', borderRadius: '5px', overflow: 'hidden' }}>
                    <motion.div initial={{ width: 0 }} animate={{ width: `${lvl.strength}%` }} transition={{ delay: 0.3 + i * 0.1, duration: 1 }}
                      style={{ height: '100%', background: `linear-gradient(90deg, #22c55e, ${lvl.strength === 100 ? '#4ade80' : '#22c55e'})`, borderRadius: '5px' }} />
                  </div>
                </motion.div>
              );
            })}
          </div>
        </div>
      );
    };

    // ========== GUARANTEE FORMULA SLIDE ==========
    const GuaranteeFormulaSlide = ({ data }) => {
      const [activeIndex, setActiveIndex] = useState(0);
      const components = [
        { element: 'Time Frame', examples: ['30 days', '60 days', 'Lifetime'], color: '#3b82f6' },
        { element: 'Condition', examples: ['No questions asked', 'If you don\'t see results', 'If you\'re not 100% satisfied'], color: '#8b5cf6' },
        { element: 'Stakes', examples: ['Full refund', 'Double your money back', 'Keep the bonuses anyway'], color: '#22c55e' }
      ];

      useEffect(() => {
        const timer = setInterval(() => setActiveIndex(prev => (prev + 1) % components.length), 2000);
        return () => clearInterval(timer);
      }, []);

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8">
          <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-6">Building Powerful Guarantees</motion.h2>
          <div className="grid md:grid-cols-3 gap-4 mb-6">
            {components.map((comp, i) => {
              const isActive = activeIndex === i;
              return (
                <motion.div key={i} initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 + i * 0.1 }}
                  style={{
                    background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)',
                    borderRadius: '16px', padding: '20px',
                    border: isActive ? `2px solid ${comp.color}` : '2px solid transparent',
                    boxShadow: isActive ? `0 0 25px ${comp.color}40` : 'none',
                    transition: 'all 0.4s ease'
                  }}>
                  <div style={{ width: '100%', height: '4px', background: `linear-gradient(90deg, transparent, ${comp.color}, transparent)`, borderRadius: '2px', marginBottom: '16px' }} />
                  <h3 className="font-bold text-lg mb-3" style={{ color: comp.color }}>{comp.element}</h3>
                  <ul className="space-y-2">
                    {comp.examples.map((ex, j) => (
                      <li key={j} className="text-neutral-400 text-sm flex items-start gap-2">
                        <span style={{ color: comp.color }}>•</span>{ex}
                      </li>
                    ))}
                  </ul>
                </motion.div>
              );
            })}
          </div>
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.5 }}
            style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '16px', padding: '20px', textAlign: 'center' }}>
            <p className="text-white font-mono text-sm">[Time Frame] + [Condition] + [Stakes] = <span style={{ color: '#22c55e', fontWeight: 700 }}>Irresistible Guarantee</span></p>
          </motion.div>
        </div>
      );
    };

    // ========== TRUST PYRAMID SLIDE ==========
    const TrustPyramidSlide = ({ data }) => {
      const [activeLayer, setActiveLayer] = useState(0);
      const layers = [
        { label: 'Risk Reversal', description: 'Foundation: Remove all fear', color: '#22c55e' },
        { label: 'Social Proof', description: 'Validation: Others trust you', color: '#3b82f6' },
        { label: 'Halo Effect', description: 'Perception: Premium = Trustworthy', color: '#8b5cf6' }
      ];

      useEffect(() => {
        const timer = setInterval(() => setActiveLayer(prev => (prev + 1) % layers.length), 2500);
        return () => clearInterval(timer);
      }, []);

      return (
        <div className="h-full flex flex-col justify-center items-center px-6 md:px-12 max-w-4xl mx-auto">
          <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">The Trust Pyramid</motion.h2>
          <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', gap: '8px' }}>
            {layers.slice().reverse().map((layer, i) => {
              const actualIndex = layers.length - 1 - i;
              const isActive = activeLayer === actualIndex;
              const widthPercent = 40 + (i * 25);
              return (
                <motion.div key={actualIndex} initial={{ opacity: 0, scale: 0.9 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.1 + i * 0.15 }}
                  style={{
                    width: `${widthPercent}%`, minWidth: '200px', maxWidth: '400px',
                    background: isActive ? layer.color : 'linear-gradient(135deg, #1a1a1a, #2d2d2d)',
                    borderRadius: '12px', padding: '16px 24px', textAlign: 'center',
                    boxShadow: isActive ? `0 0 30px ${layer.color}60` : 'none',
                    transition: 'all 0.4s ease'
                  }}>
                  <h3 className="font-bold text-white text-sm md:text-base">{layer.label}</h3>
                  <p className="text-neutral-300 text-xs mt-1" style={{ opacity: isActive ? 1 : 0.7 }}>{layer.description}</p>
                </motion.div>
              );
            })}
          </div>
          <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.6 }}
            className="text-neutral-500 text-sm mt-6 text-center">Build from the foundation up for maximum trust.</motion.p>
        </div>
      );
    };

    // ========== TRUST STATS SLIDE ==========
    const TrustStatsSlide = ({ data }) => {
      const [glowIndex, setGlowIndex] = useState(0);
      const stats = [
        { value: 89, suffix: '%', label: 'higher conversion', subtext: 'With full trust stack vs minimal copy' },
        { value: 4, suffix: 'x', label: 'more trust', subtext: 'Specific guarantees vs vague ones' },
        { value: 2.1, suffix: 's', label: 'to judge', subtext: 'Time visitors take to form first impression', decimals: 1 }
      ];

      useEffect(() => {
        const timer = setInterval(() => setGlowIndex(prev => (prev + 1) % stats.length), 2000);
        return () => clearInterval(timer);
      }, []);

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8">
          <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">Trust By The Numbers</motion.h2>
          <div className="grid md:grid-cols-3 gap-4">
            {stats.map((stat, i) => {
              const isGlowing = glowIndex === i;
              return (
                <motion.div key={i} initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 + i * 0.1 }}
                  style={{
                    background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)',
                    borderRadius: '16px', padding: '24px', textAlign: 'center',
                    boxShadow: isGlowing ? '0 0 40px rgba(34, 197, 94, 0.4)' : 'none',
                    transition: 'box-shadow 0.4s ease'
                  }}>
                  <div style={{ width: '100%', height: '4px', background: 'linear-gradient(90deg, transparent, #22c55e, transparent)', borderRadius: '2px', marginBottom: '16px' }} />
                  <div className="text-4xl md:text-5xl font-bold mb-2" style={{ color: '#22c55e' }}>
                    <AnimatedCounter value={stat.value} suffix={stat.suffix} decimals={stat.decimals || 0} />
                  </div>
                  <div className="text-sm font-semibold text-white mb-1">{stat.label}</div>
                  <div className="text-xs text-neutral-400">{stat.subtext}</div>
                </motion.div>
              );
            })}
          </div>
        </div>
      );
    };

    // ========== QUIZ SLIDE ==========
    const QuizSlide = ({ data, onShowGif, onHideGif }) => {
      const [selected, setSelected] = useState(null);
      const [showResult, setShowResult] = useState(false);
      const handleSelect = (i) => { if (showResult) return; setSelected(i); setShowResult(true);
        if (data.options[i].correct) onShowGif(getRandomCelebrationGif(), '45%', 'right');
        else onShowGif(getRandomEmpathyGif(), '45%', 'right');
      };
      useEffect(() => () => onHideGif(), []);
      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-3xl mx-auto slide-scroll overflow-y-auto py-8">
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
            <p className="text-neutral-500 text-sm mb-2">Quick Check</p>
            <h2 className="slide-title text-xl md:text-2xl text-black">{data.question}</h2>
          </motion.div>
          <div className="space-y-3">
            {data.options.map((opt, i) => {
              const letter = String.fromCharCode(65 + i);
              const isSelected = selected === i;
              const isCorrect = opt.correct;
              let bg = 'linear-gradient(135deg, #1a1a1a, #2d2d2d)';
              let border = '2px solid transparent';
              if (showResult && isSelected) { bg = isCorrect ? 'linear-gradient(135deg, #166534, #22c55e)' : 'linear-gradient(135deg, #991b1b, #ef4444)'; border = isCorrect ? '2px solid #22c55e' : '2px solid #ef4444'; }
              else if (showResult && isCorrect) { border = '2px solid #22c55e'; }
              return (
                <motion.button key={i} initial={{ opacity: 0, x: -20 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.1 + i * 0.05 }}
                  onClick={() => handleSelect(i)} disabled={showResult}
                  style={{ width: '100%', background: bg, border, borderRadius: '12px', padding: '16px 20px', display: 'flex', alignItems: 'center', gap: '12px', cursor: showResult ? 'default' : 'pointer', textAlign: 'left', transition: 'all 0.3s ease' }}>
                  <span style={{ width: '32px', height: '32px', borderRadius: '8px', background: '#374151', display: 'flex', alignItems: 'center', justifyContent: 'center', color: 'white', fontWeight: 700, fontSize: '14px', flexShrink: 0 }}>{letter}</span>
                  <span className="text-neutral-200 text-sm">{opt.text}</span>
                </motion.button>
              );
            })}
          </div>
          {showResult && (
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.3 }}
              style={{ marginTop: '24px', background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '12px', padding: '16px 20px' }}>
              <p className="text-neutral-300 text-sm">{data.explanation}</p>
            </motion.div>
          )}
        </div>
      );
    };

    // ========== TOOL SLIDE ==========
    const ToolSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-3xl mx-auto slide-scroll overflow-y-auto py-8">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="mb-6">
          <span style={{ display: 'inline-block', padding: '4px 12px', borderRadius: '20px', fontSize: '12px', fontWeight: 600, background: 'rgba(34, 197, 94, 0.1)', color: '#22c55e', marginBottom: '8px' }}>How To Do It</span>
          <h2 className="slide-title text-2xl md:text-3xl text-black">{data.title}</h2>
        </motion.div>
        <motion.p initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-neutral-600 mb-4">{data.intro}</motion.p>
        <div className="space-y-3 mb-6">
          {data.steps.map((step, i) => (
            <motion.div key={i} initial={{ opacity: 0, x: -20 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.15 + i * 0.08 }}
              style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '12px', padding: '16px 20px', display: 'flex', alignItems: 'flex-start', gap: '12px' }}>
              <span style={{ width: '28px', height: '28px', borderRadius: '8px', background: 'linear-gradient(135deg, #22c55e, #16a34a)', display: 'flex', alignItems: 'center', justifyContent: 'center', color: 'white', fontWeight: 700, fontSize: '12px', flexShrink: 0 }}>{step.step}</span>
              <div>
                <h4 className="font-bold text-white text-sm">{step.title}</h4>
                <p className="text-neutral-400 text-xs mt-1">{step.description}</p>
              </div>
            </motion.div>
          ))}
        </div>
        <motion.a initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.5 }} href={data.toolUrl} target="_blank" rel="noopener noreferrer"
          style={{ display: 'inline-flex', alignItems: 'center', justifyContent: 'center', gap: '8px', padding: '12px 24px', background: 'linear-gradient(135deg, #22c55e, #16a34a)', color: 'white', borderRadius: '12px', fontWeight: 600, textDecoration: 'none' }}>
          {data.cta} <Icons.ExternalLink />
        </motion.a>
      </div>
    );

    // ========== ELITE INSIGHT SLIDE ==========
    const EliteInsightSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-3xl mx-auto">
        <motion.div initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }}
          style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '20px', padding: '32px', position: 'relative', overflow: 'hidden' }}>
          <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '4px', background: 'linear-gradient(90deg, transparent, #22c55e, transparent)' }} />
          <div className="flex items-center gap-3 mb-4">
            <div style={{ width: '48px', height: '48px', borderRadius: '12px', background: 'linear-gradient(135deg, #22c55e, #16a34a)', display: 'flex', alignItems: 'center', justifyContent: 'center', color: 'white' }}><Icons.Shield /></div>
            <h2 className="slide-title text-xl md:text-2xl text-white">The Trust Blueprint</h2>
          </div>
          <p className="text-neutral-300 text-sm md:text-base leading-relaxed mb-6">"Trust isn't built by accident—it's <span style={{ color: '#22c55e', fontWeight: 600 }}>engineered</span>. Layer social proof, create exceptional first impressions, and reverse every possible risk."</p>
          <div className="grid grid-cols-3 gap-3">
            {[{ icon: Icons.Users, label: 'Social Proof' }, { icon: Icons.Sparkles, label: 'Halo Effect' }, { icon: Icons.Shield, label: 'Risk Reversal' }].map((item, i) => {
              const Icon = item.icon;
              return (
                <motion.div key={i} initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.3 + i * 0.1 }}
                  style={{ background: '#374151', borderRadius: '12px', padding: '16px', textAlign: 'center' }}>
                  <div style={{ color: '#22c55e', marginBottom: '8px', display: 'flex', justifyContent: 'center' }}><Icon /></div>
                  <span className="text-white text-xs font-medium">{item.label}</span>
                </motion.div>
              );
            })}
          </div>
        </motion.div>
      </div>
    );

    // ========== COMPLETION SLIDE ==========
    const CompletionSlide = ({ data, onComplete, userName }) => (
      <div className="h-full flex flex-col justify-center items-center text-center px-6 md:px-12 max-w-3xl mx-auto">
        <motion.div initial={{ scale: 0 }} animate={{ scale: 1 }} transition={{ type: 'spring', damping: 10 }}
          style={{ width: '80px', height: '80px', borderRadius: '50%', background: 'linear-gradient(135deg, #22c55e, #16a34a)', display: 'flex', alignItems: 'center', justifyContent: 'center', marginBottom: '24px', boxShadow: '0 0 40px rgba(34, 197, 94, 0.4)' }}>
          <Icons.Check />
        </motion.div>
        <motion.h2 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 }} className="slide-title text-2xl md:text-3xl text-black mb-3">{data.title}</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.3 }} className="text-neutral-600 mb-6">{data.message}</motion.p>
        {LESSON_CONFIG.nextLesson && (
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.4 }}
            style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '16px', padding: '20px 24px', marginBottom: '24px' }}>
            <p className="text-neutral-400 text-sm mb-2">Up Next</p>
            <h3 className="text-white font-bold mb-1">{LESSON_CONFIG.nextLesson.title}</h3>
            <p className="text-neutral-400 text-xs">{LESSON_CONFIG.nextLesson.teaser}</p>
          </motion.div>
        )}
        <motion.button initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.5 }} onClick={onComplete} whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }}
          style={{ padding: '12px 32px', background: 'linear-gradient(135deg, #22c55e, #16a34a)', color: 'white', borderRadius: '12px', fontWeight: 600, border: 'none', cursor: 'pointer' }}>Complete Lesson</motion.button>
      </div>
    );

    // ========== RENDER SLIDE ==========
    const renderSlide = (slide, i, { onStart, onComplete, onShowGif, onHideGif, userName }) => {
      switch (slide.type) {
        case 'welcome': return <WelcomeSlide data={slide} onStart={onStart} userName={userName} />;
        case 'hook': return <HookSlide data={slide} />;
        case 'trustCurrency': return <TrustCurrencySlide data={slide} />;
        case 'trustControlPanel': return <TrustControlPanelSlide data={slide} />;
        case 'socialProofGrid': return <SocialProofGridSlide data={slide} />;
        case 'trustStackBattle': return <TrustStackBattleSlide data={slide} />;
        case 'haloRadiance': return <HaloRadianceSlide data={slide} />;
        case 'riskMeter': return <RiskMeterSlide data={slide} />;
        case 'guaranteeFormula': return <GuaranteeFormulaSlide data={slide} />;
        case 'trustPyramid': return <TrustPyramidSlide data={slide} />;
        case 'trustStats': return <TrustStatsSlide data={slide} />;
        case 'quiz': return <QuizSlide data={slide} onShowGif={onShowGif} onHideGif={onHideGif} />;
        case 'tool': return <ToolSlide data={slide} />;
        case 'eliteInsight': return <EliteInsightSlide data={slide} />;
        case 'completion': return <CompletionSlide data={slide} onComplete={onComplete} userName={userName} />;
        default: return <div className="h-full flex items-center justify-center"><p className="text-neutral-500">Unknown slide type: {slide.type}</p></div>;
      }
    };

    // ========== MAIN APP ==========
    const App = () => {
      const [current, setCurrent] = useState(getInitialSlide());
      const [gifUrl, setGifUrl] = useState(null);
      const [gifSize, setGifSize] = useState('50%');
      const [gifSide, setGifSide] = useState('right');
      const userName = useMemo(() => getUserName(), []);

      const goNext = useCallback(() => setCurrent(c => Math.min(c + 1, slides.length - 1)), []);
      const goPrev = useCallback(() => setCurrent(c => Math.max(c - 1, 0)), []);
      const onStart = useCallback(() => setCurrent(1), []);
      const onComplete = useCallback(() => {
        if (window.parent !== window) window.parent.postMessage({ type: 'LESSON_COMPLETE', lessonId: LESSON_CONFIG.id, nextLessonId: LESSON_CONFIG.nextLesson?.id }, '*');
      }, []);
      const onShowGif = useCallback((url, size, side) => { setGifUrl(url); setGifSize(size || '50%'); setGifSide(side || 'right'); }, []);
      const onHideGif = useCallback(() => setGifUrl(null), []);

      useEffect(() => {
        const handleKey = (e) => { if (e.key === 'ArrowRight') goNext(); else if (e.key === 'ArrowLeft') goPrev(); };
        window.addEventListener('keydown', handleKey);
        return () => window.removeEventListener('keydown', handleKey);
      }, [goNext, goPrev]);

      return (
        <div style={{ width: '100%', height: '100vh', background: '#FAFAFA', position: 'relative', overflow: 'hidden' }}>
          <AnimatePresence mode="wait">
            <motion.div key={current} initial={{ opacity: 0, x: 30 }} animate={{ opacity: 1, x: 0 }} exit={{ opacity: 0, x: -30 }} transition={{ duration: 0.3 }}
              style={{ width: '100%', height: '100%', position: 'relative' }}>
              {renderSlide(slides[current], current, { onStart, onComplete, onShowGif, onHideGif, userName })}
              <AdminSlideReportButton slideIndex={current} slideType={slides[current].type} />
            </motion.div>
          </AnimatePresence>

          {gifUrl && (
            <motion.div initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: 40 }}
              style={{ position: 'absolute', bottom: 0, [gifSide]: '20px', height: gifSize, maxHeight: '400px', zIndex: 50, pointerEvents: 'none' }}>
              <video autoPlay loop muted playsInline style={{ height: '100%', width: 'auto', objectFit: 'contain' }}>
                <source src={gifUrl} type="video/mp4" />
              </video>
            </motion.div>
          )}

          {current > 0 && (
            <button onClick={goPrev} style={{ position: 'absolute', left: '16px', top: '50%', transform: 'translateY(-50%)', width: '40px', height: '40px', borderRadius: '50%', background: 'white', border: '1px solid #e5e5e5', cursor: 'pointer', display: 'flex', alignItems: 'center', justifyContent: 'center', boxShadow: '0 2px 8px rgba(0,0,0,0.1)', zIndex: 100 }}><Icons.ArrowLeft /></button>
          )}
          {current < slides.length - 1 && (
            <button onClick={goNext} style={{ position: 'absolute', right: '16px', top: '50%', transform: 'translateY(-50%)', width: '40px', height: '40px', borderRadius: '50%', background: 'white', border: '1px solid #e5e5e5', cursor: 'pointer', display: 'flex', alignItems: 'center', justifyContent: 'center', boxShadow: '0 2px 8px rgba(0,0,0,0.1)', zIndex: 100 }}><Icons.ArrowRight /></button>
          )}

          <div style={{ position: 'absolute', bottom: '16px', left: '50%', transform: 'translateX(-50%)', display: 'flex', gap: '6px', zIndex: 100 }}>
            {slides.map((_, i) => (
              <button key={i} onClick={() => setCurrent(i)} style={{ width: '8px', height: '8px', borderRadius: '50%', border: 'none', cursor: 'pointer', background: i === current ? '#22c55e' : '#d1d5db', transition: 'background 0.2s' }} />
            ))}
          </div>
        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
