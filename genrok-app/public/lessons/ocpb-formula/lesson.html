<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The OCPB Formula | Quantum Scale</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;500;600;700;800;900&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --accent: #d946ef;
      --accent-dark: #c026d3;
      --accent-light: #e879f9;
      --accent-rgb: 217, 70, 239;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Inter', sans-serif;
      background: transparent;
      -webkit-font-smoothing: antialiased;
    }
    .title-font {
      font-family: 'Fraunces', serif;
      font-weight: 900;
      letter-spacing: -0.02em;
      line-height: 1.1;
    }
    h1, h2, h3, .slide-title {
      font-family: 'Fraunces', serif;
      font-weight: 900;
      letter-spacing: -0.02em;
      line-height: 1.1;
    }
    ::selection { background: var(--accent); color: white; }
    .slide-scroll::-webkit-scrollbar { display: none; }
    .slide-scroll { -ms-overflow-style: none; scrollbar-width: none; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { motion, AnimatePresence } = window.Motion;
    const { useState, useEffect, useCallback, useMemo } = React;

    // Get user name from URL param
    const getUserName = () => {
      const params = new URLSearchParams(window.location.search);
      return params.get('userName') || 'Builder';
    };

    const LESSON_CONFIG = {
      id: 'ocpb-formula',
      title: 'The OCPB Formula',
      description: 'The 4-letter sequence that turns objections into conversions.',
      accentColor: '#d946ef',
      duration: '4 min',
      nextLesson: {
        id: 'self-persuasion-architecture',
        title: 'Self-Persuasion Architecture',
        teaser: 'Why convincing people doesn\'t work. And what does.'
      }
    };

    const greetingBank = {
      earlyDawn: [
        "5am? You're not human. You're a machine. Legend.",
        "While they dream, you build empires. This is why you'll win.",
        "The 1% starts at 4am. Welcome to the club, warrior.",
        "Most people are asleep. You? Building your future. Respect."
      ],
      earlyMorning: [
        "6am hustler! Coffee's ready? Your competition is still sleeping.",
        "Early bird gets the million. Smart move starting now.",
        "You're already ahead of 90% of people. Morning champion!",
        "Sunrise learner. This is how winners start their day."
      ],
      morningPeak: [
        "Ready to turn knowledge into profit?",
        "Perfect timing. Winners learn before the chaos starts.",
        "Let's sharpen that competitive edge. Morning strategist!",
        "Smart. Learn now, dominate later."
      ],
      lateMorning: [
        "Late morning grind! Most people are just waking up mentally.",
        "10am momentum builder! You're in the zone.",
        "While they scroll, you learn. This is the difference.",
        "Mid-morning power hour. You get it."
      ],
      lunchBreak: [
        "Lunch break learner! Most people waste this hour. Not you.",
        "While they scroll Instagram, you're building skills. Elite move.",
        "Lunch break level-up! This is how pros use downtime.",
        "Smart. 30 minutes of learning beats 3 hours of scrolling."
      ],
      afternoon: [
        "Afternoon warrior! While they crash, you climb.",
        "2pm and still grinding? You're built different.",
        "Post-lunch learner. Most quit now. You? Just getting started.",
        "Afternoon edge. This is when winners separate."
      ],
      goldenHour: [
        "5pm strategist! Most people are done. You're just warming up.",
        "Golden hour builder! While they zone out, you zone in.",
        "Evening power move. This is when the 1% gets ahead.",
        "Workday done? Nah. Winners learn when others rest."
      ],
      evening: [
        "Evening mastermind! This is YOUR time. Let's use it.",
        "7pm and leveling up? You're not playing games. Respect.",
        "Prime time learner. While they binge Netflix, you're building.",
        "Evening architect. This is when empires are designed."
      ],
      lateNight: [
        "Night owl in the building! Most are asleep. You? Hungry.",
        "9pm and still grinding? This is why you'll make it.",
        "Late night legend! While they dream, you're building dreams.",
        "Night shift builder. The quiet hours are the profitable ones."
      ],
      midnightGrind: [
        "Midnight? You're possessed. I love it.",
        "After midnight and learning? You're not normal. You're elite.",
        "Midnight oil burner. This is the stuff legends are made of.",
        "Can't sleep until you win? Same. Welcome home, builder."
      ]
    };

    const getTimeSlot = () => {
      const hour = new Date().getHours();
      if (hour >= 4 && hour < 6) return 'earlyDawn';
      if (hour >= 6 && hour < 8) return 'earlyMorning';
      if (hour >= 8 && hour < 10) return 'morningPeak';
      if (hour >= 10 && hour < 12) return 'lateMorning';
      if (hour >= 12 && hour < 14) return 'lunchBreak';
      if (hour >= 14 && hour < 17) return 'afternoon';
      if (hour >= 17 && hour < 19) return 'goldenHour';
      if (hour >= 19 && hour < 21) return 'evening';
      if (hour >= 21 && hour < 24) return 'lateNight';
      return 'midnightGrind';
    };

    const getGreeting = () => {
      const slot = getTimeSlot();
      const greetings = greetingBank[slot];
      return greetings[Math.floor(Math.random() * greetings.length)];
    };

    const slides = [
      {
        type: 'welcome',
        learningGoals: [
          'Why objections are actually buying signals in disguise',
          'The 4-step sequence that dissolves doubt in seconds',
          'How to turn "It\'s too expensive" into "Where do I pay?"'
        ]
      },
      {
        type: 'hook',
        title: 'Your Customer Just Said "But..."',
        body: 'That moment when they hit you with "It\'s too expensive" or "I need to think about it." Most store owners panic. They discount. They beg. They lose the sale.',
        punchline: 'But that objection? It\'s not a wall. It\'s a door.'
      },
      {
        type: 'content',
        subtitle: 'The Mindset Shift',
        title: 'Objections Mean They Care',
        body: 'People who don\'t care just close the tab. People who object? They want you to convince them. They\'re practically begging you to help them say yes.',
        highlight: { label: 'Remember This', text: 'Objection = Invitation to Close' }
      },
      { type: 'visual', visualType: 'ocpb-flow' },
      {
        type: 'content',
        subtitle: 'Step 1: O',
        title: 'Name the Elephant',
        body: 'Say the objection out loud before they do. This builds instant trust and steals their ammo.',
        callout: 'Hard to object when you just said their objection for them.'
      },
      {
        type: 'example',
        subtitle: 'Objection Example',
        context: 'Selling a $297 eCommerce course',
        bad: { label: 'Ignore It', text: '"Our course is the best in the market!"' },
        good: { label: 'Name It', text: '"Look, $297 isn\'t cheap. I get it. That\'s probably what\'s holding you back right now."' }
      },
      {
        type: 'content',
        subtitle: 'Step 2: C',
        title: 'Make a Bold Counter',
        body: 'Now flip the script. Don\'t disagree softly. Make a confident statement that reframes their concern completely.',
        highlight: { label: 'The Counter', text: '"But here\'s the thing - the real cost isn\'t the $297. It\'s the $10K+ you\'ll leave on the table this year without these skills."' }
      },
      {
        type: 'content',
        subtitle: 'Step 3: P',
        title: 'Back It With Receipts',
        body: 'Claims without proof are just opinions. Now drop the evidence. Numbers. Screenshots. Results. Make your claim undeniable.',
        callout: 'The stronger your proof, the weaker their resistance.'
      },
      { type: 'visual', visualType: 'trust-meter' },
      {
        type: 'content',
        subtitle: 'Step 4: B',
        title: 'Show the Upside',
        body: 'End with what they get when they believe you. Paint the picture. Make the benefit so vivid they can taste it.',
        highlight: { label: 'The Payoff', text: '"Imagine 90 days from now - your store doing $50K months while you work less. That\'s what this unlocks."' }
      },
      {
        type: 'breakdown',
        title: 'OCPB in Action',
        subtitle: 'Handling "It\'s too expensive" on your product page:',
        steps: [
          { letter: 'O', label: 'Objection', text: '"I know $297 feels like a lot right now."' },
          { letter: 'C', label: 'Claim', text: '"But cheap alternatives cost you more in wasted time and missed sales."' },
          { letter: 'P', label: 'Proof', text: '"Our students see ROI in 14 days on average. Sarah made $1,247 her first week."' },
          { letter: 'B', label: 'Benefit', text: '"That\'s 4X return before you even finish the course."' }
        ]
      },
      {
        type: 'cards',
        title: 'Use OCPB for Any Objection',
        cards: [
          { icon: 'price', title: '"Too expensive"', desc: 'Reframe as investment vs. cost of inaction' },
          { icon: 'time', title: '"No time"', desc: 'Show how it saves time long-term' },
          { icon: 'trust', title: '"Will it work?"', desc: 'Proof from similar customers' }
        ]
      },
      {
        type: 'quiz',
        question: 'What is the core idea behind the OCPB Formula?',
        options: [
          'Ignore objections and focus on product benefits',
          'Surface objections, counter with proof, and show the payoff',
          'Offer discounts to overcome price resistance',
          'Wait for customers to ask questions before addressing concerns'
        ],
        correctIndex: 1,
        feedback: {
          correct: 'Exactly. OCPB is about proactively surfacing objections (O), making a bold counter-claim (C), backing it with proof (P), and showing the benefit (B). This sequence turns doubt into conviction.',
          incorrect: 'The OCPB Formula is: Surface the Objection, make a Counter-claim, provide Proof, show the Benefit. It\'s about proactively addressing concerns and building trust through evidence.'
        }
      },
      { type: 'completion' }
    ];

    const Icons = {
      ArrowLeft: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="15 18 9 12 15 6"/></svg>,
      ArrowRight: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="9 18 15 12 9 6"/></svg>,
      Back: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="15 18 9 12 15 6"/></svg>,
      Clock: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
      Check: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><polyline points="20 6 9 17 4 12"/></svg>,
      X: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
      Sparkles: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/></svg>,
      ChevronRight: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="9 18 15 12 9 6"/></svg>,
      Price: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>,
      Time: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
      Trust: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><path d="m9 12 2 2 4-4"/></svg>
    };

    const OCPBFlowVisual = () => {
      const steps = [
        { letter: 'O', word: 'Objection', desc: 'Name it' },
        { letter: 'C', word: 'Claim', desc: 'Counter it' },
        { letter: 'P', word: 'Proof', desc: 'Prove it' },
        { letter: 'B', word: 'Benefit', desc: 'Reward them' }
      ];
      return (
        <div className="w-full h-full flex items-center justify-center p-4">
          <div className="bg-neutral-900 rounded-2xl p-5 md:p-8 w-full max-w-xl">
            <p className="text-center text-neutral-500 text-xs mb-6 uppercase tracking-widest">The 4-Step Sequence</p>
            <div className="flex flex-col md:flex-row items-center justify-center gap-3 md:gap-2">
              {steps.map((step, i) => (
                <React.Fragment key={step.letter}>
                  <motion.div initial={{ opacity: 0, scale: 0.8 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.15 + i * 0.1, type: 'spring' }} className="flex flex-col items-center">
                    <div className="w-14 h-14 md:w-16 md:h-16 rounded-xl flex items-center justify-center mb-2" style={{ background: `linear-gradient(135deg, var(--accent) 0%, var(--accent-dark) 100%)`, boxShadow: `0 4px 16px rgba(var(--accent-rgb), 0.35)` }}>
                      <span className="text-white text-xl md:text-2xl font-bold">{step.letter}</span>
                    </div>
                    <p className="text-white font-semibold text-xs">{step.word}</p>
                    <p className="text-neutral-500 text-[10px]">{step.desc}</p>
                  </motion.div>
                  {i < steps.length - 1 && <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ delay: 0.3 + i * 0.1 }} className="text-neutral-600 hidden md:block"><Icons.ChevronRight /></motion.div>}
                </React.Fragment>
              ))}
            </div>
            <motion.p initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ delay: 0.8 }} className="text-center text-neutral-600 text-xs mt-6">Each step builds trust and dissolves doubt</motion.p>
          </div>
        </div>
      );
    };

    const TrustMeterVisual = () => {
      const stages = [
        { label: 'Skeptical', letter: 'O', percent: 25 },
        { label: 'Curious', letter: 'C', percent: 50 },
        { label: 'Interested', letter: 'P', percent: 75 },
        { label: 'Ready to Buy', letter: 'B', percent: 100 }
      ];
      return (
        <div className="w-full h-full flex items-center justify-center p-4">
          <div className="bg-neutral-900 rounded-2xl p-6 md:p-8 w-full max-w-md">
            <p className="text-center text-neutral-500 text-xs mb-6 uppercase tracking-widest">Trust Level Through OCPB</p>
            <div className="space-y-4">
              {stages.map((stage, i) => (
                <motion.div key={stage.label} initial={{ opacity: 0, x: -15 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.15 + i * 0.1 }}>
                  <div className="flex justify-between mb-1.5">
                    <div className="flex items-center gap-2">
                      <span className="w-5 h-5 rounded flex items-center justify-center text-[10px] font-bold text-white" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>{stage.letter}</span>
                      <span className="text-neutral-300 text-xs">{stage.label}</span>
                    </div>
                    <span className="text-neutral-500 text-xs">{stage.percent}%</span>
                  </div>
                  <div className="h-2.5 bg-neutral-800 rounded-full overflow-hidden">
                    <motion.div initial={{ width: 0 }} animate={{ width: `${stage.percent}%` }} transition={{ delay: 0.3 + i * 0.15, duration: 0.6, ease: 'easeOut' }} className="h-full rounded-full" style={{ background: `linear-gradient(90deg, var(--accent-dark), var(--accent))`, boxShadow: `0 0 10px rgba(var(--accent-rgb), 0.4)` }} />
                  </div>
                </motion.div>
              ))}
            </div>
            <motion.p initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ delay: 1 }} className="text-center text-neutral-600 text-xs mt-5">Each step moves them closer to "Yes"</motion.p>
          </div>
        </div>
      );
    };

    const WelcomeSlide = ({ data, onStart, userName }) => {
      const greeting = useMemo(() => getGreeting(), []);
      return (
        <div className="h-full flex flex-col items-center justify-center text-center px-6 py-6 slide-scroll overflow-y-auto">
          <motion.h1 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="title-font text-3xl md:text-4xl text-black mb-4">{LESSON_CONFIG.title}</motion.h1>
          <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-neutral-500 text-sm md:text-base mb-4 max-w-md leading-relaxed">Hey <span className="font-semibold text-neutral-700">{userName}</span>! {greeting}</motion.p>
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="flex items-center gap-2 text-neutral-400 text-xs mb-6"><Icons.Clock /><span>{LESSON_CONFIG.duration}</span></motion.div>
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 }} className="bg-neutral-900 rounded-2xl p-5 mb-6 max-w-sm w-full">
            <p className="text-neutral-500 text-[10px] uppercase tracking-wider mb-3">In this lesson</p>
            <ul className="space-y-2.5">
              {data.learningGoals.map((goal, i) => (
                <motion.li key={i} initial={{ opacity: 0, x: -15 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.3 + i * 0.08 }} className="flex items-start gap-2.5 text-left">
                  <span className="w-5 h-5 rounded-md flex items-center justify-center text-[10px] font-bold text-white flex-shrink-0 mt-0.5" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>{i + 1}</span>
                  <span className="text-neutral-300 text-xs leading-relaxed">{goal}</span>
                </motion.li>
              ))}
            </ul>
          </motion.div>
          <motion.button initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.55 }} onClick={onStart} whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }} className="px-8 py-3 rounded-xl text-white font-semibold text-sm" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))`, boxShadow: `0 4px 20px rgba(var(--accent-rgb), 0.35)` }}>Let's Go</motion.button>
        </div>
      );
    };

    const HookSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-2xl mx-auto slide-scroll overflow-y-auto py-8">
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black mb-4">{data.title}</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="text-neutral-600 text-base leading-relaxed mb-6">{data.body}</motion.p>
        <motion.div initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.3 }} className="bg-neutral-900 rounded-xl p-5">
          <p className="text-xl md:text-2xl font-bold text-center" style={{ color: 'var(--accent)' }}>{data.punchline}</p>
        </motion.div>
      </div>
    );

    const ContentSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-2xl mx-auto slide-scroll overflow-y-auto py-8">
        {data.subtitle && <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-xs font-medium uppercase tracking-wider mb-2" style={{ color: 'var(--accent)' }}>{data.subtitle}</motion.p>}
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.08 }} className="slide-title text-2xl md:text-3xl text-black mb-4">{data.title}</motion.h2>
        {data.body && <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="text-neutral-600 text-base leading-relaxed mb-4">{data.body}</motion.p>}
        {data.callout && <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.22 }} className="text-neutral-500 text-sm italic">{data.callout}</motion.p>}
        {data.highlight && (
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.22 }} className="bg-neutral-900 rounded-xl p-5 mt-2">
            <p className="text-neutral-500 text-[10px] uppercase tracking-wider mb-1.5">{data.highlight.label}</p>
            <p className="text-base md:text-lg leading-relaxed" style={{ color: 'var(--accent)' }}>{data.highlight.text}</p>
          </motion.div>
        )}
      </div>
    );

    const ExampleSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-2xl mx-auto slide-scroll overflow-y-auto py-8">
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-xs font-medium uppercase tracking-wider mb-2" style={{ color: 'var(--accent)' }}>{data.subtitle}</motion.p>
        {data.context && <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.08 }} className="text-neutral-500 text-xs mb-4">{data.context}</motion.p>}
        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-5">
          <motion.div initial={{ opacity: 0, x: -15 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.15 }} className="bg-neutral-100 rounded-xl p-4 border border-neutral-200">
            <div className="flex items-center gap-2 mb-2"><div className="w-5 h-5 rounded bg-neutral-300 flex items-center justify-center text-neutral-500"><Icons.X /></div><span className="text-neutral-400 text-[10px] font-medium uppercase">{data.bad.label}</span></div>
            <p className="text-neutral-500 text-sm italic">{data.bad.text}</p>
          </motion.div>
          <motion.div initial={{ opacity: 0, x: 15 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.25 }} className="bg-white rounded-xl p-4 border-2" style={{ borderColor: 'var(--accent)' }}>
            <div className="flex items-center gap-2 mb-2"><div className="w-5 h-5 rounded flex items-center justify-center text-white" style={{ background: 'var(--accent)' }}><Icons.Check /></div><span className="text-[10px] font-medium uppercase" style={{ color: 'var(--accent)' }}>{data.good.label}</span></div>
            <p className="text-neutral-800 text-sm italic font-medium">{data.good.text}</p>
          </motion.div>
        </div>
      </div>
    );

    const VisualSlide = ({ data }) => (
      <div className="h-full flex items-center justify-center">
        {data.visualType === 'ocpb-flow' && <OCPBFlowVisual />}
        {data.visualType === 'trust-meter' && <TrustMeterVisual />}
      </div>
    );

    const BreakdownSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-10 slide-scroll overflow-y-auto py-8">
        <div className="text-center mb-5">
          <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-xl md:text-2xl text-black mb-1">{data.title}</motion.h2>
          <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.08 }} className="text-neutral-500 text-xs">{data.subtitle}</motion.p>
        </div>
        <div className="bg-neutral-900 rounded-xl p-5 max-w-lg mx-auto w-full">
          <div className="space-y-3">
            {data.steps.map((step, i) => (
              <motion.div key={i} initial={{ opacity: 0, x: -15 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.15 + i * 0.08 }} className="flex items-start gap-3">
                <div className="w-8 h-8 rounded-lg flex-shrink-0 flex items-center justify-center" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}><span className="text-white text-xs font-bold">{step.letter}</span></div>
                <div className="flex-1 pt-0.5"><p className="text-neutral-500 text-[10px] uppercase tracking-wider mb-0.5">{step.label}</p><p className="text-neutral-200 text-xs leading-relaxed">{step.text}</p></div>
              </motion.div>
            ))}
          </div>
        </div>
      </div>
    );

    const CardsSlide = ({ data }) => {
      const getIcon = (iconName) => {
        const icons = { price: Icons.Price, time: Icons.Time, trust: Icons.Trust };
        return icons[iconName] ? React.createElement(icons[iconName]) : null;
      };
      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-10 slide-scroll overflow-y-auto py-8">
          <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-xl md:text-2xl text-black text-center mb-5">{data.title}</motion.h2>
          <div className="grid grid-cols-1 md:grid-cols-3 gap-3 max-w-3xl mx-auto w-full">
            {data.cards.map((card, i) => (
              <motion.div key={i} initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 + i * 0.08 }} className="bg-neutral-50 rounded-xl p-4 border border-neutral-100">
                <div className="w-10 h-10 rounded-lg flex items-center justify-center mb-3" style={{ background: `linear-gradient(135deg, rgba(var(--accent-rgb), 0.1), rgba(var(--accent-rgb), 0.05))`, color: 'var(--accent)' }}>{getIcon(card.icon)}</div>
                <h4 className="font-semibold text-black text-sm mb-1">{card.title}</h4>
                <p className="text-neutral-500 text-xs leading-relaxed">{card.desc}</p>
              </motion.div>
            ))}
          </div>
        </div>
      );
    };

    const QuizSlide = ({ data }) => {
      const [selected, setSelected] = useState(null);
      const [showFeedback, setShowFeedback] = useState(false);
      const handleSelect = (index) => { if (showFeedback) return; setSelected(index); setShowFeedback(true); };
      const isCorrect = selected === data.correctIndex;
      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-10 max-w-xl mx-auto slide-scroll overflow-y-auto py-8">
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-5">
            <p className="text-[10px] uppercase tracking-wider text-neutral-400 mb-2">Quick Check</p>
            <h2 className="slide-title text-lg md:text-xl text-black leading-tight">{data.question}</h2>
          </motion.div>
          <div className="space-y-2.5 mb-5">
            {data.options.map((option, i) => (
              <motion.button key={i} initial={{ opacity: 0, x: -15 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.08 + i * 0.06 }} onClick={() => handleSelect(i)} disabled={showFeedback} className={`w-full p-3 rounded-xl text-left transition-all border-2 ${showFeedback ? i === data.correctIndex ? 'border-green-500 bg-green-50' : i === selected ? 'border-red-400 bg-red-50' : 'border-neutral-200 bg-white opacity-40' : 'border-neutral-200 bg-white hover:border-neutral-300'}`}>
                <div className="flex items-center gap-2.5">
                  <span className={`w-7 h-7 rounded-lg flex items-center justify-center text-xs font-bold transition-all ${showFeedback && i === data.correctIndex ? 'bg-green-500 text-white' : showFeedback && i === selected && !isCorrect ? 'bg-red-400 text-white' : 'bg-neutral-100 text-neutral-500'}`}>
                    {showFeedback && i === data.correctIndex ? <Icons.Check /> : showFeedback && i === selected && !isCorrect ? <Icons.X /> : String.fromCharCode(65 + i)}
                  </span>
                  <span className="text-neutral-700 text-sm">{option}</span>
                </div>
              </motion.button>
            ))}
          </div>
          <AnimatePresence>
            {showFeedback && (
              <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className={`p-4 rounded-xl ${isCorrect ? 'bg-green-50 border border-green-200' : 'bg-amber-50 border border-amber-200'}`}>
                <p className={`text-xs leading-relaxed ${isCorrect ? 'text-green-800' : 'text-amber-800'}`}>{isCorrect ? data.feedback.correct : data.feedback.incorrect}</p>
              </motion.div>
            )}
          </AnimatePresence>
        </div>
      );
    };

    const CompletionSlide = () => (
      <div className="h-full flex flex-col items-center justify-center text-center px-6 slide-scroll overflow-y-auto py-8">
        <motion.div initial={{ opacity: 0, scale: 0 }} animate={{ opacity: 1, scale: 1 }} transition={{ type: 'spring', duration: 0.5 }} className="w-16 h-16 rounded-xl flex items-center justify-center mb-5 text-white" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))`, boxShadow: `0 6px 24px rgba(var(--accent-rgb), 0.35)` }}><Icons.Check /></motion.div>
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="slide-title text-2xl md:text-3xl text-black mb-3">Lesson Complete</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.25 }} className="text-neutral-500 text-sm mb-6 max-w-sm leading-relaxed">You now have a 4-letter cheat code for dissolving doubt. O-C-P-B. Use it on your product pages, emails, and ads.</motion.p>
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.35 }} className="bg-neutral-900 rounded-xl p-5 max-w-sm w-full">
          <p className="text-neutral-500 text-[10px] uppercase tracking-wider mb-2">Up Next</p>
          <h3 className="text-white font-bold text-lg mb-1">{LESSON_CONFIG.nextLesson.title}</h3>
          <p className="text-neutral-400 text-xs">{LESSON_CONFIG.nextLesson.teaser}</p>
        </motion.div>
      </div>
    );

    const App = () => {
      const [currentSlide, setCurrentSlide] = useState(0);
      const [direction, setDirection] = useState(0);
      const userName = useMemo(() => getUserName(), []);

      const goToSlide = useCallback((newSlide) => {
        if (newSlide < 0 || newSlide >= slides.length) return;
        setDirection(newSlide > currentSlide ? 1 : -1);
        setCurrentSlide(newSlide);
      }, [currentSlide]);

      const nextSlide = useCallback(() => goToSlide(currentSlide + 1), [currentSlide, goToSlide]);
      const prevSlide = useCallback(() => goToSlide(currentSlide - 1), [currentSlide, goToSlide]);

      useEffect(() => {
        const handleKeyDown = (e) => {
          if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); nextSlide(); }
          if (e.key === 'ArrowLeft') { e.preventDefault(); prevSlide(); }
        };
        window.addEventListener('keydown', handleKeyDown);
        return () => window.removeEventListener('keydown', handleKeyDown);
      }, [nextSlide, prevSlide]);

      const slideVariants = {
        enter: (dir) => ({ x: dir > 0 ? '100%' : '-100%', opacity: 0 }),
        center: { x: 0, opacity: 1 },
        exit: (dir) => ({ x: dir > 0 ? '-100%' : '100%', opacity: 0 })
      };

      const renderSlide = (slide) => {
        switch (slide.type) {
          case 'welcome': return <WelcomeSlide data={slide} onStart={nextSlide} userName={userName} />;
          case 'hook': return <HookSlide data={slide} />;
          case 'content': return <ContentSlide data={slide} />;
          case 'example': return <ExampleSlide data={slide} />;
          case 'visual': return <VisualSlide data={slide} />;
          case 'breakdown': return <BreakdownSlide data={slide} />;
          case 'cards': return <CardsSlide data={slide} />;
          case 'quiz': return <QuizSlide data={slide} />;
          case 'completion': return <CompletionSlide />;
          default: return null;
        }
      };

      const showPrev = currentSlide > 0;
      const showNext = currentSlide < slides.length - 1 && slides[currentSlide].type !== 'welcome';

      return (
        <div className="fixed inset-0 z-[9999]">
          <div className="absolute inset-0" style={{ background: 'rgba(0, 0, 0, 0.7)', backdropFilter: 'blur(16px)' }} />
          <div className="fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white rounded-2xl overflow-hidden flex flex-col" style={{ width: '85vw', height: '85vh', maxWidth: '1400px', maxHeight: '900px', boxShadow: '0 25px 100px rgba(0, 0, 0, 0.5)' }}>
            <div className="flex items-center justify-between px-5 md:px-6 py-3.5 border-b border-neutral-100 flex-shrink-0">
              <a href="/learn" className="flex items-center gap-1.5 text-neutral-400 hover:text-neutral-600 transition-colors text-xs"><Icons.Back /><span>Back to Learning Center</span></a>
              <div className="text-right"><p className="text-neutral-900 font-semibold text-sm">{LESSON_CONFIG.title}</p><p className="text-neutral-400 text-[10px]">{LESSON_CONFIG.description}</p></div>
            </div>
            <div className="flex-1 relative overflow-hidden">
              <AnimatePresence mode="wait" custom={direction}>
                <motion.div key={currentSlide} custom={direction} variants={slideVariants} initial="enter" animate="center" exit="exit" transition={{ duration: 0.3, ease: [0.25, 0.1, 0.25, 1] }} className="absolute inset-0">{renderSlide(slides[currentSlide])}</motion.div>
              </AnimatePresence>
              {showPrev && <button onClick={prevSlide} className="absolute left-4 top-1/2 -translate-y-1/2 w-10 h-10 rounded-full bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-500 hover:text-neutral-700 transition-all z-10"><Icons.ArrowLeft /></button>}
              {showNext && <button onClick={nextSlide} className="absolute right-4 top-1/2 -translate-y-1/2 w-10 h-10 rounded-full bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-500 hover:text-neutral-700 transition-all z-10"><Icons.ArrowRight /></button>}
            </div>
            <div className="px-5 md:px-6 py-4 border-t border-neutral-100 flex-shrink-0">
              <div className="flex items-center justify-center gap-2">
                {slides.map((_, i) => <button key={i} onClick={() => goToSlide(i)} className="w-2 h-2 rounded-full transition-all duration-300" style={{ background: i === currentSlide ? 'var(--accent)' : '#d4d4d4', transform: i === currentSlide ? 'scale(1.3)' : 'scale(1)' }} />)}
              </div>
            </div>
          </div>
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
