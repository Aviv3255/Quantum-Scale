<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The OCPB Formula | Quantum Scale</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;500;600;700;800;900&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --accent: #d946ef;
      --accent-dark: #c026d3;
      --accent-light: #e879f9;
      --accent-rgb: 217, 70, 239;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Inter', sans-serif;
      background: transparent;
      -webkit-font-smoothing: antialiased;
    }
    .title-font {
      font-family: 'Fraunces', serif;
      font-weight: 900;
      letter-spacing: -0.02em;
      line-height: 1.1;
    }
    h1, h2, h3, .slide-title {
      font-family: 'Fraunces', serif;
      font-weight: 900;
      letter-spacing: -0.02em;
      line-height: 1.1;
    }
    ::selection { background: var(--accent); color: white; }
    .slide-scroll::-webkit-scrollbar { display: none; }
    .slide-scroll { -ms-overflow-style: none; scrollbar-width: none; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { motion, AnimatePresence } = window.Motion;
    const { useState, useEffect, useCallback, useMemo } = React;

    // ============================================
    // GET USER NAME FROM URL PARAM
    // ============================================
    const getUserName = () => {
      const params = new URLSearchParams(window.location.search);
      return params.get('userName') || 'Builder';
    };

    // ============================================
    // LESSON CONFIGURATION
    // ============================================
    const LESSON_CONFIG = {
      id: 'ocpb-formula',
      title: 'The OCPB Formula',
      description: 'The 4-letter sequence that turns objections into conversions.',
      accentColor: '#d946ef',
      duration: '4 min',
      nextLesson: {
        id: 'self-persuasion-architecture',
        title: 'Self-Persuasion Architecture',
        teaser: 'Why convincing people doesn\'t work. And what does.'
      }
    };

    // ============================================
    // TIME-BASED WELCOME ANIMATIONS (GIF + Greeting pairs)
    // Each time slot has matched GIF + greeting combinations
    // ============================================
    const welcomeAnimations = {
      // Morning (5:00am - 11:59am)
      morning: [
        {
          gif: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_Holding_coffee_mug_taking_a_sip_tired_but_dete_ea89f0bd-3cec-424c-b616-3ef902b2ce07_3.mp4',
          greeting: "Coffee's ready? Your competition is still sleeping. Let's go."
        },
        {
          gif: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_httpss.mj.runXIb_HMRUiT0_He_is_streching_his_arms_ha_2d6fbd3c-4b32-49eb-a5f7-c2b0f2d7bbbc_0.mp4',
          greeting: "Early bird gets the million. You're already ahead of 90% of people!"
        },
        {
          gif: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_Standing_in_superhero_power_pose_with_superman_bccd0d91-830b-4696-bed8-5bdead0eba36_2.mp4',
          greeting: "Morning champion! This is how winners start their day."
        }
      ],
      // Afternoon (12:00pm - 5:00pm)
      afternoon: [
        {
          gif: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_Leaning_forward_slightly_focused_eyes_fingers__5c0d1465-878c-49ea-a8c9-2238975718b0_1.mp4',
          greeting: "Afternoon warrior! While they crash, you climb. Serious mode activated."
        },
        {
          gif: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_Nodding_head_a_few_times_subtle_smile_lets_do__6ed8d140-2dc3-4f10-823d-79bfbee8cedc_3.mp4',
          greeting: "Post-lunch learner. Most quit now. You? Let's do this."
        },
        {
          gif: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_Pointing_forward_with_determination_focused_ey_6c200771-c0a0-4ccf-99de-53e21b0d89f0_2.mp4',
          greeting: "We have work to do. This is when winners separate from watchers."
        }
      ],
      // Evening (5:00pm - 9:00pm)
      evening: [
        {
          gif: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_Leaning_back_in_chair_arms_behind_head_relaxed_850faa8d-67d9-4b68-8cae-277e0f191db1_1.mp4',
          greeting: "Evening mastermind! Relaxed but ready. This is YOUR time."
        },
        {
          gif: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_Adjusting_glasses_thoughtfully_intellectual_ev_90f03bdd-89f1-4707-98c6-091573624247_2.mp4',
          greeting: "Prime time learner. While they binge Netflix, you're building empires."
        },
        {
          gif: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_Slow_clapping_with_respect_impressed_expressio_0b19509f-cc4b-42f9-8f0b-c3815f48e892_1.mp4',
          greeting: "Respect for being here. Evening architect mode activated."
        }
      ],
      // Night (9:00pm - 4:59am)
      night: [
        {
          gif: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_Fist_pump_in_the_air_burning_eyes_midnight_war_e1620aa7-f682-4a1e-939d-72e21a68bdfc_3.mp4',
          greeting: "Night owl energy! While they sleep, you're building dreams."
        },
        {
          gif: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_Typing_rapidly_on_invisible_keyboard_completel_e28a1205-4e65-4eb7-908d-4eacbc5c3a49_1.mp4',
          greeting: "Midnight grind mode. The quiet hours are the profitable ones."
        },
        {
          gif: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_httpss.mj.run4YtlydUb6iQ_He_is_doing_Military_salute_f147476f-7106-4200-bc87-65549ff24b91_2.mp4',
          greeting: "You're one of us. Can't sleep until you win? Welcome home, builder."
        }
      ]
    };

    const getTimeBasedWelcome = () => {
      const hour = new Date().getHours();
      let slot;
      if (hour >= 5 && hour < 12) slot = 'morning';
      else if (hour >= 12 && hour < 17) slot = 'afternoon';
      else if (hour >= 17 && hour < 21) slot = 'evening';
      else slot = 'night';

      const options = welcomeAnimations[slot];
      const randomIndex = Math.floor(Math.random() * options.length);
      return options[randomIndex];
    };

    // ============================================
    // SLIDE DATA - OCPB FORMULA
    // ============================================
    const slides = [
      {
        type: 'welcome',
        learningGoals: [
          'Why objections are actually buying signals in disguise',
          'The 4-step sequence that dissolves doubt in seconds',
          'How to turn "It\'s too expensive" into "Where do I pay?"'
        ]
      },
      {
        type: 'hook',
        title: 'Your Customer Just Said "But..."',
        body: 'That moment when they hit you with "It\'s too expensive" or "I need to think about it." Most store owners panic. They discount. They beg. They lose the sale.',
        punchline: 'But that objection? It\'s not a wall. It\'s a door.'
      },
      {
        type: 'content',
        subtitle: 'The Mindset Shift',
        title: 'Objections Mean They Care',
        body: 'People who don\'t care just close the tab. People who object? They want you to convince them. They\'re practically begging you to help them say yes.',
        highlight: { label: 'Remember This', text: 'Objection = Invitation to Close' }
      },
      { type: 'visual', visualType: 'ocpb-flow' },
      {
        type: 'content',
        subtitle: 'Step 1: O',
        title: 'Name the Elephant',
        body: 'Say the objection out loud before they do. This builds instant trust and steals their ammo.',
        callout: 'Hard to object when you just said their objection for them.'
      },
      {
        type: 'example',
        subtitle: 'Objection Example',
        context: 'Selling a $297 eCommerce course',
        bad: { label: 'Ignore It', text: '"Our course is the best in the market!"' },
        good: { label: 'Name It', text: '"Look, $297 isn\'t cheap. I get it. That\'s probably what\'s holding you back right now."' }
      },
      {
        type: 'content',
        subtitle: 'Step 2: C',
        title: 'Make a Bold Counter',
        body: 'Now flip the script. Don\'t disagree softly. Make a confident statement that reframes their concern completely.',
        highlight: { label: 'The Counter', text: '"But here\'s the thing - the real cost isn\'t the $297. It\'s the $10K+ you\'ll leave on the table this year without these skills."' }
      },
      {
        type: 'content',
        subtitle: 'Step 3: P',
        title: 'Back It With Receipts',
        body: 'Claims without proof are just opinions. Now drop the evidence. Numbers. Screenshots. Results. Make your claim undeniable.',
        callout: 'The stronger your proof, the weaker their resistance.'
      },
      { type: 'visual', visualType: 'trust-meter' },
      {
        type: 'content',
        subtitle: 'Step 4: B',
        title: 'Show the Upside',
        body: 'End with what they get when they believe you. Paint the picture. Make the benefit so vivid they can taste it.',
        highlight: { label: 'The Payoff', text: '"Imagine 90 days from now - your store doing $50K months while you work less. That\'s what this unlocks."' }
      },
      {
        type: 'breakdown',
        title: 'OCPB in Action',
        subtitle: 'Handling "It\'s too expensive" on your product page:',
        steps: [
          { letter: 'O', label: 'Objection', text: '"I know $297 feels like a lot right now."' },
          { letter: 'C', label: 'Claim', text: '"But cheap alternatives cost you more in wasted time and missed sales."' },
          { letter: 'P', label: 'Proof', text: '"Our students see ROI in 14 days on average. Sarah made $1,247 her first week."' },
          { letter: 'B', label: 'Benefit', text: '"That\'s 4X return before you even finish the course."' }
        ]
      },
      {
        type: 'cards',
        title: 'Use OCPB for Any Objection',
        cards: [
          { icon: 'price', title: '"Too expensive"', desc: 'Reframe as investment vs. cost of inaction' },
          { icon: 'time', title: '"No time"', desc: 'Show how it saves time long-term' },
          { icon: 'trust', title: '"Will it work?"', desc: 'Proof from similar customers' }
        ]
      },
      {
        type: 'quiz',
        question: 'What is the core idea behind the OCPB Formula?',
        options: [
          'Ignore objections and focus on product benefits',
          'Surface objections, counter with proof, and show the payoff',
          'Offer discounts to overcome price resistance',
          'Wait for customers to ask questions before addressing concerns'
        ],
        correctIndex: 1,
        feedback: {
          correct: 'Exactly. OCPB is about proactively surfacing objections (O), making a bold counter-claim (C), backing it with proof (P), and showing the benefit (B). This sequence turns doubt into conviction.',
          incorrect: 'The OCPB Formula is: Surface the Objection, make a Counter-claim, provide Proof, show the Benefit. It\'s about proactively addressing concerns and building trust through evidence.'
        }
      },
      { type: 'completion' }
    ];

    // ============================================
    // ICONS (Minimalist SVG - 25% larger)
    // ============================================
    const Icons = {
      ArrowLeft: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="15 18 9 12 15 6"/></svg>,
      ArrowRight: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="9 18 15 12 9 6"/></svg>,
      Clock: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
      Check: () => <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><polyline points="20 6 9 17 4 12"/></svg>,
      X: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
      Sparkles: () => <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/></svg>,
      ChevronRight: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="9 18 15 12 9 6"/></svg>,
      Price: () => <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>,
      Time: () => <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
      Trust: () => <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><path d="m9 12 2 2 4-4"/></svg>
    };

    // ============================================
    // VISUAL COMPONENTS (25% larger)
    // ============================================
    const OCPBFlowVisual = () => {
      const steps = [
        { letter: 'O', word: 'Objection', desc: 'Name it' },
        { letter: 'C', word: 'Claim', desc: 'Counter it' },
        { letter: 'P', word: 'Proof', desc: 'Prove it' },
        { letter: 'B', word: 'Benefit', desc: 'Reward them' }
      ];
      return (
        <div className="w-full h-full flex items-center justify-center p-6">
          <div className="bg-neutral-900 rounded-3xl p-6 md:p-10 w-full max-w-2xl">
            <p className="text-center text-neutral-500 text-sm mb-8 uppercase tracking-widest">The 4-Step Sequence</p>
            <div className="flex flex-col md:flex-row items-center justify-center gap-4 md:gap-3">
              {steps.map((step, i) => (
                <React.Fragment key={step.letter}>
                  <motion.div initial={{ opacity: 0, scale: 0.8 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.15 + i * 0.1, type: 'spring' }} className="flex flex-col items-center">
                    <div className="w-18 h-18 md:w-20 md:h-20 rounded-xl flex items-center justify-center mb-3" style={{ background: `linear-gradient(135deg, var(--accent) 0%, var(--accent-dark) 100%)`, boxShadow: `0 4px 20px rgba(var(--accent-rgb), 0.35)` }}>
                      <span className="text-white text-2xl md:text-3xl font-bold">{step.letter}</span>
                    </div>
                    <p className="text-white font-semibold text-sm">{step.word}</p>
                    <p className="text-neutral-500 text-xs">{step.desc}</p>
                  </motion.div>
                  {i < steps.length - 1 && <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ delay: 0.3 + i * 0.1 }} className="text-neutral-600 hidden md:block"><Icons.ChevronRight /></motion.div>}
                </React.Fragment>
              ))}
            </div>
            <motion.p initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ delay: 0.8 }} className="text-center text-neutral-600 text-sm mt-8">Each step builds trust and dissolves doubt</motion.p>
          </div>
        </div>
      );
    };

    const TrustMeterVisual = () => {
      const stages = [
        { label: 'Skeptical', letter: 'O', percent: 25 },
        { label: 'Curious', letter: 'C', percent: 50 },
        { label: 'Interested', letter: 'P', percent: 75 },
        { label: 'Ready to Buy', letter: 'B', percent: 100 }
      ];
      return (
        <div className="w-full h-full flex items-center justify-center p-6">
          <div className="bg-neutral-900 rounded-3xl p-8 md:p-10 w-full max-w-lg">
            <p className="text-center text-neutral-500 text-sm mb-8 uppercase tracking-widest">Trust Level Through OCPB</p>
            <div className="space-y-5">
              {stages.map((stage, i) => (
                <motion.div key={stage.label} initial={{ opacity: 0, x: -15 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.15 + i * 0.1 }}>
                  <div className="flex justify-between mb-2">
                    <div className="flex items-center gap-3">
                      <span className="w-7 h-7 rounded-lg flex items-center justify-center text-sm font-bold text-white" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>{stage.letter}</span>
                      <span className="text-neutral-300 text-sm">{stage.label}</span>
                    </div>
                    <span className="text-neutral-500 text-sm">{stage.percent}%</span>
                  </div>
                  <div className="h-3 bg-neutral-800 rounded-full overflow-hidden">
                    <motion.div initial={{ width: 0 }} animate={{ width: `${stage.percent}%` }} transition={{ delay: 0.3 + i * 0.15, duration: 0.6, ease: 'easeOut' }} className="h-full rounded-full" style={{ background: `linear-gradient(90deg, var(--accent-dark), var(--accent))`, boxShadow: `0 0 12px rgba(var(--accent-rgb), 0.4)` }} />
                  </div>
                </motion.div>
              ))}
            </div>
            <motion.p initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ delay: 1 }} className="text-center text-neutral-600 text-sm mt-8">Each step moves them closer to "Yes"</motion.p>
          </div>
        </div>
      );
    };

    // ============================================
    // SLIDE COMPONENTS (25% larger content)
    // ============================================

    // Welcome Slide with GIF - single GIF, bottom-anchored, side position
    const WelcomeSlide = ({ data, onStart, userName }) => {
      const welcomeData = useMemo(() => getTimeBasedWelcome(), []);
      // Alternate GIF position based on random seed
      const gifSide = useMemo(() => Math.random() > 0.5 ? 'left' : 'right', []);

      return (
        <div className="h-full flex flex-col relative overflow-hidden">
          {/* Main content - centered, compressed to fit */}
          <div className="flex-1 flex flex-col items-center justify-center text-center px-4 py-4 md:px-8 md:py-6 min-h-0">
            {/* Lesson Title */}
            <motion.h1 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="title-font text-2xl sm:text-3xl md:text-4xl lg:text-5xl text-black mb-2 md:mb-4">
              {LESSON_CONFIG.title}
            </motion.h1>

            {/* Personalized greeting */}
            <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-neutral-600 text-sm md:text-base lg:text-lg mb-2 md:mb-3 max-w-md leading-relaxed px-2">
              Hey <span className="font-bold text-neutral-900">{userName}</span>! {welcomeData.greeting}
            </motion.p>

            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="flex items-center justify-center gap-2 text-neutral-400 text-xs mb-3 md:mb-5">
              <Icons.Clock />
              <span>{LESSON_CONFIG.duration}</span>
            </motion.div>

            {/* In This Lesson - centered */}
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 }} className="bg-neutral-900 rounded-xl md:rounded-2xl p-3 md:p-5 mb-3 md:mb-5 max-w-sm w-full mx-auto">
              <p className="text-neutral-500 text-[10px] md:text-xs uppercase tracking-wider mb-2 md:mb-3">In this lesson</p>
              <ul className="space-y-1.5 md:space-y-2">
                {data.learningGoals.map((goal, i) => (
                  <motion.li key={i} initial={{ opacity: 0, x: -15 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.3 + i * 0.06 }} className="flex items-start gap-2 text-left">
                    <span className="w-5 h-5 rounded-md flex items-center justify-center text-[10px] font-bold text-white flex-shrink-0 mt-0.5" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>{i + 1}</span>
                    <span className="text-neutral-300 text-xs leading-relaxed">{goal}</span>
                  </motion.li>
                ))}
              </ul>
            </motion.div>

            <motion.button initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.5 }} onClick={onStart} whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }} className="px-6 md:px-8 py-2.5 md:py-3 rounded-xl text-white font-semibold text-sm md:text-base" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))`, boxShadow: `0 4px 20px rgba(var(--accent-rgb), 0.35)` }}>
              Let's Go
            </motion.button>
          </div>

          {/* GIF - anchored to bottom, on side, above dots */}
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.4, type: 'spring' }}
            className={`absolute bottom-0 ${gifSide === 'left' ? 'left-0 md:left-4' : 'right-0 md:right-4'} pointer-events-none`}
            style={{ zIndex: 20 }}
          >
            <video
              autoPlay
              loop
              muted
              playsInline
              className="h-24 sm:h-28 md:h-36 lg:h-44 w-auto object-contain"
              style={{ background: 'transparent', border: 'none', boxShadow: 'none' }}
            >
              <source src={welcomeData.gif} type="video/mp4" />
            </video>
          </motion.div>
        </div>
      );
    };

    // Hook Slide (25% larger)
    const HookSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-8 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-10">
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-3xl md:text-4xl text-black mb-6">{data.title}</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="text-neutral-600 text-lg md:text-xl leading-relaxed mb-8">{data.body}</motion.p>
        <motion.div initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.3 }} className="bg-neutral-900 rounded-xl p-6">
          <p className="text-2xl md:text-3xl font-bold text-center" style={{ color: 'var(--accent)' }}>{data.punchline}</p>
        </motion.div>
      </div>
    );

    // Content Slide (25% larger)
    const ContentSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-8 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-10">
        {data.subtitle && <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-sm font-medium uppercase tracking-wider mb-3" style={{ color: 'var(--accent)' }}>{data.subtitle}</motion.p>}
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.08 }} className="slide-title text-3xl md:text-4xl text-black mb-5">{data.title}</motion.h2>
        {data.body && <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="text-neutral-600 text-lg md:text-xl leading-relaxed mb-5">{data.body}</motion.p>}
        {data.callout && <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.22 }} className="text-neutral-500 text-base italic">{data.callout}</motion.p>}
        {data.highlight && (
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.22 }} className="bg-neutral-900 rounded-xl p-6 mt-3">
            <p className="text-neutral-500 text-xs uppercase tracking-wider mb-2">{data.highlight.label}</p>
            <p className="text-lg md:text-xl leading-relaxed" style={{ color: 'var(--accent)' }}>{data.highlight.text}</p>
          </motion.div>
        )}
      </div>
    );

    // Example Slide (25% larger)
    const ExampleSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-8 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-10">
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-sm font-medium uppercase tracking-wider mb-3" style={{ color: 'var(--accent)' }}>{data.subtitle}</motion.p>
        {data.context && <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.08 }} className="text-neutral-500 text-sm mb-5">{data.context}</motion.p>}
        <div className="grid grid-cols-1 md:grid-cols-2 gap-5 mb-6">
          <motion.div initial={{ opacity: 0, x: -15 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.15 }} className="bg-neutral-100 rounded-xl p-5 border border-neutral-200">
            <div className="flex items-center gap-2 mb-3">
              <div className="w-6 h-6 rounded bg-neutral-300 flex items-center justify-center text-neutral-500"><Icons.X /></div>
              <span className="text-neutral-400 text-xs font-medium uppercase">{data.bad.label}</span>
            </div>
            <p className="text-neutral-500 text-base italic">{data.bad.text}</p>
          </motion.div>
          <motion.div initial={{ opacity: 0, x: 15 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.25 }} className="bg-white rounded-xl p-5 border-2" style={{ borderColor: 'var(--accent)' }}>
            <div className="flex items-center gap-2 mb-3">
              <div className="w-6 h-6 rounded flex items-center justify-center text-white" style={{ background: 'var(--accent)' }}><Icons.Check /></div>
              <span className="text-xs font-medium uppercase" style={{ color: 'var(--accent)' }}>{data.good.label}</span>
            </div>
            <p className="text-neutral-800 text-base italic font-medium">{data.good.text}</p>
          </motion.div>
        </div>
      </div>
    );

    const VisualSlide = ({ data }) => (
      <div className="h-full flex items-center justify-center">
        {data.visualType === 'ocpb-flow' && <OCPBFlowVisual />}
        {data.visualType === 'trust-meter' && <TrustMeterVisual />}
      </div>
    );

    // Breakdown Slide (25% larger)
    const BreakdownSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-8 md:px-12 slide-scroll overflow-y-auto py-10">
        <div className="text-center mb-6">
          <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black mb-2">{data.title}</motion.h2>
          <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.08 }} className="text-neutral-500 text-sm">{data.subtitle}</motion.p>
        </div>
        <div className="bg-neutral-900 rounded-2xl p-6 max-w-xl mx-auto w-full">
          <div className="space-y-4">
            {data.steps.map((step, i) => (
              <motion.div key={i} initial={{ opacity: 0, x: -15 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.15 + i * 0.08 }} className="flex items-start gap-4">
                <div className="w-10 h-10 rounded-lg flex-shrink-0 flex items-center justify-center" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>
                  <span className="text-white text-sm font-bold">{step.letter}</span>
                </div>
                <div className="flex-1 pt-1">
                  <p className="text-neutral-500 text-xs uppercase tracking-wider mb-1">{step.label}</p>
                  <p className="text-neutral-200 text-sm leading-relaxed">{step.text}</p>
                </div>
              </motion.div>
            ))}
          </div>
        </div>
      </div>
    );

    // Cards Slide (25% larger)
    const CardsSlide = ({ data }) => {
      const getIcon = (iconName) => {
        const icons = { price: Icons.Price, time: Icons.Time, trust: Icons.Trust };
        return icons[iconName] ? React.createElement(icons[iconName]) : null;
      };
      return (
        <div className="h-full flex flex-col justify-center px-8 md:px-12 slide-scroll overflow-y-auto py-10">
          <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-6">{data.title}</motion.h2>
          <div className="grid grid-cols-1 md:grid-cols-3 gap-4 max-w-4xl mx-auto w-full">
            {data.cards.map((card, i) => (
              <motion.div key={i} initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 + i * 0.08 }} className="bg-neutral-50 rounded-xl p-5 border border-neutral-100">
                <div className="w-12 h-12 rounded-lg flex items-center justify-center mb-4" style={{ background: `linear-gradient(135deg, rgba(var(--accent-rgb), 0.1), rgba(var(--accent-rgb), 0.05))`, color: 'var(--accent)' }}>{getIcon(card.icon)}</div>
                <h4 className="font-semibold text-black text-base mb-2">{card.title}</h4>
                <p className="text-neutral-500 text-sm leading-relaxed">{card.desc}</p>
              </motion.div>
            ))}
          </div>
        </div>
      );
    };

    // Quiz Slide (25% larger)
    const QuizSlide = ({ data }) => {
      const [selected, setSelected] = useState(null);
      const [showFeedback, setShowFeedback] = useState(false);
      const handleSelect = (index) => { if (showFeedback) return; setSelected(index); setShowFeedback(true); };
      const isCorrect = selected === data.correctIndex;
      return (
        <div className="h-full flex flex-col justify-center px-8 md:px-12 max-w-2xl mx-auto slide-scroll overflow-y-auto py-10">
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
            <p className="text-xs uppercase tracking-wider text-neutral-400 mb-3">Quick Check</p>
            <h2 className="slide-title text-xl md:text-2xl text-black leading-tight">{data.question}</h2>
          </motion.div>
          <div className="space-y-3 mb-6">
            {data.options.map((option, i) => (
              <motion.button key={i} initial={{ opacity: 0, x: -15 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.08 + i * 0.06 }} onClick={() => handleSelect(i)} disabled={showFeedback} className={`w-full p-4 rounded-xl text-left transition-all border-2 ${showFeedback ? i === data.correctIndex ? 'border-green-500 bg-green-50' : i === selected ? 'border-red-400 bg-red-50' : 'border-neutral-200 bg-white opacity-40' : 'border-neutral-200 bg-white hover:border-neutral-300'}`}>
                <div className="flex items-center gap-3">
                  <span className={`w-8 h-8 rounded-lg flex items-center justify-center text-sm font-bold transition-all ${showFeedback && i === data.correctIndex ? 'bg-green-500 text-white' : showFeedback && i === selected && !isCorrect ? 'bg-red-400 text-white' : 'bg-neutral-100 text-neutral-500'}`}>
                    {showFeedback && i === data.correctIndex ? <Icons.Check /> : showFeedback && i === selected && !isCorrect ? <Icons.X /> : String.fromCharCode(65 + i)}
                  </span>
                  <span className="text-neutral-700 text-base">{option}</span>
                </div>
              </motion.button>
            ))}
          </div>
          <AnimatePresence>
            {showFeedback && (
              <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className={`p-5 rounded-xl ${isCorrect ? 'bg-green-50 border border-green-200' : 'bg-amber-50 border border-amber-200'}`}>
                <p className={`text-sm leading-relaxed ${isCorrect ? 'text-green-800' : 'text-amber-800'}`}>{isCorrect ? data.feedback.correct : data.feedback.incorrect}</p>
              </motion.div>
            )}
          </AnimatePresence>
        </div>
      );
    };

    // Completion Slide (25% larger)
    const CompletionSlide = () => (
      <div className="h-full flex flex-col items-center justify-center text-center px-8 slide-scroll overflow-y-auto py-10">
        <motion.div initial={{ opacity: 0, scale: 0 }} animate={{ opacity: 1, scale: 1 }} transition={{ type: 'spring', duration: 0.5 }} className="w-20 h-20 rounded-xl flex items-center justify-center mb-6 text-white" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))`, boxShadow: `0 6px 24px rgba(var(--accent-rgb), 0.35)` }}><Icons.Check /></motion.div>
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="slide-title text-3xl md:text-4xl text-black mb-4">Lesson Complete</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.25 }} className="text-neutral-500 text-base mb-8 max-w-md leading-relaxed">You now have a 4-letter cheat code for dissolving doubt. O-C-P-B. Use it on your product pages, emails, and ads.</motion.p>
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.35 }} className="bg-neutral-900 rounded-xl p-6 max-w-md w-full">
          <p className="text-neutral-500 text-xs uppercase tracking-wider mb-3">Up Next</p>
          <h3 className="text-white font-bold text-xl mb-2">{LESSON_CONFIG.nextLesson.title}</h3>
          <p className="text-neutral-400 text-sm">{LESSON_CONFIG.nextLesson.teaser}</p>
        </motion.div>
      </div>
    );

    // ============================================
    // MAIN APP
    // ============================================
    const App = () => {
      const [currentSlide, setCurrentSlide] = useState(0);
      const [direction, setDirection] = useState(0);
      const userName = useMemo(() => getUserName(), []);
      const currentSlideRef = React.useRef(0);

      React.useEffect(() => { currentSlideRef.current = currentSlide; }, [currentSlide]);

      const goToSlide = useCallback((newSlide) => {
        if (newSlide < 0 || newSlide >= slides.length) return;
        setDirection(newSlide > currentSlideRef.current ? 1 : -1);
        setCurrentSlide(newSlide);
      }, []);

      const nextSlide = useCallback(() => { if (currentSlideRef.current + 1 < slides.length) goToSlide(currentSlideRef.current + 1); }, [goToSlide]);
      const prevSlide = useCallback(() => { if (currentSlideRef.current - 1 >= 0) goToSlide(currentSlideRef.current - 1); }, [goToSlide]);

      useEffect(() => {
        const handleKeyDown = (e) => {
          if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); nextSlide(); }
          if (e.key === 'ArrowLeft') { e.preventDefault(); prevSlide(); }
        };
        window.addEventListener('keydown', handleKeyDown);
        return () => window.removeEventListener('keydown', handleKeyDown);
      }, [nextSlide, prevSlide]);

      const slideVariants = {
        enter: (dir) => ({ x: dir > 0 ? '100%' : '-100%', opacity: 0 }),
        center: { x: 0, opacity: 1 },
        exit: (dir) => ({ x: dir > 0 ? '-100%' : '100%', opacity: 0 })
      };

      const renderSlide = (slide) => {
        switch (slide.type) {
          case 'welcome': return <WelcomeSlide data={slide} onStart={nextSlide} userName={userName} />;
          case 'hook': return <HookSlide data={slide} />;
          case 'content': return <ContentSlide data={slide} />;
          case 'example': return <ExampleSlide data={slide} />;
          case 'visual': return <VisualSlide data={slide} />;
          case 'breakdown': return <BreakdownSlide data={slide} />;
          case 'cards': return <CardsSlide data={slide} />;
          case 'quiz': return <QuizSlide data={slide} />;
          case 'completion': return <CompletionSlide />;
          default: return null;
        }
      };

      const showPrev = currentSlide > 0;
      const showNext = currentSlide < slides.length - 1 && slides[currentSlide].type !== 'welcome';

      return (
        <div className="w-full h-screen bg-white flex flex-col">
          <div className="flex-1 relative overflow-hidden">
            <AnimatePresence mode="wait" custom={direction}>
              <motion.div key={currentSlide} custom={direction} variants={slideVariants} initial="enter" animate="center" exit="exit" transition={{ duration: 0.3, ease: [0.25, 0.1, 0.25, 1] }} className="absolute inset-0">
                {renderSlide(slides[currentSlide])}
              </motion.div>
            </AnimatePresence>
            {showPrev && <button onClick={prevSlide} className="absolute left-5 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-500 hover:text-neutral-700 transition-all z-10"><Icons.ArrowLeft /></button>}
            {showNext && <button onClick={nextSlide} className="absolute right-5 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-500 hover:text-neutral-700 transition-all z-10"><Icons.ArrowRight /></button>}
          </div>
          <div className="px-6 md:px-8 py-5 border-t border-neutral-100 flex-shrink-0">
            <div className="flex items-center justify-center gap-2.5">
              {slides.map((_, i) => <button key={i} onClick={() => goToSlide(i)} className="w-2.5 h-2.5 rounded-full transition-all duration-300" style={{ background: i === currentSlide ? 'var(--accent)' : '#d4d4d4', transform: i === currentSlide ? 'scale(1.3)' : 'scale(1)' }} />)}
            </div>
          </div>
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
