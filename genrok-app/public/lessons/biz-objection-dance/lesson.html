<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Objection Dance | Quantum Scale</title>
  <script src="https://cdn.tailwindcss.com" defer></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" defer></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" defer></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js" defer></script>
  <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js" defer></script>
  <script src="../shared/greetings.js" defer></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;500;600;700;800;900&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root { --accent: #f97316; --accent-dark: #ea580c; --accent-light: #fb923c; --accent-rgb: 249, 115, 22; }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Inter', sans-serif; background: transparent; -webkit-font-smoothing: antialiased; }
    .title-font { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    h1, h2, h3, .slide-title { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    ::selection { background: var(--accent); color: white; }
    .slide-scroll::-webkit-scrollbar { display: none; }
    .slide-scroll { -ms-overflow-style: none; scrollbar-width: none; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { motion, AnimatePresence } = window.Motion;
    const { useState, useEffect, useCallback, useMemo } = React;

    const getUserName = () => { const params = new URLSearchParams(window.location.search); return params.get('userName') || 'Builder'; };
    const getInitialSlide = () => { const params = new URLSearchParams(window.location.search); const slide = params.get('slide'); return slide ? parseInt(slide, 10) : 0; };

    const LESSON_CONFIG = {
      id: 'biz-objection-dance',
      title: 'The Objection Dance',
      description: 'Handle objections like a dance, not a fight',
      accentColor: '#f97316',
      duration: '7 min',
      nextLesson: { id: 'biz-infinite-flywheel', title: 'The Infinite Money Flywheel', teaser: 'How $100 ad spend becomes a predictable, scalable money machine.' }
    };

    const celebrationGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_doing_a_quick_victory_dance_move_high_energy_c_d03b798b-a518-4e6c-bcae-d69b2dd50486_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_jumping_in_the_air_arms_raised_high_YESSS_cele_201477e8-3df4-405a-bc81-81d1747e5c6c_2.mp4'
    ];
    const getRandomCelebrationGif = () => celebrationGifs[Math.floor(Math.random() * celebrationGifs.length)];

    const empathyGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_thumbs_down_with_encouraging_nod_close_keep_go_613e541f-c072-436f-aee7-f99cd6f834fc_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_shaking_head_side_to_side_sadly_disappointed_e_c4a4be22-6a70-4738-8612-3039454fef37_1.mp4'
    ];
    const getRandomEmpathyGif = () => empathyGifs[Math.floor(Math.random() * empathyGifs.length)];

    const slides = [
      { type: 'welcome', learningGoals: ['Why objections are a dance, not a fight', 'The 4 techniques: Curiosity, Questions, Eminem, Back Foot', 'How to disarm resistance without arguing'] },
      { type: 'hook', headline: 'The moment someone objects, most salespeople fight. The best ones? They dance.', subtext: 'An objection is not rejection. It is an invitation to lead. When they step left, you step right. When they push, you pull. You never argue. You never force. You guide. You disarm.' },
      { type: 'fight-vs-dance', title: 'Fight vs Dance', subtitle: 'Two approaches to objections' },
      { type: 'four-techniques', title: 'The 4 Dance Moves', subtitle: 'Master these and objections become opportunities' },
      { type: 'technique-detail', title: 'Technique 1: Childlike Curiosity', num: 1, color: '#f97316', desc: 'When they object, get genuinely curious. "Tell me more about that." "What makes you feel that way?" You are not defending. You are exploring. They expect a fight. You give them curiosity.', example: '"Tell me more about that..."' },
      { type: 'technique-detail', title: 'Technique 2: Only Questions', num: 2, color: '#3B82F6', desc: 'Stop making statements. Start asking questions. Questions shift the power dynamic. They are not being sold to. They are solving their own problem with your guidance.', example: '"What would need to be true for this to work for you?"' },
      { type: 'push-vs-pull', title: 'Statements vs Questions', subtitle: 'One pushes. One leads.' },
      { type: 'technique-detail', title: 'Technique 3: The Eminem Method', num: 3, color: '#8B5CF6', desc: 'Before they can bring up negatives, YOU bring them up first. "Look, this is not cheap." "This will not work if you do not put in the effort." When you own the negatives, they cannot use them against you.', example: '"This costs $5K. It is not for everyone..."' },
      { type: 'eminem-examples', title: 'The Eminem Method in Action', subtitle: 'Own their negatives before they can use them' },
      { type: 'technique-detail', title: 'Technique 4: Sell From the Back Foot', num: 4, color: '#22C55E', desc: 'Stop chasing. Start retreating. "If you want it, I am here. But if it is not right for you, no problem." This creates FOMO. When you pull away, they lean in.', example: '"Take your time. If it is right, you will know."' },
      { type: 'quiz', question: 'What is the "Eminem Method" for handling objections?', options: ['Rap really fast to confuse them', 'Own their negatives before they can use them against you', 'Tell them they are wrong', 'Ignore the objection completely'], correctIndex: 1, feedback: { correct: 'Exactly! The Eminem Method means YOU bring up the negatives first. When you own the negatives, they cannot be used against you.', incorrect: 'Not quite. The Eminem Method is about owning their negatives BEFORE they can use them. By bringing it up first, you disarm the objection.' }},
      { type: 'mindset-shift', title: 'The Golden Rule', insight: 'The moment you argue, you lose. Even if you "win" the argument, you lose the sale. Never fight. Always dance.' },
      { type: 'completion', sources: ['Alex Hormozi - $100M Offers'] }
    ];

    const Icons = {
      Clock: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
      Check: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><polyline points="20 6 9 17 4 12"/></svg>,
      X: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
      ArrowLeft: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>,
      ArrowRight: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>,
      Zap: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
      MessageCircle: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/></svg>,
      HelpCircle: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>,
      Shield: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>,
      ArrowUpRight: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="7" y1="17" x2="17" y2="7"/><polyline points="7 7 17 7 17 17"/></svg>,
      TrendingDown: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="23 18 13.5 8.5 8.5 13.5 1 6"/><polyline points="17 18 23 18 23 12"/></svg>,
      Users: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>,
      DollarSign: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>,
      Clock2: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
      Target: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>,
    };

    // ============ CUSTOM ELITE SLIDE COMPONENTS ============

    // Fight vs Dance Comparison
    const FightVsDanceSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-8">
        <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
          <h2 className="slide-title text-2xl md:text-3xl lg:text-4xl text-black mb-2">{data.title}</h2>
          <p className="text-neutral-500 text-sm">{data.subtitle}</p>
        </motion.div>

        <div className="grid md:grid-cols-2 gap-6">
          {/* Fight */}
          <motion.div initial={{ opacity: 0, x: -30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.2 }}
            style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: 16, padding: 24, position: 'relative', overflow: 'hidden' }}>
            <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: 3, background: 'linear-gradient(90deg, transparent, #EF4444, transparent)' }} />
            <div className="flex items-center gap-3 mb-4">
              <div style={{ width: 48, height: 48, borderRadius: 12, background: 'rgba(239, 68, 68, 0.15)', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                <span style={{ color: '#EF4444' }}><Icons.X /></span>
              </div>
              <div>
                <p className="text-red-400 text-xs uppercase tracking-wider">Wrong Approach</p>
                <p className="text-white font-semibold text-lg">Fight</p>
              </div>
            </div>
            <div className="space-y-3">
              {['Push harder when they resist', 'Argue to prove you are right', 'Make statements, not questions', 'Chase when they pull away'].map((item, i) => (
                <motion.div key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.3 + i * 0.1 }}
                  className="flex items-center gap-3 text-neutral-400 text-sm">
                  <div style={{ width: 6, height: 6, borderRadius: '50%', background: '#EF4444' }} />
                  {item}
                </motion.div>
              ))}
            </div>
            <div className="mt-4 pt-4 border-t border-neutral-700">
              <p className="text-red-400 text-sm font-medium">Result: You win the argument, lose the sale</p>
            </div>
          </motion.div>

          {/* Dance */}
          <motion.div initial={{ opacity: 0, x: 30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.4 }}
            style={{ background: 'linear-gradient(135deg, #1a1f1a, #2d3d2d)', borderRadius: 16, padding: 24, position: 'relative', overflow: 'hidden', boxShadow: '0 0 40px rgba(249, 115, 22, 0.15)' }}>
            <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: 3, background: 'linear-gradient(90deg, transparent, #f97316, transparent)' }} />
            <div className="flex items-center gap-3 mb-4">
              <div style={{ width: 48, height: 48, borderRadius: 12, background: 'rgba(249, 115, 22, 0.15)', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                <span style={{ color: '#f97316' }}><Icons.Check /></span>
              </div>
              <div>
                <p className="text-orange-400 text-xs uppercase tracking-wider">Right Approach</p>
                <p className="text-white font-semibold text-lg">Dance</p>
              </div>
            </div>
            <div className="space-y-3">
              {['Step back when they push', 'Get curious, not defensive', 'Lead with questions', 'Pull away to create desire'].map((item, i) => (
                <motion.div key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.5 + i * 0.1 }}
                  className="flex items-center gap-3 text-orange-200/80 text-sm">
                  <div style={{ width: 6, height: 6, borderRadius: '50%', background: '#f97316' }} />
                  {item}
                </motion.div>
              ))}
            </div>
            <div className="mt-4 pt-4 border-t border-orange-900/30">
              <p className="text-orange-400 text-sm font-medium">Result: They sell themselves</p>
            </div>
          </motion.div>
        </div>
      </div>
    );

    // Four Techniques Grid
    const FourTechniquesSlide = ({ data }) => {
      const techniques = [
        { num: 1, title: 'Childlike Curiosity', desc: '"Tell me more about that..."', icon: Icons.HelpCircle, color: '#f97316' },
        { num: 2, title: 'Only Questions', desc: 'Never statements. Lead with questions.', icon: Icons.MessageCircle, color: '#3B82F6' },
        { num: 3, title: 'Eminem Method', desc: 'Own their negatives first', icon: Icons.Shield, color: '#8B5CF6' },
        { num: 4, title: 'Back Foot', desc: 'Pull away to create desire', icon: Icons.TrendingDown, color: '#22C55E' }
      ];

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-8">
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
            <h2 className="slide-title text-2xl md:text-3xl lg:text-4xl text-black mb-2">{data.title}</h2>
            <p className="text-neutral-500 text-sm">{data.subtitle}</p>
          </motion.div>

          <div className="grid grid-cols-2 gap-4">
            {techniques.map((tech, i) => (
              <motion.div key={i} initial={{ opacity: 0, scale: 0.9 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.2 + i * 0.1 }}
                style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: 16, padding: 20, position: 'relative', overflow: 'hidden' }}>
                <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: 3, background: `linear-gradient(90deg, transparent, ${tech.color}, transparent)` }} />
                <div className="flex items-start gap-3">
                  <div style={{ width: 40, height: 40, borderRadius: 10, background: `${tech.color}20`, display: 'flex', alignItems: 'center', justifyContent: 'center', flexShrink: 0, border: `1px solid ${tech.color}30` }}>
                    <span style={{ color: tech.color }}>{tech.num}</span>
                  </div>
                  <div>
                    <h3 className="font-bold text-white text-sm mb-1">{tech.title}</h3>
                    <p className="text-neutral-400 text-xs">{tech.desc}</p>
                  </div>
                </div>
              </motion.div>
            ))}
          </div>

          <motion.p initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ delay: 0.8 }}
            className="text-center text-neutral-500 text-sm mt-6">
            Master all four and objections become opportunities
          </motion.p>
        </div>
      );
    };

    // Technique Detail Slide
    const TechniqueDetailSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto py-8">
        <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }}
          style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: 20, padding: 32, position: 'relative', overflow: 'hidden' }}>
          <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: 3, background: `linear-gradient(90deg, transparent, ${data.color}, transparent)` }} />

          <div className="flex items-center gap-4 mb-6">
            <div style={{ width: 56, height: 56, borderRadius: 14, background: `${data.color}20`, display: 'flex', alignItems: 'center', justifyContent: 'center', border: `1px solid ${data.color}30` }}>
              <span className="text-2xl font-bold" style={{ color: data.color }}>{data.num}</span>
            </div>
            <div>
              <p style={{ color: data.color }} className="text-xs uppercase tracking-wider mb-1">Technique {data.num}</p>
              <h2 className="slide-title text-xl md:text-2xl text-white">{data.title.replace(`Technique ${data.num}: `, '')}</h2>
            </div>
          </div>

          <p className="text-neutral-300 text-base leading-relaxed mb-6">{data.desc}</p>

          <motion.div initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.3 }}
            style={{ background: `${data.color}15`, borderRadius: 12, padding: 16, border: `1px solid ${data.color}30` }}>
            <p className="text-xs uppercase tracking-wider mb-2" style={{ color: data.color }}>Example</p>
            <p className="text-white font-medium italic">"{data.example}"</p>
          </motion.div>
        </motion.div>
      </div>
    );

    // Push vs Pull Comparison
    const PushVsPullSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-8">
        <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
          <h2 className="slide-title text-2xl md:text-3xl lg:text-4xl text-black mb-2">{data.title}</h2>
          <p className="text-neutral-500 text-sm">{data.subtitle}</p>
        </motion.div>

        <div className="grid md:grid-cols-2 gap-6">
          {/* Statement (Push) */}
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 }}
            style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: 16, padding: 24, position: 'relative' }}>
            <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: 3, background: 'linear-gradient(90deg, transparent, #EF4444, transparent)' }} />
            <div className="flex items-center gap-2 mb-4">
              <div style={{ width: 32, height: 32, borderRadius: 8, background: 'rgba(239, 68, 68, 0.15)', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                <span style={{ color: '#EF4444' }}><Icons.ArrowUpRight /></span>
              </div>
              <p className="text-red-400 text-sm font-semibold">Statement (Pushy)</p>
            </div>
            <div style={{ background: 'rgba(239, 68, 68, 0.1)', borderRadius: 12, padding: 16, border: '1px solid rgba(239, 68, 68, 0.2)' }}>
              <p className="text-neutral-300 text-sm italic">"Trust me, this works for everyone. You just need to commit."</p>
            </div>
            <p className="text-neutral-500 text-xs mt-3">Tells them what to think. Creates resistance.</p>
          </motion.div>

          {/* Question (Pull) */}
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.4 }}
            style={{ background: 'linear-gradient(135deg, #1a1f1a, #2d3d2d)', borderRadius: 16, padding: 24, position: 'relative', boxShadow: '0 0 30px rgba(59, 130, 246, 0.15)' }}>
            <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: 3, background: 'linear-gradient(90deg, transparent, #3B82F6, transparent)' }} />
            <div className="flex items-center gap-2 mb-4">
              <div style={{ width: 32, height: 32, borderRadius: 8, background: 'rgba(59, 130, 246, 0.15)', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                <span style={{ color: '#3B82F6' }}><Icons.HelpCircle /></span>
              </div>
              <p className="text-blue-400 text-sm font-semibold">Question (Dance)</p>
            </div>
            <div style={{ background: 'rgba(59, 130, 246, 0.1)', borderRadius: 12, padding: 16, border: '1px solid rgba(59, 130, 246, 0.2)' }}>
              <p className="text-blue-100 text-sm italic">"What would make this feel like the right decision for you?"</p>
            </div>
            <p className="text-blue-300/60 text-xs mt-3">Invites them to think. Creates engagement.</p>
          </motion.div>
        </div>

        <motion.p initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ delay: 0.6 }}
          className="text-center text-neutral-500 text-sm mt-6">
          Questions invite. Statements repel. Dance, do not push.
        </motion.p>
      </div>
    );

    // Eminem Examples Slide
    const EminemExamplesSlide = ({ data }) => {
      const examples = [
        { objection: 'Price', response: '"This costs $5,000. It is not for everyone. But if you are serious about results, it is worth 10x that."', icon: Icons.DollarSign, color: '#f97316' },
        { objection: 'Time', response: '"This takes 6 months. Not overnight. But that is why it worksâ€”no shortcuts, just real transformation."', icon: Icons.Clock2, color: '#3B82F6' },
        { objection: 'Effort', response: '"You will need to show up. This is not passive. But that is exactly why people succeed with it."', icon: Icons.Target, color: '#22C55E' }
      ];

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto py-8">
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
            <h2 className="slide-title text-2xl md:text-3xl lg:text-4xl text-black mb-2">{data.title}</h2>
            <p className="text-neutral-500 text-sm">{data.subtitle}</p>
          </motion.div>

          <div className="space-y-4">
            {examples.map((ex, i) => (
              <motion.div key={i} initial={{ opacity: 0, x: -20 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.2 + i * 0.15 }}
                style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: 16, padding: 20, position: 'relative', overflow: 'hidden' }}>
                <div style={{ position: 'absolute', left: 0, top: 0, bottom: 0, width: 4, background: ex.color }} />
                <div className="flex items-start gap-4">
                  <div style={{ width: 40, height: 40, borderRadius: 10, background: `${ex.color}20`, display: 'flex', alignItems: 'center', justifyContent: 'center', flexShrink: 0, border: `1px solid ${ex.color}30` }}>
                    <span style={{ color: ex.color }}><ex.icon /></span>
                  </div>
                  <div>
                    <p style={{ color: ex.color }} className="text-xs uppercase tracking-wider mb-2">{ex.objection} Objection</p>
                    <p className="text-neutral-300 text-sm italic leading-relaxed">{ex.response}</p>
                  </div>
                </div>
              </motion.div>
            ))}
          </div>
        </div>
      );
    };

    // Mindset Shift Slide
    const MindsetShiftSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-3xl mx-auto py-8">
        <motion.div initial={{ opacity: 0, scale: 0.9 }} animate={{ opacity: 1, scale: 1 }}
          style={{ background: 'linear-gradient(135deg, #1f1a0f, #3d2d1a)', borderRadius: 24, padding: 40, textAlign: 'center', position: 'relative', overflow: 'hidden', boxShadow: '0 0 60px rgba(249, 115, 22, 0.2)' }}>
          <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: 3, background: 'linear-gradient(90deg, transparent, #f97316, transparent)' }} />

          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 }}
            style={{ width: 64, height: 64, borderRadius: 16, background: 'rgba(249, 115, 22, 0.2)', display: 'flex', alignItems: 'center', justifyContent: 'center', margin: '0 auto 24px', border: '1px solid rgba(249, 115, 22, 0.3)' }}>
            <span style={{ color: '#f97316' }}><Icons.Zap /></span>
          </motion.div>

          <motion.h2 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.3 }}
            className="slide-title text-2xl md:text-3xl text-white mb-6">{data.title}</motion.h2>

          <motion.p initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.4 }}
            className="text-orange-100/80 text-lg leading-relaxed">{data.insight}</motion.p>
        </motion.div>
      </div>
    );

    // ============ STANDARD TEMPLATE COMPONENTS ============

    const WelcomeSlide = ({ data, onStart, userName, onShowGif, onHideGif }) => {
      const welcomeData = useMemo(() => getTimeBasedWelcome(), []);
      const gifSide = useMemo(() => Math.random() > 0.5 ? 'left' : 'right', []);
      useEffect(() => { onShowGif(welcomeData.gif, '65%', gifSide); return () => onHideGif(); }, [welcomeData.gif, gifSide, onShowGif, onHideGif]);

      return (
        <div className="h-full w-full relative overflow-hidden">
          <div className="h-full flex flex-col items-center justify-center text-center px-6 py-4 relative z-20">
            <motion.h1 initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} className="title-font text-3xl sm:text-4xl md:text-5xl lg:text-6xl text-black mb-2 md:mb-3">{LESSON_CONFIG.title}</motion.h1>
            <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-neutral-600 text-base md:text-lg lg:text-xl mb-2 md:mb-3 max-w-lg leading-relaxed" dangerouslySetInnerHTML={{ __html: formatGreeting(welcomeData.greeting, `<span class="font-bold text-neutral-900">${userName}</span>`) }} />
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="flex items-center justify-center gap-1.5 text-neutral-400 text-[10px] md:text-xs mb-2 md:mb-3"><Icons.Clock /><span>{LESSON_CONFIG.duration}</span></motion.div>
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 }} className="bg-neutral-900 rounded-xl md:rounded-2xl p-3 md:p-5 mb-3 md:mb-4 max-w-sm w-full mx-auto">
              <p className="text-neutral-500 text-[9px] md:text-[11px] uppercase tracking-wider mb-2 md:mb-3">In this lesson</p>
              <ul className="space-y-1.5 md:space-y-2">
                {data.learningGoals.map((goal, i) => (
                  <motion.li key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.25 + i * 0.05 }} className="flex items-start gap-2 text-left">
                    <span className="w-5 h-5 rounded-md flex items-center justify-center text-[9px] font-bold text-white flex-shrink-0 mt-0.5" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>{i + 1}</span>
                    <span className="text-neutral-300 text-[11px] md:text-sm leading-snug">{goal}</span>
                  </motion.li>
                ))}
              </ul>
            </motion.div>
            <motion.button initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.45 }} onClick={onStart} whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }} className="px-6 md:px-7 py-2.5 md:py-3 rounded-xl text-white font-semibold text-sm md:text-base" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>Let's Go</motion.button>
          </div>
        </div>
      );
    };

    const HookSlide = ({ data }) => (
      <div className="h-full relative overflow-hidden">
        <div className="h-full flex flex-col justify-center px-6 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-8 md:py-10 relative z-10">
          <motion.div initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} className="mb-4 md:mb-6">
            <span className="inline-block px-3 py-1 rounded-full text-xs font-semibold mb-3 md:mb-4" style={{ background: `rgba(var(--accent-rgb), 0.1)`, color: 'var(--accent)' }}>The Hook</span>
            <h2 className="slide-title text-2xl md:text-4xl lg:text-5xl text-black leading-tight">{data.headline}</h2>
          </motion.div>
          <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="text-base md:text-xl text-neutral-600 leading-relaxed">{data.subtext}</motion.p>
        </div>
      </div>
    );

    const QuizSlide = ({ data, onShowGif, onHideGif }) => {
      const [selected, setSelected] = useState(null);
      const [showFeedback, setShowFeedback] = useState(false);
      const isCorrect = selected === data.correctIndex;

      useEffect(() => {
        if (showFeedback) {
          const gif = isCorrect ? getRandomCelebrationGif() : getRandomEmpathyGif();
          onShowGif(gif, '50%', 'right');
          return () => onHideGif();
        }
      }, [showFeedback, isCorrect, onShowGif, onHideGif]);

      const handleSelect = (index) => {
        if (showFeedback) return;
        setSelected(index);
        setShowFeedback(true);
      };

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-3xl mx-auto slide-scroll overflow-y-auto py-8">
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="mb-6">
            <p className="text-neutral-400 text-xs uppercase tracking-wider mb-2">Quick Check</p>
            <h2 className="slide-title text-xl md:text-2xl text-black">{data.question}</h2>
          </motion.div>
          <div className="space-y-3">
            {data.options.map((option, i) => (
              <motion.button key={i} initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 + i * 0.05 }}
                onClick={() => handleSelect(i)}
                disabled={showFeedback}
                className={`w-full p-4 rounded-xl text-left flex items-center gap-3 transition-all ${showFeedback ? (i === data.correctIndex ? 'bg-green-50 border-2 border-green-500' : i === selected ? 'bg-red-50 border-2 border-red-500' : 'bg-neutral-50 border-2 border-neutral-200 opacity-50') : 'bg-white border-2 border-neutral-200 hover:border-neutral-400'}`}>
                <span className={`w-8 h-8 rounded-lg flex items-center justify-center font-bold text-sm ${showFeedback && i === data.correctIndex ? 'bg-green-500 text-white' : showFeedback && i === selected ? 'bg-red-500 text-white' : 'bg-neutral-200 text-neutral-700'}`}>
                  {String.fromCharCode(65 + i)}
                </span>
                <span className="text-neutral-700 text-sm">{option}</span>
              </motion.button>
            ))}
          </div>
          <AnimatePresence>
            {showFeedback && (
              <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0 }}
                className={`mt-6 p-4 rounded-xl ${isCorrect ? 'bg-green-50 border border-green-200' : 'bg-red-50 border border-red-200'}`}>
                <p className={`text-sm ${isCorrect ? 'text-green-700' : 'text-red-700'}`}>
                  {isCorrect ? data.feedback.correct : data.feedback.incorrect}
                </p>
              </motion.div>
            )}
          </AnimatePresence>
        </div>
      );
    };

    const CompletionSlide = ({ data }) => (
      <div className="h-full flex flex-col items-center justify-center text-center px-6 py-8">
        <motion.div initial={{ opacity: 0, scale: 0.8 }} animate={{ opacity: 1, scale: 1 }}
          className="w-20 h-20 rounded-full flex items-center justify-center mb-6" style={{ background: 'linear-gradient(135deg, var(--accent), var(--accent-dark))' }}>
          <Icons.Check />
        </motion.div>
        <motion.h2 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 }}
          className="slide-title text-2xl md:text-3xl text-black mb-3">Lesson Complete!</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.3 }}
          className="text-neutral-600 mb-6">You have mastered the objection dance.</motion.p>
        {LESSON_CONFIG.nextLesson && (
          <motion.a initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.4 }}
            href={`/lessons/${LESSON_CONFIG.nextLesson.id}/lesson.html`}
            className="px-6 py-3 rounded-xl text-white font-semibold" style={{ background: 'linear-gradient(135deg, var(--accent), var(--accent-dark))' }}>
            Next: {LESSON_CONFIG.nextLesson.title}
          </motion.a>
        )}
        {data.sources && data.sources.length > 0 && (
          <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ delay: 0.5 }} className="mt-8 text-xs text-neutral-400">
            Sources: {data.sources.join(', ')}
          </motion.div>
        )}
      </div>
    );

    // ============ LESSON APP ============

    const LessonApp = () => {
      const [currentSlide, setCurrentSlide] = useState(getInitialSlide);
      const [direction, setDirection] = useState(1);
      const [isAnimating, setIsAnimating] = useState(false);
      const [gifConfig, setGifConfig] = useState(null);
      const userName = getUserName();

      const nextSlide = useCallback(() => {
        if (isAnimating || currentSlide >= slides.length - 1) return;
        setDirection(1);
        setIsAnimating(true);
        setCurrentSlide(prev => prev + 1);
      }, [isAnimating, currentSlide]);

      const prevSlide = useCallback(() => {
        if (isAnimating || currentSlide <= 0) return;
        setDirection(-1);
        setIsAnimating(true);
        setCurrentSlide(prev => prev - 1);
      }, [isAnimating, currentSlide]);

      const goToSlide = useCallback((index) => {
        if (isAnimating || index === currentSlide) return;
        setDirection(index > currentSlide ? 1 : -1);
        setIsAnimating(true);
        setCurrentSlide(index);
      }, [isAnimating, currentSlide]);

      const showGif = useCallback((url, height = '50%', side = 'right') => setGifConfig({ url, height, side }), []);
      const hideGif = useCallback(() => setGifConfig(null), []);

      useEffect(() => {
        const handleKeyDown = (e) => {
          if (e.key === 'ArrowRight' || e.key === ' ') nextSlide();
          if (e.key === 'ArrowLeft') prevSlide();
        };
        window.addEventListener('keydown', handleKeyDown);
        return () => window.removeEventListener('keydown', handleKeyDown);
      }, [nextSlide, prevSlide]);

      const slideVariants = {
        enter: (dir) => ({ x: dir > 0 ? '100%' : '-100%', opacity: 0 }),
        center: { x: 0, opacity: 1 },
        exit: (dir) => ({ x: dir > 0 ? '-100%' : '100%', opacity: 0 })
      };

      const renderSlide = (slide) => {
        switch (slide.type) {
          case 'welcome': return <WelcomeSlide data={slide} onStart={nextSlide} userName={userName} onShowGif={showGif} onHideGif={hideGif} />;
          case 'hook': return <HookSlide data={slide} />;
          case 'quiz': return <QuizSlide data={slide} onShowGif={showGif} onHideGif={hideGif} />;
          case 'completion': return <CompletionSlide data={slide} />;
          // Custom elite slides
          case 'fight-vs-dance': return <FightVsDanceSlide data={slide} />;
          case 'four-techniques': return <FourTechniquesSlide data={slide} />;
          case 'technique-detail': return <TechniqueDetailSlide data={slide} />;
          case 'push-vs-pull': return <PushVsPullSlide data={slide} />;
          case 'eminem-examples': return <EminemExamplesSlide data={slide} />;
          case 'mindset-shift': return <MindsetShiftSlide data={slide} />;
          default: return null;
        }
      };

      const showPrev = currentSlide > 0;
      const showNext = currentSlide < slides.length - 1 && slides[currentSlide].type !== 'welcome';

      return (
        <div className="w-full h-screen bg-white flex flex-col relative">
          <div className="flex-1 relative overflow-hidden z-20">
            <AnimatePresence mode="wait" custom={direction} onExitComplete={() => setIsAnimating(false)}>
              <motion.div key={currentSlide} custom={direction} variants={slideVariants} initial="enter" animate="center" exit="exit" transition={{ duration: 0.3, ease: [0.25, 0.1, 0.25, 1] }} className="absolute inset-0">
                {renderSlide(slides[currentSlide])}
              </motion.div>
            </AnimatePresence>
            {showPrev && <button onClick={prevSlide} className="absolute left-5 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-500 hover:text-neutral-700 transition-all z-10"><Icons.ArrowLeft /></button>}
            {showNext && <button onClick={nextSlide} className="absolute right-5 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-500 hover:text-neutral-700 transition-all z-10"><Icons.ArrowRight /></button>}
          </div>
          <div className="px-6 md:px-8 py-5 border-t border-neutral-100 flex-shrink-0 relative z-10">
            <div className="flex items-center justify-center gap-2.5">
              {slides.map((_, i) => <button key={i} onClick={() => goToSlide(i)} className="w-2.5 h-2.5 rounded-full transition-all duration-300" style={{ background: i === currentSlide ? 'var(--accent)' : '#d4d4d4', transform: i === currentSlide ? 'scale(1.3)' : 'scale(1)' }} />)}
            </div>
          </div>
          <AnimatePresence>
            {gifConfig && (
              <motion.div initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: 30 }} transition={{ type: 'spring', stiffness: 100 }} className={`absolute ${gifConfig.side === 'left' ? 'left-4 md:left-8' : 'right-4 md:right-8'} bottom-0 pointer-events-none`} style={{ zIndex: 15, height: gifConfig.height }}>
                <video autoPlay loop muted playsInline className="h-full w-auto object-contain object-bottom">
                  <source src={gifConfig.url} type="video/mp4" />
                </video>
              </motion.div>
            )}
          </AnimatePresence>
        </div>
      );
    };

    ReactDOM.render(<LessonApp />, document.getElementById('root'));
  </script>
</body>
</html>
