<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Creative is the New Targeting | Quantum Scale</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
  <script src="../shared/greetings.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fraunces:wght@700;800;900&display=swap" rel="stylesheet">
  <style>
    :root {
      --accent: #D4A017;
      --accent-light: #F4D03F;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; background: #FAFAFA; overflow: hidden; }
    .font-display { font-family: 'Fraunces', Georgia, serif; }
    .hide-scrollbar::-webkit-scrollbar { display: none; }
    .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useMemo, useCallback } = React;
    const { motion, AnimatePresence } = Motion;

    // ===========================================
    // LESSON CONFIGURATION
    // ===========================================
    const LESSON_CONFIG = {
      id: 'biz-creative-targeting',
      title: 'Creative is the New Targeting',
      category: 'Business Strategy',
      categoryIcon: 'üé®',
      accent: '#D4A017',
      nextLesson: {
        id: 'biz-infinite-money-loop',
        title: 'The Infinite Money Loop',
        teaser: 'Discover the flywheel that turns $1 into $10 repeatedly'
      }
    };

    // ===========================================
    // CELEBRATION & EMPATHY GIFS
    // ===========================================
    const celebrationGifs = [
      'https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExcjd0Z2V5OHRxcWx1NHBqbXNudmNjYnVtMjFtOXdmOXRrY3N2dGx6dCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/artj92V8o75VPL7AeQ/giphy.gif',
      'https://media0.giphy.com/media/v1.Y2lkPTc5MGI3NjExaWVqYW0ybG5hZG1hMDRlcXNlcmhraWZhOXRzd2RhdXpuaHB6cXphYiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/xUPGGDNsLvqsBOhuU0/giphy.gif',
      'https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExNHBjOGRmMGJtaGdsYjNvcWd4NG1hcng5aDRlcXRrYnZrd2VjcjcwcCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/3o6fJ1BM7R2EBRDnxK/giphy.gif',
      'https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExMDlqaGR5d2szbWZ6ZjdyZHczNGYyamhzajd4cWJnOXpsOWR3YXg1ciZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/xT0xezQGU5xCDJuCPe/giphy.gif',
      'https://media.giphy.com/media/l0MYt5jPR6QX5pnqM/giphy.gif',
      'https://media.giphy.com/media/3oz8xRF0v9WMAUVLNK/giphy.gif'
    ];

    const empathyGifs = [
      'https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExMTBjNXUwbjN3M2tkdXM1YWM3eHQ1dzZyYXV3NTUwMWRoNGNqZXpjeiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/xmxGoENM1V81q/giphy.gif',
      'https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExd3N4czR6cWtjcnJicnNnY2c2cHVncWtxdGR2MWpxdXY3YjZrM3RtYSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/3o7TKwmnDgQb5jemjK/giphy.gif',
      'https://media.giphy.com/media/l0HlvtIPzPdt2usKs/giphy.gif',
      'https://media.giphy.com/media/xT5LMHxhOfscxPfIfm/giphy.gif'
    ];

    const getRandomCelebrationGif = () => celebrationGifs[Math.floor(Math.random() * celebrationGifs.length)];
    const getRandomEmpathyGif = () => empathyGifs[Math.floor(Math.random() * empathyGifs.length)];

    // ===========================================
    // ICONS
    // ===========================================
    const Icons = {
      ChevronLeft: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m15 18-6-6 6-6"/></svg>,
      ChevronRight: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m9 18 6-6-6-6"/></svg>,
      Clock: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
      Check: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><polyline points="20 6 9 17 4 12"/></svg>,
      Sparkles: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/></svg>,
      Target: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>,
      Layers: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="12 2 2 7 12 12 22 7 12 2"/><polyline points="2 17 12 22 22 17"/><polyline points="2 12 12 17 22 12"/></svg>,
      BarChart: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="20" x2="12" y2="10"/><line x1="18" y1="20" x2="18" y2="4"/><line x1="6" y1="20" x2="6" y2="16"/></svg>,
      Zap: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
      Repeat: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m17 2 4 4-4 4"/><path d="M3 11v-1a4 4 0 0 1 4-4h14"/><path d="m7 22-4-4 4-4"/><path d="M21 13v1a4 4 0 0 1-4 4H3"/></svg>,
      ArrowRight: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
    };

    // ===========================================
    // SLIDE DATA (MAX 70 WORDS PER SLIDE)
    // ===========================================
    const slides = [
      {
        type: 'welcome',
        goals: [
          'Why creative volume beats audience targeting',
          'The 3 pillars: Volume, Diversity, Measurement',
          'How to feed the Meta AI beast'
        ]
      },
      {
        type: 'hook',
        headline: 'Targeting is dead.',
        subtext: 'Meta\'s AI knows who to show your ads to better than you ever could. Your biggest lever isn\'t WHO you target. It\'s WHAT they see.'
      },
      {
        type: 'content',
        title: 'The Old Playbook is Gone',
        body: 'Hyper-targeted audiences. Interest stacking. Custom lookalikes. All outdated. Meta\'s Andromeda AI handles targeting now. Your job changed: give the AI options. 100 ads? It finds winners. 5 ads? You\'re gambling. The bottleneck shifted from finding customers to producing creative.'
      },
      {
        type: 'visual',
        title: 'The Creative Triangle',
        subtitle: 'Master all three to win at scale',
        svg: `<svg viewBox="0 0 400 350" class="w-full max-w-md mx-auto">
          <defs>
            <linearGradient id="volumeGrad" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#3B82F6;stop-opacity:0.2" />
              <stop offset="100%" style="stop-color:#3B82F6;stop-opacity:0.05" />
            </linearGradient>
            <linearGradient id="diversityGrad" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#10B981;stop-opacity:0.2" />
              <stop offset="100%" style="stop-color:#10B981;stop-opacity:0.05" />
            </linearGradient>
            <linearGradient id="measureGrad" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#F59E0B;stop-opacity:0.2" />
              <stop offset="100%" style="stop-color:#F59E0B;stop-opacity:0.05" />
            </linearGradient>
          </defs>
          <path d="M200 40 L350 280 L50 280 Z" fill="none" stroke="#D4A017" stroke-width="2" stroke-dasharray="8,4"/>
          <circle cx="200" cy="40" r="45" fill="url(#volumeGrad)" stroke="#3B82F6" stroke-width="2"/>
          <text x="200" y="35" text-anchor="middle" fill="#3B82F6" font-weight="700" font-size="14">VOLUME</text>
          <text x="200" y="52" text-anchor="middle" fill="#6B7280" font-size="10">100s of ads</text>
          <circle cx="50" cy="280" r="45" fill="url(#diversityGrad)" stroke="#10B981" stroke-width="2"/>
          <text x="50" y="275" text-anchor="middle" fill="#10B981" font-weight="700" font-size="14">DIVERSITY</text>
          <text x="50" y="292" text-anchor="middle" fill="#6B7280" font-size="10">Different angles</text>
          <circle cx="350" cy="280" r="45" fill="url(#measureGrad)" stroke="#F59E0B" stroke-width="2"/>
          <text x="350" y="275" text-anchor="middle" fill="#F59E0B" font-weight="700" font-size="14">MEASURE</text>
          <text x="350" y="292" text-anchor="middle" fill="#6B7280" font-size="10">Track what works</text>
          <circle cx="200" cy="190" r="35" fill="#D4A017" fill-opacity="0.15" stroke="#D4A017" stroke-width="2"/>
          <text x="200" y="186" text-anchor="middle" fill="#1F2937" font-weight="700" font-size="12">WINNING</text>
          <text x="200" y="200" text-anchor="middle" fill="#1F2937" font-weight="700" font-size="12">SYSTEM</text>
        </svg>`
      },
      {
        type: 'cards',
        title: 'The Three Pillars',
        cards: [
          {
            icon: 'Layers',
            title: 'Volume',
            description: 'Launch hundreds of ads per week. One winner might max at $100K/day. Need more winners to spend more.',
            color: '#3B82F6'
          },
          {
            icon: 'Sparkles',
            title: 'Diversity',
            description: 'A new background color isn\'t enough. Different formats, angles, hooks, talent. Radically different.',
            color: '#10B981'
          },
          {
            icon: 'BarChart',
            title: 'Measurement',
            description: 'Track concepts, hooks, edits with MTA tools. Data drives decisions. Gut instinct gets expensive.',
            color: '#F59E0B'
          }
        ]
      },
      {
        type: 'example',
        title: 'Old Way vs New Way',
        before: {
          label: 'Targeting Focus',
          items: ['Hyper-targeted audiences', 'Interest stacking', 'Custom lookalikes', '5-10 ads per month']
        },
        after: {
          label: 'Creative Focus',
          items: ['Broad targeting', 'Volume production', 'Diverse creative', '100+ ads per week']
        }
      },
      {
        type: 'content',
        title: 'Volume: The Math',
        body: 'One winning ad maxes out at ~$100K/day spend. To spend $1M/day? You need 10 winners running. To spend $10M/day? 100 winners. You can\'t find winners without volume. The AI needs options to test. Feed the beast or starve.'
      },
      {
        type: 'content',
        title: 'Diversity: What It Means',
        body: 'Tweaking a background isn\'t diversity. You need: UGC vs studio production, pain point A vs pain point B, question hooks vs statement hooks, "pretty people" vs "real people". Radically different creative = more signals for the AI to test.'
      },
      {
        type: 'visual',
        title: 'The Creative Flywheel',
        subtitle: 'Never stop spinning',
        svg: `<svg viewBox="0 0 400 300" class="w-full max-w-md mx-auto">
          <defs>
            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
              <polygon points="0 0, 10 3.5, 0 7" fill="#D4A017"/>
            </marker>
          </defs>
          <circle cx="200" cy="150" r="90" fill="none" stroke="#D4A017" stroke-width="2" stroke-dasharray="8,4"/>
          <circle cx="200" cy="60" r="35" fill="#3B82F6" fill-opacity="0.15" stroke="#3B82F6" stroke-width="2"/>
          <text x="200" y="57" text-anchor="middle" fill="#3B82F6" font-weight="700" font-size="12">LAUNCH</text>
          <text x="200" y="70" text-anchor="middle" fill="#6B7280" font-size="9">100s of ads</text>
          <circle cx="290" cy="150" r="35" fill="#10B981" fill-opacity="0.15" stroke="#10B981" stroke-width="2"/>
          <text x="290" y="147" text-anchor="middle" fill="#10B981" font-weight="700" font-size="12">MEASURE</text>
          <text x="290" y="160" text-anchor="middle" fill="#6B7280" font-size="9">MTA tracking</text>
          <circle cx="200" cy="240" r="35" fill="#F59E0B" fill-opacity="0.15" stroke="#F59E0B" stroke-width="2"/>
          <text x="200" y="237" text-anchor="middle" fill="#F59E0B" font-weight="700" font-size="12">LEARN</text>
          <text x="200" y="250" text-anchor="middle" fill="#6B7280" font-size="9">Find patterns</text>
          <circle cx="110" cy="150" r="35" fill="#EF4444" fill-opacity="0.15" stroke="#EF4444" stroke-width="2"/>
          <text x="110" y="147" text-anchor="middle" fill="#EF4444" font-weight="700" font-size="12">ITERATE</text>
          <text x="110" y="160" text-anchor="middle" fill="#6B7280" font-size="9">More winners</text>
          <path d="M235 75 Q260 100 270 115" fill="none" stroke="#D4A017" stroke-width="2" marker-end="url(#arrowhead)"/>
          <path d="M275 185 Q260 210 235 225" fill="none" stroke="#D4A017" stroke-width="2" marker-end="url(#arrowhead)"/>
          <path d="M165 225 Q140 200 125 185" fill="none" stroke="#D4A017" stroke-width="2" marker-end="url(#arrowhead)"/>
          <path d="M125 115 Q140 90 165 75" fill="none" stroke="#D4A017" stroke-width="2" marker-end="url(#arrowhead)"/>
        </svg>`
      },
      {
        type: 'content',
        title: 'Naming Convention System',
        body: 'Every ad needs a naming convention. Format: [Product]_[Angle]_[Hook]_[Format]_[Version]. Example: Skincare_AntiAging_Question_UGC_v1. Now you can see: "Question hooks outperform stats by 30%" or "UGC beats studio for this product." Data drives better creative.'
      },
      {
        type: 'quiz',
        question: 'What is the biggest lever in Meta ads at scale?',
        options: [
          'Hyper-targeted audience segmentation',
          'Creative volume and diversity',
          'Increasing daily ad spend',
          'Retargeting campaigns'
        ],
        correctIndex: 1,
        correctFeedback: 'Exactly! Creative volume and diversity is the biggest lever. The AI needs OPTIONS to find winners.',
        incorrectFeedback: 'Not quite. Andromeda is so advanced that creative matters more than targeting. Give the AI more options.'
      },
      {
        type: 'completion',
        title: 'You Now Have The System',
        summary: 'Creative volume and diversity is the biggest lever. Launch hundreds of ads, track what works, iterate. The AI handles targeting. You handle creative.',
        nextSteps: [
          'Set up naming conventions for all your ads',
          'Build a creative production system',
          'Implement MTA tracking to measure what works'
        ]
      }
    ];

    // ===========================================
    // SLIDE COMPONENTS
    // ===========================================
    function WelcomeSlide({ data, gifConfig }) {
      const greeting = typeof window !== 'undefined' && window.getGreeting ? window.getGreeting() : 'Welcome';

      return (
        <div className="flex flex-col items-center justify-center h-full px-6 py-8 text-center">
          <motion.div
            initial={{ scale: 0.9, opacity: 0 }}
            animate={{ scale: 1, opacity: 1 }}
            transition={{ duration: 0.5 }}
            className="inline-flex items-center gap-2 px-4 py-2 rounded-full mb-6"
            style={{ backgroundColor: 'rgba(212, 160, 23, 0.1)' }}
          >
            <span className="text-lg">{LESSON_CONFIG.categoryIcon}</span>
            <span className="text-sm font-semibold" style={{ color: 'var(--accent)' }}>{LESSON_CONFIG.category}</span>
          </motion.div>

          <motion.p
            initial={{ y: 20, opacity: 0 }}
            animate={{ y: 0, opacity: 1 }}
            transition={{ delay: 0.1 }}
            className="text-neutral-500 text-lg mb-2"
          >
            {greeting}!
          </motion.p>

          <motion.h1
            initial={{ y: 20, opacity: 0 }}
            animate={{ y: 0, opacity: 1 }}
            transition={{ delay: 0.2 }}
            className="font-display text-3xl md:text-4xl lg:text-5xl font-bold text-neutral-900 mb-8 leading-tight"
          >
            {LESSON_CONFIG.title}
          </motion.h1>

          <motion.div
            initial={{ y: 20, opacity: 0 }}
            animate={{ y: 0, opacity: 1 }}
            transition={{ delay: 0.3 }}
            className="bg-white rounded-2xl p-6 shadow-sm border border-neutral-100 w-full max-w-md"
          >
            <h3 className="text-sm font-semibold text-neutral-500 uppercase tracking-wider mb-4">What you'll learn</h3>
            <ul className="space-y-3">
              {data.goals.map((goal, i) => (
                <motion.li
                  key={i}
                  initial={{ x: -20, opacity: 0 }}
                  animate={{ x: 0, opacity: 1 }}
                  transition={{ delay: 0.4 + i * 0.1 }}
                  className="flex items-start gap-3 text-left"
                >
                  <div className="w-5 h-5 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5" style={{ backgroundColor: 'var(--accent)' }}>
                    <Icons.Check />
                  </div>
                  <span className="text-neutral-700">{goal}</span>
                </motion.li>
              ))}
            </ul>
          </motion.div>

          {/* Celebration GIF */}
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.6, duration: 0.5 }}
            className={`absolute bottom-20 ${gifConfig.side} hidden md:block`}
            style={{ height: gifConfig.height, zIndex: 5 }}
          >
            <img
              src={gifConfig.url}
              alt="Welcome"
              className="h-full w-auto object-contain rounded-lg"
              style={{ maxHeight: '280px' }}
            />
          </motion.div>
        </div>
      );
    }

    function HookSlide({ data }) {
      return (
        <div className="flex flex-col items-center justify-center h-full px-6 py-8 text-center bg-gradient-to-br from-neutral-900 to-black">
          <motion.h2
            initial={{ y: 30, opacity: 0 }}
            animate={{ y: 0, opacity: 1 }}
            transition={{ duration: 0.6 }}
            className="font-display text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-6 leading-tight max-w-3xl"
          >
            {data.headline}
          </motion.h2>

          <motion.p
            initial={{ y: 20, opacity: 0 }}
            animate={{ y: 0, opacity: 1 }}
            transition={{ delay: 0.3, duration: 0.6 }}
            className="text-xl md:text-2xl text-neutral-400 max-w-2xl leading-relaxed"
          >
            {data.subtext}
          </motion.p>
        </div>
      );
    }

    function ContentSlide({ data }) {
      return (
        <div className="flex flex-col items-center justify-center h-full px-6 py-8">
          <div className="max-w-2xl w-full">
            <motion.h2
              initial={{ y: 20, opacity: 0 }}
              animate={{ y: 0, opacity: 1 }}
              className="font-display text-3xl md:text-4xl font-bold text-neutral-900 mb-8 text-center"
            >
              {data.title}
            </motion.h2>

            <motion.p
              initial={{ y: 20, opacity: 0 }}
              animate={{ y: 0, opacity: 1 }}
              transition={{ delay: 0.2 }}
              className="text-lg md:text-xl text-neutral-600 leading-relaxed text-center"
            >
              {data.body}
            </motion.p>
          </div>
        </div>
      );
    }

    function VisualSlide({ data }) {
      return (
        <div className="flex flex-col items-center justify-center h-full px-6 py-8">
          <motion.h2
            initial={{ y: 20, opacity: 0 }}
            animate={{ y: 0, opacity: 1 }}
            className="font-display text-3xl md:text-4xl font-bold text-neutral-900 mb-2 text-center"
          >
            {data.title}
          </motion.h2>

          {data.subtitle && (
            <motion.p
              initial={{ y: 20, opacity: 0 }}
              animate={{ y: 0, opacity: 1 }}
              transition={{ delay: 0.1 }}
              className="text-neutral-500 mb-8 text-center"
            >
              {data.subtitle}
            </motion.p>
          )}

          <motion.div
            initial={{ scale: 0.9, opacity: 0 }}
            animate={{ scale: 1, opacity: 1 }}
            transition={{ delay: 0.2, duration: 0.5 }}
            className="w-full max-w-lg"
            dangerouslySetInnerHTML={{ __html: data.svg }}
          />
        </div>
      );
    }

    function CardsSlide({ data }) {
      const iconMap = {
        Layers: Icons.Layers,
        Sparkles: Icons.Sparkles,
        BarChart: Icons.BarChart,
        Target: Icons.Target,
        Zap: Icons.Zap,
        Repeat: Icons.Repeat
      };

      return (
        <div className="flex flex-col items-center justify-center h-full px-6 py-8">
          <motion.h2
            initial={{ y: 20, opacity: 0 }}
            animate={{ y: 0, opacity: 1 }}
            className="font-display text-3xl md:text-4xl font-bold text-neutral-900 mb-8 text-center"
          >
            {data.title}
          </motion.h2>

          <div className="grid grid-cols-1 md:grid-cols-3 gap-4 w-full max-w-4xl">
            {data.cards.map((card, i) => {
              const IconComponent = iconMap[card.icon] || Icons.Sparkles;
              return (
                <motion.div
                  key={i}
                  initial={{ y: 20, opacity: 0 }}
                  animate={{ y: 0, opacity: 1 }}
                  transition={{ delay: 0.2 + i * 0.1 }}
                  className="bg-white rounded-xl p-5 shadow-sm border border-neutral-100"
                >
                  <div
                    className="w-10 h-10 rounded-lg flex items-center justify-center mb-3"
                    style={{ backgroundColor: `${card.color}15`, color: card.color }}
                  >
                    <IconComponent />
                  </div>
                  <h3 className="font-semibold text-neutral-900 mb-2">{card.title}</h3>
                  <p className="text-sm text-neutral-600">{card.description}</p>
                </motion.div>
              );
            })}
          </div>
        </div>
      );
    }

    function ExampleSlide({ data }) {
      return (
        <div className="flex flex-col items-center justify-center h-full px-6 py-8">
          <motion.h2
            initial={{ y: 20, opacity: 0 }}
            animate={{ y: 0, opacity: 1 }}
            className="font-display text-3xl md:text-4xl font-bold text-neutral-900 mb-8 text-center"
          >
            {data.title}
          </motion.h2>

          <div className="grid grid-cols-1 md:grid-cols-2 gap-6 w-full max-w-3xl">
            {/* Before */}
            <motion.div
              initial={{ x: -20, opacity: 0 }}
              animate={{ x: 0, opacity: 1 }}
              transition={{ delay: 0.2 }}
              className="bg-red-50 rounded-xl p-6 border-2 border-red-100"
            >
              <div className="flex items-center gap-2 mb-4">
                <span className="text-2xl">‚ùå</span>
                <span className="font-semibold text-red-700">{data.before.label}</span>
              </div>
              <ul className="space-y-2">
                {data.before.items.map((item, i) => (
                  <li key={i} className="text-red-600 text-sm flex items-center gap-2">
                    <span className="w-1.5 h-1.5 rounded-full bg-red-400" />
                    {item}
                  </li>
                ))}
              </ul>
            </motion.div>

            {/* After */}
            <motion.div
              initial={{ x: 20, opacity: 0 }}
              animate={{ x: 0, opacity: 1 }}
              transition={{ delay: 0.3 }}
              className="bg-green-50 rounded-xl p-6 border-2 border-green-100"
            >
              <div className="flex items-center gap-2 mb-4">
                <span className="text-2xl">‚úÖ</span>
                <span className="font-semibold text-green-700">{data.after.label}</span>
              </div>
              <ul className="space-y-2">
                {data.after.items.map((item, i) => (
                  <li key={i} className="text-green-600 text-sm flex items-center gap-2">
                    <span className="w-1.5 h-1.5 rounded-full bg-green-400" />
                    {item}
                  </li>
                ))}
              </ul>
            </motion.div>
          </div>
        </div>
      );
    }

    function QuizSlide({ data, onAnswer, showFeedback, selectedAnswer }) {
      const isCorrect = selectedAnswer === data.correctIndex;

      const gifConfig = useMemo(() => ({
        url: isCorrect ? getRandomCelebrationGif() : getRandomEmpathyGif(),
        side: Math.random() > 0.5 ? 'left-4' : 'right-4'
      }), [showFeedback]);

      return (
        <div className="flex flex-col items-center justify-center h-full px-6 py-8">
          <div className="max-w-2xl w-full">
            {!showFeedback ? (
              <>
                <motion.div
                  initial={{ scale: 0.9, opacity: 0 }}
                  animate={{ scale: 1, opacity: 1 }}
                  className="inline-flex items-center gap-2 px-4 py-2 rounded-full mb-6"
                  style={{ backgroundColor: 'rgba(212, 160, 23, 0.1)' }}
                >
                  <span className="text-sm font-semibold" style={{ color: 'var(--accent)' }}>Quick Check</span>
                </motion.div>

                <motion.h2
                  initial={{ y: 20, opacity: 0 }}
                  animate={{ y: 0, opacity: 1 }}
                  className="font-display text-2xl md:text-3xl font-bold text-neutral-900 mb-8"
                >
                  {data.question}
                </motion.h2>

                <div className="space-y-3">
                  {data.options.map((option, i) => (
                    <motion.button
                      key={i}
                      initial={{ x: -20, opacity: 0 }}
                      animate={{ x: 0, opacity: 1 }}
                      transition={{ delay: 0.2 + i * 0.1 }}
                      onClick={() => onAnswer(i)}
                      className="w-full text-left p-4 rounded-xl border-2 border-neutral-200 bg-white hover:border-neutral-300 hover:shadow-sm transition-all"
                    >
                      <span className="font-medium text-neutral-500 mr-3">{String.fromCharCode(65 + i)}.</span>
                      <span className="text-neutral-700">{option}</span>
                    </motion.button>
                  ))}
                </div>
              </>
            ) : (
              <motion.div
                initial={{ scale: 0.9, opacity: 0 }}
                animate={{ scale: 1, opacity: 1 }}
                className={`rounded-2xl p-8 text-center ${isCorrect ? 'bg-green-50 border-2 border-green-200' : 'bg-amber-50 border-2 border-amber-200'}`}
              >
                <div className="text-5xl mb-4">{isCorrect ? 'üéâ' : 'üí™'}</div>
                <h3 className={`text-2xl font-bold mb-4 ${isCorrect ? 'text-green-700' : 'text-amber-700'}`}>
                  {isCorrect ? 'Correct!' : 'Not Quite!'}
                </h3>
                <p className={`text-lg ${isCorrect ? 'text-green-600' : 'text-amber-600'}`}>
                  {isCorrect ? data.correctFeedback : data.incorrectFeedback}
                </p>
              </motion.div>
            )}
          </div>

          {/* Feedback GIF */}
          {showFeedback && (
            <motion.div
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ delay: 0.3 }}
              className={`absolute bottom-20 ${gifConfig.side} hidden md:block`}
              style={{ height: '60%', zIndex: 5 }}
            >
              <img
                src={gifConfig.url}
                alt="Feedback"
                className="h-full w-auto object-contain rounded-lg"
                style={{ maxHeight: '260px' }}
              />
            </motion.div>
          )}
        </div>
      );
    }

    function CompletionSlide({ data, nextLesson }) {
      return (
        <div className="flex flex-col items-center justify-center h-full px-6 py-8 text-center bg-gradient-to-br from-neutral-900 to-black">
          <motion.div
            initial={{ scale: 0 }}
            animate={{ scale: 1 }}
            transition={{ type: 'spring', duration: 0.6 }}
            className="text-6xl mb-6"
          >
            üéØ
          </motion.div>

          <motion.h2
            initial={{ y: 20, opacity: 0 }}
            animate={{ y: 0, opacity: 1 }}
            transition={{ delay: 0.2 }}
            className="font-display text-3xl md:text-4xl font-bold text-white mb-4"
          >
            {data.title}
          </motion.h2>

          <motion.p
            initial={{ y: 20, opacity: 0 }}
            animate={{ y: 0, opacity: 1 }}
            transition={{ delay: 0.3 }}
            className="text-neutral-400 text-lg max-w-xl mb-8"
          >
            {data.summary}
          </motion.p>

          <motion.div
            initial={{ y: 20, opacity: 0 }}
            animate={{ y: 0, opacity: 1 }}
            transition={{ delay: 0.4 }}
            className="bg-white/5 rounded-xl p-6 max-w-md w-full mb-6 border border-white/10"
          >
            <h3 className="text-white font-semibold mb-4 text-left">Next Steps:</h3>
            <ul className="space-y-3 text-left">
              {data.nextSteps.map((step, i) => (
                <li key={i} className="flex items-start gap-3 text-neutral-300">
                  <Icons.ArrowRight />
                  <span>{step}</span>
                </li>
              ))}
            </ul>
          </motion.div>

          {nextLesson && (
            <motion.div
              initial={{ y: 20, opacity: 0 }}
              animate={{ y: 0, opacity: 1 }}
              transition={{ delay: 0.5 }}
              className="bg-white/10 rounded-xl p-5 max-w-md w-full border border-white/20"
            >
              <p className="text-neutral-500 text-sm mb-2">Up Next</p>
              <p className="text-white font-semibold mb-1">{nextLesson.title}</p>
              <p className="text-neutral-400 text-sm">{nextLesson.teaser}</p>
            </motion.div>
          )}

          <motion.button
            initial={{ y: 20, opacity: 0 }}
            animate={{ y: 0, opacity: 1 }}
            transition={{ delay: 0.6 }}
            onClick={() => window.parent.postMessage({ type: 'LESSON_COMPLETE', lessonId: LESSON_CONFIG.id }, '*')}
            className="mt-8 px-8 py-4 rounded-xl font-semibold text-neutral-900 transition-all hover:scale-105"
            style={{ backgroundColor: 'var(--accent)' }}
          >
            Back to Learning Center
          </motion.button>
        </div>
      );
    }

    // ===========================================
    // MAIN LESSON APP
    // ===========================================
    function LessonApp() {
      const [currentSlide, setCurrentSlide] = useState(0);
      const [quizAnswers, setQuizAnswers] = useState({});
      const [showQuizFeedback, setShowQuizFeedback] = useState({});

      const gifConfig = useMemo(() => ({
        url: getRandomCelebrationGif(),
        height: '65%',
        side: Math.random() > 0.5 ? 'left-4' : 'right-4'
      }), []);

      const nextSlide = useCallback(() => {
        if (currentSlide < slides.length - 1) {
          setCurrentSlide(prev => prev + 1);
        }
      }, [currentSlide]);

      const prevSlide = useCallback(() => {
        if (currentSlide > 0) {
          setCurrentSlide(prev => prev - 1);
        }
      }, [currentSlide]);

      const goToSlide = useCallback((index) => {
        setCurrentSlide(index);
      }, []);

      const handleQuizAnswer = useCallback((slideIndex, answerIndex) => {
        setQuizAnswers(prev => ({ ...prev, [slideIndex]: answerIndex }));
        setShowQuizFeedback(prev => ({ ...prev, [slideIndex]: true }));
      }, []);

      // Keyboard navigation
      useEffect(() => {
        const handleKeyDown = (e) => {
          if (e.key === 'ArrowRight') nextSlide();
          if (e.key === 'ArrowLeft') prevSlide();
        };
        window.addEventListener('keydown', handleKeyDown);
        return () => window.removeEventListener('keydown', handleKeyDown);
      }, [nextSlide, prevSlide]);

      const slide = slides[currentSlide];
      const showPrev = currentSlide > 0 && slide.type !== 'welcome';
      const showNext = currentSlide < slides.length - 1 && slide.type !== 'quiz';
      const isQuizSlide = slide.type === 'quiz';
      const quizAnswered = showQuizFeedback[currentSlide];

      const renderSlide = () => {
        switch (slide.type) {
          case 'welcome':
            return <WelcomeSlide data={slide} gifConfig={gifConfig} />;
          case 'hook':
            return <HookSlide data={slide} />;
          case 'content':
            return <ContentSlide data={slide} />;
          case 'visual':
            return <VisualSlide data={slide} />;
          case 'cards':
            return <CardsSlide data={slide} />;
          case 'example':
            return <ExampleSlide data={slide} />;
          case 'quiz':
            return (
              <QuizSlide
                data={slide}
                onAnswer={(i) => handleQuizAnswer(currentSlide, i)}
                showFeedback={showQuizFeedback[currentSlide]}
                selectedAnswer={quizAnswers[currentSlide]}
              />
            );
          case 'completion':
            return <CompletionSlide data={slide} nextLesson={LESSON_CONFIG.nextLesson} />;
          default:
            return null;
        }
      };

      return (
        <div className="h-screen w-screen bg-neutral-50 flex flex-col overflow-hidden">
          {/* Main Content */}
          <div className="flex-1 relative overflow-hidden">
            <AnimatePresence mode="wait">
              <motion.div
                key={currentSlide}
                initial={{ opacity: 0, x: 20 }}
                animate={{ opacity: 1, x: 0 }}
                exit={{ opacity: 0, x: -20 }}
                transition={{ duration: 0.3 }}
                className="absolute inset-0"
              >
                {renderSlide()}
              </motion.div>
            </AnimatePresence>

            {/* Navigation Arrows */}
            {showPrev && (
              <button
                onClick={prevSlide}
                className="absolute left-5 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-white shadow-lg border border-neutral-200 flex items-center justify-center text-neutral-600 hover:text-neutral-900 hover:shadow-xl transition-all z-20"
              >
                <Icons.ChevronLeft />
              </button>
            )}

            {(showNext || (isQuizSlide && quizAnswered)) && (
              <button
                onClick={nextSlide}
                className="absolute right-5 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full shadow-lg flex items-center justify-center text-white hover:shadow-xl transition-all z-20"
                style={{ backgroundColor: 'var(--accent)' }}
              >
                <Icons.ChevronRight />
              </button>
            )}
          </div>

          {/* Dot Navigation Footer */}
          <div className="px-6 md:px-8 py-5 border-t border-neutral-100 flex-shrink-0 relative z-10 bg-white/80 backdrop-blur-sm">
            <div className="flex items-center justify-center gap-2.5">
              {slides.map((_, i) => (
                <button
                  key={i}
                  onClick={() => goToSlide(i)}
                  className={`w-2.5 h-2.5 rounded-full transition-all ${
                    i === currentSlide
                      ? 'scale-125'
                      : 'bg-neutral-300 hover:bg-neutral-400'
                  }`}
                  style={i === currentSlide ? { backgroundColor: 'var(--accent)' } : {}}
                />
              ))}
            </div>
          </div>
        </div>
      );
    }

    // ===========================================
    // RENDER
    // ===========================================
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<LessonApp />);
  </script>
</body>
</html>
