<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Two Worlds Every DTC Founder Must Master | Quantum Scale</title>
  <script src="https://cdn.tailwindcss.com" defer></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" defer></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" defer></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js" defer></script>
  <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js" defer></script>
  <script src="../shared/greetings.js" defer></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;500;600;700;800;900&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root { --accent: #6366f1; --accent-dark: #4f46e5; --accent-light: #818cf8; --accent-rgb: 99, 102, 241; }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Inter', sans-serif; background: transparent; -webkit-font-smoothing: antialiased; }
    .title-font { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    h1, h2, h3, .slide-title { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    ::selection { background: var(--accent); color: white; }
    .slide-scroll::-webkit-scrollbar { display: none; }
    .slide-scroll { -ms-overflow-style: none; scrollbar-width: none; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { motion, AnimatePresence } = window.Motion;
    const { useState, useEffect, useCallback, useMemo } = React;

    const getUserName = () => { const params = new URLSearchParams(window.location.search); return params.get('userName') || 'Builder'; };
    const getInitialSlide = () => { const params = new URLSearchParams(window.location.search); const slide = params.get('slide'); return slide ? parseInt(slide, 10) : 0; };

    const LESSON_CONFIG = {
      id: 'two-worlds-mastery',
      title: 'The Two Worlds Every DTC Founder Must Master',
      description: 'Most founders live in one world and wonder why they plateau. The masters dance between both.',
      accentColor: '#6366f1',
      duration: '7 min',
      nextLesson: { id: 'race-to-bottom-escape', title: 'Why Your ROAS Is Killing Your Business', teaser: 'You are winning every battle and still losing the war.' }
    };

    // ============ ADMIN REPORTER SYSTEM ============
    let __isAdmin = false;
    window.addEventListener('message', function(e) { if (e.data?.type === 'ADMIN_STATUS') { __isAdmin = e.data.isAdmin; } });
    if (window.parent !== window) { window.parent.postMessage({ type: 'CHECK_ADMIN_STATUS' }, '*'); }

    const AdminSlideReportButton = ({ slideIndex, slideType }) => {
      const handleReport = (e) => {
        e.stopPropagation(); e.preventDefault();
        if (window.parent !== window) {
          window.parent.postMessage({ type: 'ADMIN_REPORT_REQUEST', slideIndex, slideType, lessonSlug: LESSON_CONFIG.id, elementId: slideType + '-' + slideIndex }, '*');
        }
      };
      return (
        <button onClick={handleReport} title={`Report issue on Slide ${slideIndex + 1}`}
          style={{ position: 'absolute', top: '12px', right: '12px', width: '32px', height: '32px', borderRadius: '8px', backgroundColor: 'rgba(239, 68, 68, 0.9)', color: 'white', border: 'none', cursor: 'pointer', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 1000, opacity: 0.6, transition: 'opacity 0.2s, transform 0.2s' }}
          onMouseEnter={(e) => { e.currentTarget.style.opacity = '1'; e.currentTarget.style.transform = 'scale(1.1)'; }}
          onMouseLeave={(e) => { e.currentTarget.style.opacity = '0.6'; e.currentTarget.style.transform = 'scale(1)'; }}>
          <img src="/images/icons/bug-icon.svg" alt="Report" style={{ width: '16px', height: '16px', filter: 'invert(1)' }} />
        </button>
      );
    };
    // ============ END ADMIN REPORTER ============

    const celebrationGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_doing_a_quick_victory_dance_move_high_energy_c_d03b798b-a518-4e6c-bcae-d69b2dd50486_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_jumping_in_the_air_arms_raised_high_YESSS_cele_201477e8-3df4-405a-bc81-81d1747e5c6c_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_playing_air_guitar_light_headbanging_rockstar__0702007e-9e84-4d9e-8f99-8ee23d0b65f8_2.mp4'
    ];
    const getRandomCelebrationGif = () => celebrationGifs[Math.floor(Math.random() * celebrationGifs.length)];
    const empathyGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_thumbs_down_with_encouraging_nod_close_keep_go_613e541f-c072-436f-aee7-f99cd6f834fc_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_shaking_head_side_to_side_sadly_disappointed_e_c4a4be22-6a70-4738-8612-3039454fef37_1.mp4'
    ];
    const getRandomEmpathyGif = () => empathyGifs[Math.floor(Math.random() * empathyGifs.length)];

    // AnimatedCounter component
    const AnimatedCounter = ({ value, suffix = '', prefix = '', duration = 2000, decimals = 0 }) => {
      const [count, setCount] = useState(0);
      useEffect(() => {
        let start = 0;
        const end = parseFloat(value);
        const increment = end / (duration / 16);
        const timer = setInterval(() => {
          start += increment;
          if (start >= end) { setCount(end); clearInterval(timer); }
          else { setCount(start); }
        }, 16);
        return () => clearInterval(timer);
      }, [value, duration]);
      return <span>{prefix}{decimals > 0 ? count.toFixed(decimals) : Math.floor(count)}{suffix}</span>;
    };

    // Icons
    const Icons = {
      Clock: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
      Check: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><polyline points="20 6 9 17 4 12"/></svg>,
      X: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
      ArrowLeft: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>,
      ArrowRight: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>,
      BarChart: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="20" x2="12" y2="10"/><line x1="18" y1="20" x2="18" y2="4"/><line x1="6" y1="20" x2="6" y2="16"/></svg>,
      Heart: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>,
      Zap: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
      TrendingUp: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>,
      TrendingDown: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="23 18 13.5 8.5 8.5 13.5 1 6"/><polyline points="17 18 23 18 23 12"/></svg>,
      Target: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>,
      Shield: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>,
      Crown: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M2 4l3 12h14l3-12-6 7-4-7-4 7-6-7z"/><path d="M3 20h18"/></svg>,
      DollarSign: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>,
      Users: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>,
      RefreshCw: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>,
      Infinity: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M18.178 8c5.096 0 5.096 8 0 8-5.095 0-7.133-8-12.739-8-4.585 0-4.585 8 0 8 5.606 0 7.644-8 12.74-8z"/></svg>,
      Plus: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>,
      AlertTriangle: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>,
      Lightbulb: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M15.09 14c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 18 8 6 6 0 0 0 6 8c0 1 .23 2.23 1.5 3.5A4.61 4.61 0 0 1 8.91 14"/></svg>,
    };

    const slides = [
      { type: 'welcome', learningGoals: ['Why most founders plateau by living in only one world', 'The fundamental difference between Direct Marketing and Brand Marketing', 'How to fuse both worlds to dominate your market'] },
      { type: 'hook', headline: 'Most founders live in one world and wonder why they plateau.', subtext: 'Walk into any DTC founder meetup and you will hear two completely different conversations happening at once. Table 1 is obsessing over ROAS, CPMs, and conversion rates. Table 2 is debating brand positioning, cultural relevance, and storytelling. They are speaking different languages. Playing different games.', brandImage: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/Meta_Platforms_Inc._logo_(cropped).svg.png', brandName: 'Meta' },
      { type: 'meetup-visual', tables: [
        { number: 1, label: 'Direct Marketers', topics: ['ROAS', 'CPMs', 'Conversion Rates', '5-cent clicks'], icon: 'BarChart', color: '#3b82f6' },
        { number: 2, label: 'Brand Builders', topics: ['Positioning', 'Cultural Relevance', 'Storytelling', 'Emotional Connection'], icon: 'Heart', color: '#ec4899' }
      ], insight: 'Both tables think the other is wasting their time.' },
      { type: 'world-reveal', worldNumber: 1, title: 'Direct Marketing', description: 'The world of Google auctions, Facebook pixels, and 5-cent clicks. Where L.L. Bean once spent 50 cents on stamps and made $1.50 in profit.', coreBelief: 'If you can measure it, you can improve it.', strength: { label: 'Strength', text: 'Hyper-measurable ROI. Turn the dial on spending and watch revenue respond in real-time.' }, weakness: { label: 'Weakness', text: 'It races to the bottom. When everyone optimizes the same metrics, you commoditize yourself.' }, color: '#3b82f6' },
      { type: 'world-reveal', worldNumber: 2, title: 'Brand Marketing', description: 'The world of story, feeling, logos, and cultural position. It is not about clicks - it is about what people say when your brand is not in the room.', coreBelief: 'You cannot measure brand.', strength: { label: 'Strength', text: 'Long-term moat. Pricing power. Cultural relevance that competitors cannot copy with ad spend.' }, weakness: { label: 'Weakness', text: 'Vague, slow, unmeasurable. Requires patience most founders do not have.' }, color: '#ec4899' },
      { type: 'world-battle', world1: { name: 'Direct Marketing', roi: 'Days', moat: 'None', metrics: ['ROAS', 'CPM', 'CTR'], risk: 'Race to bottom', color: '#3b82f6' }, world2: { name: 'Brand Marketing', roi: 'Years', moat: 'Strong', metrics: ['Loyalty', 'Pricing Power', 'Culture'], risk: 'Slow & vague', color: '#ec4899' } },
      { type: 'treadmill-visual', title: 'The Uncomfortable Truth', stats: [
        { label: 'DTC Founders in World 1 Only', value: 90, suffix: '%' },
        { label: 'Optimize Their Way To...', value: 0, suffix: '' }
      ], symptoms: ['Rising CPMs', 'Commoditization', 'Zero Customer Loyalty', 'Death by 1,000 Optimizations'], insight: 'Performance marketing without brand positioning is a treadmill.' },
      { type: 'quiz', question: 'What is the main weakness of relying only on Direct Marketing?', options: ['It is too expensive to scale', 'It races to the bottom and commoditizes you', 'It requires too much technical knowledge', 'It only works for certain industries'], correctIndex: 1, feedback: { correct: 'Exactly. When everyone optimizes the same metrics (ROAS, CPMs, conversion rates), you enter a race to the bottom. You commoditize yourself and erode margins to zero.', incorrect: 'The core issue is the race to the bottom. When everyone optimizes the same metrics, you commoditize yourself and erode margins to zero. Rising CPMs, commoditization, and zero customer loyalty become inevitable.' }},
      { type: 'fusion-formula', leftWorld: { name: 'Direct Marketing', description: 'Funds your growth TODAY', icon: 'BarChart', color: '#3b82f6', actions: ['Measure everything', 'Optimize ruthlessly', 'Get ROAS up'] }, rightWorld: { name: 'Brand Marketing', description: 'Builds your moat TOMORROW', icon: 'Heart', color: '#ec4899', actions: ['Stand for something', 'Tell a story', 'Build cultural relevance'] }, result: { title: 'DOMINATION', description: 'The founders who fuse both worlds do not just survive. They dominate.' } },
      { type: 'mastery-stats', stats: [
        { value: 90, suffix: '%', label: 'Live in One World', description: 'Most founders never learn both' },
        { value: 10, suffix: 'x', label: 'Pricing Power', description: 'Brand creates premium margins' },
        { value: 0, suffix: '', label: 'Competitors Can Copy', description: 'Culture cannot be bought' }
      ] },
      { type: 'elite-insight', quote: 'You are not Nike. I am not Nike. But the principles of standing for something are universal.', author: 'DTC Founder Truth', insight: 'Performance marketing without brand positioning is a treadmill. Direct Marketing funds growth today. Brand Marketing builds moat tomorrow. Fuse both, dominate.', actions: [
        { icon: 'Target', text: 'Master both worlds' },
        { icon: 'Zap', text: 'Measure + storytell' },
        { icon: 'Crown', text: 'Build unfair advantage' }
      ] },
      { type: 'completion', sources: [] }
    ];

    // ============ SLIDE COMPONENTS ============

    const WelcomeSlide = ({ data, onStart, userName, onShowGif, onHideGif }) => {
      const welcomeData = useMemo(() => getTimeBasedWelcome(), []);
      const gifSide = useMemo(() => Math.random() > 0.5 ? 'left' : 'right', []);
      useEffect(() => { onShowGif(welcomeData.gif, '65%', gifSide); return () => onHideGif(); }, [welcomeData.gif, gifSide, onShowGif, onHideGif]);

      return (
        <div className="h-full w-full relative overflow-hidden">
          <div className="h-full flex flex-col items-center justify-center text-center px-6 py-4 relative z-20">
            <motion.h1 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="title-font text-3xl sm:text-4xl md:text-5xl lg:text-6xl text-black mb-2 md:mb-3">{LESSON_CONFIG.title}</motion.h1>
            <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-neutral-600 text-base md:text-lg lg:text-xl mb-2 md:mb-3 max-w-lg leading-relaxed" dangerouslySetInnerHTML={{ __html: formatGreeting(welcomeData.greeting, `<span class="font-bold text-neutral-900">${userName}</span>`) }} />
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="flex items-center justify-center gap-1.5 text-neutral-400 text-[10px] md:text-xs mb-2 md:mb-3"><Icons.Clock /><span>{LESSON_CONFIG.duration}</span></motion.div>
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 }} className="bg-neutral-900 rounded-xl md:rounded-2xl p-3 md:p-5 mb-3 md:mb-4 max-w-sm w-full mx-auto">
              <p className="text-neutral-500 text-[9px] md:text-[11px] uppercase tracking-wider mb-2 md:mb-3">In this lesson</p>
              <ul className="space-y-1.5 md:space-y-2">
                {data.learningGoals.map((goal, i) => (
                  <motion.li key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.25 + i * 0.05 }} className="flex items-start gap-2 text-left">
                    <span className="w-5 h-5 rounded-md flex items-center justify-center text-[9px] font-bold text-white flex-shrink-0 mt-0.5" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>{i + 1}</span>
                    <span className="text-neutral-300 text-[11px] md:text-sm leading-snug">{goal}</span>
                  </motion.li>
                ))}
              </ul>
            </motion.div>
            <motion.button initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.45 }} onClick={onStart} whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }} className="px-6 md:px-7 py-2.5 md:py-3 rounded-xl text-white font-semibold text-sm md:text-base" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>Let's Go</motion.button>
          </div>
        </div>
      );
    };

    const HookSlide = ({ data }) => (
      <div className="h-full relative overflow-hidden">
        <div className="h-full flex flex-col justify-center px-6 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-8 md:py-10 relative z-10">
          <motion.div initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} className="mb-4 md:mb-6">
            <span className="inline-block px-3 py-1 rounded-full text-xs font-semibold mb-3 md:mb-4" style={{ background: `rgba(var(--accent-rgb), 0.1)`, color: 'var(--accent)' }}>The Hook</span>
            <h2 className="slide-title text-2xl md:text-4xl lg:text-5xl text-black leading-tight">{data.headline}</h2>
          </motion.div>
          <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="text-base md:text-xl text-neutral-600 leading-relaxed">{data.subtext}</motion.p>
        </div>
        {data.brandImage && (
          <motion.div initial={{ opacity: 0, x: 30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.3, duration: 0.5 }}
            className="absolute bottom-0 right-0 z-0 pointer-events-none hidden md:block" style={{ height: '30%', maxHeight: '200px', marginRight: '80px', marginBottom: '5%' }}>
            <img src={data.brandImage} alt={data.brandName || ''} className="h-full w-auto object-contain" style={{ opacity: 1 }} />
          </motion.div>
        )}
      </div>
    );

    // MeetupVisualSlide - Two tables at a founder meetup
    const MeetupVisualSlide = ({ data }) => {
      const [activeTable, setActiveTable] = useState(0);
      useEffect(() => {
        const timer = setInterval(() => setActiveTable(prev => (prev + 1) % 2), 3000);
        return () => clearInterval(timer);
      }, []);

      const TableIcon = ({ type }) => {
        if (type === 'BarChart') return <Icons.BarChart />;
        if (type === 'Heart') return <Icons.Heart />;
        return <Icons.Users />;
      };

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-8">
          <motion.h2 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">The DTC Founder Meetup</motion.h2>

          <div className="grid md:grid-cols-2 gap-6 mb-6">
            {data.tables.map((table, i) => (
              <motion.div key={i} initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 + i * 0.15 }}
                style={{
                  background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)',
                  borderRadius: '16px',
                  padding: '24px',
                  position: 'relative',
                  overflow: 'hidden',
                  border: activeTable === i ? `2px solid ${table.color}` : '2px solid transparent',
                  boxShadow: activeTable === i ? `0 0 30px ${table.color}40` : 'none',
                  transition: 'all 0.3s ease'
                }}>
                <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: `linear-gradient(90deg, transparent, ${table.color}, transparent)` }} />

                <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '16px' }}>
                  <div style={{ width: '40px', height: '40px', borderRadius: '10px', background: `${table.color}20`, display: 'flex', alignItems: 'center', justifyContent: 'center', color: table.color }}>
                    <TableIcon type={table.icon} />
                  </div>
                  <div>
                    <div style={{ fontSize: '12px', color: '#999', fontWeight: '600' }}>TABLE {table.number}</div>
                    <div style={{ fontSize: '18px', color: 'white', fontWeight: '700' }}>{table.label}</div>
                  </div>
                </div>

                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '8px' }}>
                  {table.topics.map((topic, j) => (
                    <motion.span key={j} initial={{ opacity: 0, scale: 0.9 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.3 + j * 0.1 }}
                      style={{ padding: '6px 12px', borderRadius: '20px', background: `${table.color}20`, color: table.color, fontSize: '13px', fontWeight: '500' }}>
                      {topic}
                    </motion.span>
                  ))}
                </div>
              </motion.div>
            ))}
          </div>

          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.5 }}
            style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '12px', padding: '16px', textAlign: 'center' }}>
            <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '8px' }}>
              <Icons.AlertTriangle style={{ color: '#f59e0b' }} />
              <span style={{ color: '#f59e0b', fontWeight: '600', fontSize: '15px' }}>{data.insight}</span>
            </div>
          </motion.div>
        </div>
      );
    };

    // WorldRevealSlide - Deep dive into each world
    const WorldRevealSlide = ({ data }) => {
      const [showStrength, setShowStrength] = useState(false);
      const [showWeakness, setShowWeakness] = useState(false);

      useEffect(() => {
        const t1 = setTimeout(() => setShowStrength(true), 1500);
        const t2 = setTimeout(() => setShowWeakness(true), 2500);
        return () => { clearTimeout(t1); clearTimeout(t2); };
      }, []);

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto py-8">
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }}
            style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '20px', padding: '32px', position: 'relative', overflow: 'hidden' }}>
            <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '4px', background: `linear-gradient(90deg, transparent, ${data.color}, transparent)` }} />

            <div style={{ display: 'flex', alignItems: 'center', gap: '16px', marginBottom: '20px' }}>
              <div style={{ width: '48px', height: '48px', borderRadius: '12px', background: `${data.color}20`, display: 'flex', alignItems: 'center', justifyContent: 'center', color: data.color, fontWeight: '900', fontSize: '24px' }}>
                {data.worldNumber}
              </div>
              <div>
                <span style={{ fontSize: '11px', color: '#888', textTransform: 'uppercase', letterSpacing: '1px' }}>WORLD #{data.worldNumber}</span>
                <h2 className="slide-title" style={{ fontSize: '28px', color: 'white', margin: 0 }}>{data.title}</h2>
              </div>
            </div>

            <p style={{ color: '#ccc', fontSize: '16px', lineHeight: 1.7, marginBottom: '20px' }}>{data.description}</p>

            <div style={{ background: `${data.color}15`, borderRadius: '12px', padding: '16px', marginBottom: '24px', borderLeft: `3px solid ${data.color}` }}>
              <span style={{ color: data.color, fontWeight: '700', fontSize: '14px' }}>Core Belief:</span>
              <span style={{ color: 'white', marginLeft: '8px', fontStyle: 'italic' }}>"{data.coreBelief}"</span>
            </div>

            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '16px' }}>
              <motion.div initial={{ opacity: 0, x: -20 }} animate={{ opacity: showStrength ? 1 : 0, x: showStrength ? 0 : -20 }}
                style={{ background: '#22c55e15', borderRadius: '12px', padding: '16px', border: '1px solid #22c55e30' }}>
                <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '8px' }}>
                  <Icons.TrendingUp style={{ color: '#22c55e' }} />
                  <span style={{ color: '#22c55e', fontWeight: '700', fontSize: '14px' }}>{data.strength.label}</span>
                </div>
                <p style={{ color: '#ccc', fontSize: '13px', lineHeight: 1.6 }}>{data.strength.text}</p>
              </motion.div>

              <motion.div initial={{ opacity: 0, x: 20 }} animate={{ opacity: showWeakness ? 1 : 0, x: showWeakness ? 0 : 20 }}
                style={{ background: '#ef444415', borderRadius: '12px', padding: '16px', border: '1px solid #ef444430' }}>
                <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '8px' }}>
                  <Icons.TrendingDown style={{ color: '#ef4444' }} />
                  <span style={{ color: '#ef4444', fontWeight: '700', fontSize: '14px' }}>{data.weakness.label}</span>
                </div>
                <p style={{ color: '#ccc', fontSize: '13px', lineHeight: 1.6 }}>{data.weakness.text}</p>
              </motion.div>
            </div>
          </motion.div>
        </div>
      );
    };

    // WorldBattleSlide - Side by side comparison
    const WorldBattleSlide = ({ data }) => {
      const [showVs, setShowVs] = useState(false);
      useEffect(() => { const timer = setTimeout(() => setShowVs(true), 1000); return () => clearTimeout(timer); }, []);

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-8">
          <motion.h2 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">The Two Worlds Compared</motion.h2>

          <div style={{ display: 'grid', gridTemplateColumns: '1fr auto 1fr', gap: '16px', alignItems: 'center' }}>
            {/* World 1 */}
            <motion.div initial={{ opacity: 0, x: -30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.2 }}
              style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '16px', padding: '24px', position: 'relative' }}>
              <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: `linear-gradient(90deg, transparent, ${data.world1.color}, transparent)` }} />
              <h3 style={{ color: data.world1.color, fontWeight: '700', fontSize: '18px', marginBottom: '16px', textAlign: 'center' }}>{data.world1.name}</h3>

              <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
                <div style={{ background: '#ffffff10', borderRadius: '8px', padding: '12px' }}>
                  <span style={{ color: '#888', fontSize: '11px', textTransform: 'uppercase' }}>ROI Timeline</span>
                  <div style={{ color: 'white', fontWeight: '700', fontSize: '20px' }}>{data.world1.roi}</div>
                </div>
                <div style={{ background: '#ffffff10', borderRadius: '8px', padding: '12px' }}>
                  <span style={{ color: '#888', fontSize: '11px', textTransform: 'uppercase' }}>Moat Strength</span>
                  <div style={{ color: '#ef4444', fontWeight: '700', fontSize: '20px' }}>{data.world1.moat}</div>
                </div>
                <div style={{ background: '#ffffff10', borderRadius: '8px', padding: '12px' }}>
                  <span style={{ color: '#888', fontSize: '11px', textTransform: 'uppercase' }}>Key Metrics</span>
                  <div style={{ color: 'white', fontSize: '14px' }}>{data.world1.metrics.join(', ')}</div>
                </div>
              </div>
            </motion.div>

            {/* VS Badge */}
            <motion.div initial={{ opacity: 0, scale: 0 }} animate={{ opacity: showVs ? 1 : 0, scale: showVs ? 1 : 0 }}
              style={{ width: '60px', height: '60px', borderRadius: '50%', background: 'linear-gradient(135deg, var(--accent), var(--accent-dark))', display: 'flex', alignItems: 'center', justifyContent: 'center', boxShadow: '0 0 30px rgba(var(--accent-rgb), 0.4)' }}>
              <span style={{ color: 'white', fontWeight: '900', fontSize: '18px' }}>VS</span>
            </motion.div>

            {/* World 2 */}
            <motion.div initial={{ opacity: 0, x: 30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.4 }}
              style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '16px', padding: '24px', position: 'relative' }}>
              <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: `linear-gradient(90deg, transparent, ${data.world2.color}, transparent)` }} />
              <h3 style={{ color: data.world2.color, fontWeight: '700', fontSize: '18px', marginBottom: '16px', textAlign: 'center' }}>{data.world2.name}</h3>

              <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
                <div style={{ background: '#ffffff10', borderRadius: '8px', padding: '12px' }}>
                  <span style={{ color: '#888', fontSize: '11px', textTransform: 'uppercase' }}>ROI Timeline</span>
                  <div style={{ color: 'white', fontWeight: '700', fontSize: '20px' }}>{data.world2.roi}</div>
                </div>
                <div style={{ background: '#ffffff10', borderRadius: '8px', padding: '12px' }}>
                  <span style={{ color: '#888', fontSize: '11px', textTransform: 'uppercase' }}>Moat Strength</span>
                  <div style={{ color: '#22c55e', fontWeight: '700', fontSize: '20px' }}>{data.world2.moat}</div>
                </div>
                <div style={{ background: '#ffffff10', borderRadius: '8px', padding: '12px' }}>
                  <span style={{ color: '#888', fontSize: '11px', textTransform: 'uppercase' }}>Key Metrics</span>
                  <div style={{ color: 'white', fontSize: '14px' }}>{data.world2.metrics.join(', ')}</div>
                </div>
              </div>
            </motion.div>
          </div>
        </div>
      );
    };

    // TreadmillVisualSlide - The uncomfortable truth
    const TreadmillVisualSlide = ({ data }) => {
      const [activeSymptom, setActiveSymptom] = useState(0);
      useEffect(() => {
        const timer = setInterval(() => setActiveSymptom(prev => (prev + 1) % data.symptoms.length), 2000);
        return () => clearInterval(timer);
      }, [data.symptoms.length]);

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto py-8">
          <motion.h2 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">{data.title}</motion.h2>

          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '24px', marginBottom: '24px' }}>
            {data.stats.map((stat, i) => (
              <motion.div key={i} initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 + i * 0.2 }}
                style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '16px', padding: '24px', textAlign: 'center', position: 'relative' }}>
                <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: i === 0 ? 'linear-gradient(90deg, transparent, #ef4444, transparent)' : 'linear-gradient(90deg, transparent, #888, transparent)' }} />
                <div style={{ fontSize: '48px', fontWeight: '900', color: i === 0 ? '#ef4444' : '#888', fontFamily: 'Fraunces, serif' }}>
                  <AnimatedCounter value={stat.value} suffix={stat.suffix} />
                </div>
                <div style={{ color: '#999', fontSize: '14px', marginTop: '8px' }}>{stat.label}</div>
              </motion.div>
            ))}
          </div>

          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.5 }}
            style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '16px', padding: '24px' }}>
            <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '16px', justifyContent: 'center' }}>
              <Icons.RefreshCw style={{ color: '#ef4444' }} />
              <span style={{ color: '#ef4444', fontWeight: '700', fontSize: '14px', textTransform: 'uppercase' }}>The Treadmill Symptoms</span>
            </div>
            <div style={{ display: 'flex', flexWrap: 'wrap', gap: '12px', justifyContent: 'center' }}>
              {data.symptoms.map((symptom, i) => (
                <motion.span key={i} animate={{ scale: activeSymptom === i ? 1.1 : 1, background: activeSymptom === i ? '#ef444430' : '#ffffff10' }}
                  style={{ padding: '10px 18px', borderRadius: '20px', color: activeSymptom === i ? '#ef4444' : '#999', fontWeight: '600', fontSize: '14px', transition: 'all 0.3s ease' }}>
                  {symptom}
                </motion.span>
              ))}
            </div>
          </motion.div>

          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.7 }}
            style={{ marginTop: '20px', textAlign: 'center', padding: '16px', background: '#f59e0b15', borderRadius: '12px', border: '1px solid #f59e0b30' }}>
            <Icons.AlertTriangle style={{ color: '#f59e0b', display: 'inline', marginRight: '8px' }} />
            <span style={{ color: '#f59e0b', fontWeight: '600' }}>{data.insight}</span>
          </motion.div>
        </div>
      );
    };

    // FusionFormulaSlide - The solution
    const FusionFormulaSlide = ({ data }) => {
      const [showResult, setShowResult] = useState(false);
      useEffect(() => { const timer = setTimeout(() => setShowResult(true), 2000); return () => clearTimeout(timer); }, []);

      const WorldIcon = ({ type }) => {
        if (type === 'BarChart') return <Icons.BarChart />;
        if (type === 'Heart') return <Icons.Heart />;
        return <Icons.Zap />;
      };

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-8">
          <motion.h2 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">The Only Path Forward</motion.h2>

          <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '20px', flexWrap: 'wrap' }}>
            {/* Left World */}
            <motion.div initial={{ opacity: 0, x: -30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.2 }}
              style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '16px', padding: '24px', width: '280px', position: 'relative' }}>
              <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: `linear-gradient(90deg, transparent, ${data.leftWorld.color}, transparent)` }} />
              <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '16px' }}>
                <div style={{ width: '40px', height: '40px', borderRadius: '10px', background: `${data.leftWorld.color}20`, display: 'flex', alignItems: 'center', justifyContent: 'center', color: data.leftWorld.color }}>
                  <WorldIcon type={data.leftWorld.icon} />
                </div>
                <div>
                  <div style={{ color: data.leftWorld.color, fontWeight: '700' }}>{data.leftWorld.name}</div>
                  <div style={{ color: '#888', fontSize: '12px' }}>{data.leftWorld.description}</div>
                </div>
              </div>
              <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
                {data.leftWorld.actions.map((action, i) => (
                  <div key={i} style={{ display: 'flex', alignItems: 'center', gap: '8px', color: '#ccc', fontSize: '13px' }}>
                    <Icons.Check style={{ color: data.leftWorld.color, width: '16px', height: '16px' }} />
                    {action}
                  </div>
                ))}
              </div>
            </motion.div>

            {/* Plus */}
            <motion.div initial={{ opacity: 0, scale: 0 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.5 }}
              style={{ width: '50px', height: '50px', borderRadius: '50%', background: '#ffffff10', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
              <Icons.Plus style={{ color: 'var(--accent)' }} />
            </motion.div>

            {/* Right World */}
            <motion.div initial={{ opacity: 0, x: 30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.8 }}
              style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '16px', padding: '24px', width: '280px', position: 'relative' }}>
              <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: `linear-gradient(90deg, transparent, ${data.rightWorld.color}, transparent)` }} />
              <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '16px' }}>
                <div style={{ width: '40px', height: '40px', borderRadius: '10px', background: `${data.rightWorld.color}20`, display: 'flex', alignItems: 'center', justifyContent: 'center', color: data.rightWorld.color }}>
                  <WorldIcon type={data.rightWorld.icon} />
                </div>
                <div>
                  <div style={{ color: data.rightWorld.color, fontWeight: '700' }}>{data.rightWorld.name}</div>
                  <div style={{ color: '#888', fontSize: '12px' }}>{data.rightWorld.description}</div>
                </div>
              </div>
              <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
                {data.rightWorld.actions.map((action, i) => (
                  <div key={i} style={{ display: 'flex', alignItems: 'center', gap: '8px', color: '#ccc', fontSize: '13px' }}>
                    <Icons.Check style={{ color: data.rightWorld.color, width: '16px', height: '16px' }} />
                    {action}
                  </div>
                ))}
              </div>
            </motion.div>
          </div>

          {/* Result */}
          <motion.div initial={{ opacity: 0, y: 30 }} animate={{ opacity: showResult ? 1 : 0, y: showResult ? 0 : 30 }} transition={{ delay: 0.3 }}
            style={{ marginTop: '32px', background: 'linear-gradient(135deg, var(--accent), var(--accent-dark))', borderRadius: '16px', padding: '24px', textAlign: 'center', boxShadow: '0 0 40px rgba(var(--accent-rgb), 0.3)' }}>
            <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '12px', marginBottom: '8px' }}>
              <Icons.Crown style={{ color: 'white' }} />
              <span style={{ color: 'white', fontWeight: '900', fontSize: '24px', fontFamily: 'Fraunces, serif' }}>{data.result.title}</span>
              <Icons.Crown style={{ color: 'white' }} />
            </div>
            <p style={{ color: 'rgba(255,255,255,0.9)', fontSize: '15px' }}>{data.result.description}</p>
          </motion.div>
        </div>
      );
    };

    // MasteryStatsSlide - Key stats
    const MasteryStatsSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto py-8">
        <motion.h2 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">The Mastery Stats</motion.h2>

        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '20px' }}>
          {data.stats.map((stat, i) => (
            <motion.div key={i} initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 + i * 0.15 }}
              style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '16px', padding: '24px', textAlign: 'center', position: 'relative' }}>
              <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: 'linear-gradient(90deg, transparent, var(--accent), transparent)' }} />
              <div style={{ fontSize: '42px', fontWeight: '900', color: 'var(--accent)', fontFamily: 'Fraunces, serif', marginBottom: '8px' }}>
                <AnimatedCounter value={stat.value} suffix={stat.suffix} />
              </div>
              <div style={{ color: 'white', fontWeight: '700', fontSize: '15px', marginBottom: '6px' }}>{stat.label}</div>
              <div style={{ color: '#888', fontSize: '12px' }}>{stat.description}</div>
            </motion.div>
          ))}
        </div>
      </div>
    );

    // EliteInsightSlide
    const EliteInsightSlide = ({ data }) => {
      const ActionIcon = ({ type }) => {
        const icons = { Target: Icons.Target, Zap: Icons.Zap, Crown: Icons.Crown, Shield: Icons.Shield };
        const Icon = icons[type] || Icons.Lightbulb;
        return <Icon />;
      };

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-3xl mx-auto py-8">
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }}
            style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '20px', padding: '32px', position: 'relative', overflow: 'hidden' }}>
            <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '4px', background: 'linear-gradient(90deg, transparent, var(--accent), transparent)' }} />

            <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '20px' }}>
              <div style={{ width: '48px', height: '48px', borderRadius: '12px', background: 'rgba(var(--accent-rgb), 0.2)', display: 'flex', alignItems: 'center', justifyContent: 'center', color: 'var(--accent)' }}>
                <Icons.Lightbulb />
              </div>
              <span style={{ color: '#888', fontSize: '12px', textTransform: 'uppercase', letterSpacing: '1px' }}>Elite Insight</span>
            </div>

            <blockquote style={{ fontSize: '20px', color: 'white', fontWeight: '600', lineHeight: 1.6, marginBottom: '16px', fontStyle: 'italic' }}>
              "{data.quote}"
            </blockquote>
            <div style={{ color: '#888', fontSize: '13px', marginBottom: '24px' }}>- {data.author}</div>

            <div style={{ background: '#ffffff10', borderRadius: '12px', padding: '16px', marginBottom: '24px' }}>
              <p style={{ color: '#ccc', fontSize: '14px', lineHeight: 1.7 }}>{data.insight}</p>
            </div>

            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '12px' }}>
              {data.actions.map((action, i) => (
                <motion.div key={i} initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.3 + i * 0.1 }}
                  style={{ background: 'rgba(var(--accent-rgb), 0.1)', borderRadius: '10px', padding: '12px', display: 'flex', flexDirection: 'column', alignItems: 'center', gap: '8px' }}>
                  <div style={{ color: 'var(--accent)' }}><ActionIcon type={action.icon} /></div>
                  <span style={{ color: '#ccc', fontSize: '12px', textAlign: 'center' }}>{action.text}</span>
                </motion.div>
              ))}
            </div>
          </motion.div>
        </div>
      );
    };

    // QuizSlide
    const QuizSlide = ({ data, onShowGif, onHideGif }) => {
      const [selected, setSelected] = useState(null);
      const [showFeedback, setShowFeedback] = useState(false);
      const celebrationGif = useMemo(() => getRandomCelebrationGif(), []);
      const empathyGif = useMemo(() => getRandomEmpathyGif(), []);
      const gifSide = useMemo(() => Math.random() > 0.5 ? 'left' : 'right', []);
      const handleSelect = (index) => { if (showFeedback) return; setSelected(index); setShowFeedback(true); };
      const isCorrect = selected === data.correctIndex;

      useEffect(() => { if (showFeedback) { if (isCorrect) { onShowGif(celebrationGif, '60%', gifSide); } else { onShowGif(empathyGif, '60%', gifSide); } } }, [showFeedback, isCorrect, celebrationGif, empathyGif, gifSide, onShowGif]);
      useEffect(() => { return () => onHideGif(); }, [onHideGif]);

      return (
        <div className="h-full w-full relative overflow-hidden">
          <div className="h-full flex flex-col justify-center px-8 md:px-12 max-w-2xl mx-auto slide-scroll overflow-y-auto py-10 relative z-30">
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
              <p className="text-xs uppercase tracking-wider text-neutral-400 mb-3">Quick Check</p>
              <h2 className="slide-title text-xl md:text-2xl text-black leading-tight">{data.question}</h2>
            </motion.div>
            <div className="space-y-3 mb-6">
              {data.options.map((option, i) => (
                <motion.button key={i} initial={{ opacity: 0, x: -15 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.08 + i * 0.06 }} onClick={() => handleSelect(i)} disabled={showFeedback} className={`w-full p-4 rounded-xl text-left transition-all border-2 ${showFeedback ? i === data.correctIndex ? 'border-green-500 bg-green-50' : i === selected ? 'border-red-400 bg-red-50' : 'border-neutral-200 bg-white opacity-40' : 'border-neutral-200 bg-white hover:border-neutral-300'}`}>
                  <div className="flex items-center gap-3">
                    <span className={`w-8 h-8 rounded-lg flex items-center justify-center text-sm font-bold transition-all ${showFeedback && i === data.correctIndex ? 'bg-green-500 text-white' : showFeedback && i === selected && !isCorrect ? 'bg-red-400 text-white' : 'bg-neutral-100 text-neutral-500'}`}>
                      {showFeedback && i === data.correctIndex ? <Icons.Check /> : showFeedback && i === selected && !isCorrect ? <Icons.X /> : String.fromCharCode(65 + i)}
                    </span>
                    <span className="text-neutral-700 text-sm md:text-base">{option}</span>
                  </div>
                </motion.button>
              ))}
            </div>
            <AnimatePresence>
              {showFeedback && (
                <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className={`p-5 rounded-xl ${isCorrect ? 'bg-green-50 border border-green-200' : 'bg-amber-50 border border-amber-200'}`}>
                  <p className={`text-sm leading-relaxed ${isCorrect ? 'text-green-800' : 'text-amber-800'}`}>{isCorrect ? data.feedback.correct : data.feedback.incorrect}</p>
                </motion.div>
              )}
            </AnimatePresence>
          </div>
        </div>
      );
    };

    // CompletionSlide
    const CompletionSlide = ({ data }) => (
      <div className="h-full flex flex-col items-center justify-center text-center px-8 slide-scroll overflow-y-auto py-8">
        <motion.div initial={{ opacity: 0, scale: 0 }} animate={{ opacity: 1, scale: 1 }} transition={{ type: 'spring', duration: 0.5 }} className="w-16 h-16 rounded-xl flex items-center justify-center mb-4 text-white" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))`, boxShadow: `0 6px 24px rgba(var(--accent-rgb), 0.35)` }}><Icons.Check /></motion.div>
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="slide-title text-2xl md:text-3xl text-black mb-3">Lesson Complete</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.25 }} className="text-neutral-500 text-sm mb-5 max-w-md leading-relaxed">You now understand the Two Worlds every DTC founder must master. Direct Marketing funds your growth today. Brand Marketing builds your moat for tomorrow. Fuse both, and you dominate.</motion.p>
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.35 }} className="bg-neutral-900 rounded-xl p-5 max-w-md w-full mb-4">
          <p className="text-neutral-500 text-xs uppercase tracking-wider mb-2">Up Next</p>
          <h3 className="text-white font-bold text-lg mb-1">{LESSON_CONFIG.nextLesson.title}</h3>
          <p className="text-neutral-400 text-xs">{LESSON_CONFIG.nextLesson.teaser}</p>
        </motion.div>
      </div>
    );

    // ============ MAIN APP ============

    const LessonApp = () => {
      const [currentSlide, setCurrentSlide] = useState(getInitialSlide());
      const [direction, setDirection] = useState(1);
      const userName = useMemo(() => getUserName(), []);
      const currentSlideRef = React.useRef(0);
      const [gifConfig, setGifConfig] = useState(null);
      const [isAnimating, setIsAnimating] = useState(false);

      const showGif = useCallback((url, height, side) => setGifConfig({ url, height, side }), []);
      const hideGif = useCallback(() => setGifConfig(null), []);

      React.useEffect(() => { currentSlideRef.current = currentSlide; }, [currentSlide]);

      useEffect(() => {
        window.parent.postMessage({ type: 'LESSON_SLIDE_UPDATE',
          totalSlides: slides.length, slideIndex: currentSlide, slideType: slides[currentSlide]?.type, lessonSlug: LESSON_CONFIG.id }, '*');
      }, [currentSlide]);

      const goToSlide = useCallback((newSlide) => {
        if (isAnimating || newSlide < 0 || newSlide >= slides.length) return;
        setIsAnimating(true);
        setDirection(newSlide > currentSlideRef.current ? 1 : -1);
        setCurrentSlide(newSlide);
      }, [isAnimating]);

      const nextSlide = useCallback(() => { if (currentSlideRef.current + 1 < slides.length) goToSlide(currentSlideRef.current + 1); }, [goToSlide]);
      const prevSlide = useCallback(() => { if (currentSlideRef.current - 1 >= 0) goToSlide(currentSlideRef.current - 1); }, [goToSlide]);

      useEffect(() => {
        const handleKeyDown = (e) => {
          if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); nextSlide(); }
          if (e.key === 'ArrowLeft') { e.preventDefault(); prevSlide(); }
        };
        window.addEventListener('keydown', handleKeyDown);
        return () => window.removeEventListener('keydown', handleKeyDown);
      }, [nextSlide, prevSlide]);

      const slideVariants = {
        enter: (dir) => ({ x: dir > 0 ? '100%' : '-100%', opacity: 0 }),
        center: { x: 0, opacity: 1 },
        exit: (dir) => ({ x: dir > 0 ? '-100%' : '100%', opacity: 0 })
      };

      const renderSlide = (slide) => {
        switch (slide.type) {
          case 'welcome': return <WelcomeSlide data={slide} onStart={nextSlide} userName={userName} onShowGif={showGif} onHideGif={hideGif} />;
          case 'hook': return <HookSlide data={slide} />;
          case 'meetup-visual': return <MeetupVisualSlide data={slide} />;
          case 'world-reveal': return <WorldRevealSlide data={slide} />;
          case 'world-battle': return <WorldBattleSlide data={slide} />;
          case 'treadmill-visual': return <TreadmillVisualSlide data={slide} />;
          case 'fusion-formula': return <FusionFormulaSlide data={slide} />;
          case 'mastery-stats': return <MasteryStatsSlide data={slide} />;
          case 'elite-insight': return <EliteInsightSlide data={slide} />;
          case 'quiz': return <QuizSlide data={slide} onShowGif={showGif} onHideGif={hideGif} />;
          case 'completion': return <CompletionSlide data={slide} />;
          default: return null;
        }
      };

      const showPrev = currentSlide > 0;
      const showNext = currentSlide < slides.length - 1 && slides[currentSlide].type !== 'welcome';

      return (
        <div className="w-full h-screen bg-white flex flex-col relative">
          <div className="flex-1 relative overflow-hidden z-20">
            <AnimatePresence mode="wait" custom={direction} onExitComplete={() => setIsAnimating(false)}>
              <motion.div key={currentSlide} custom={direction} variants={slideVariants} initial="enter" animate="center" exit="exit" transition={{ duration: 0.3, ease: [0.25, 0.1, 0.25, 1] }} className="absolute inset-0">
                {renderSlide(slides[currentSlide])}
                <AdminSlideReportButton slideIndex={currentSlide} slideType={slides[currentSlide].type} />
              </motion.div>
            </AnimatePresence>
            {showPrev && <button onClick={prevSlide} className="absolute left-5 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-500 hover:text-neutral-700 transition-all z-10"><Icons.ArrowLeft /></button>}
            {showNext && <button onClick={nextSlide} className="absolute right-5 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-500 hover:text-neutral-700 transition-all z-10"><Icons.ArrowRight /></button>}
          </div>
          <div className="px-6 md:px-8 py-5 border-t border-neutral-100 flex-shrink-0 relative z-10">
            <div className="flex items-center justify-center gap-2.5">
              {slides.map((_, i) => <button key={i} onClick={() => goToSlide(i)} className="w-2.5 h-2.5 rounded-full transition-all duration-300" style={{ background: i === currentSlide ? 'var(--accent)' : '#d4d4d4', transform: i === currentSlide ? 'scale(1.3)' : 'scale(1)' }} />)}
            </div>
          </div>
          <AnimatePresence>
            {gifConfig && (
              <motion.div initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: 30 }} transition={{ type: 'spring', stiffness: 100 }} className={`absolute ${gifConfig.side === 'left' ? 'left-4 md:left-8' : 'right-4 md:right-8'} bottom-0 pointer-events-none`} style={{ zIndex: 15, height: gifConfig.height }}>
                <video autoPlay loop muted playsInline className="h-full w-auto object-contain object-bottom" style={{ background: 'transparent', border: 'none', boxShadow: 'none' }}>
                  <source src={gifConfig.url} type="video/mp4" />
                </video>
              </motion.div>
            )}
          </AnimatePresence>
        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<LessonApp />);
  </script>
</body>
</html>
