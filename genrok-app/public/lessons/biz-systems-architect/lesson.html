<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Systems Architect | Quantum Scale</title>
  <script src="https://cdn.tailwindcss.com" defer></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" defer></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" defer></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js" defer></script>
  <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js" defer></script>
  <script src="../shared/greetings.js" defer></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://unpkg.com" crossorigin>
  <link rel="preconnect" href="https://cdn.tailwindcss.com" crossorigin>
  <link rel="preconnect" href="https://pqvvrljykfvhpyvxmwzb.supabase.co" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;500;600;700;800;900&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root { --accent: #8B5CF6; --accent-dark: #7C3AED; --accent-light: #A78BFA; --accent-rgb: 139, 92, 246; }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Inter', sans-serif; background: transparent; -webkit-font-smoothing: antialiased; }
    .title-font { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    h1, h2, h3, .slide-title { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    ::selection { background: var(--accent); color: white; }
    .slide-scroll::-webkit-scrollbar { display: none; }
    .slide-scroll { -ms-overflow-style: none; scrollbar-width: none; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { motion, AnimatePresence } = window.Motion;
    const { useState, useEffect, useCallback, useMemo } = React;

    const getUserName = () => { const params = new URLSearchParams(window.location.search); return params.get('userName') || 'Builder'; };

    const LESSON_CONFIG = {
      id: 'biz-systems-architect',
      title: 'The Systems Architect',
      description: 'Scaling from player to systems architect',
      accentColor: '#8B5CF6',
      duration: '6 min',
      nextLesson: { id: 'biz-high-margin-fortress', title: 'The High Margin Fortress', teaser: 'Why selling cheap is a death sentence for eCommerce.' }
    };

    const celebrationGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_doing_a_quick_victory_dance_move_high_energy_c_d03b798b-a518-4e6c-bcae-d69b2dd50486_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_jumping_in_the_air_arms_raised_high_YESSS_cele_201477e8-3df4-405a-bc81-81d1747e5c6c_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_playing_air_guitar_light_headbanging_rockstar__0702007e-9e84-4d9e-8f99-8ee23d0b65f8_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_doing_the_running_man_dance_move_vintage_cool__25682b0f-cf4c-4e93-8dcb-6c3dac8135cd_0.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_standing_and_clapping_enthusiastically_mouth_o_992ac4fd-9a0e-4963-bbcc-a5271f25f4fd_3.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_clapping_very_fast_huge_smile_extreme_exciteme_9a4dde09-55ca-4173-a47d-613bc2924230_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_clapping_above_head_world_champion_celebration_484bd560-f049-41ca-b3d1-c03d7468ab56_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_starting_with_slow_clap_accelerating_to_fast_c_ee478a38-0ee7-437d-bd13-d687f7dd624a_0.mp4'
    ];
    const getRandomCelebrationGif = () => celebrationGifs[Math.floor(Math.random() * celebrationGifs.length)];

    const empathyGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_thumbs_down_with_encouraging_nod_close_keep_go_613e541f-c072-436f-aee7-f99cd6f834fc_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_shaking_head_side_to_side_sadly_disappointed_e_c4a4be22-6a70-4738-8612-3039454fef37_1.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_covering_face_with_palm_facepalm_gesture_disap_211b0566-078f-4d42-9c41-547b14f5827c_0.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_looking_down_sadly_shoulders_slumped_disappoin_790d48bd-e49e-40ea-9979-d3e86fa3a422_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_wiping_away_a_small_tear_sad_but_gentle_disapp_8d78571b-3c36-4502-abee-81683255843c_1.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_sighing_sadly_exhaling_with_disappointment_hea_f6014f2a-3a99-4378-a2a8-414e16b3e72d_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_slouching_with_disappointment_body_curling_inw_caedddbe-413c-492a-9fdf-1e8433f5e2a8_2%20(1).mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_placing_hand_on_forehead_sadly_eyes_closed_fru_3e048895-f365-4ff2-9e88-0d0a35b2a9e1_3.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_nodding_slowly_with_sadness_what_a_shame_expre_377f67ca-63da-41aa-9072-4926fc2f6e82_3.mp4'
    ];
    const getRandomEmpathyGif = () => empathyGifs[Math.floor(Math.random() * empathyGifs.length)];

    const slides = [
      { type: 'welcome', learningGoals: ['The scaling paradox that traps founders', 'How to build teams around winners', 'The 5 stages from $1M to $10M+'] },
      { type: 'hook', headline: 'Getting to $1M/month is a marketing challenge.', subtext: 'Getting to $10M/month is a systems and people challenge. Most founders master the first part. They crack CAC, build a product, and scale ads to seven figures. Then they hit a wall. Not because marketing fails. But because they become the bottleneck. This is the scaling paradox.' },
      { type: 'content', title: 'The Scaling Paradox', body: 'At $1M/month, your challenge is simple: figure out how to profitably acquire customers. At $10M/month, the challenge shifts entirely. You need systems. Teams. Processes. Delegation. You transition from Player to Systems Architect. Most founders never make this transition. They stay trapped in execution mode, managing every detail, until they burn out or plateau.' },
      { type: 'checklist-founder', title: 'The "Checklist Founder" Trap', example: { name: 'Christian Guzman', company: 'Alphalete', problem: 'Had 24 direct reports', result: 'Became the bottleneck', solution: 'Hired leaders to own departments' }, items: ['Customer service messages you directly', 'Designers send you every mockup for approval', 'You review every ad creative personally', 'Inventory decisions require your sign-off', 'Hiring waits for your final interview', 'Brand partnerships need your greenlight'] },
      { type: 'org-chart', title: 'Build the Machine', description: 'The solution is not to work harder. The solution is to build an organization that runs without you in every decision.' },
      { type: 'content', title: 'Principle 1: Hire A-Players Over Volume', body: 'Stop hiring three mediocre people at $50-70k each. Instead, hire ONE exceptional person at $150k. Why? Because one A-player with real experience will outperform three people learning on your dime. A-players bring battle-tested systems, instant credibility, and strategic thinking. They do not just execute. They improve the game. Hire for experience, not potential. Your business cannot afford to be a training ground when you are scaling to eight figures.' },
      { type: 'hiring-comparison', title: 'The A-Player Math', mediocre: { count: 3, salary: 60000, total: 180000, output: '70% capacity', onboarding: '6 months', quality: 'Learning on your dime', label: 'MEDIOCRE TEAM' }, aPlayer: { count: 1, salary: 150000, total: 150000, output: '120% capacity', onboarding: '2 weeks', quality: 'Battle-tested systems', label: 'A-PLAYER' } },
      { type: 'content', title: 'Principle 2: Build Teams Around Winners', body: 'If you have a brand ambassador generating $500k/month, do NOT make them share one editor with 12 other people. Build a dedicated team around them. Give them a personal editor, a media buyer, a copywriter. When you have a winning horse, you feed it. You do not starve it by spreading resources thin. This principle applies to products, campaigns, and channels too. Double down on what works. Starve what does not.' },
      { type: 'team-structure', title: 'Teams Around Winners', winner: { name: 'Top Brand Ambassador', revenue: '$500k/month', team: ['Dedicated Video Editor', 'Personal Media Buyer', 'Copywriter', 'Content Strategist'] }, loser: { name: 'Shared Resources Model', revenue: '$50k/month per person', team: ['1 editor for 12 people', 'Generic media buyer', 'No dedicated support'] } },
      { type: 'content', title: 'Principle 3: Align Incentives Beyond Money', body: 'Money is not the only motivator. Ask your A-players what they want beyond salary. Some want status: a fancy title, public recognition, speaking opportunities. Some want growth: access to mentorship, skill development, career advancement. Some want autonomy: freedom to build their own team, own a vertical. When you align incentives with what people actually want, they perform at 10x. Money alone gets compliance. Aligned incentives get obsession.' },
      { type: 'incentives-framework', title: 'Beyond Money: What A-Players Want', incentives: [
        { type: 'Status', examples: ['C-level title', 'Public recognition', 'Conference speaking', 'Thought leadership'], icon: 'Award', color: '#F59E0B' },
        { type: 'Growth', examples: ['Mentorship access', 'Skill development budget', 'Career advancement path', 'Learning opportunities'], icon: 'TrendingUp', color: '#3B82F6' },
        { type: 'Autonomy', examples: ['Build own team', 'Own a vertical', 'Decision authority', 'Strategic freedom'], icon: 'Zap', color: '#8B5CF6' },
        { type: 'Impact', examples: ['Shape company direction', 'Ownership stakes', 'Profit sharing', 'Equity upside'], icon: 'Target', color: '#22C55E' }
      ] },
      { type: 'five-stages', title: 'The 5 Stages to $10M+', stages: [
        { stage: 1, name: 'Conquer CAC', goal: 'Profitable acquisition', metric: 'LTV > 3x CAC', color: '#EF4444' },
        { stage: 2, name: 'Establish Foundation', goal: 'Repeatable systems', metric: 'SOPs documented', color: '#F59E0B' },
        { stage: 3, name: 'Maximize LTV', goal: 'Retention excellence', metric: '40%+ repeat rate', color: '#8B5CF6' },
        { stage: 4, name: 'Master OS', goal: 'Team autonomy', metric: 'You work 20hrs/week', color: '#3B82F6' },
        { stage: 5, name: 'Build Endgame', goal: 'Systems architect', metric: 'Business runs without you', color: '#22C55E' }
      ] },
      { type: 'highlight-box', title: 'The Transition', body: 'From $1M to $10M is not about doing more of what got you here. It is about becoming a different type of leader. You stop being the best player on the field. You become the architect who designs the game, hires the players, and builds the system that wins without you. This is the hardest transition most founders never make.', highlight: 'You stop being the best player. You become the architect who designs the game.' },
      { type: 'quiz', question: 'What is the key to scaling past $1M/month?', options: ['Spending more on ads', 'Building systems and hiring A-players', 'Working longer hours', 'Adding more products'], correctIndex: 1, feedback: { correct: 'Exactly right. Scaling past $1M is not a marketing challenge, it is a systems and people challenge. You need to hire A-players, build teams around winners, and create systems that run without you. That is how you go from Player to Systems Architect.', incorrect: 'Not quite. The key to scaling past $1M is building systems and hiring A-players. Marketing got you to $1M. Systems and people get you to $10M. You cannot scale on your own execution. You need to become the architect, not the player.' }},
      { type: 'completion', sources: [] }
    ];

    // Icons
    const Icons = {
      Clock: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
      Check: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><polyline points="20 6 9 17 4 12"/></svg>,
      X: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
      ArrowLeft: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>,
      ArrowRight: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>,
      Zap: ({ size = 18, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
      Users: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>,
      AlertTriangle: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>,
      TrendingUp: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>,
      Award: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>,
      Target: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>,
      Layers: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="12 2 2 7 12 12 22 7 12 2"/><polyline points="2 17 12 22 22 17"/><polyline points="2 12 12 17 22 12"/></svg>,
      DollarSign: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>,
      Building: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="4" y="2" width="16" height="20" rx="2" ry="2"/><line x1="9" y1="6" x2="9" y2="6"/><line x1="15" y1="6" x2="15" y2="6"/><line x1="9" y1="10" x2="9" y2="10"/><line x1="15" y1="10" x2="15" y2="10"/><line x1="9" y1="14" x2="9" y2="14"/><line x1="15" y1="14" x2="15" y2="14"/><line x1="9" y1="18" x2="15" y2="18"/></svg>,
    };

    // Checklist Founder Trap Slide
    const ChecklistFounderSlide = ({ data }) => {
      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto py-8 slide-scroll overflow-y-auto">
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
            <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-3" style={{ background: 'rgba(var(--accent-rgb), 0.1)', color: 'var(--accent)' }}>
              <Icons.AlertTriangle size={14} color="var(--accent)" />
              <span>Warning Sign</span>
            </div>
            <h2 className="slide-title text-2xl md:text-3xl text-black">{data.title}</h2>
          </motion.div>

          {/* Example case */}
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.2 }}
            className="rounded-2xl p-6 mb-6 relative overflow-hidden"
            style={{ background: '#0a0a0a', border: '1px solid #EF4444', boxShadow: '0 0 30px rgba(239,68,68,0.15)' }}
          >
            <div className="absolute top-0 right-0 w-40 h-40 rounded-full blur-3xl -mr-20 -mt-20" style={{ background: 'rgba(239,68,68,0.1)' }} />

            <div className="relative z-10">
              <div className="flex items-start gap-4 mb-4">
                <div className="w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0" style={{ background: 'rgba(239,68,68,0.2)', border: '1px solid #EF4444' }}>
                  <Icons.AlertTriangle size={24} color="#EF4444" />
                </div>
                <div>
                  <div className="text-white font-bold text-lg">{data.example.name}</div>
                  <div className="text-neutral-400 text-sm">{data.example.company}</div>
                </div>
              </div>

              <div className="grid md:grid-cols-3 gap-4 text-sm">
                <div className="bg-neutral-900 rounded-lg p-3">
                  <div className="text-neutral-500 text-xs mb-1">Problem</div>
                  <div className="text-red-400 font-semibold">{data.example.problem}</div>
                </div>
                <div className="bg-neutral-900 rounded-lg p-3">
                  <div className="text-neutral-500 text-xs mb-1">Result</div>
                  <div className="text-red-400 font-semibold">{data.example.result}</div>
                </div>
                <div className="bg-neutral-900 rounded-lg p-3">
                  <div className="text-neutral-500 text-xs mb-1">Solution</div>
                  <div className="text-green-400 font-semibold">{data.example.solution}</div>
                </div>
              </div>
            </div>
          </motion.div>

          {/* Signs you're trapped */}
          <motion.div
            initial={{ opacity: 0, y: 15 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.4 }}
            className="bg-neutral-50 rounded-xl p-5"
          >
            <p className="text-neutral-600 text-sm font-semibold mb-3">Signs you're the bottleneck:</p>
            <div className="space-y-2">
              {data.items.map((item, i) => (
                <motion.div
                  key={i}
                  initial={{ opacity: 0, x: -10 }}
                  animate={{ opacity: 1, x: 0 }}
                  transition={{ delay: 0.5 + i * 0.08 }}
                  className="flex items-start gap-2"
                >
                  <span className="w-1.5 h-1.5 rounded-full bg-red-500 mt-1.5 flex-shrink-0" />
                  <span className="text-neutral-700 text-sm">{item}</span>
                </motion.div>
              ))}
            </div>
          </motion.div>
        </div>
      );
    };

    // Entrepreneur Images for Org Chart (CEO only)
    const entrepreneurImages = {
      ceo: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/channels4_profile__2_-removebg-preview.png', // Ben Francis
    };

    // Org Chart Slide
    const OrgChartSlide = ({ data }) => {
      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-4 slide-scroll overflow-y-auto">
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-4">
            <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-2" style={{ background: 'rgba(var(--accent-rgb), 0.1)', color: 'var(--accent)' }}>
              <Icons.Building size={14} color="var(--accent)" />
              <span>Organization Design</span>
            </div>
            <h2 className="slide-title text-xl md:text-2xl text-black mb-1">{data.title}</h2>
            <p className="text-neutral-600 text-xs">{data.description}</p>
          </motion.div>

          {/* Org Chart Visual */}
          <div className="rounded-2xl p-4 md:p-6" style={{ background: '#0a0a0a' }}>
            {/* Founder */}
            <motion.div
              initial={{ opacity: 0, scale: 0.8 }}
              animate={{ opacity: 1, scale: 1 }}
              transition={{ delay: 0.2 }}
              className="flex justify-center mb-4"
            >
              <div className="rounded-xl p-3 text-center relative" style={{ background: 'linear-gradient(135deg, #8B5CF6, #7C3AED)', boxShadow: '0 0 30px rgba(139,92,246,0.4)' }}>
                <div className="w-14 h-14 rounded-full mx-auto mb-2 overflow-hidden border-2 border-white/30" style={{ background: '#1a1a1a' }}>
                  <img src={entrepreneurImages.ceo} alt="CEO" className="w-full h-full object-cover object-top" onError={(e) => { e.target.style.display = 'none'; e.target.parentElement.innerHTML = '<div class="w-full h-full flex items-center justify-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/></svg></div>'; }} />
                </div>
                <div className="text-white font-bold text-sm">Founder / CEO</div>
                <div className="text-purple-200 text-[10px]">Systems Architect</div>
              </div>
            </motion.div>

            {/* Connector Lines */}
            <div className="flex justify-center mb-0">
              <svg width="100%" height="40" viewBox="0 0 400 40" preserveAspectRatio="xMidYMid meet" className="hidden md:block max-w-lg">
                {/* Vertical line from CEO down */}
                <motion.line
                  initial={{ pathLength: 0 }}
                  animate={{ pathLength: 1 }}
                  transition={{ duration: 0.8, delay: 0.4 }}
                  x1="200" y1="0" x2="200" y2="15"
                  stroke="#8B5CF6"
                  strokeWidth="2"
                />
                {/* Horizontal connector line */}
                <motion.line
                  initial={{ pathLength: 0 }}
                  animate={{ pathLength: 1 }}
                  transition={{ duration: 0.8, delay: 0.5 }}
                  x1="66" y1="15" x2="334" y2="15"
                  stroke="#8B5CF6"
                  strokeWidth="2"
                />
                {/* Left vertical line to Marketing */}
                <motion.line
                  initial={{ pathLength: 0 }}
                  animate={{ pathLength: 1 }}
                  transition={{ duration: 0.6, delay: 0.6 }}
                  x1="66" y1="15" x2="66" y2="40"
                  stroke="#8B5CF6"
                  strokeWidth="2"
                />
                {/* Center vertical line to Operations */}
                <motion.line
                  initial={{ pathLength: 0 }}
                  animate={{ pathLength: 1 }}
                  transition={{ duration: 0.6, delay: 0.6 }}
                  x1="200" y1="15" x2="200" y2="40"
                  stroke="#8B5CF6"
                  strokeWidth="2"
                />
                {/* Right vertical line to Product */}
                <motion.line
                  initial={{ pathLength: 0 }}
                  animate={{ pathLength: 1 }}
                  transition={{ duration: 0.6, delay: 0.6 }}
                  x1="334" y1="15" x2="334" y2="40"
                  stroke="#8B5CF6"
                  strokeWidth="2"
                />
                {/* Dots at connection points */}
                <motion.circle initial={{ scale: 0 }} animate={{ scale: 1 }} transition={{ delay: 0.7 }} cx="66" cy="40" r="3" fill="#8B5CF6" />
                <motion.circle initial={{ scale: 0 }} animate={{ scale: 1 }} transition={{ delay: 0.7 }} cx="200" cy="40" r="3" fill="#8B5CF6" />
                <motion.circle initial={{ scale: 0 }} animate={{ scale: 1 }} transition={{ delay: 0.7 }} cx="334" cy="40" r="3" fill="#8B5CF6" />
              </svg>
            </div>

            {/* Department Leads */}
            <div className="grid grid-cols-1 md:grid-cols-3 gap-3 mb-6">
              {[
                { name: 'Head of Marketing', teams: ['Media Buying', 'Creative', 'Analytics'], color: '#3B82F6', delay: 0.7, icon: 'TrendingUp' },
                { name: 'Head of Operations', teams: ['Fulfillment', 'Support', 'Supply Chain'], color: '#22C55E', delay: 0.8, icon: 'Layers' },
                { name: 'Head of Product', teams: ['Development', 'Design', 'Research'], color: '#F59E0B', delay: 0.9, icon: 'Target' }
              ].map((dept, i) => {
                const IconComponent = Icons[dept.icon];
                return (
                  <motion.div
                    key={i}
                    initial={{ opacity: 0, y: 20 }}
                    animate={{ opacity: 1, y: 0 }}
                    transition={{ delay: dept.delay }}
                    className="rounded-xl p-3"
                    style={{ background: `${dept.color}15`, border: `1px solid ${dept.color}` }}
                  >
                    <div className="text-center mb-2">
                      {/* Department Icon - Centered */}
                      <div className="w-10 h-10 rounded-full mx-auto mb-2 flex items-center justify-center border-2" style={{ borderColor: dept.color, background: '#1a1a1a' }}>
                        <IconComponent size={18} color={dept.color} />
                      </div>
                      <div className="font-bold text-white text-xs mb-0.5">{dept.name}</div>
                      <div className="text-[10px] text-neutral-400">Department Lead</div>
                    </div>
                    <div className="space-y-1">
                      {dept.teams.map((team, j) => (
                        <motion.div
                          key={j}
                          initial={{ opacity: 0, x: -10 }}
                          animate={{ opacity: 1, x: 0 }}
                          transition={{ delay: dept.delay + 0.1 + j * 0.1 }}
                          className="bg-neutral-900 rounded px-2 py-1 text-[10px] text-neutral-300 text-center"
                        >
                          {team}
                        </motion.div>
                      ))}
                    </div>
                  </motion.div>
                );
              })}
            </div>

            <motion.div
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              transition={{ delay: 1.2 }}
              className="text-center text-neutral-400 text-xs mt-3"
            >
              Each department runs autonomously. You architect the system, not execute the tasks.
            </motion.div>
          </div>
        </div>
      );
    };

    // Hiring Comparison Slide
    const HiringComparisonSlide = ({ data }) => {
      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-8 slide-scroll overflow-y-auto">
          <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">{data.title}</motion.h2>

          <div className="grid md:grid-cols-2 gap-6">
            {/* Mediocre Team */}
            <motion.div
              initial={{ opacity: 0, x: -30 }}
              animate={{ opacity: 1, x: 0 }}
              className="rounded-2xl p-6 relative overflow-hidden"
              style={{ background: '#0a0a0a', border: '1px solid #EF4444', boxShadow: '0 0 30px rgba(239,68,68,0.15)' }}
            >
              <div className="absolute top-0 right-0 w-40 h-40 rounded-full blur-3xl -mr-20 -mt-20" style={{ background: 'rgba(239,68,68,0.08)' }} />

              <div className="relative z-10">
                <div className="text-xs font-bold tracking-wider mb-4" style={{ color: '#EF4444' }}>{data.mediocre.label}</div>

                <div className="mb-5">
                  <div className="text-4xl font-bold text-white mb-1">{data.mediocre.count}x</div>
                  <div className="text-neutral-500 text-sm">${(data.mediocre.salary / 1000).toFixed(0)}k each</div>
                </div>

                <div className="space-y-3 mb-5">
                  <div className="bg-neutral-900 rounded-lg p-3">
                    <div className="text-neutral-500 text-xs mb-1">Total Cost</div>
                    <div className="text-red-400 font-bold">${(data.mediocre.total / 1000).toFixed(0)}k/year</div>
                  </div>
                  <div className="bg-neutral-900 rounded-lg p-3">
                    <div className="text-neutral-500 text-xs mb-1">Output</div>
                    <div className="text-red-400 font-semibold">{data.mediocre.output}</div>
                  </div>
                  <div className="bg-neutral-900 rounded-lg p-3">
                    <div className="text-neutral-500 text-xs mb-1">Onboarding</div>
                    <div className="text-red-400 font-semibold">{data.mediocre.onboarding}</div>
                  </div>
                </div>

                <div className="border-t border-neutral-800 pt-3">
                  <div className="text-neutral-400 text-xs">{data.mediocre.quality}</div>
                </div>
              </div>
            </motion.div>

            {/* A-Player */}
            <motion.div
              initial={{ opacity: 0, x: 30 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ delay: 0.15 }}
              className="rounded-2xl p-6 relative overflow-hidden"
              style={{ background: '#0a0a0a', border: '1px solid #22C55E', boxShadow: '0 0 30px rgba(34,197,94,0.15)' }}
            >
              <div className="absolute top-0 right-0 w-40 h-40 rounded-full blur-3xl -mr-20 -mt-20" style={{ background: 'rgba(34,197,94,0.08)' }} />

              <div className="relative z-10">
                <div className="text-xs font-bold tracking-wider mb-4" style={{ color: '#22C55E' }}>{data.aPlayer.label}</div>

                <div className="mb-5">
                  <div className="text-4xl font-bold text-white mb-1">{data.aPlayer.count}x</div>
                  <div className="text-neutral-500 text-sm">${(data.aPlayer.salary / 1000).toFixed(0)}k total</div>
                </div>

                <div className="space-y-3 mb-5">
                  <div className="bg-neutral-900 rounded-lg p-3">
                    <div className="text-neutral-500 text-xs mb-1">Total Cost</div>
                    <div className="text-green-400 font-bold">${(data.aPlayer.total / 1000).toFixed(0)}k/year</div>
                  </div>
                  <div className="bg-neutral-900 rounded-lg p-3">
                    <div className="text-neutral-500 text-xs mb-1">Output</div>
                    <div className="text-green-400 font-semibold">{data.aPlayer.output}</div>
                  </div>
                  <div className="bg-neutral-900 rounded-lg p-3">
                    <div className="text-neutral-500 text-xs mb-1">Onboarding</div>
                    <div className="text-green-400 font-semibold">{data.aPlayer.onboarding}</div>
                  </div>
                </div>

                <div className="border-t border-neutral-800 pt-3">
                  <div className="text-neutral-400 text-xs">{data.aPlayer.quality}</div>
                </div>
              </div>
            </motion.div>
          </div>

          <motion.p
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 0.5 }}
            className="text-center text-neutral-500 text-sm mt-6"
          >
            One A-player costs less and produces more than three mediocre hires.
          </motion.p>
        </div>
      );
    };

    // Team Structure Slide
    const TeamStructureSlide = ({ data }) => {
      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-8 slide-scroll overflow-y-auto">
          <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">{data.title}</motion.h2>

          <div className="grid md:grid-cols-2 gap-6">
            {/* Winner Model */}
            <motion.div
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ delay: 0.2 }}
              className="rounded-2xl p-6 relative overflow-hidden"
              style={{ background: '#0a0a0a', border: '1px solid #22C55E', boxShadow: '0 0 30px rgba(34,197,94,0.15)' }}
            >
              <div className="absolute top-0 left-0 w-32 h-32 rounded-full blur-3xl -ml-16 -mt-16" style={{ background: 'rgba(34,197,94,0.1)' }} />

              <div className="relative z-10">
                <div className="flex items-center gap-3 mb-4">
                  <div className="w-12 h-12 rounded-xl flex items-center justify-center" style={{ background: 'linear-gradient(135deg, #22C55E, #16A34A)', boxShadow: '0 0 20px rgba(34,197,94,0.4)' }}>
                    <Icons.Award size={24} color="white" />
                  </div>
                  <div>
                    <div className="text-white font-bold">{data.winner.name}</div>
                    <div className="text-green-400 text-sm font-semibold">{data.winner.revenue}</div>
                  </div>
                </div>

                <div className="bg-neutral-900 rounded-lg p-4 mb-4">
                  <div className="text-neutral-500 text-xs uppercase tracking-wider mb-2">Dedicated Team</div>
                  <div className="space-y-2">
                    {data.winner.team.map((role, i) => (
                      <motion.div
                        key={i}
                        initial={{ opacity: 0, x: -10 }}
                        animate={{ opacity: 1, x: 0 }}
                        transition={{ delay: 0.4 + i * 0.1 }}
                        className="flex items-center gap-2"
                      >
                        <span className="w-1.5 h-1.5 rounded-full bg-green-400" style={{ boxShadow: '0 0 6px rgba(34,197,94,0.6)' }} />
                        <span className="text-neutral-300 text-sm">{role}</span>
                      </motion.div>
                    ))}
                  </div>
                </div>

                <div className="text-green-400 text-xs font-semibold">✓ Feed the winning horse</div>
              </div>
            </motion.div>

            {/* Shared Resources Model */}
            <motion.div
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ delay: 0.3 }}
              className="rounded-2xl p-6 relative overflow-hidden"
              style={{ background: '#0a0a0a', border: '1px solid #6B7280', boxShadow: '0 0 20px rgba(107,114,128,0.1)' }}
            >
              <div className="absolute top-0 right-0 w-32 h-32 rounded-full blur-3xl -mr-16 -mt-16" style={{ background: 'rgba(107,114,128,0.08)' }} />

              <div className="relative z-10">
                <div className="flex items-center gap-3 mb-4">
                  <div className="w-12 h-12 rounded-xl flex items-center justify-center bg-neutral-800 border border-neutral-700">
                    <Icons.Users size={24} color="#9CA3AF" />
                  </div>
                  <div>
                    <div className="text-white font-bold">{data.loser.name}</div>
                    <div className="text-neutral-500 text-sm font-semibold">{data.loser.revenue}</div>
                  </div>
                </div>

                <div className="bg-neutral-900 rounded-lg p-4 mb-4">
                  <div className="text-neutral-500 text-xs uppercase tracking-wider mb-2">Shared Resources</div>
                  <div className="space-y-2">
                    {data.loser.team.map((role, i) => (
                      <motion.div
                        key={i}
                        initial={{ opacity: 0, x: -10 }}
                        animate={{ opacity: 1, x: 0 }}
                        transition={{ delay: 0.5 + i * 0.1 }}
                        className="flex items-center gap-2"
                      >
                        <span className="w-1.5 h-1.5 rounded-full bg-neutral-600" />
                        <span className="text-neutral-500 text-sm">{role}</span>
                      </motion.div>
                    ))}
                  </div>
                </div>

                <div className="text-neutral-500 text-xs font-semibold">✗ Spreading resources thin</div>
              </div>
            </motion.div>
          </div>

          <motion.p
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 0.7 }}
            className="text-center text-neutral-500 text-sm mt-6"
          >
            When you have a winner, double down. Build a dedicated team around them.
          </motion.p>
        </div>
      );
    };

    // Incentives Framework Slide
    const IncentivesFrameworkSlide = ({ data }) => {
      const getIcon = (iconName) => Icons[iconName] || Icons.Zap;

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-8 slide-scroll overflow-y-auto">
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
            <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-3" style={{ background: 'rgba(var(--accent-rgb), 0.1)', color: 'var(--accent)' }}>
              <Icons.Target size={14} color="var(--accent)" />
              <span>Motivation Framework</span>
            </div>
            <h2 className="slide-title text-2xl md:text-3xl text-black">{data.title}</h2>
          </motion.div>

          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            {data.incentives.map((incentive, i) => {
              const IconComponent = getIcon(incentive.icon);
              return (
                <motion.div
                  key={i}
                  initial={{ opacity: 0, y: 20 }}
                  animate={{ opacity: 1, y: 0 }}
                  transition={{ delay: 0.1 + i * 0.1 }}
                  className="rounded-xl p-5 relative overflow-hidden"
                  style={{ background: '#0a0a0a', border: `1px solid ${incentive.color}30`, boxShadow: `0 0 20px ${incentive.color}08` }}
                >
                  <div className="absolute top-0 right-0 w-24 h-24 rounded-full blur-3xl -mr-12 -mt-12" style={{ background: `${incentive.color}10` }} />

                  <div className="relative z-10">
                    <div className="flex items-center gap-3 mb-4">
                      <div className="w-10 h-10 rounded-lg flex items-center justify-center" style={{ background: `${incentive.color}20`, border: `1px solid ${incentive.color}40` }}>
                        <IconComponent size={20} color={incentive.color} />
                      </div>
                      <div className="font-bold text-white text-lg">{incentive.type}</div>
                    </div>

                    <div className="space-y-1.5">
                      {incentive.examples.map((example, j) => (
                        <motion.div
                          key={j}
                          initial={{ opacity: 0, x: -10 }}
                          animate={{ opacity: 1, x: 0 }}
                          transition={{ delay: 0.2 + i * 0.1 + j * 0.05 }}
                          className="flex items-center gap-2"
                        >
                          <span className="w-1 h-1 rounded-full flex-shrink-0" style={{ background: incentive.color }} />
                          <span className="text-neutral-400 text-xs">{example}</span>
                        </motion.div>
                      ))}
                    </div>
                  </div>
                </motion.div>
              );
            })}
          </div>

          <motion.div
            initial={{ opacity: 0, y: 15 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.6 }}
            className="rounded-xl p-4 text-center mt-6"
            style={{ background: 'linear-gradient(135deg, var(--accent), var(--accent-dark))' }}
          >
            <p className="text-white text-sm font-medium">Money alone gets compliance. Aligned incentives get obsession.</p>
          </motion.div>
        </div>
      );
    };

    // Five Stages Slide
    const FiveStagesSlide = ({ data }) => {
      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-6xl mx-auto py-8 slide-scroll overflow-y-auto">
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
            <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-3" style={{ background: 'rgba(var(--accent-rgb), 0.1)', color: 'var(--accent)' }}>
              <Icons.Layers size={14} color="var(--accent)" />
              <span>The Journey</span>
            </div>
            <h2 className="slide-title text-2xl md:text-3xl text-black">{data.title}</h2>
          </motion.div>

          {/* Timeline */}
          <div className="rounded-2xl p-6 md:p-8 relative" style={{ background: '#0a0a0a' }}>
            <div className="relative">
              {/* Connection line */}
              <div className="absolute top-8 left-0 right-0 h-0.5 bg-neutral-800 hidden md:block" />

              <div className="grid grid-cols-1 md:grid-cols-5 gap-4 md:gap-3 relative">
                {data.stages.map((stage, i) => (
                  <motion.div
                    key={i}
                    initial={{ opacity: 0, y: 30 }}
                    animate={{ opacity: 1, y: 0 }}
                    transition={{ delay: 0.2 + i * 0.15 }}
                    className="flex flex-col items-center text-center"
                  >
                    {/* Stage number circle */}
                    <motion.div
                      initial={{ scale: 0 }}
                      animate={{ scale: 1 }}
                      transition={{ delay: 0.3 + i * 0.15, type: 'spring' }}
                      className="w-16 h-16 rounded-full flex items-center justify-center mb-3 relative z-10"
                      style={{
                        background: `linear-gradient(135deg, ${stage.color}, ${stage.color}dd)`,
                        boxShadow: `0 0 30px ${stage.color}40, inset 0 1px 0 rgba(255,255,255,0.2)`
                      }}
                    >
                      <span className="text-white text-2xl font-bold">{stage.stage}</span>
                    </motion.div>

                    {/* Stage content */}
                    <div className="rounded-lg p-3 w-full" style={{ background: `${stage.color}10`, border: `1px solid ${stage.color}30` }}>
                      <div className="font-bold text-white text-sm mb-1">{stage.name}</div>
                      <div className="text-neutral-400 text-xs mb-2">{stage.goal}</div>
                      <div className="text-xs font-semibold px-2 py-1 rounded" style={{ background: `${stage.color}20`, color: stage.color }}>
                        {stage.metric}
                      </div>
                    </div>
                  </motion.div>
                ))}
              </div>
            </div>

            <motion.div
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              transition={{ delay: 1.2 }}
              className="text-center text-neutral-400 text-sm mt-6"
            >
              Each stage requires different skills. Master one before moving to the next.
            </motion.div>
          </div>
        </div>
      );
    };

    const WelcomeSlide = ({ data, onStart, userName, onShowGif, onHideGif }) => {
      const welcomeData = useMemo(() => getTimeBasedWelcome(), []);
      const gifSide = useMemo(() => Math.random() > 0.5 ? 'left' : 'right', []);
      useEffect(() => { onShowGif(welcomeData.gif, '65%', gifSide); return () => onHideGif(); }, [welcomeData.gif, gifSide, onShowGif, onHideGif]);

      return (
        <div className="h-full w-full relative overflow-hidden">
          <div className="h-full flex flex-col items-center justify-center text-center px-6 py-4 relative z-20">
            <motion.h1 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="title-font text-3xl sm:text-4xl md:text-5xl lg:text-6xl text-black mb-2 md:mb-3">{LESSON_CONFIG.title}</motion.h1>
            <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-neutral-600 text-base md:text-lg lg:text-xl mb-2 md:mb-3 max-w-lg leading-relaxed" dangerouslySetInnerHTML={{ __html: formatGreeting(welcomeData.greeting, `<span class="font-bold text-neutral-900">${userName}</span>`) }} />
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="flex items-center justify-center gap-1.5 text-neutral-400 text-[10px] md:text-xs mb-2 md:mb-3"><Icons.Clock /><span>{LESSON_CONFIG.duration}</span></motion.div>
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 }} className="bg-neutral-900 rounded-xl md:rounded-2xl p-3 md:p-5 mb-3 md:mb-4 max-w-sm w-full mx-auto">
              <p className="text-neutral-500 text-[9px] md:text-[11px] uppercase tracking-wider mb-2 md:mb-3">In this lesson</p>
              <ul className="space-y-1.5 md:space-y-2">
                {data.learningGoals.map((goal, i) => (
                  <motion.li key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.25 + i * 0.05 }} className="flex items-start gap-2 text-left">
                    <span className="w-5 h-5 rounded-md flex items-center justify-center text-[9px] font-bold text-white flex-shrink-0 mt-0.5" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>{i + 1}</span>
                    <span className="text-neutral-300 text-[11px] md:text-sm leading-snug">{goal}</span>
                  </motion.li>
                ))}
              </ul>
            </motion.div>
            <motion.button initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.45 }} onClick={onStart} whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }} className="px-6 md:px-7 py-2.5 md:py-3 rounded-xl text-white font-semibold text-sm md:text-base" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>Let's Go</motion.button>
          </div>
        </div>
      );
    };

    const HookSlide = ({ data }) => (
      <div className="h-full relative overflow-hidden">
        <div className="h-full flex flex-col justify-center px-8 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-10 relative z-10">
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="mb-6">
            <span className="inline-block px-3 py-1 rounded-full text-xs font-semibold mb-4" style={{ background: `rgba(var(--accent-rgb), 0.1)`, color: 'var(--accent)' }}>The Hook</span>
            <h2 className="slide-title text-3xl md:text-4xl lg:text-5xl text-black leading-tight">{data.headline}</h2>
          </motion.div>
          <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="text-lg md:text-xl text-neutral-600 leading-relaxed">{data.subtext}</motion.p>
        </div>
        {data.brandImage && (
          <motion.div initial={{ opacity: 0, x: 30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.3, duration: 0.5 }}
            className="absolute bottom-0 right-0 z-0 pointer-events-none" style={{ height: '30%', maxHeight: '200px', marginRight: '80px', marginBottom: '5%' }}>
            <img src={data.brandImage} alt={data.brandName || ''} className="h-full w-auto object-contain" style={{ opacity: 1 }} />
          </motion.div>
        )}
      </div>
    );

    const ContentSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-8 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-10">
        <motion.h2 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl lg:text-4xl text-black mb-6">{data.title}</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-base md:text-lg text-neutral-600 leading-relaxed">{data.body}</motion.p>
      
        {data.characterVideo && (
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.4, duration: 0.5 }}
            className={`absolute bottom-0 ${data.characterPosition === 'left' ? 'left-4' : 'right-4'} z-0 pointer-events-none`}
            style={{ height: '25%', maxHeight: '180px', marginBottom: '3%' }}>
            <video autoPlay loop muted playsInline className="h-full w-auto object-contain object-bottom">
              <source src={data.characterVideo} type="video/mp4" />
            </video>
          </motion.div>
        )}
      </div>
    );

    const HighlightBoxSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-8 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-10">
        <motion.h2 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl lg:text-4xl text-black mb-6">{data.title}</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-base md:text-lg text-neutral-600 leading-relaxed mb-6">{data.body}</motion.p>
        <motion.div initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.2 }} className="rounded-xl p-6 text-center" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>
          <p className="text-white text-lg font-bold">{data.highlight}</p>
        </motion.div>
      </div>
    );

    const QuizSlide = ({ data, onShowGif, onHideGif }) => {
      const [selected, setSelected] = useState(null);
      const [showFeedback, setShowFeedback] = useState(false);
      const celebrationGif = useMemo(() => getRandomCelebrationGif(), []);
      const empathyGif = useMemo(() => getRandomEmpathyGif(), []);
      const gifSide = useMemo(() => Math.random() > 0.5 ? 'left' : 'right', []);
      const handleSelect = (index) => { if (showFeedback) return; setSelected(index); setShowFeedback(true); };
      const isCorrect = selected === data.correctIndex;

      useEffect(() => { if (showFeedback) { if (isCorrect) { onShowGif(celebrationGif, '60%', gifSide); } else { onShowGif(empathyGif, '60%', gifSide); } } }, [showFeedback, isCorrect, celebrationGif, empathyGif, gifSide, onShowGif]);
      useEffect(() => { return () => onHideGif(); }, [onHideGif]);

      return (
        <div className="h-full w-full relative overflow-hidden">
          <div className="h-full flex flex-col justify-center px-8 md:px-12 max-w-2xl mx-auto slide-scroll overflow-y-auto py-10 relative z-30">
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
              <p className="text-xs uppercase tracking-wider text-neutral-400 mb-3">Quick Check</p>
              <h2 className="slide-title text-xl md:text-2xl text-black leading-tight">{data.question}</h2>
            </motion.div>
            <div className="space-y-3 mb-6">
              {data.options.map((option, i) => (
                <motion.button key={i} initial={{ opacity: 0, x: -15 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.08 + i * 0.06 }} onClick={() => handleSelect(i)} disabled={showFeedback} className={`w-full p-4 rounded-xl text-left transition-all border-2 ${showFeedback ? i === data.correctIndex ? 'border-green-500 bg-green-50' : i === selected ? 'border-red-400 bg-red-50' : 'border-neutral-200 bg-white opacity-40' : 'border-neutral-200 bg-white hover:border-neutral-300'}`}>
                  <div className="flex items-center gap-3">
                    <span className={`w-8 h-8 rounded-lg flex items-center justify-center text-sm font-bold transition-all ${showFeedback && i === data.correctIndex ? 'bg-green-500 text-white' : showFeedback && i === selected && !isCorrect ? 'bg-red-400 text-white' : 'bg-neutral-100 text-neutral-500'}`}>
                      {showFeedback && i === data.correctIndex ? <Icons.Check /> : showFeedback && i === selected && !isCorrect ? <Icons.X /> : String.fromCharCode(65 + i)}
                    </span>
                    <span className="text-neutral-700 text-sm md:text-base">{option}</span>
                  </div>
                </motion.button>
              ))}
            </div>
            <AnimatePresence>
              {showFeedback && (
                <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className={`p-5 rounded-xl ${isCorrect ? 'bg-green-50 border border-green-200' : 'bg-amber-50 border border-amber-200'}`}>
                  <p className={`text-sm leading-relaxed ${isCorrect ? 'text-green-800' : 'text-amber-800'}`}>{isCorrect ? data.feedback.correct : data.feedback.incorrect}</p>
                </motion.div>
              )}
            </AnimatePresence>
          </div>
        </div>
      );
    };

    const CompletionSlide = ({ data }) => (
      <div className="h-full flex flex-col items-center justify-center text-center px-8 slide-scroll overflow-y-auto py-8">
        <motion.div initial={{ opacity: 0, scale: 0 }} animate={{ opacity: 1, scale: 1 }} transition={{ type: 'spring', duration: 0.5 }} className="w-16 h-16 rounded-xl flex items-center justify-center mb-4 text-white" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))`, boxShadow: `0 6px 24px rgba(var(--accent-rgb), 0.35)` }}><Icons.Check /></motion.div>
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="slide-title text-2xl md:text-3xl text-black mb-3">Lesson Complete</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.25 }} className="text-neutral-500 text-sm mb-5 max-w-md leading-relaxed">You now understand the transition from Player to Systems Architect. Hire A-players, build teams around winners, and align incentives beyond money. This is how you scale to eight figures.</motion.p>
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.35 }} className="bg-neutral-900 rounded-xl p-5 max-w-md w-full mb-4">
          <p className="text-neutral-500 text-xs uppercase tracking-wider mb-2">Up Next</p>
          <h3 className="text-white font-bold text-lg mb-1">{LESSON_CONFIG.nextLesson.title}</h3>
          <p className="text-neutral-400 text-xs">{LESSON_CONFIG.nextLesson.teaser}</p>
        </motion.div>
      </div>
    );

    const LessonApp = () => {
      const [currentSlide, setCurrentSlide] = useState(0);
      const [direction, setDirection] = useState(1);
      const userName = useMemo(() => getUserName(), []);
      const currentSlideRef = React.useRef(0);
      const [gifConfig, setGifConfig] = useState(null);
      const [isAnimating, setIsAnimating] = useState(false);

      const showGif = useCallback((url, height, side) => setGifConfig({ url, height, side }), []);
      const hideGif = useCallback(() => setGifConfig(null), []);

      React.useEffect(() => { currentSlideRef.current = currentSlide; }, [currentSlide]);

      const goToSlide = useCallback((newSlide) => {
        if (isAnimating || newSlide < 0 || newSlide >= slides.length) return;
        setIsAnimating(true);
        setDirection(newSlide > currentSlideRef.current ? 1 : -1);
        setCurrentSlide(newSlide);
      }, [isAnimating]);

      const nextSlide = useCallback(() => { if (currentSlideRef.current + 1 < slides.length) goToSlide(currentSlideRef.current + 1); }, [goToSlide]);
      const prevSlide = useCallback(() => { if (currentSlideRef.current - 1 >= 0) goToSlide(currentSlideRef.current - 1); }, [goToSlide]);

      useEffect(() => {
        const handleKeyDown = (e) => {
          if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); nextSlide(); }
          if (e.key === 'ArrowLeft') { e.preventDefault(); prevSlide(); }
        };
        window.addEventListener('keydown', handleKeyDown);
        return () => window.removeEventListener('keydown', handleKeyDown);
      }, [nextSlide, prevSlide]);

      const slideVariants = {
        enter: (dir) => ({ x: dir > 0 ? '100%' : '-100%', opacity: 0 }),
        center: { x: 0, opacity: 1 },
        exit: (dir) => ({ x: dir > 0 ? '-100%' : '100%', opacity: 0 })
      };

      const renderSlide = (slide) => {
        switch (slide.type) {
          case 'welcome': return <WelcomeSlide data={slide} onStart={nextSlide} userName={userName} onShowGif={showGif} onHideGif={hideGif} />;
          case 'hook': return <HookSlide data={slide} />;
          case 'content': return <ContentSlide data={slide} />;
          case 'checklist-founder': return <ChecklistFounderSlide data={slide} />;
          case 'org-chart': return <OrgChartSlide data={slide} />;
          case 'hiring-comparison': return <HiringComparisonSlide data={slide} />;
          case 'team-structure': return <TeamStructureSlide data={slide} />;
          case 'incentives-framework': return <IncentivesFrameworkSlide data={slide} />;
          case 'five-stages': return <FiveStagesSlide data={slide} />;
          case 'highlight-box': return <HighlightBoxSlide data={slide} />;
          case 'quiz': return <QuizSlide data={slide} onShowGif={showGif} onHideGif={hideGif} />;
          case 'completion': return <CompletionSlide data={slide} />;
          default: return null;
        }
      };

      const showPrev = currentSlide > 0;
      const showNext = currentSlide < slides.length - 1 && slides[currentSlide].type !== 'welcome';

      return (
        <div className="w-full h-screen bg-white flex flex-col relative">
          <div className="flex-1 relative overflow-hidden z-20">
            <AnimatePresence mode="wait" custom={direction} onExitComplete={() => setIsAnimating(false)}>
              <motion.div key={currentSlide} custom={direction} variants={slideVariants} initial="enter" animate="center" exit="exit" transition={{ duration: 0.3, ease: [0.25, 0.1, 0.25, 1] }} className="absolute inset-0">
                {renderSlide(slides[currentSlide])}
              </motion.div>
            </AnimatePresence>
            {showPrev && <button onClick={prevSlide} className="absolute left-5 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-500 hover:text-neutral-700 transition-all z-10"><Icons.ArrowLeft /></button>}
            {showNext && <button onClick={nextSlide} className="absolute right-5 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-500 hover:text-neutral-700 transition-all z-10"><Icons.ArrowRight /></button>}
          </div>
          <div className="px-6 md:px-8 py-5 border-t border-neutral-100 flex-shrink-0 relative z-10">
            <div className="flex items-center justify-center gap-2.5">
              {slides.map((_, i) => <button key={i} onClick={() => goToSlide(i)} className="w-2.5 h-2.5 rounded-full transition-all duration-300" style={{ background: i === currentSlide ? 'var(--accent)' : '#d4d4d4', transform: i === currentSlide ? 'scale(1.3)' : 'scale(1)' }} />)}
            </div>
          </div>
          <AnimatePresence>
            {gifConfig && (
              <motion.div initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: 30 }} transition={{ type: 'spring', stiffness: 100 }} className={`absolute ${gifConfig.side === 'left' ? 'left-4 md:left-8' : 'right-4 md:right-8'} bottom-0 pointer-events-none`} style={{ zIndex: 15, height: gifConfig.height }}>
                <video autoPlay loop muted playsInline className="h-full w-auto object-contain object-bottom" style={{ background: 'transparent', border: 'none', boxShadow: 'none' }}>
                  <source src={gifConfig.url} type="video/mp4" />
                </video>
              </motion.div>
            )}
          </AnimatePresence>
        </div>
      );
    };

    ReactDOM.render(<LessonApp />, document.getElementById('root'));
  </script>
</body>
</html>
