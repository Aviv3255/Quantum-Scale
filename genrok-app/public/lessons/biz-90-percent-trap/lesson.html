<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The 90% Trap | Quantum Scale</title>
  <script src="https://cdn.tailwindcss.com" defer></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" defer></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" defer></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js" defer></script>
  <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js" defer></script>
  <script src="../shared/greetings.js" defer></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://unpkg.com" crossorigin>
  <link rel="preconnect" href="https://cdn.tailwindcss.com" crossorigin>
  <link rel="preconnect" href="https://pqvvrljykfvhpyvxmwzb.supabase.co" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;500;600;700;800;900&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root { --accent: #EF4444; --accent-dark: #DC2626; --accent-light: #F87171; --accent-rgb: 239, 68, 68; }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Inter', sans-serif; background: transparent; -webkit-font-smoothing: antialiased; }
    .title-font { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    h1, h2, h3, .slide-title { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    ::selection { background: var(--accent); color: white; }
    .slide-scroll::-webkit-scrollbar { display: none; }
    .slide-scroll { -ms-overflow-style: none; scrollbar-width: none; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { motion, AnimatePresence } = window.Motion;
    const { useState, useEffect, useCallback, useMemo } = React;

    const getUserName = () => { const params = new URLSearchParams(window.location.search); return params.get('userName') || 'Builder'; };

    const LESSON_CONFIG = {
      id: 'biz-90-percent-trap',
      title: 'The 90% Trap',
      description: 'Why most businesses operate on expensive guesswork',
      accentColor: '#EF4444',
      duration: '5 min',
      nextLesson: { id: 'biz-animal-mindset', title: 'The Animal Mindset', teaser: 'Relentless action beats perfect strategy.' }
    };

    const celebrationGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_doing_a_quick_victory_dance_move_high_energy_c_d03b798b-a518-4e6c-bcae-d69b2dd50486_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_jumping_in_the_air_arms_raised_high_YESSS_cele_201477e8-3df4-405a-bc81-81d1747e5c6c_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_playing_air_guitar_light_headbanging_rockstar__0702007e-9e84-4d9e-8f99-8ee23d0b65f8_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_doing_the_running_man_dance_move_vintage_cool__25682b0f-cf4c-4e93-8dcb-6c3dac8135cd_0.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_standing_and_clapping_enthusiastically_mouth_o_992ac4fd-9a0e-4963-bbcc-a5271f25f4fd_3.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_clapping_very_fast_huge_smile_extreme_exciteme_9a4dde09-55ca-4173-a47d-613bc2924230_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_clapping_above_head_world_champion_celebration_484bd560-f049-41ca-b3d1-c03d7468ab56_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_starting_with_slow_clap_accelerating_to_fast_c_ee478a38-0ee7-437d-bd13-d687f7dd624a_0.mp4'
    ];
    const getRandomCelebrationGif = () => celebrationGifs[Math.floor(Math.random() * celebrationGifs.length)];

    const empathyGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_thumbs_down_with_encouraging_nod_close_keep_go_613e541f-c072-436f-aee7-f99cd6f834fc_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_shaking_head_side_to_side_sadly_disappointed_e_c4a4be22-6a70-4738-8612-3039454fef37_1.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_covering_face_with_palm_facepalm_gesture_disap_211b0566-078f-4d42-9c41-547b14f5827c_0.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_looking_down_sadly_shoulders_slumped_disappoin_790d48bd-e49e-40ea-9979-d3e86fa3a422_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_wiping_away_a_small_tear_sad_but_gentle_disapp_8d78571b-3c36-4502-abee-81683255843c_1.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_sighing_sadly_exhaling_with_disappointment_hea_f6014f2a-3a99-4378-a2a8-414e16b3e72d_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_slouching_with_disappointment_body_curling_inw_caedddbe-413c-492a-9fdf-1e8433f5e2a8_2%20(1).mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_placing_hand_on_forehead_sadly_eyes_closed_fru_3e048895-f365-4ff2-9e88-0d0a35b2a9e1_3.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_nodding_slowly_with_sadness_what_a_shame_expre_377f67ca-63da-41aa-9072-4926fc2f6e82_3.mp4'
    ];
    const getRandomEmpathyGif = () => empathyGifs[Math.floor(Math.random() * empathyGifs.length)];

    const slides = [
      { type: 'welcome', learningGoals: ['Why 90% of businesses fail to scale', 'The single number that separates winners', 'How to escape the guesswork trap'] },
      { type: 'hook', headline: '90% of businesses make every decision on gut feeling.', subtext: 'They guess which products to launch. They guess how much to spend on ads. They guess if a customer is profitable. Meanwhile, the top 1% operate like casinos. They know their odds. They know their numbers. They know exactly what a customer is worth. Guess who wins?' },
      { type: 'trap-visual', title: 'The 90% Trap', subtitle: 'Most founders are playing blind.' },
      { type: 'content', title: 'The Expensive Guessing Game', body: 'Here is how most businesses operate: They look at revenue. If revenue goes up, they feel good. If revenue goes down, they panic. They never dig deeper. They never ask: "Was that sale actually profitable?" They spend $100 to acquire a customer who buys once for $50 and never returns. They call that growth. It is not growth. It is a slow death disguised as progress.' },
      { type: 'comparison-cards', title: 'Two Types of Business Owners', left: { label: 'THE 90%', iconComponent: 'Dice', value: '90%', subtext: 'of businesses', percentage: 'Guessing', items: ['Make decisions on gut feeling', 'Celebrate revenue without profit', 'No idea what a customer is worth', 'React to problems too late'], color: 'red' }, right: { label: 'THE 1%', iconComponent: 'Target', value: '1%', subtext: 'of businesses', percentage: 'Calculating', items: ['Make decisions on data', 'Know exact customer profitability', 'Track LTV:CAC religiously', 'See problems before they hit'], color: 'green' } },
      { type: 'math-breakdown', title: 'The Math They Never Teach You', scenarios: [
        { label: 'What you think:', cost: '$50 ad spend', result: '$75 sale', profit: '+$25 profit', icon: 'smile', color: '#22C55E' },
        { label: 'What is real:', cost: '$50 ads + $20 COGS + $15 shipping + $10 returns', result: '$75 sale', profit: '-$20 loss', icon: 'frown', color: '#EF4444' }
      ], insight: 'Most "profitable" sales are actually losses. You just cannot see it.' },
      { type: 'stat-countdown', title: 'The Numbers That Matter', stats: [
        { value: 90, suffix: '%', label: 'Operate on Guesswork', subtext: 'Making expensive blind bets' },
        { value: 67, suffix: '%', label: 'Do Not Know Their CAC', subtext: 'Flying completely blind' },
        { value: 1, suffix: '%', label: 'Know LTV:CAC Ratio', subtext: 'The math-driven elite' }
      ]},
      { type: 'content', title: 'The One Number That Changes Everything', body: 'There is one ratio that separates struggling stores from 8-figure brands: LTV:CAC. Lifetime Value divided by Customer Acquisition Cost. It tells you exactly how much you can spend to acquire a customer and still make money. Without it, you are gambling. With it, you are investing. The best businesses know this number down to the penny.' , characterVideo: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_calculating_numbers_with_calculator_100_pure_w_b930553b-32c0-4367-bcc5-c1b2c51a9318_2.mp4', characterPosition: 'right'},
      { type: 'ratio-visual', title: 'LTV:CAC - Your North Star', ratios: [
        { label: 'Below 1:1', value: '0.8:1', description: 'Losing money on every customer', color: '#EF4444', status: 'danger' },
        { label: 'Survival', value: '1.5:1', description: 'Breaking even after overhead', color: '#F59E0B', status: 'warning' },
        { label: 'Healthy', value: '3:1', description: 'The golden ratio for growth', color: '#22C55E', status: 'good' },
        { label: 'Scaling', value: '5:1', description: 'Ready to pour fuel on fire', color: '#3B82F6', status: 'excellent' }
      ]},
      { type: 'before-after', title: 'Before vs After Knowing Your Numbers', before: [
        '"I think we\'re profitable"',
        'Spending based on gut feeling',
        'Panic when cash flow dips',
        'No idea which customers matter',
        'Celebrating vanity metrics'
      ], after: [
        '"We know our exact margins"',
        'Spending based on LTV:CAC',
        'Predicting cash flow 6 months out',
        'Doubling down on best customers',
        'Tracking profit per customer'
      ]},
      { type: 'strategy-steps', title: 'Escape The 90% Trap', steps: [
        { number: 1, title: 'CALCULATE CAC', icon: 'Calculator', color: '#EF4444', description: 'Add up ALL costs to acquire a customer: ad spend, creative costs, agency fees, discounts given. Divide by number of customers acquired. This is your true CAC.' },
        { number: 2, title: 'MEASURE LTV', icon: 'DollarSign', color: '#F59E0B', description: 'Track what customers actually spend over time, not just first purchase. Include repeat orders, upsells, referrals. Use DataDrew to see real LTV by segment.' },
        { number: 3, title: 'HIT 3:1 RATIO', icon: 'Target', color: '#22C55E', description: 'Your LTV should be 3x your CAC minimum. Below that, you are funding losses. Above that, you can scale aggressively. This is your green light.' }
      ]},
      { type: 'tool-integration', title: 'See Your Real Numbers', subtitle: 'Stop guessing. Start knowing.', tool: { name: 'DataDrew', description: 'Free Shopify app that shows your true LTV and customer segments', image: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/46.webp', link: 'https://apps.shopify.com/customer-lifetime-value?mref=lsbqcbva', features: ['See real LTV by customer segment', 'Identify your most profitable customers', 'Track repeat purchase rates', '100% free - no credit card'] } },
      { type: 'highlight-box', title: 'The 1% Advantage', body: 'The top 1% of businesses do not have better products. They do not have more money. They do not have secret tactics. They have one thing: clarity. They know exactly what a customer is worth, exactly what it costs to get one, and exactly when to scale or pull back. While everyone else guesses, they calculate. While everyone else reacts, they predict. This is not about being smarter. It is about knowing your numbers.', highlight: 'While everyone else guesses, they calculate. While everyone else reacts, they predict.' },
      { type: 'quiz', question: 'What ratio do the top 1% of businesses track religiously?', options: ['Revenue to expense ratio', 'LTV:CAC ratio', 'Click-through rate', 'Social media engagement'], correctIndex: 1, feedback: { correct: 'Exactly. LTV:CAC is the single most important ratio in business. It tells you if you are building a money machine or funding a money pit. The top 1% know this number by heart. Now you do too.', incorrect: 'Not quite. The answer is LTV:CAC ratio. This single number tells you if your business model actually works. If LTV is 3x CAC or higher, you have a license to grow. Below that, every new customer could be a loss in disguise.' }},
      { type: 'completion', sources: [] }
    ];

    // Icons
    const Icons = {
      Clock: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
      Check: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><polyline points="20 6 9 17 4 12"/></svg>,
      X: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
      ArrowLeft: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>,
      ArrowRight: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>,
      Zap: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
      ExternalLink: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>,
      Target: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>,
      Dice: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><circle cx="8.5" cy="8.5" r="1.5" fill={color}/><circle cx="15.5" cy="8.5" r="1.5" fill={color}/><circle cx="15.5" cy="15.5" r="1.5" fill={color}/><circle cx="8.5" cy="15.5" r="1.5" fill={color}/></svg>,
      Calculator: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="4" y="2" width="16" height="20" rx="2"/><line x1="8" y1="6" x2="16" y2="6"/><line x1="8" y1="10" x2="8" y2="10"/><line x1="12" y1="10" x2="12" y2="10"/><line x1="16" y1="10" x2="16" y2="10"/><line x1="8" y1="14" x2="8" y2="14"/><line x1="12" y1="14" x2="12" y2="14"/><line x1="16" y1="14" x2="16" y2="14"/><line x1="8" y1="18" x2="8" y2="18"/><line x1="12" y1="18" x2="12" y2="18"/><line x1="16" y1="18" x2="16" y2="18"/></svg>,
      DollarSign: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>,
      AlertTriangle: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>,
      Eye: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>,
      EyeOff: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/></svg>,
      Smile: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/></svg>,
      Frown: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="M16 16s-1.5-2-4-2-4 2-4 2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/></svg>,
    };

    // Animated Counter
    const AnimatedCounter = ({ target, suffix = '', prefix = '', duration = 2000 }) => {
      const [count, setCount] = useState(0);
      useEffect(() => {
        let start = 0;
        const increment = target / (duration / 16);
        const timer = setInterval(() => {
          start += increment;
          if (start >= target) { setCount(target); clearInterval(timer); }
          else { setCount(Math.floor(start)); }
        }, 16);
        return () => clearInterval(timer);
      }, [target, duration]);
      return <span>{prefix}{count}{suffix}</span>;
    };

    // 90% Trap Visual
    const TrapVisualSlide = ({ data }) => {
      const [animated, setAnimated] = useState(false);
      useEffect(() => { const timer = setTimeout(() => setAnimated(true), 300); return () => clearTimeout(timer); }, []);

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-8 slide-scroll overflow-y-auto">
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
            <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-4" style={{ background: 'rgba(var(--accent-rgb), 0.1)', color: 'var(--accent)' }}>
              <Icons.AlertTriangle size={14} color="var(--accent)" />
              <span>The Problem</span>
            </div>
            <h2 className="slide-title text-2xl md:text-3xl lg:text-4xl text-black mb-2">{data.title}</h2>
            <p className="text-neutral-500 text-sm">{data.subtitle}</p>
          </motion.div>

          <motion.div initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.2 }} className="rounded-2xl p-8 md:p-12 relative overflow-hidden" style={{ background: 'linear-gradient(135deg, #0a0a0a 0%, #111 50%, #0a0a0a 100%)', border: '1px solid #333', boxShadow: '0 0 60px rgba(var(--accent-rgb), 0.15), inset 0 1px 0 rgba(255,255,255,0.05)' }}>
              {/* Subtle grid pattern */}
              <div className="absolute inset-0 opacity-[0.03]" style={{ backgroundImage: 'radial-gradient(circle at 1px 1px, white 1px, transparent 1px)', backgroundSize: '24px 24px' }} />
            <div className="flex flex-col md:flex-row items-center justify-center gap-8 md:gap-16">
              {/* 90% - Guessing */}
              <div className="text-center">
                <motion.div
                  className="relative w-40 h-40 md:w-48 md:h-48 mx-auto mb-4"
                  initial={{ opacity: 0 }}
                  animate={{ opacity: 1 }}
                  transition={{ delay: 0.4 }}
                >
                  <svg viewBox="0 0 100 100" className="w-full h-full">
                    <circle cx="50" cy="50" r="45" fill="none" stroke="#1f1f1f" strokeWidth="8" />
                    <motion.circle
                      cx="50" cy="50" r="45"
                      fill="none"
                      stroke="#EF4444"
                      strokeWidth="8"
                      strokeLinecap="round"
                      strokeDasharray={283}
                      initial={{ strokeDashoffset: 283 }}
                      animate={animated ? { strokeDashoffset: 283 * 0.1 } : {}}
                      transition={{ duration: 1.5, ease: 'easeOut' }}
                      style={{ transform: 'rotate(-90deg)', transformOrigin: '50% 50%', filter: 'drop-shadow(0 0 15px rgba(239, 68, 68, 0.7)) drop-shadow(0 0 30px rgba(239, 68, 68, 0.4))' }}
                    />
                  </svg>
                  <div className="absolute inset-0 flex flex-col items-center justify-center">
                    <span className="text-4xl md:text-5xl font-bold text-white">90%</span>
                    <span className="text-xs text-red-400 uppercase tracking-wider mt-1">Guessing</span>
                  </div>
                </motion.div>
                <div className="flex items-center justify-center gap-2 text-neutral-400">
                  <Icons.EyeOff size={16} color="#EF4444" />
                  <span className="text-sm">Flying blind</span>
                </div>
              </div>

              {/* VS */}
              <motion.div
                initial={{ opacity: 0, scale: 0 }}
                animate={{ opacity: 1, scale: 1 }}
                transition={{ delay: 0.8, type: 'spring', stiffness: 200 }}
                className="relative"
              >
                <div className="text-3xl font-black text-white uppercase tracking-widest" style={{ textShadow: '0 0 20px rgba(255,255,255,0.3), 0 0 40px rgba(255,255,255,0.1)' }}>vs</div>
                <div className="absolute inset-0 blur-xl opacity-30 bg-white rounded-full" />
              </motion.div>

              {/* 1% - Calculating */}
              <div className="text-center">
                <motion.div
                  className="relative w-40 h-40 md:w-48 md:h-48 mx-auto mb-4"
                  initial={{ opacity: 0 }}
                  animate={{ opacity: 1 }}
                  transition={{ delay: 0.6 }}
                >
                  <svg viewBox="0 0 100 100" className="w-full h-full">
                    <circle cx="50" cy="50" r="45" fill="none" stroke="#1f1f1f" strokeWidth="8" />
                    <motion.circle
                      cx="50" cy="50" r="45"
                      fill="none"
                      stroke="#22C55E"
                      strokeWidth="8"
                      strokeLinecap="round"
                      strokeDasharray={283}
                      initial={{ strokeDashoffset: 283 }}
                      animate={animated ? { strokeDashoffset: 283 * 0.99 } : {}}
                      transition={{ duration: 1.5, ease: 'easeOut', delay: 0.3 }}
                      style={{ transform: 'rotate(-90deg)', transformOrigin: '50% 50%', filter: 'drop-shadow(0 0 15px rgba(34, 197, 94, 0.7)) drop-shadow(0 0 30px rgba(34, 197, 94, 0.4))' }}
                    />
                  </svg>
                  <div className="absolute inset-0 flex flex-col items-center justify-center">
                    <span className="text-4xl md:text-5xl font-bold text-white">1%</span>
                    <span className="text-xs text-green-400 uppercase tracking-wider mt-1">Calculating</span>
                  </div>
                </motion.div>
                <div className="flex items-center justify-center gap-2 text-neutral-400">
                  <Icons.Eye size={16} color="#22C55E" />
                  <span className="text-sm">Crystal clear</span>
                </div>
              </div>
            </div>
          </motion.div>

          <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 1.2 }} className="text-center text-neutral-600 text-sm mt-6 max-w-md mx-auto">
            Which group are you in?
          </motion.p>
        </div>
      );
    };

    // Math Breakdown Slide
    const MathBreakdownSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto py-8 slide-scroll overflow-y-auto">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
          <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-4" style={{ background: 'rgba(var(--accent-rgb), 0.1)', color: 'var(--accent)' }}>
            <Icons.Calculator size={14} color="var(--accent)" />
            <span>Reality Check</span>
          </div>
          <h2 className="slide-title text-2xl md:text-3xl text-black mb-2">{data.title}</h2>
        </motion.div>

        <div className="space-y-6 mb-8">
          {data.scenarios.map((scenario, i) => (
            <motion.div
              key={i}
              initial={{ opacity: 0, x: i === 0 ? -30 : 30 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ delay: 0.2 + i * 0.3 }}
              className="rounded-xl p-6 relative overflow-hidden"
              style={{ background: '#0a0a0a', border: `1px solid ${scenario.color}30` }}
            >
              <div className="flex items-start gap-4">
                <div className="w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0" style={{ background: `${scenario.color}20` }}>
                  {scenario.icon === 'smile' ? <Icons.Smile size={24} color={scenario.color} /> : <Icons.Frown size={24} color={scenario.color} />}
                </div>
                <div className="flex-grow">
                  <div className="text-sm text-neutral-400 mb-2">{scenario.label}</div>
                  <div className="text-white text-sm mb-3 font-mono" style={{ background: '#1a1a1a', padding: '12px', borderRadius: '8px' }}>
                    {scenario.cost}
                  </div>
                  <div className="flex items-center justify-between">
                    <span className="text-neutral-400 text-sm">{scenario.result}</span>
                    <span className="text-xl font-bold" style={{ color: scenario.color }}>{scenario.profit}</span>
                  </div>
                </div>
              </div>
            </motion.div>
          ))}
        </div>

        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.9 }} className="rounded-xl p-4 text-center" style={{ background: 'linear-gradient(135deg, rgba(var(--accent-rgb), 0.1), rgba(var(--accent-rgb), 0.05))', border: '1px solid rgba(var(--accent-rgb), 0.2)' }}>
          <p className="text-neutral-700 text-sm font-medium">{data.insight}</p>
        </motion.div>
      </div>
    );

    // Ratio Visual Slide
    const RatioVisualSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto py-8 slide-scroll overflow-y-auto">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
          <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-4" style={{ background: 'rgba(var(--accent-rgb), 0.1)', color: 'var(--accent)' }}>
            <Icons.Target size={14} color="var(--accent)" />
            <span>The Key Metric</span>
          </div>
          <h2 className="slide-title text-2xl md:text-3xl text-black">{data.title}</h2>
        </motion.div>

        <div className="space-y-4">
          {data.ratios.map((ratio, i) => (
            <motion.div
              key={i}
              initial={{ opacity: 0, x: -30 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ delay: 0.15 + i * 0.1 }}
              className="rounded-xl p-5 relative overflow-hidden"
              style={{ background: '#0a0a0a', border: `1px solid ${ratio.color}30` }}
            >
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-16 text-center">
                    <span className="text-2xl font-bold" style={{ color: ratio.color }}>{ratio.value}</span>
                  </div>
                  <div>
                    <div className="text-white font-medium text-sm">{ratio.label}</div>
                    <div className="text-neutral-500 text-xs">{ratio.description}</div>
                  </div>
                </div>
                <div className="px-3 py-1 rounded-full text-xs font-bold uppercase" style={{ background: `${ratio.color}20`, color: ratio.color }}>
                  {ratio.status}
                </div>
              </div>
              {/* Progress bar */}
              <div className="mt-3 h-2 rounded-full overflow-hidden" style={{ background: '#1f1f1f' }}>
                <motion.div
                  className="h-full rounded-full"
                  initial={{ width: 0 }}
                  animate={{ width: `${(parseFloat(ratio.value) / 5) * 100}%` }}
                  transition={{ duration: 1, delay: 0.3 + i * 0.1 }}
                  style={{ background: ratio.color, boxShadow: `0 0 10px ${ratio.color}50` }}
                />
              </div>
            </motion.div>
          ))}
        </div>
      </div>
    );

    // Comparison Cards Slide
    const ComparisonCardsSlide = ({ data }) => {
      const IconComponent = (name, color) => {
        const iconMap = { Dice: Icons.Dice, Target: Icons.Target };
        const Icon = iconMap[name] || Icons.Target;
        return <Icon size={28} color={color} />;
      };

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-8 slide-scroll overflow-y-auto">
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
            <h2 className="slide-title text-2xl md:text-3xl text-black">{data.title}</h2>
          </motion.div>

          <div className="grid md:grid-cols-2 gap-6">
            {/* Left Card - 90% */}
            <motion.div initial={{ opacity: 0, x: -30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.2 }} className="rounded-2xl p-6 relative overflow-hidden" style={{ background: 'linear-gradient(135deg, #0a0a0a 0%, #1a0a0a 100%)', border: '1px solid rgba(239, 68, 68, 0.4)', boxShadow: '0 0 40px rgba(239, 68, 68, 0.1), inset 0 1px 0 rgba(255,255,255,0.03)' }}>
              <div className="absolute top-0 right-0 w-32 h-32 rounded-full blur-3xl opacity-20" style={{ background: '#EF4444', transform: 'translate(30%, -30%)' }} />
              <div className="flex items-center gap-3 mb-4">
                <div className="w-12 h-12 rounded-xl flex items-center justify-center" style={{ background: 'rgba(239, 68, 68, 0.15)', boxShadow: '0 0 20px rgba(239, 68, 68, 0.2)' }}>
                  {IconComponent(data.left.iconComponent, '#EF4444')}
                </div>
                <div>
                  <span className="text-xs text-red-400 font-semibold uppercase tracking-wider">{data.left.label}</span>
                  <div className="text-2xl font-bold text-white">{data.left.value}</div>
                </div>
              </div>
              <p className="text-neutral-400 text-sm mb-4">{data.left.subtext}</p>
              <div className="space-y-2">
                {data.left.items.map((item, i) => (
                  <motion.div key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.4 + i * 0.1 }} className="flex items-center gap-2 text-sm">
                    <span className="text-red-500"><Icons.X /></span>
                    <span className="text-neutral-300">{item}</span>
                  </motion.div>
                ))}
              </div>
            </motion.div>

            {/* Right Card - 1% */}
            <motion.div initial={{ opacity: 0, x: 30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.3 }} className="rounded-2xl p-6 relative overflow-hidden" style={{ background: 'linear-gradient(135deg, #0a0a0a 0%, #0a1a0a 100%)', border: '1px solid rgba(34, 197, 94, 0.5)', boxShadow: '0 0 50px rgba(34, 197, 94, 0.15), inset 0 1px 0 rgba(255,255,255,0.03)' }}>
              <div className="absolute top-0 right-0 w-40 h-40 rounded-full blur-3xl opacity-20" style={{ background: '#22C55E', transform: 'translate(30%, -30%)' }} />
              <div className="flex items-center gap-3 mb-4">
                <div className="w-12 h-12 rounded-xl flex items-center justify-center" style={{ background: 'rgba(34, 197, 94, 0.15)', boxShadow: '0 0 25px rgba(34, 197, 94, 0.25)' }}>
                  {IconComponent(data.right.iconComponent, '#22C55E')}
                </div>
                <div>
                  <span className="text-xs text-green-400 font-semibold uppercase tracking-wider">{data.right.label}</span>
                  <div className="text-2xl font-bold text-white">{data.right.value}</div>
                </div>
              </div>
              <p className="text-neutral-400 text-sm mb-4">{data.right.subtext}</p>
              <div className="space-y-2">
                {data.right.items.map((item, i) => (
                  <motion.div key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.5 + i * 0.1 }} className="flex items-center gap-2 text-sm">
                    <span className="text-green-500"><Icons.Check /></span>
                    <span className="text-neutral-300">{item}</span>
                  </motion.div>
                ))}
              </div>
            </motion.div>
          </div>
        </div>
      );
    };

    // Stat Countdown Slide
    const StatCountdownSlide = ({ data }) => {
      const getCardStyle = (index) => {
        const styles = [
          { // 90% - Danger (red)
            background: 'linear-gradient(135deg, #0a0a0a 0%, #1a0808 100%)',
            border: '1px solid rgba(239, 68, 68, 0.4)',
            boxShadow: '0 0 40px rgba(239, 68, 68, 0.1), inset 0 1px 0 rgba(255,255,255,0.03)',
            color: '#EF4444',
            glowColor: '#EF4444'
          },
          { // 67% - Warning (orange)
            background: 'linear-gradient(135deg, #0a0a0a 0%, #1a1008 100%)',
            border: '1px solid rgba(245, 158, 11, 0.4)',
            boxShadow: '0 0 40px rgba(245, 158, 11, 0.1), inset 0 1px 0 rgba(255,255,255,0.03)',
            color: '#F59E0B',
            glowColor: '#F59E0B'
          },
          { // 1% - Success (green)
            background: 'linear-gradient(135deg, #0a0a0a 0%, #081a08 100%)',
            border: '1px solid rgba(34, 197, 94, 0.5)',
            boxShadow: '0 0 50px rgba(34, 197, 94, 0.15), inset 0 1px 0 rgba(255,255,255,0.03)',
            color: '#22C55E',
            glowColor: '#22C55E'
          }
        ];
        return styles[index] || styles[0];
      };

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-8 slide-scroll overflow-y-auto">
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-10">
            <h2 className="slide-title text-2xl md:text-3xl text-black">{data.title}</h2>
          </motion.div>

          <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
            {data.stats.map((stat, i) => {
              const cardStyle = getCardStyle(i);
              return (
                <motion.div
                  key={i}
                  initial={{ opacity: 0, y: 40 }}
                  animate={{ opacity: 1, y: 0 }}
                  transition={{ delay: 0.2 + i * 0.15 }}
                  className="rounded-2xl p-6 text-center relative overflow-hidden"
                  style={{ background: cardStyle.background, border: cardStyle.border, boxShadow: cardStyle.boxShadow }}
                >
                  {/* Corner glow effect */}
                  <div className="absolute top-0 right-0 w-24 h-24 rounded-full blur-3xl opacity-20" style={{ background: cardStyle.glowColor, transform: 'translate(30%, -30%)' }} />

                  <div className="text-5xl md:text-6xl font-bold mb-2 relative" style={{ color: cardStyle.color, textShadow: `0 0 30px ${cardStyle.glowColor}40` }}>
                    <AnimatedCounter target={stat.value} suffix={stat.suffix} duration={2000 + i * 500} />
                  </div>
                  <div className="text-white font-medium mb-1 relative">{stat.label}</div>
                  <div className="text-neutral-500 text-sm relative">{stat.subtext}</div>
                </motion.div>
              );
            })}
          </div>
        </div>
      );
    };

    // Before/After Slide
    const BeforeAfterSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-8 slide-scroll overflow-y-auto">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
          <h2 className="slide-title text-2xl md:text-3xl text-black">{data.title}</h2>
        </motion.div>

        <div className="grid md:grid-cols-2 gap-6">
          {/* Before */}
          <motion.div initial={{ opacity: 0, x: -30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.2 }} className="rounded-2xl p-6" style={{ background: '#0a0a0a', border: '1px solid rgba(239, 68, 68, 0.3)' }}>
            <div className="flex items-center gap-2 mb-4">
              <div className="w-8 h-8 rounded-full flex items-center justify-center" style={{ background: 'rgba(239, 68, 68, 0.2)' }}>
                <span className="text-red-500"><Icons.X /></span>
              </div>
              <span className="text-red-400 font-semibold uppercase text-sm tracking-wider">Before</span>
            </div>
            <div className="space-y-3">
              {data.before.map((item, i) => (
                <motion.div key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.3 + i * 0.1 }} className="flex items-start gap-3 text-neutral-300 text-sm">
                  <span className="text-red-500 mt-0.5">-</span>
                  <span>{item}</span>
                </motion.div>
              ))}
            </div>
          </motion.div>

          {/* After */}
          <motion.div initial={{ opacity: 0, x: 30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.3 }} className="rounded-2xl p-6" style={{ background: '#0a0a0a', border: '1px solid rgba(34, 197, 94, 0.3)', boxShadow: '0 0 30px rgba(34, 197, 94, 0.1)' }}>
            <div className="flex items-center gap-2 mb-4">
              <div className="w-8 h-8 rounded-full flex items-center justify-center" style={{ background: 'rgba(34, 197, 94, 0.2)' }}>
                <span className="text-green-500"><Icons.Check /></span>
              </div>
              <span className="text-green-400 font-semibold uppercase text-sm tracking-wider">After</span>
            </div>
            <div className="space-y-3">
              {data.after.map((item, i) => (
                <motion.div key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.4 + i * 0.1 }} className="flex items-start gap-3 text-neutral-300 text-sm">
                  <span className="text-green-500 mt-0.5">+</span>
                  <span>{item}</span>
                </motion.div>
              ))}
            </div>
          </motion.div>
        </div>
      </div>
    );

    // Strategy Steps Slide
    const StrategyStepsSlide = ({ data }) => {
      const IconComponent = (name, color) => {
        const iconMap = { Calculator: Icons.Calculator, DollarSign: Icons.DollarSign, Target: Icons.Target };
        const Icon = iconMap[name] || Icons.Target;
        return <Icon size={24} color={color} />;
      };

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-8 slide-scroll overflow-y-auto">
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
            <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-4" style={{ background: 'rgba(var(--accent-rgb), 0.1)', color: 'var(--accent)' }}>
              <Icons.Zap />
              <span>The Escape Plan</span>
            </div>
            <h2 className="slide-title text-2xl md:text-3xl text-black">{data.title}</h2>
          </motion.div>

          <div className="space-y-4">
            {data.steps.map((step, i) => (
              <motion.div key={i} initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 + i * 0.15 }} className="rounded-xl p-5 relative overflow-hidden" style={{ background: '#0a0a0a', border: `1px solid ${step.color}30` }}>
                <div className="flex items-start gap-4">
                  <div className="w-14 h-14 rounded-xl flex items-center justify-center flex-shrink-0 relative" style={{ background: `${step.color}15` }}>
                    {IconComponent(step.icon, step.color)}
                    <div className="absolute -top-2 -right-2 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold text-white" style={{ background: step.color }}>
                      {step.number}
                    </div>
                  </div>
                  <div>
                    <h3 className="text-white font-bold mb-1" style={{ color: step.color }}>{step.title}</h3>
                    <p className="text-neutral-400 text-sm leading-relaxed">{step.description}</p>
                  </div>
                </div>
              </motion.div>
            ))}
          </div>
        </div>
      );
    };

    // Tool Integration Slide
    const ToolIntegrationSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto py-8 slide-scroll overflow-y-auto">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
          <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-4" style={{ background: 'rgba(var(--accent-rgb), 0.1)', color: 'var(--accent)' }}>
            <Icons.Zap />
            <span>Recommended Tool</span>
          </div>
          <h2 className="slide-title text-2xl md:text-3xl text-black mb-2">{data.title}</h2>
          <p className="text-neutral-500 text-sm">{data.subtitle}</p>
        </motion.div>

        <motion.div initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.2 }} className="rounded-2xl p-6 md:p-8" style={{ background: '#0a0a0a', border: '1px solid #222' }}>
          <div className="flex flex-col md:flex-row gap-6 items-center">
            <div className="w-full md:w-2/5">
              <img src={data.tool.image} alt={data.tool.name} className="w-full rounded-xl" style={{ border: '1px solid #333' }} />
            </div>
            <div className="w-full md:w-3/5">
              <h3 className="text-2xl font-bold text-white mb-2">{data.tool.name}</h3>
              <p className="text-neutral-400 text-sm mb-4">{data.tool.description}</p>
              <div className="space-y-2 mb-6">
                {data.tool.features.map((feature, i) => (
                  <motion.div key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.4 + i * 0.1 }} className="flex items-center gap-2 text-sm">
                    <span className="text-green-500"><Icons.Check /></span>
                    <span className="text-neutral-300">{feature}</span>
                  </motion.div>
                ))}
              </div>
              <a href={data.tool.link} target="_blank" rel="noopener noreferrer" className="inline-flex items-center gap-2 px-5 py-3 rounded-xl font-semibold text-white text-sm transition-all hover:scale-105" style={{ background: 'linear-gradient(135deg, var(--accent), var(--accent-dark))' }}>
                Get {data.tool.name} Free
                <Icons.ExternalLink />
              </a>
            </div>
          </div>
        </motion.div>
      </div>
    );

    // Highlight Box Slide
    const HighlightBoxSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-8 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-10">
        <motion.h2 initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl lg:text-4xl text-black mb-6 relative z-10">{data.title}</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-base md:text-lg text-neutral-600 leading-relaxed mb-6">{data.body}</motion.p>
        <motion.div initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.2 }} className="rounded-xl p-6 text-center" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>
          <p className="text-white text-lg font-bold">{data.highlight}</p>
        </motion.div>
      </div>
    );

    // Content Slide
    const ContentSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-8 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-10">
        <motion.h2 initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl lg:text-4xl text-black mb-6 relative z-10">{data.title}</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-base md:text-lg text-neutral-600 leading-relaxed relative z-10">{data.body}</motion.p>
      
        {data.characterVideo && (
          <motion.div
            initial={{ opacity: 0, y: 40 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.4, duration: 0.6 }}
            className={`absolute bottom-0 ${data.characterPosition === 'left' ? 'left-6' : 'right-6'} z-0 pointer-events-none`}
            style={{ height: '35%', maxHeight: '280px' }}>
            <video autoPlay loop muted playsInline className="h-full w-auto object-contain object-bottom">
              <source src={data.characterVideo} type="video/mp4" />
            </video>
          </motion.div>
        )}
      </div>
    );

    // Hook Slide
    const HookSlide = ({ data }) => (
      <div className="h-full relative overflow-hidden">
        <div className="h-full flex flex-col justify-center px-8 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-10 relative z-10">
          <motion.div initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} className="mb-6">
            <span className="inline-block px-3 py-1 rounded-full text-xs font-semibold mb-4" style={{ background: `rgba(var(--accent-rgb), 0.1)`, color: 'var(--accent)' }}>The Hook</span>
            <h2 className="slide-title text-3xl md:text-4xl lg:text-5xl text-black leading-tight">{data.headline}</h2>
          </motion.div>
          <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="text-lg md:text-xl text-neutral-600 leading-relaxed">{data.subtext}</motion.p>
        </div>
        {data.brandImage && (
          <motion.div initial={{ opacity: 0, x: 30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.3, duration: 0.5 }}
            className="absolute bottom-0 right-0 z-0 pointer-events-none" style={{ height: '30%', maxHeight: '200px', marginRight: '3%', marginBottom: '5%' }}>
            <img src={data.brandImage} alt={data.brandName || ''} className="h-full w-auto object-contain" style={{ opacity: 1 }} />
          </motion.div>
        )}
      </div>
    );
      const currentSlideRef = React.useRef(0);
      const [gifConfig, setGifConfig] = useState(null);
      const [isAnimating, setIsAnimating] = useState(false);

      const showGif = useCallback((url, height, side) => setGifConfig({ url, height, side }), []);
      const hideGif = useCallback(() => setGifConfig(null), []);

      React.useEffect(() => { currentSlideRef.current = currentSlide; }, [currentSlide]);

      const goToSlide = useCallback((newSlide) => {
        if (isAnimating || newSlide < 0 || newSlide >= slides.length) return;
        setIsAnimating(true);
        setDirection(newSlide > currentSlideRef.current ? 1 : -1);
        setCurrentSlide(newSlide);
      }, [isAnimating]);

      const nextSlide = useCallback(() => { if (currentSlideRef.current + 1 < slides.length) goToSlide(currentSlideRef.current + 1); }, [goToSlide]);
      const prevSlide = useCallback(() => { if (currentSlideRef.current - 1 >= 0) goToSlide(currentSlideRef.current - 1); }, [goToSlide]);

      useEffect(() => {
        const handleKeyDown = (e) => {
          if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); nextSlide(); }
          if (e.key === 'ArrowLeft') { e.preventDefault(); prevSlide(); }
        };
        window.addEventListener('keydown', handleKeyDown);
        return () => window.removeEventListener('keydown', handleKeyDown);
      }, [nextSlide, prevSlide]);

      const slideVariants = {
        enter: (dir) => ({ x: dir > 0 ? '100%' : '-100%', opacity: 0 }),
        center: { x: 0, opacity: 1 },
        exit: (dir) => ({ x: dir > 0 ? '-100%' : '100%', opacity: 0 })
      };

      const renderSlide = (slide) => {
        switch (slide.type) {
          case 'welcome': return <WelcomeSlide data={slide} onStart={nextSlide} userName={userName} onShowGif={showGif} onHideGif={hideGif} />;
          case 'hook': return <HookSlide data={slide} />;
          case 'trap-visual': return <TrapVisualSlide data={slide} />;
          case 'content': return <ContentSlide data={slide} />;
          case 'comparison-cards': return <ComparisonCardsSlide data={slide} />;
          case 'math-breakdown': return <MathBreakdownSlide data={slide} />;
          case 'stat-countdown': return <StatCountdownSlide data={slide} />;
          case 'ratio-visual': return <RatioVisualSlide data={slide} />;
          case 'before-after': return <BeforeAfterSlide data={slide} />;
          case 'strategy-steps': return <StrategyStepsSlide data={slide} />;
          case 'tool-integration': return <ToolIntegrationSlide data={slide} />;
          case 'highlight-box': return <HighlightBoxSlide data={slide} />;
          case 'quiz': return <QuizSlide data={slide} onShowGif={showGif} onHideGif={hideGif} />;
          case 'completion': return <CompletionSlide data={slide} />;
          default: return null;
        }
      };

      const showPrev = currentSlide > 0;
      const showNext = currentSlide < slides.length - 1 && slides[currentSlide].type !== 'welcome';

      return (
        <div className="w-full h-screen bg-white flex flex-col relative">
          <div className="flex-1 relative overflow-hidden z-20">
            <AnimatePresence mode="wait" custom={direction} onExitComplete={() => setIsAnimating(false)}>
              <motion.div key={currentSlide} custom={direction} variants={slideVariants} initial="enter" animate="center" exit="exit" transition={{ duration: 0.3, ease: [0.25, 0.1, 0.25, 1] }} className="absolute inset-0">
                {renderSlide(slides[currentSlide])}
              </motion.div>
            </AnimatePresence>
            {showPrev && <button onClick={prevSlide} className="absolute left-5 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-500 hover:text-neutral-700 transition-all z-10"><Icons.ArrowLeft /></button>}
            {showNext && <button onClick={nextSlide} className="absolute right-5 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-500 hover:text-neutral-700 transition-all z-10"><Icons.ArrowRight /></button>}
          </div>
          <div className="px-6 md:px-8 py-5 border-t border-neutral-100 flex-shrink-0 relative z-10">
            <div className="flex items-center justify-center gap-2.5">
              {slides.map((_, i) => <button key={i} onClick={() => goToSlide(i)} className="w-2.5 h-2.5 rounded-full transition-all duration-300" style={{ background: i === currentSlide ? 'var(--accent)' : '#d4d4d4', transform: i === currentSlide ? 'scale(1.3)' : 'scale(1)' }} />)}
            </div>
          </div>
          <AnimatePresence>
            {gifConfig && (
              <motion.div initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: 30 }} transition={{ type: 'spring', stiffness: 100 }} className={`absolute ${gifConfig.side === 'left' ? 'left-4 md:left-8' : 'right-4 md:right-8'} bottom-0 pointer-events-none`} style={{ zIndex: 15, height: gifConfig.height }}>
                <video autoPlay loop muted playsInline className="h-full w-auto object-contain object-bottom" style={{ background: 'transparent', border: 'none', boxShadow: 'none' }}>
                  <source src={gifConfig.url} type="video/mp4" />
                </video>
              </motion.div>
            )}
          </AnimatePresence>
        </div>
      );
    };

    ReactDOM.render(<LessonApp />, document.getElementById('root'));
  </script>
</body>
</html>
