<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Precise Price Trick | Quantum Scale</title>
  <script src="https://cdn.tailwindcss.com" defer></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" defer></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" defer></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js" defer></script>
  <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js" defer></script>
  <script src="../shared/greetings.js" defer></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://unpkg.com" crossorigin>
  <link rel="preconnect" href="https://cdn.tailwindcss.com" crossorigin>
  <link rel="preconnect" href="https://pqvvrljykfvhpyvxmwzb.supabase.co" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;500;600;700;800;900&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root { --accent: #10b981; --accent-dark: #059669; --accent-light: #34d399; --accent-rgb: 16, 185, 129; }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Inter', sans-serif; background: transparent; -webkit-font-smoothing: antialiased; }
    .title-font { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    h1, h2, h3, .slide-title { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    ::selection { background: var(--accent); color: white; }
    .slide-scroll::-webkit-scrollbar { display: none; }
    .slide-scroll { -ms-overflow-style: none; scrollbar-width: none; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { motion, AnimatePresence } = window.Motion;
    const { useState, useEffect, useCallback, useMemo } = React;

    const getUserName = () => { const params = new URLSearchParams(window.location.search); return params.get('userName') || 'Builder'; };
    const getInitialSlide = () => { const params = new URLSearchParams(window.location.search); const slide = params.get('slide'); return slide ? parseInt(slide, 10) : 0; };

    const LESSON_CONFIG = {
      id: 'precise-price-trick',
      title: 'The Precise Price Trick',
      description: 'Why $4,988 feels fairer than $5,000 - the psychology of specific numbers.',
      accentColor: '#10b981',
      duration: '5 min',
      nextLesson: { id: 'paradox-of-choice', title: 'The Paradox of Choice', teaser: 'Why Chipotle outsells Cheesecake Factory - and the conversion-killing mistake you are making.' }
    };

    // ============ ADMIN REPORTER SYSTEM ============
    let __isAdmin = false;
    window.addEventListener('message', function(e) {
      if (e.data?.type === 'ADMIN_STATUS') { __isAdmin = e.data.isAdmin; }
    });
    if (window.parent !== window) { window.parent.postMessage({ type: 'CHECK_ADMIN_STATUS' }, '*'); }

    const AdminSlideReportButton = ({ slideIndex, slideType }) => {
      const handleReport = (e) => {
        e.stopPropagation();
        e.preventDefault();
        if (window.parent !== window) {
          window.parent.postMessage({ type: 'ADMIN_REPORT_REQUEST', slideIndex, slideType, lessonSlug: LESSON_CONFIG.id, elementId: slideType + '-' + slideIndex }, '*');
        }
      };
      return (
        <button onClick={handleReport} title={`Report issue on Slide ${slideIndex + 1} (${slideType})`}
          style={{ position: 'absolute', top: '12px', right: '12px', width: '32px', height: '32px', borderRadius: '8px', backgroundColor: 'rgba(239, 68, 68, 0.9)', color: 'white', border: 'none', cursor: 'pointer', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 1000, opacity: 0.6, transition: 'opacity 0.2s, transform 0.2s', boxShadow: '0 2px 8px rgba(0,0,0,0.15)' }}
          onMouseEnter={(e) => { e.currentTarget.style.opacity = '1'; e.currentTarget.style.transform = 'scale(1.1)'; }}
          onMouseLeave={(e) => { e.currentTarget.style.opacity = '0.6'; e.currentTarget.style.transform = 'scale(1)'; }}>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="m8 2 1.88 1.88"/><path d="M14.12 3.88 16 2"/><path d="M9 7.13v-1a3.003 3.003 0 1 1 6 0v1"/><path d="M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6"/><path d="M12 20v-9"/><path d="M6.53 9C4.6 8.8 3 7.1 3 5"/><path d="M6 13H2"/><path d="M3 21c0-2.1 1.7-3.9 3.8-4"/><path d="M20.97 5c0 2.1-1.6 3.8-3.5 4"/><path d="M22 13h-4"/><path d="M17.2 17c2.1.1 3.8 1.9 3.8 4"/></svg>
        </button>
      );
    };
    // ============ END ADMIN REPORTER SYSTEM ============

    const celebrationGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_doing_a_quick_victory_dance_move_high_energy_c_d03b798b-a518-4e6c-bcae-d69b2dd50486_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_jumping_in_the_air_arms_raised_high_YESSS_cele_201477e8-3df4-405a-bc81-81d1747e5c6c_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_playing_air_guitar_light_headbanging_rockstar__0702007e-9e84-4d9e-8f99-8ee23d0b65f8_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_doing_the_running_man_dance_move_vintage_cool__25682b0f-cf4c-4e93-8dcb-6c3dac8135cd_0.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_standing_and_clapping_enthusiastically_mouth_o_992ac4fd-9a0e-4963-bbcc-a5271f25f4fd_3.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_clapping_very_fast_huge_smile_extreme_exciteme_9a4dde09-55ca-4173-a47d-613bc2924230_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_clapping_above_head_world_champion_celebration_484bd560-f049-41ca-b3d1-c03d7468ab56_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_starting_with_slow_clap_accelerating_to_fast_c_ee478a38-0ee7-437d-bd13-d687f7dd624a_0.mp4'
    ];
    const getRandomCelebrationGif = () => celebrationGifs[Math.floor(Math.random() * celebrationGifs.length)];

    const empathyGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_thumbs_down_with_encouraging_nod_close_keep_go_613e541f-c072-436f-aee7-f99cd6f834fc_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_shaking_head_side_to_side_sadly_disappointed_e_c4a4be22-6a70-4738-8612-3039454fef37_1.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_covering_face_with_palm_facepalm_gesture_disap_211b0566-078f-4d42-9c41-547b14f5827c_0.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_looking_down_sadly_shoulders_slumped_disappoin_790d48bd-e49e-40ea-9979-d3e86fa3a422_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_wiping_away_a_small_tear_sad_but_gentle_disapp_8d78571b-3c36-4502-abee-81683255843c_1.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_sighing_sadly_exhaling_with_disappointment_hea_f6014f2a-3a99-4378-a2a8-414e16b3e72d_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_slouching_with_disappointment_body_curling_inw_caedddbe-413c-492a-9fdf-1e8433f5e2a8_2%20(1).mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_placing_hand_on_forehead_sadly_eyes_closed_fru_3e048895-f365-4ff2-9e88-0d0a35b2a9e1_3.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_nodding_slowly_with_sadness_what_a_shame_expre_377f67ca-63da-41aa-9072-4926fc2f6e82_3.mp4'
    ];
    const getRandomEmpathyGif = () => empathyGifs[Math.floor(Math.random() * empathyGifs.length)];

    // ============ CONFIGURATION ARRAYS ============
    const PRICE_COMPARISON = {
      round: { price: '$5,000', thought: 'That feels like a guess. I bet the real price is lower. I will offer $4,500.', label: 'ROUND', color: '#94a3b8', result: 'INVITES NEGOTIATION' },
      precise: { price: '$4,988', thought: 'That looks calculated. Based on real costs. Not much room to negotiate.', label: 'PRECISE', color: '#10b981', result: 'COMMANDS RESPECT' }
    };

    const PRICE_PSYCHOLOGY = [
      { type: 'Round', example: '$5,000', perception: 'Arbitrary guess', behavior: 'Negotiate down', color: '#ef4444', icon: 'HelpCircle' },
      { type: 'Precise', example: '$4,988', perception: 'Calculated cost', behavior: 'Accept as fair', color: '#10b981', icon: 'Calculator' }
    ];

    const SWEET_SPOT_ENDINGS = [
      { ending: '7 or 8', example: '$X97', effect: 'Feels calculated, not cheap', status: 'good', color: '#10b981' },
      { ending: '3 or 4', example: '$X43', effect: 'Signals real cost math', status: 'good', color: '#10b981' },
      { ending: '00', example: '$X00', effect: 'Feels arbitrary', status: 'avoid', color: '#ef4444' }
    ];

    const WHEN_PRECISE = [
      { title: 'High-Ticket Items ($500+)', desc: 'The bigger the price, the more scrutiny. Precision signals you have done the math.', icon: 'DollarSign', color: '#10b981' },
      { title: 'B2B Proposals', desc: 'Business buyers negotiate. $14,750 vs $15,000 leaves less wiggle room.', icon: 'Briefcase', color: '#3b82f6' },
      { title: 'Salary Negotiations', desc: 'Precise asks get better results. $68,500 beats $70,000.', icon: 'TrendingUp', color: '#8b5cf6' },
      { title: 'Premium Products', desc: 'Luxury items benefit from precision. Suggests careful craftsmanship.', icon: 'Crown', color: '#f59e0b' }
    ];

    const WHEN_ROUND = [
      { title: 'Low-Ticket Items (<$20)', desc: 'For small purchases, cognitive ease matters. $10 beats $9.73.', icon: 'ShoppingCart', color: '#10b981' },
      { title: 'Emotional Purchases', desc: 'Gifts, donations, impulse buys. "I gave $100" sounds better.', icon: 'Heart', color: '#ec4899' },
      { title: 'Speed Checkouts', desc: 'When friction kills conversions, round numbers reduce mental math.', icon: 'Zap', color: '#f59e0b' }
    ];

    const MATTRESS_CASE_STUDY = {
      before: { queen: '$1,000', king: '$1,500', discountRate: 34 },
      after: { queen: '$987', king: '$1,487', discountRate: 19 },
      reduction: 44
    };

    const IMPACT_STATS = [
      { value: 12, suffix: '%', label: 'Higher Perceived Value', subtext: 'Precise vs round prices' },
      { value: 44, suffix: '%', label: 'Less Haggling', subtext: 'With precise pricing' },
      { value: 23, suffix: '%', label: 'Fewer Discount Requests', subtext: 'On high-ticket items' }
    ];
    // ============ END CONFIGURATION ============

    // ============ ICONS ============
    const Icons = {
      Clock: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
      Check: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><polyline points="20 6 9 17 4 12"/></svg>,
      X: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
      ArrowLeft: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>,
      ArrowRight: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>,
      Zap: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
      DollarSign: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>,
      Calculator: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="4" y="2" width="16" height="20" rx="2"/><line x1="8" y1="6" x2="16" y2="6"/><line x1="8" y1="10" x2="8" y2="10"/><line x1="12" y1="10" x2="12" y2="10"/><line x1="16" y1="10" x2="16" y2="10"/><line x1="8" y1="14" x2="8" y2="14"/><line x1="12" y1="14" x2="12" y2="14"/><line x1="16" y1="14" x2="16" y2="14"/><line x1="8" y1="18" x2="8" y2="18"/><line x1="12" y1="18" x2="12" y2="18"/><line x1="16" y1="18" x2="16" y2="18"/></svg>,
      HelpCircle: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>,
      Briefcase: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></svg>,
      TrendingUp: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>,
      Crown: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14"/></svg>,
      ShoppingCart: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>,
      Heart: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>,
      Brain: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"/><path d="M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z"/><path d="M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4"/><path d="M8.5 17a5 5 0 0 1 7 0"/><path d="M12 18v-9"/></svg>,
      Lightbulb: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></svg>,
      Link: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>,
    };

    const IconComponents = {
      DollarSign: Icons.DollarSign,
      Calculator: Icons.Calculator,
      HelpCircle: Icons.HelpCircle,
      Briefcase: Icons.Briefcase,
      TrendingUp: Icons.TrendingUp,
      Crown: Icons.Crown,
      ShoppingCart: Icons.ShoppingCart,
      Heart: Icons.Heart,
      Zap: Icons.Zap,
      Brain: Icons.Brain,
      Lightbulb: Icons.Lightbulb
    };
    // ============ END ICONS ============

    // ============ COMPONENTS ============
    const AnimatedCounter = ({ target, suffix = '', prefix = '', duration = 2000, decimals = 0 }) => {
      const [count, setCount] = useState(0);
      useEffect(() => {
        let start = 0;
        const increment = target / (duration / 16);
        const timer = setInterval(() => {
          start += increment;
          if (start >= target) { setCount(target); clearInterval(timer); }
          else { setCount(decimals > 0 ? parseFloat(start.toFixed(decimals)) : Math.floor(start)); }
        }, 16);
        return () => clearInterval(timer);
      }, [target, duration, decimals]);
      return <span>{prefix}{decimals > 0 ? count.toFixed(decimals) : count}{suffix}</span>;
    };

    // ============ CUSTOM ELITE SLIDES ============

    // PriceComparisonSlide - Round vs Precise with auto-cycling
    const PriceComparisonSlide = ({ data }) => {
      const [activePrice, setActivePrice] = useState(0);
      useEffect(() => {
        const timer = setInterval(() => setActivePrice(p => (p + 1) % 2), 3000);
        return () => clearInterval(timer);
      }, []);

      const prices = [PRICE_COMPARISON.round, PRICE_COMPARISON.precise];

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8">
          <motion.h2 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">{data.title}</motion.h2>

          <div className="grid md:grid-cols-2 gap-6">
            {prices.map((p, i) => {
              const isActive = activePrice === i;
              const isWinner = i === 1;
              return (
                <motion.div key={i} initial={{ opacity: 0, x: i === 0 ? -30 : 30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.1 + i * 0.1 }}
                  style={{ background: isActive ? 'linear-gradient(135deg, #1a1a1a, #2d2d2d)' : '#f9fafb', borderRadius: '20px', padding: '28px', position: 'relative', overflow: 'hidden', border: isActive ? `2px solid ${p.color}` : '2px solid #e5e5e5', transition: 'all 0.5s ease', boxShadow: isActive ? `0 0 40px ${p.color}30` : 'none' }}>
                  <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '4px', background: `linear-gradient(90deg, transparent, ${p.color}, transparent)` }} />

                  {/* Label badge */}
                  <div className="flex items-center justify-between mb-4">
                    <span style={{ background: `${p.color}20`, color: p.color, padding: '6px 16px', borderRadius: '20px', fontSize: '12px', fontWeight: 700 }}>{p.label}</span>
                    {isWinner && isActive && (
                      <motion.span initial={{ scale: 0 }} animate={{ scale: 1 }} style={{ background: '#10b981', color: 'white', padding: '4px 12px', borderRadius: '20px', fontSize: '11px', fontWeight: 700 }}>WINS</motion.span>
                    )}
                  </div>

                  {/* Price */}
                  <div style={{ fontSize: '56px', fontWeight: 900, color: isActive ? p.color : '#9ca3af', fontFamily: 'monospace', marginBottom: '16px', transition: 'color 0.5s' }}>
                    {p.price}
                  </div>

                  {/* Thought bubble */}
                  <div style={{ background: isActive ? '#ffffff10' : '#f3f4f6', borderRadius: '12px', padding: '16px', marginBottom: '12px' }}>
                    <p style={{ fontSize: '12px', color: isActive ? '#9ca3af' : '#6b7280', fontStyle: 'italic', marginBottom: '8px' }}>Subconscious thought:</p>
                    <p style={{ fontSize: '14px', color: isActive ? '#d1d5db' : '#4b5563', lineHeight: 1.5 }}>"{p.thought}"</p>
                  </div>

                  {/* Result */}
                  <div style={{ textAlign: 'center', padding: '12px', background: `${p.color}15`, borderRadius: '10px' }}>
                    <span style={{ fontWeight: 700, color: p.color, fontSize: '13px' }}>{p.result}</span>
                  </div>
                </motion.div>
              );
            })}
          </div>

          <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.4 }}
            className="text-center mt-6" style={{ color: '#6b7280', fontSize: '14px' }}>
            Same product. $12 difference. Completely different perception.
          </motion.p>
        </div>
      );
    };

    // PricePsychologySlide - Round = Arbitrary, Precise = Calculated
    const PricePsychologySlide = ({ data }) => {
      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8">
          <motion.h2 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">{data.title}</motion.h2>

          <div className="grid md:grid-cols-2 gap-6">
            {PRICE_PSYCHOLOGY.map((item, i) => {
              const IconComponent = IconComponents[item.icon];
              return (
                <motion.div key={i} initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 + i * 0.15 }}
                  style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '20px', padding: '28px', position: 'relative', overflow: 'hidden', border: `2px solid ${item.color}` }}>
                  <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: `linear-gradient(90deg, transparent, ${item.color}, transparent)` }} />

                  <div className="flex items-center gap-3 mb-4">
                    <div style={{ width: '48px', height: '48px', borderRadius: '12px', background: `${item.color}20`, display: 'flex', alignItems: 'center', justifyContent: 'center', color: item.color }}>
                      {IconComponent && <IconComponent />}
                    </div>
                    <div>
                      <span style={{ fontWeight: 700, color: 'white', fontSize: '18px' }}>{item.type} Numbers</span>
                      <p style={{ fontSize: '28px', fontWeight: 900, color: item.color, fontFamily: 'monospace' }}>{item.example}</p>
                    </div>
                  </div>

                  <div style={{ marginTop: '16px' }}>
                    <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '12px' }}>
                      <span style={{ color: '#9ca3af', fontSize: '12px', width: '100px' }}>Perceived as:</span>
                      <span style={{ color: 'white', fontWeight: 600 }}>{item.perception}</span>
                    </div>
                    <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                      <span style={{ color: '#9ca3af', fontSize: '12px', width: '100px' }}>Behavior:</span>
                      <span style={{ color: item.color, fontWeight: 600 }}>{item.behavior}</span>
                    </div>
                  </div>
                </motion.div>
              );
            })}
          </div>
        </div>
      );
    };

    // SweetSpotEndingsSlide - Which endings to use
    const SweetSpotEndingsSlide = ({ data }) => {
      const [activeEnding, setActiveEnding] = useState(0);
      useEffect(() => {
        const timer = setInterval(() => setActiveEnding(e => (e + 1) % SWEET_SPOT_ENDINGS.length), 2500);
        return () => clearInterval(timer);
      }, []);

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8">
          <motion.h2 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">{data.title}</motion.h2>

          <div className="grid md:grid-cols-3 gap-4">
            {SWEET_SPOT_ENDINGS.map((item, i) => {
              const isActive = activeEnding === i;
              const isGood = item.status === 'good';
              return (
                <motion.div key={i} initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 + i * 0.1 }}
                  style={{ background: isActive ? 'linear-gradient(135deg, #1a1a1a, #2d2d2d)' : '#f9fafb', borderRadius: '16px', padding: '24px', position: 'relative', overflow: 'hidden', border: isActive ? `2px solid ${item.color}` : '2px solid #e5e5e5', transition: 'all 0.5s ease', textAlign: 'center' }}>
                  <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: `linear-gradient(90deg, transparent, ${item.color}, transparent)`, opacity: isActive ? 1 : 0.3 }} />

                  <div style={{ marginBottom: '16px' }}>
                    <span style={{ background: isGood ? '#10b98120' : '#ef444420', color: item.color, padding: '4px 12px', borderRadius: '20px', fontSize: '11px', fontWeight: 700 }}>
                      {isGood ? 'USE' : 'AVOID'}
                    </span>
                  </div>

                  <p style={{ fontSize: '14px', color: isActive ? '#9ca3af' : '#6b7280', marginBottom: '8px' }}>End in {item.ending}</p>
                  <p style={{ fontSize: '36px', fontWeight: 900, color: item.color, fontFamily: 'monospace', marginBottom: '12px' }}>{item.example}</p>
                  <p style={{ fontSize: '13px', color: isActive ? '#d1d5db' : '#4b5563' }}>{item.effect}</p>
                </motion.div>
              );
            })}
          </div>
        </div>
      );
    };

    // WhenToUsePreciseSlide - 4-item grid
    const WhenToUsePreciseSlide = ({ data }) => {
      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8">
          <motion.h2 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-2">{data.title}</motion.h2>
          <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-center mb-8" style={{ color: '#6b7280', fontSize: '14px' }}>
            Use precision when the stakes are high
          </motion.p>

          <div className="grid md:grid-cols-2 gap-4">
            {WHEN_PRECISE.map((item, i) => {
              const IconComponent = IconComponents[item.icon];
              return (
                <motion.div key={i} initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 + i * 0.1 }}
                  style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '16px', padding: '20px', position: 'relative', overflow: 'hidden' }}>
                  <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: `linear-gradient(90deg, transparent, ${item.color}, transparent)` }} />

                  <div className="flex items-start gap-4">
                    <div style={{ width: '44px', height: '44px', borderRadius: '12px', background: `${item.color}20`, display: 'flex', alignItems: 'center', justifyContent: 'center', color: item.color, flexShrink: 0 }}>
                      {IconComponent && <IconComponent />}
                    </div>
                    <div>
                      <h3 style={{ fontWeight: 700, color: 'white', fontSize: '15px', marginBottom: '6px' }}>{item.title}</h3>
                      <p style={{ fontSize: '13px', color: '#9ca3af', lineHeight: 1.5 }}>{item.desc}</p>
                    </div>
                  </div>
                </motion.div>
              );
            })}
          </div>
        </div>
      );
    };

    // WhenToUseRoundSlide - 3-item grid
    const WhenToUseRoundSlide = ({ data }) => {
      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8">
          <motion.h2 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-2">{data.title}</motion.h2>
          <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-center mb-8" style={{ color: '#6b7280', fontSize: '14px' }}>
            Round numbers have their place too
          </motion.p>

          <div className="grid md:grid-cols-3 gap-4">
            {WHEN_ROUND.map((item, i) => {
              const IconComponent = IconComponents[item.icon];
              return (
                <motion.div key={i} initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 + i * 0.1 }}
                  style={{ background: '#f9fafb', borderRadius: '16px', padding: '24px', position: 'relative', overflow: 'hidden', border: '2px solid #e5e5e5', textAlign: 'center' }}>

                  <div style={{ width: '52px', height: '52px', borderRadius: '14px', background: `${item.color}15`, display: 'flex', alignItems: 'center', justifyContent: 'center', color: item.color, margin: '0 auto 16px' }}>
                    {IconComponent && <IconComponent />}
                  </div>
                  <h3 style={{ fontWeight: 700, color: '#1f2937', fontSize: '15px', marginBottom: '8px' }}>{item.title}</h3>
                  <p style={{ fontSize: '13px', color: '#6b7280', lineHeight: 1.5 }}>{item.desc}</p>
                </motion.div>
              );
            })}
          </div>
        </div>
      );
    };

    // MattressCaseStudySlide - Before/After with stats
    const MattressCaseStudySlide = ({ data }) => {
      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8">
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
            <span style={{ background: 'rgba(16, 185, 129, 0.1)', color: '#10b981', padding: '6px 16px', borderRadius: '20px', fontSize: '12px', fontWeight: 600 }}>Case Study</span>
            <h2 className="slide-title text-xl md:text-2xl text-black mt-3">{data.title}</h2>
          </motion.div>

          <div className="grid md:grid-cols-2 gap-6 mb-6">
            {/* Before */}
            <motion.div initial={{ opacity: 0, x: -20 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.1 }}
              style={{ background: '#fef2f2', border: '2px solid #fecaca', borderRadius: '16px', padding: '24px' }}>
              <div className="flex items-center gap-2 mb-4">
                <div style={{ width: '32px', height: '32px', borderRadius: '50%', background: '#ef4444', display: 'flex', alignItems: 'center', justifyContent: 'center', color: 'white' }}>
                  <Icons.X />
                </div>
                <span style={{ fontWeight: 700, color: '#dc2626' }}>Original Pricing</span>
              </div>
              <div style={{ marginBottom: '16px' }}>
                <p style={{ color: '#6b7280', fontSize: '13px' }}>Queen mattress: <strong style={{ color: '#1f2937', fontFamily: 'monospace' }}>{MATTRESS_CASE_STUDY.before.queen}</strong></p>
                <p style={{ color: '#6b7280', fontSize: '13px' }}>King mattress: <strong style={{ color: '#1f2937', fontFamily: 'monospace' }}>{MATTRESS_CASE_STUDY.before.king}</strong></p>
              </div>
              <div style={{ background: '#fee2e2', borderRadius: '10px', padding: '12px', textAlign: 'center' }}>
                <p style={{ fontSize: '12px', color: '#6b7280' }}>Discount request rate</p>
                <p style={{ fontSize: '28px', fontWeight: 800, color: '#ef4444' }}>{MATTRESS_CASE_STUDY.before.discountRate}%</p>
              </div>
            </motion.div>

            {/* After */}
            <motion.div initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.2 }}
              style={{ background: '#f0fdf4', border: '2px solid #bbf7d0', borderRadius: '16px', padding: '24px', position: 'relative' }}>
              <motion.div initial={{ scale: 0 }} animate={{ scale: 1 }} transition={{ delay: 0.5 }}
                style={{ position: 'absolute', top: '-12px', right: '16px', background: '#10b981', color: 'white', padding: '4px 16px', borderRadius: '20px', fontSize: '12px', fontWeight: 700 }}>
                WINS
              </motion.div>
              <div className="flex items-center gap-2 mb-4">
                <div style={{ width: '32px', height: '32px', borderRadius: '50%', background: '#10b981', display: 'flex', alignItems: 'center', justifyContent: 'center', color: 'white' }}>
                  <Icons.Check />
                </div>
                <span style={{ fontWeight: 700, color: '#16a34a' }}>Precise Pricing</span>
              </div>
              <div style={{ marginBottom: '16px' }}>
                <p style={{ color: '#6b7280', fontSize: '13px' }}>Queen mattress: <strong style={{ color: '#10b981', fontFamily: 'monospace' }}>{MATTRESS_CASE_STUDY.after.queen}</strong></p>
                <p style={{ color: '#6b7280', fontSize: '13px' }}>King mattress: <strong style={{ color: '#10b981', fontFamily: 'monospace' }}>{MATTRESS_CASE_STUDY.after.king}</strong></p>
              </div>
              <div style={{ background: '#dcfce7', borderRadius: '10px', padding: '12px', textAlign: 'center' }}>
                <p style={{ fontSize: '12px', color: '#6b7280' }}>Discount request rate</p>
                <p style={{ fontSize: '28px', fontWeight: 800, color: '#10b981' }}>{MATTRESS_CASE_STUDY.after.discountRate}%</p>
              </div>
            </motion.div>
          </div>

          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.4 }}
            style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '12px', padding: '20px', textAlign: 'center' }}>
            <p style={{ color: '#9ca3af', fontSize: '13px', marginBottom: '8px' }}>Haggling attempts reduced by</p>
            <p style={{ fontSize: '48px', fontWeight: 800, color: '#10b981' }}><AnimatedCounter target={MATTRESS_CASE_STUDY.reduction} suffix="%" duration={1500} /></p>
          </motion.div>
        </div>
      );
    };

    // ImpactStatsSlide - AnimatedCounter stats
    const ImpactStatsSlide = ({ data }) => {
      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8">
          <motion.h2 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">{data.title}</motion.h2>

          <div className="grid md:grid-cols-3 gap-4">
            {IMPACT_STATS.map((stat, i) => (
              <motion.div key={i} initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 + i * 0.15 }}
                style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '16px', padding: '28px', position: 'relative', overflow: 'hidden', textAlign: 'center' }}>
                <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: 'linear-gradient(90deg, transparent, #10b981, transparent)' }} />

                <div style={{ fontSize: '48px', fontWeight: 800, color: '#10b981', marginBottom: '8px' }}>
                  <AnimatedCounter target={stat.value} suffix={stat.suffix} duration={2000} />
                </div>
                <p style={{ color: 'white', fontWeight: 600, marginBottom: '4px' }}>{stat.label}</p>
                <p style={{ color: '#6b7280', fontSize: '12px' }}>{stat.subtext}</p>
              </motion.div>
            ))}
          </div>
        </div>
      );
    };

    // EliteInsightSlide - The Precision Paradox
    const EliteInsightSlide = ({ data }) => {
      return (
        <div className="h-full flex flex-col justify-center items-center px-6 md:px-12 max-w-3xl mx-auto slide-scroll overflow-y-auto py-8">
          <motion.div initial={{ opacity: 0, scale: 0.9 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.2 }}
            style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '24px', padding: '48px', position: 'relative', overflow: 'hidden', width: '100%', boxShadow: '0 0 60px rgba(16, 185, 129, 0.15)' }}>
            <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '4px', background: 'linear-gradient(90deg, transparent, #10b981, transparent)' }} />

            <div className="text-center mb-6">
              <div style={{ width: '60px', height: '60px', borderRadius: '16px', background: '#10b98120', display: 'flex', alignItems: 'center', justifyContent: 'center', margin: '0 auto 20px', color: '#10b981' }}>
                <Icons.Brain />
              </div>
              <p style={{ color: '#9ca3af', fontSize: '14px', marginBottom: '8px' }}>Elite Insight</p>
              <h3 className="slide-title" style={{ color: 'white', fontSize: '28px', marginBottom: '16px' }}>{data.title}</h3>
            </div>

            <p style={{ color: '#d1d5db', fontSize: '16px', lineHeight: '1.8', textAlign: 'center' }}>{data.insight}</p>

            <div style={{ marginTop: '24px', padding: '16px', background: '#10b98110', borderRadius: '12px', textAlign: 'center' }}>
              <div className="flex items-center justify-center gap-2" style={{ color: '#10b981' }}>
                <Icons.Lightbulb />
                <span style={{ fontWeight: 600 }}>Precision signals calculation. Calculation signals fairness.</span>
              </div>
            </div>
          </motion.div>
        </div>
      );
    };

    // ============ STANDARD SLIDES ============
    const WelcomeSlide = ({ data, onStart, userName, onShowGif, onHideGif }) => {
      const welcomeData = useMemo(() => getTimeBasedWelcome(), []);
      const gifSide = useMemo(() => Math.random() > 0.5 ? 'left' : 'right', []);
      useEffect(() => { onShowGif(welcomeData.gif, '65%', gifSide); return () => onHideGif(); }, [welcomeData.gif, gifSide, onShowGif, onHideGif]);

      return (
        <div className="h-full w-full relative overflow-hidden">
          <div className="h-full flex flex-col items-center justify-center text-center px-6 py-4 relative z-20">
            <motion.h1 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="title-font text-3xl sm:text-4xl md:text-5xl lg:text-6xl text-black mb-2 md:mb-3">{LESSON_CONFIG.title}</motion.h1>
            <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-neutral-600 text-base md:text-lg lg:text-xl mb-2 md:mb-3 max-w-lg leading-relaxed" dangerouslySetInnerHTML={{ __html: formatGreeting(welcomeData.greeting, `<span class="font-bold text-neutral-900">${userName}</span>`) }} />
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="flex items-center justify-center gap-1.5 text-neutral-400 text-[10px] md:text-xs mb-2 md:mb-3"><Icons.Clock /><span>{LESSON_CONFIG.duration}</span></motion.div>
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 }} className="bg-neutral-900 rounded-xl md:rounded-2xl p-3 md:p-5 mb-3 md:mb-4 max-w-sm w-full mx-auto">
              <p className="text-neutral-500 text-[9px] md:text-[11px] uppercase tracking-wider mb-2 md:mb-3">In this lesson</p>
              <ul className="space-y-1.5 md:space-y-2">
                {data.learningGoals.map((goal, i) => (
                  <motion.li key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.25 + i * 0.05 }} className="flex items-start gap-2 text-left">
                    <span className="w-5 h-5 rounded-md flex items-center justify-center text-[9px] font-bold text-white flex-shrink-0 mt-0.5" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>{i + 1}</span>
                    <span className="text-neutral-300 text-[11px] md:text-sm leading-snug">{goal}</span>
                  </motion.li>
                ))}
              </ul>
            </motion.div>
            <motion.button initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.45 }} onClick={onStart} whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }} className="px-6 md:px-7 py-2.5 md:py-3 rounded-xl text-white font-semibold text-sm md:text-base" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>Let's Go</motion.button>
          </div>
        </div>
      );
    };

    const HookSlide = ({ data }) => (
      <div className="h-full relative overflow-hidden">
        <div className="h-full flex flex-col justify-center px-6 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-8 md:py-10 relative z-10">
          <motion.div initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} className="mb-4 md:mb-6">
            <span className="inline-block px-3 py-1 rounded-full text-xs font-semibold mb-3 md:mb-4" style={{ background: `rgba(var(--accent-rgb), 0.1)`, color: 'var(--accent)' }}>The Hook</span>
            <h2 className="slide-title text-2xl md:text-4xl lg:text-5xl text-black leading-tight">{data.headline}</h2>
          </motion.div>
          <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="text-base md:text-xl text-neutral-600 leading-relaxed">{data.subtext}</motion.p>
        </div>
      </div>
    );

    const ContentSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-8 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-10">
        <motion.h2 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl lg:text-4xl text-black mb-6">{data.title}</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-base md:text-lg text-neutral-600 leading-relaxed">{data.body}</motion.p>
      </div>
    );

    const QuizSlide = ({ data, onShowGif, onHideGif }) => {
      const [selected, setSelected] = useState(null);
      const [showFeedback, setShowFeedback] = useState(false);
      const celebrationGif = useMemo(() => getRandomCelebrationGif(), []);
      const empathyGif = useMemo(() => getRandomEmpathyGif(), []);
      const gifSide = useMemo(() => Math.random() > 0.5 ? 'left' : 'right', []);
      const handleSelect = (index) => { if (showFeedback) return; setSelected(index); setShowFeedback(true); };
      const isCorrect = selected === data.correctIndex;

      useEffect(() => { if (showFeedback) { if (isCorrect) { onShowGif(celebrationGif, '60%', gifSide); } else { onShowGif(empathyGif, '60%', gifSide); } } }, [showFeedback, isCorrect, celebrationGif, empathyGif, gifSide, onShowGif]);
      useEffect(() => { return () => onHideGif(); }, [onHideGif]);

      return (
        <div className="h-full w-full relative overflow-hidden">
          <div className="h-full flex flex-col justify-center px-8 md:px-12 max-w-2xl mx-auto slide-scroll overflow-y-auto py-10 relative z-30">
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
              <p className="text-xs uppercase tracking-wider text-neutral-400 mb-3">Quick Check</p>
              <h2 className="slide-title text-xl md:text-2xl text-black leading-tight">{data.question}</h2>
            </motion.div>
            <div className="space-y-3 mb-6">
              {data.options.map((option, i) => (
                <motion.button key={i} initial={{ opacity: 0, x: -15 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.08 + i * 0.06 }} onClick={() => handleSelect(i)} disabled={showFeedback} className={`w-full p-4 rounded-xl text-left transition-all border-2 ${showFeedback ? i === data.correctIndex ? 'border-green-500 bg-green-50' : i === selected ? 'border-red-400 bg-red-50' : 'border-neutral-200 bg-white opacity-40' : 'border-neutral-200 bg-white hover:border-neutral-300'}`}>
                  <div className="flex items-center gap-3">
                    <span className={`w-8 h-8 rounded-lg flex items-center justify-center text-sm font-bold transition-all ${showFeedback && i === data.correctIndex ? 'bg-green-500 text-white' : showFeedback && i === selected && !isCorrect ? 'bg-red-400 text-white' : 'bg-neutral-100 text-neutral-500'}`}>
                      {showFeedback && i === data.correctIndex ? <Icons.Check /> : showFeedback && i === selected && !isCorrect ? <Icons.X /> : String.fromCharCode(65 + i)}
                    </span>
                    <span className="text-neutral-700 text-sm md:text-base">{option}</span>
                  </div>
                </motion.button>
              ))}
            </div>
            <AnimatePresence>
              {showFeedback && (
                <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className={`p-5 rounded-xl ${isCorrect ? 'bg-green-50 border border-green-200' : 'bg-amber-50 border border-amber-200'}`}>
                  <p className={`text-sm leading-relaxed ${isCorrect ? 'text-green-800' : 'text-amber-800'}`}>{isCorrect ? data.feedback.correct : data.feedback.incorrect}</p>
                </motion.div>
              )}
            </AnimatePresence>
          </div>
        </div>
      );
    };

    const CompletionSlide = ({ data }) => (
      <div className="h-full flex flex-col items-center justify-center text-center px-8 slide-scroll overflow-y-auto py-8">
        <motion.div initial={{ opacity: 0, scale: 0 }} animate={{ opacity: 1, scale: 1 }} transition={{ type: 'spring', duration: 0.5 }} className="w-16 h-16 rounded-xl flex items-center justify-center mb-4 text-white" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))`, boxShadow: `0 6px 24px rgba(var(--accent-rgb), 0.35)` }}><Icons.Check /></motion.div>
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="slide-title text-2xl md:text-3xl text-black mb-3">Lesson Complete</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.25 }} className="text-neutral-500 text-sm mb-5 max-w-md leading-relaxed">You now understand the Precise Price Trick. For high-ticket items, use specific numbers ending in 7 or 8. Signal calculation, not guessing. Reduce negotiation instincts and build trust before you say a single word.</motion.p>
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.35 }} className="bg-neutral-900 rounded-xl p-5 max-w-md w-full mb-4">
          <p className="text-neutral-500 text-xs uppercase tracking-wider mb-2">Up Next</p>
          <h3 className="text-white font-bold text-lg mb-1">{LESSON_CONFIG.nextLesson.title}</h3>
          <p className="text-neutral-400 text-xs">{LESSON_CONFIG.nextLesson.teaser}</p>
        </motion.div>
      </div>
    );

    // ============ SLIDES ARRAY ============
    const slides = [
      { type: 'welcome', learningGoals: ['Why round numbers trigger negotiation instincts', 'The University of Florida study that changed pricing forever', 'When to use precise vs round numbers for max conversions'] },
      { type: 'hook', headline: 'Which price feels more calculated? $5,000 or $4,988?', subtext: 'Researchers at University of Florida tested this exact question. The result? People estimated items priced at round numbers ($5,000) were worth LESS than identical items priced at precise numbers ($4,988). The round number felt like a guess. The precise number felt researched. Same item. Different perception. Different sales.' },
      { type: 'price-comparison', title: 'The Subconscious Reaction' },
      { type: 'price-psychology', title: 'The Psychology of Precision' },
      { type: 'content', title: 'Why This Matters for E-commerce', body: 'You are not just selling products. You are defending your prices against the customer inner skeptic. A round price like $100 whispers "I made this up." A precise price like $97.43 whispers "I calculated this carefully." The precise price builds trust before you say a single word.' },
      { type: 'sweet-spot-endings', title: 'The Sweet Spot Endings' },
      { type: 'when-precise', title: 'When To Use Precise Numbers' },
      { type: 'when-round', title: 'When Round Numbers Win' },
      { type: 'mattress-case-study', title: 'Mattress Brand: Real Results' },
      { type: 'content', title: 'The Implementation Formula', body: 'For products over $100: End prices in 7 or 8 (feels calculated, not cheap like .99). For B2B or high-ticket: Use specific numbers like $14,847 or $2,388. For bundles: Let the math be visible. "$47 + $47 + $47 = $141 (you pay $127)" shows deliberate pricing.' },
      { type: 'impact-stats', title: 'The Precision Impact' },
      { type: 'elite-insight', title: 'The Precision Paradox', insight: 'The smaller the price difference, the bigger the psychological shift. $4,988 vs $5,000 is only $12 apart - but one invites haggling while the other commands respect. It is not about the amount. It is about the signal. Precision says "I did the math." Round says "I made it up."' },
      { type: 'quiz', question: 'Why do precise prices like $4,988 reduce negotiation attempts compared to $5,000?', options: ['Because $4,988 is technically cheaper', 'Because precise numbers signal careful calculation, reducing perceived wiggle room', 'Because odd numbers are harder to remember', 'Because customers prefer even numbers'], correctIndex: 1, feedback: { correct: 'Exactly! The subconscious interprets precise numbers as calculated and researched, while round numbers feel arbitrary and negotiable. It is about perceived fairness, not the actual amount.', incorrect: 'Not quite. The power of precise pricing comes from psychology: your brain assumes precise numbers were carefully calculated, while round numbers feel like guesses open to negotiation.' } },
      { type: 'completion' }
    ];

    // ============ APP ============
    const LessonApp = () => {
      const [currentSlide, setCurrentSlide] = useState(getInitialSlide());
      const [direction, setDirection] = useState(1);
      const userName = useMemo(() => getUserName(), []);
      const currentSlideRef = React.useRef(0);
      const [gifConfig, setGifConfig] = useState(null);
      const [isAnimating, setIsAnimating] = useState(false);

      const showGif = useCallback((url, height, side) => setGifConfig({ url, height, side }), []);
      const hideGif = useCallback(() => setGifConfig(null), []);

      React.useEffect(() => { currentSlideRef.current = currentSlide; }, [currentSlide]);

      useEffect(() => {
        window.parent.postMessage({ type: 'LESSON_SLIDE_UPDATE',
          totalSlides: slides.length, slideIndex: currentSlide, slideType: slides[currentSlide]?.type, lessonSlug: LESSON_CONFIG.id }, '*');
      }, [currentSlide]);

      const goToSlide = useCallback((newSlide) => {
        if (isAnimating || newSlide < 0 || newSlide >= slides.length) return;
        setIsAnimating(true);
        setDirection(newSlide > currentSlideRef.current ? 1 : -1);
        setCurrentSlide(newSlide);
      }, [isAnimating]);

      const nextSlide = useCallback(() => { if (currentSlideRef.current + 1 < slides.length) goToSlide(currentSlideRef.current + 1); }, [goToSlide]);
      const prevSlide = useCallback(() => { if (currentSlideRef.current - 1 >= 0) goToSlide(currentSlideRef.current - 1); }, [goToSlide]);

      useEffect(() => {
        const handleKeyDown = (e) => {
          if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); nextSlide(); }
          if (e.key === 'ArrowLeft') { e.preventDefault(); prevSlide(); }
        };
        window.addEventListener('keydown', handleKeyDown);
        return () => window.removeEventListener('keydown', handleKeyDown);
      }, [nextSlide, prevSlide]);

      const slideVariants = {
        enter: (dir) => ({ x: dir > 0 ? '100%' : '-100%', opacity: 0 }),
        center: { x: 0, opacity: 1 },
        exit: (dir) => ({ x: dir > 0 ? '-100%' : '100%', opacity: 0 })
      };

      const renderSlide = (slide) => {
        switch (slide.type) {
          case 'welcome': return <WelcomeSlide data={slide} onStart={nextSlide} userName={userName} onShowGif={showGif} onHideGif={hideGif} />;
          case 'hook': return <HookSlide data={slide} />;
          case 'content': return <ContentSlide data={slide} />;
          case 'quiz': return <QuizSlide data={slide} onShowGif={showGif} onHideGif={hideGif} />;
          case 'completion': return <CompletionSlide data={slide} />;
          case 'price-comparison': return <PriceComparisonSlide data={slide} />;
          case 'price-psychology': return <PricePsychologySlide data={slide} />;
          case 'sweet-spot-endings': return <SweetSpotEndingsSlide data={slide} />;
          case 'when-precise': return <WhenToUsePreciseSlide data={slide} />;
          case 'when-round': return <WhenToUseRoundSlide data={slide} />;
          case 'mattress-case-study': return <MattressCaseStudySlide data={slide} />;
          case 'impact-stats': return <ImpactStatsSlide data={slide} />;
          case 'elite-insight': return <EliteInsightSlide data={slide} />;
          default: return null;
        }
      };

      const showPrev = currentSlide > 0;
      const showNext = currentSlide < slides.length - 1 && slides[currentSlide].type !== 'welcome';

      return (
        <div className="w-full h-screen bg-white flex flex-col relative">
          <div className="flex-1 relative overflow-hidden z-20">
            <AnimatePresence mode="wait" custom={direction} onExitComplete={() => setIsAnimating(false)}>
              <motion.div key={currentSlide} custom={direction} variants={slideVariants} initial="enter" animate="center" exit="exit" transition={{ duration: 0.3, ease: [0.25, 0.1, 0.25, 1] }} className="absolute inset-0">
                {renderSlide(slides[currentSlide])}
                <AdminSlideReportButton slideIndex={currentSlide} slideType={slides[currentSlide].type} />
              </motion.div>
            </AnimatePresence>
            {showPrev && <button onClick={prevSlide} className="absolute left-5 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-500 hover:text-neutral-700 transition-all z-10"><Icons.ArrowLeft /></button>}
            {showNext && <button onClick={nextSlide} className="absolute right-5 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-500 hover:text-neutral-700 transition-all z-10"><Icons.ArrowRight /></button>}
          </div>
          <div className="px-6 md:px-8 py-5 border-t border-neutral-100 flex-shrink-0 relative z-10">
            <div className="flex items-center justify-center gap-2.5">
              {slides.map((_, i) => <button key={i} onClick={() => goToSlide(i)} className="w-2.5 h-2.5 rounded-full transition-all duration-300" style={{ background: i === currentSlide ? 'var(--accent)' : '#d4d4d4', transform: i === currentSlide ? 'scale(1.3)' : 'scale(1)' }} />)}
            </div>
          </div>
          <AnimatePresence>
            {gifConfig && (
              <motion.div initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: 30 }} transition={{ type: 'spring', stiffness: 100 }} className={`absolute ${gifConfig.side === 'left' ? 'left-4 md:left-8' : 'right-4 md:right-8'} bottom-0 pointer-events-none`} style={{ zIndex: 15, height: gifConfig.height }}>
                <video autoPlay loop muted playsInline className="h-full w-auto object-contain object-bottom" style={{ background: 'transparent', border: 'none', boxShadow: 'none' }}>
                  <source src={gifConfig.url} type="video/mp4" />
                </video>
              </motion.div>
            )}
          </AnimatePresence>
        </div>
      );
    };

    ReactDOM.render(<LessonApp />, document.getElementById('root'));
  </script>
</body>
</html>
