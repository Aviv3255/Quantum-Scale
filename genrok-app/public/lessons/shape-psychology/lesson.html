<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Shape Psychology | Quantum Scale</title>
  <script src="https://cdn.tailwindcss.com" defer></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" defer></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" defer></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js" defer></script>
  <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js" defer></script>
  <script src="../shared/greetings.js" defer></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;500;600;700;800;900&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --accent: #06b6d4;
      --accent-dark: #0891b2;
      --accent-light: #22d3ee;
      --accent-rgb: 6, 182, 212;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Inter', sans-serif; background: transparent; -webkit-font-smoothing: antialiased; }
    .title-font { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    h1, h2, h3, .slide-title { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    ::selection { background: var(--accent); color: white; }
    .slide-scroll::-webkit-scrollbar { display: none; }
    .slide-scroll { -ms-overflow-style: none; scrollbar-width: none; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { motion, AnimatePresence } = window.Motion;
    const { useState, useEffect, useCallback, useMemo } = React;

    const getUserName = () => {
      const params = new URLSearchParams(window.location.search);
      return params.get('userName') || 'Builder';
    };

    const LESSON_CONFIG = {
      id: 'shape-psychology',
      title: 'The Shape Psychology',
      description: 'How shapes trigger emotions and buying decisions in milliseconds.',
      accentColor: '#06b6d4',
      duration: '5 min',
      nextLesson: {
        id: 'brand-moat',
        title: 'The Brand Moat',
        teaser: 'Why your brand is the only thing competitors can never copy.'
      }
    };

    // ============ ADMIN REPORTER SYSTEM ============
    let __isAdmin = false;
    window.addEventListener('message', function(e) {
      if (e.data?.type === 'ADMIN_STATUS') { __isAdmin = e.data.isAdmin; }
    });
    if (window.parent !== window) {
      window.parent.postMessage({ type: 'CHECK_ADMIN_STATUS' }, '*');
    }

    const AdminSlideReportButton = ({ slideIndex, slideType }) => {
      const handleReport = (e) => {
        e.stopPropagation();
        e.preventDefault();
        if (window.parent !== window) {
          window.parent.postMessage({
            type: 'ADMIN_REPORT_REQUEST',
            slideIndex: slideIndex,
            slideType: slideType,
            lessonSlug: LESSON_CONFIG.id,
            elementId: slideType + '-' + slideIndex
          }, '*');
        }
      };

      return (
        <button onClick={handleReport} title={`Report issue on Slide ${slideIndex + 1} (${slideType})`}
          style={{
            position: 'absolute', top: '12px', right: '12px', width: '32px', height: '32px',
            borderRadius: '8px', backgroundColor: 'rgba(239, 68, 68, 0.9)', color: 'white',
            border: 'none', cursor: 'pointer', display: 'flex', alignItems: 'center',
            justifyContent: 'center', zIndex: 1000, opacity: 0.6, transition: 'opacity 0.2s, transform 0.2s'
          }}
          onMouseEnter={(e) => { e.currentTarget.style.opacity = '1'; e.currentTarget.style.transform = 'scale(1.1)'; }}
          onMouseLeave={(e) => { e.currentTarget.style.opacity = '0.6'; e.currentTarget.style.transform = 'scale(1)'; }}>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
            <path d="m8 2 1.88 1.88"/><path d="M14.12 3.88 16 2"/>
            <path d="M9 7.13v-1a3.003 3.003 0 1 1 6 0v1"/>
            <path d="M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6"/>
            <path d="M12 20v-9"/><path d="M6.53 9C4.6 8.8 3 7.1 3 5"/>
            <path d="M6 13H2"/><path d="M3 21c0-2.1 1.7-3.9 3.8-4"/>
            <path d="M20.97 5c0 2.1-1.6 3.8-3.5 4"/><path d="M22 13h-4"/>
            <path d="M17.2 17c2.1.1 3.8 1.9 3.8 4"/>
          </svg>
        </button>
      );
    };
    // ============ END ADMIN REPORTER ============

    const celebrationGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_doing_a_quick_victory_dance_move_high_energy_c_d03b798b-a518-4e6c-bcae-d69b2dd50486_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_jumping_in_the_air_arms_raised_high_YESSS_cele_201477e8-3df4-405a-bc81-81d1747e5c6c_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_playing_air_guitar_light_headbanging_rockstar__0702007e-9e84-4d9e-8f99-8ee23d0b65f8_2.mp4'
    ];
    const getRandomCelebrationGif = () => celebrationGifs[Math.floor(Math.random() * celebrationGifs.length)];
    const empathyGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_thumbs_down_with_encouraging_nod_close_keep_go_613e541f-c072-436f-aee7-f99cd6f834fc_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_shaking_head_side_to_side_sadly_disappointed_e_c4a4be22-6a70-4738-8612-3039454fef37_1.mp4'
    ];
    const getRandomEmpathyGif = () => empathyGifs[Math.floor(Math.random() * empathyGifs.length)];

    // ============ ICONS ============
    const Icons = {
      Clock: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
      Check: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><polyline points="20 6 9 17 4 12"/></svg>,
      X: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
      ArrowLeft: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>,
      ArrowRight: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>,
      Zap: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
      Circle: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/></svg>,
      Square: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="3" y="3" width="18" height="18" rx="2"/></svg>,
      Triangle: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="12 2 22 22 2 22"/></svg>,
      Heart: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>,
      Shield: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>,
      Target: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>,
      Brain: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z"/><path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z"/></svg>,
      Lightbulb: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M15.09 14c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 18 8 6 6 0 0 0 6 8c0 1 .23 2.23 1.5 3.5A4.61 4.61 0 0 1 8.91 14"/></svg>,
      Settings: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>,
      Monitor: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>,
      Car: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M14 16H9m10 0h3v-3.15a1 1 0 0 0-.84-.99L16 11l-2.7-3.6a1 1 0 0 0-.8-.4H5.24a2 2 0 0 0-1.8 1.1l-.8 1.63A6 6 0 0 0 2 12.42V16h2"/><circle cx="6.5" cy="16.5" r="2.5"/><circle cx="16.5" cy="16.5" r="2.5"/></svg>,
      Smile: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/></svg>,
      Utensils: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"/><path d="M7 2v20"/><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"/></svg>,
      ShoppingBag: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>,
      Briefcase: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></svg>,
      Dumbbell: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="m6.5 6.5 11 11"/><path d="m21 21-1-1"/><path d="m3 3 1 1"/><path d="m18 22 4-4"/><path d="m2 6 4-4"/><path d="m3 10 7-7"/><path d="m14 21 7-7"/></svg>,
      Crown: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7z"/><path d="M4 16c0 2 1.5 4 8 4s8-2 8-4"/></svg>
    };

    // ============ ANIMATED COUNTER ============
    const AnimatedCounter = ({ value, suffix = '', prefix = '', duration = 2000 }) => {
      const [count, setCount] = useState(0);
      const numericValue = parseFloat(value.toString().replace(/[^0-9.]/g, ''));
      const hasDecimal = value.toString().includes('.');

      useEffect(() => {
        let startTime;
        const animate = (currentTime) => {
          if (!startTime) startTime = currentTime;
          const progress = Math.min((currentTime - startTime) / duration, 1);
          const easeOut = 1 - Math.pow(1 - progress, 3);
          setCount(numericValue * easeOut);
          if (progress < 1) requestAnimationFrame(animate);
        };
        requestAnimationFrame(animate);
      }, [numericValue, duration]);

      return <span>{prefix}{hasDecimal ? count.toFixed(1) : Math.floor(count)}{suffix}</span>;
    };

    // ============ SLIDES DATA ============
    const slides = [
      { type: 'welcome', learningGoals: [
        'How brains associate shapes with emotions instantly',
        'Curves vs angles: which triggers trust, which triggers power',
        'Using shape psychology for buttons, logos, and layouts'
      ]},
      { type: 'hook', headline: 'The shape of your buttons is making you money. Or losing it.', subtext: 'Rounded corners feel safe and approachable. Sharp angles feel precise and powerful. Your brain decides in 50 milliseconds which one to trust. Porsche uses curves to say "elegant performance." Lamborghini uses angles to say "aggressive dominance." Same product category. Opposite shapes. Opposite emotions. This isn\'t random. It\'s neuroscience.', brandImage: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/BMW.svg', brandName: 'Porsche'},
      { type: 'brain-speed' },
      { type: 'shape-spectrum' },
      { type: 'curves-industries' },
      { type: 'angles-industries' },
      { type: 'car-battle' },
      { type: 'button-demo' },
      { type: 'shape-stats' },
      { type: 'brand-shapes' },
      { type: 'app-comparison' },
      { type: 'application-grid' },
      { type: 'elite-insight' },
      { type: 'quiz', question: 'Why do wellness brands like Headspace use rounded buttons while tech brands like GitHub use angular buttons?', options: ['Rounded buttons are easier to click on mobile', 'Shapes trigger instant emotions: curves feel safe/warm, angles feel precise/technical', 'Angular buttons look more modern', 'Rounded buttons are a current design trend'], correctIndex: 1, feedback: { correct: 'Exactly! Shape psychology works in milliseconds. Curves trigger safety, warmth, and organic feelings - perfect for wellness. Angles trigger precision, efficiency, and technical trust - perfect for developer tools. The shape sets the emotional tone before you read a word.', incorrect: 'Not quite. It\'s not about trends or clickability - it\'s about emotion. Your brain associates curves with safety and nature (perfect for meditation) and angles with precision and tech (perfect for code). Shape = instant emotional signal.' }},
      { type: 'completion' }
    ];

    // ============ UNIQUE SLIDE COMPONENTS ============

    // Brain Speed Slide - Shows 50ms processing
    const BrainSpeedSlide = () => {
      const [showResult, setShowResult] = useState(false);

      useEffect(() => {
        const timer = setTimeout(() => setShowResult(true), 1500);
        return () => clearTimeout(timer);
      }, []);

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto">
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
            <span className="inline-block px-3 py-1 rounded-full text-xs font-semibold mb-3" style={{ background: 'rgba(6, 182, 212, 0.1)', color: '#06b6d4' }}>The Science</span>
            <h2 className="slide-title text-2xl md:text-4xl text-black">Shapes Are Emotional Triggers</h2>
          </motion.div>

          <div className="grid md:grid-cols-2 gap-6 mb-8">
            <motion.div initial={{ opacity: 0, x: -30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.2 }}
              style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '16px', padding: '24px', position: 'relative', overflow: 'hidden' }}>
              <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: 'linear-gradient(90deg, transparent, #06b6d4, transparent)' }} />
              <div className="flex items-center gap-3 mb-4">
                <div style={{ width: '48px', height: '48px', borderRadius: '50%', background: 'rgba(6, 182, 212, 0.2)', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                  <Icons.Brain />
                </div>
                <span className="text-white font-bold">Reptilian Brain</span>
              </div>
              <p className="text-neutral-400 text-sm leading-relaxed">Your ancient brain evolved to read the environment fast. Before you read a single word, the shape has already told your brain how to feel.</p>
            </motion.div>

            <motion.div initial={{ opacity: 0, x: 30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.3 }}
              style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '16px', padding: '24px', position: 'relative', overflow: 'hidden' }}>
              <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: 'linear-gradient(90deg, transparent, #8b5cf6, transparent)' }} />
              <div className="text-center">
                <div className="text-5xl font-bold mb-2" style={{ color: '#8b5cf6' }}>
                  {showResult ? <AnimatedCounter value={50} suffix="ms" /> : '...'}
                </div>
                <div className="text-white font-semibold mb-1">Shape Processing Time</div>
                <div className="text-neutral-400 text-xs">Before you read ANY text</div>
              </div>
            </motion.div>
          </div>

          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.5 }}
            className="grid grid-cols-2 gap-4">
            <div style={{ background: 'rgba(6, 182, 212, 0.1)', borderRadius: '12px', padding: '16px', textAlign: 'center', border: '1px solid rgba(6, 182, 212, 0.3)' }}>
              <div className="text-2xl mb-2" style={{ color: '#06b6d4' }}>Curves</div>
              <div className="text-neutral-600 text-sm">Rolling hills, fruit, faces</div>
              <div className="text-xs text-neutral-500 mt-1">= SAFE</div>
            </div>
            <div style={{ background: 'rgba(139, 92, 246, 0.1)', borderRadius: '12px', padding: '16px', textAlign: 'center', border: '1px solid rgba(139, 92, 246, 0.3)' }}>
              <div className="text-2xl mb-2" style={{ color: '#8b5cf6' }}>Angles</div>
              <div className="text-neutral-600 text-sm">Thorns, rocks, claws</div>
              <div className="text-xs text-neutral-500 mt-1">= DANGER</div>
            </div>
          </motion.div>
        </div>
      );
    };

    // Shape Spectrum Slide - Interactive spectrum from curves to angles
    const ShapeSpectrumSlide = () => {
      const [activeIndex, setActiveIndex] = useState(2);
      const spectrum = [
        { shape: 'circle', label: 'Full Circle', emotion: 'Community, Unity', color: '#06b6d4', radius: '50%' },
        { shape: 'rounded', label: 'Rounded', emotion: 'Friendly, Approachable', color: '#14b8a6', radius: '16px' },
        { shape: 'mixed', label: 'Mixed', emotion: 'Balanced, Professional', color: '#8b5cf6', radius: '8px' },
        { shape: 'sharp', label: 'Sharp', emotion: 'Precise, Technical', color: '#f59e0b', radius: '4px' },
        { shape: 'angular', label: 'Angular', emotion: 'Aggressive, Powerful', color: '#ef4444', radius: '0px' }
      ];

      useEffect(() => {
        const timer = setInterval(() => {
          setActiveIndex(i => (i + 1) % spectrum.length);
        }, 2500);
        return () => clearInterval(timer);
      }, []);

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto">
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
            <h2 className="slide-title text-2xl md:text-4xl text-black mb-2">The Shape Psychology Spectrum</h2>
            <p className="text-neutral-500">Click or watch the auto-cycle</p>
          </motion.div>

          <div className="flex justify-center items-end gap-3 md:gap-6 mb-8">
            {spectrum.map((item, i) => (
              <motion.div key={i} initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 + i * 0.1 }}
                onClick={() => setActiveIndex(i)}
                style={{
                  width: '60px', height: '60px', cursor: 'pointer',
                  background: i === activeIndex ? item.color : '#e5e7eb',
                  borderRadius: item.radius,
                  transform: i === activeIndex ? 'scale(1.3)' : 'scale(1)',
                  transition: 'all 0.3s ease',
                  boxShadow: i === activeIndex ? `0 0 30px ${item.color}40` : 'none'
                }} />
            ))}
          </div>

          <motion.div key={activeIndex} initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }}
            style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '16px', padding: '24px', textAlign: 'center', position: 'relative', overflow: 'hidden' }}>
            <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: `linear-gradient(90deg, transparent, ${spectrum[activeIndex].color}, transparent)` }} />
            <div className="text-3xl font-bold mb-2" style={{ color: spectrum[activeIndex].color }}>{spectrum[activeIndex].label}</div>
            <div className="text-white text-lg">{spectrum[activeIndex].emotion}</div>
          </motion.div>
        </div>
      );
    };

    // Curves Industries Slide
    const CurvesIndustriesSlide = () => {
      const [activeIndex, setActiveIndex] = useState(0);
      const industries = [
        { icon: <Icons.Heart />, title: 'Wellness & Health', desc: 'Calm, natural, nurturing. Skincare, supplements, meditation apps.', reason: '"We care about you"' },
        { icon: <Icons.Smile />, title: 'Family & Kids', desc: 'Safe, friendly, non-threatening. Toys, childcare, education.', reason: '"Removes fear"' },
        { icon: <Icons.Utensils />, title: 'Food & Hospitality', desc: 'Inviting, warm, comforting. Restaurants, cafes, meal kits.', reason: '"Feels welcome"' },
        { icon: <Icons.ShoppingBag />, title: 'Lifestyle & Fashion', desc: 'Elegant, organic, human. Apparel, beauty, home goods.', reason: '"Premium without intimidation"' }
      ];

      useEffect(() => {
        const timer = setInterval(() => setActiveIndex(i => (i + 1) % industries.length), 3000);
        return () => clearInterval(timer);
      }, []);

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto">
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
            <span className="inline-block px-3 py-1 rounded-full text-xs font-semibold mb-3" style={{ background: 'rgba(6, 182, 212, 0.1)', color: '#06b6d4' }}>Curves</span>
            <h2 className="slide-title text-2xl md:text-3xl text-black">When To Use Curves</h2>
          </motion.div>

          <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
            {industries.map((item, i) => (
              <motion.div key={i} initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 + i * 0.1 }}
                onClick={() => setActiveIndex(i)}
                style={{
                  background: i === activeIndex ? 'linear-gradient(135deg, #1a1a1a, #2d2d2d)' : '#f5f5f5',
                  borderRadius: '16px', padding: '16px', cursor: 'pointer', position: 'relative', overflow: 'hidden',
                  boxShadow: i === activeIndex ? '0 0 30px rgba(6, 182, 212, 0.2)' : 'none',
                  transition: 'all 0.3s ease'
                }}>
                {i === activeIndex && <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: 'linear-gradient(90deg, transparent, #06b6d4, transparent)' }} />}
                <div style={{ width: '40px', height: '40px', borderRadius: '50%', background: i === activeIndex ? 'rgba(6, 182, 212, 0.2)' : 'white', display: 'flex', alignItems: 'center', justifyContent: 'center', marginBottom: '12px', color: '#06b6d4' }}>
                  {item.icon}
                </div>
                <h3 className="font-bold text-sm mb-1" style={{ color: i === activeIndex ? 'white' : '#171717' }}>{item.title}</h3>
                <p className="text-xs leading-relaxed" style={{ color: i === activeIndex ? '#a3a3a3' : '#737373' }}>{item.desc}</p>
                <div className="mt-2 text-xs font-semibold" style={{ color: '#06b6d4' }}>{item.reason}</div>
              </motion.div>
            ))}
          </div>
        </div>
      );
    };

    // Angles Industries Slide
    const AnglesIndustriesSlide = () => {
      const [activeIndex, setActiveIndex] = useState(0);
      const industries = [
        { icon: <Icons.Monitor />, title: 'Tech & Software', desc: 'Precise, efficient, cutting-edge. SaaS, AI tools, dev products.', reason: '"We\'re serious"' },
        { icon: <Icons.Briefcase />, title: 'Finance & B2B', desc: 'Professional, trustworthy, no-nonsense. Banking, consulting.', reason: '"Builds authority"' },
        { icon: <Icons.Dumbbell />, title: 'Performance & Sports', desc: 'Aggressive, fast, powerful. Fitness gear, cars, gaming.', reason: '"Triggers adrenaline"' },
        { icon: <Icons.Crown />, title: 'Luxury & Prestige', desc: 'Exclusive, sharp, aspirational. High-end watches, cars.', reason: '"Signals status"' }
      ];

      useEffect(() => {
        const timer = setInterval(() => setActiveIndex(i => (i + 1) % industries.length), 3000);
        return () => clearInterval(timer);
      }, []);

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto">
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
            <span className="inline-block px-3 py-1 rounded-full text-xs font-semibold mb-3" style={{ background: 'rgba(139, 92, 246, 0.1)', color: '#8b5cf6' }}>Angles</span>
            <h2 className="slide-title text-2xl md:text-3xl text-black">When To Use Angles</h2>
          </motion.div>

          <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
            {industries.map((item, i) => (
              <motion.div key={i} initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 + i * 0.1 }}
                onClick={() => setActiveIndex(i)}
                style={{
                  background: i === activeIndex ? 'linear-gradient(135deg, #1a1a1a, #2d2d2d)' : '#f5f5f5',
                  borderRadius: '4px', padding: '16px', cursor: 'pointer', position: 'relative', overflow: 'hidden',
                  boxShadow: i === activeIndex ? '0 0 30px rgba(139, 92, 246, 0.2)' : 'none',
                  transition: 'all 0.3s ease'
                }}>
                {i === activeIndex && <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: 'linear-gradient(90deg, transparent, #8b5cf6, transparent)' }} />}
                <div style={{ width: '40px', height: '40px', borderRadius: '4px', background: i === activeIndex ? 'rgba(139, 92, 246, 0.2)' : 'white', display: 'flex', alignItems: 'center', justifyContent: 'center', marginBottom: '12px', color: '#8b5cf6' }}>
                  {item.icon}
                </div>
                <h3 className="font-bold text-sm mb-1" style={{ color: i === activeIndex ? 'white' : '#171717' }}>{item.title}</h3>
                <p className="text-xs leading-relaxed" style={{ color: i === activeIndex ? '#a3a3a3' : '#737373' }}>{item.desc}</p>
                <div className="mt-2 text-xs font-semibold" style={{ color: '#8b5cf6' }}>{item.reason}</div>
              </motion.div>
            ))}
          </div>
        </div>
      );
    };

    // Car Battle Slide - Porsche vs Lamborghini
    const CarBattleSlide = () => {
      const [showInsight, setShowInsight] = useState(false);

      useEffect(() => {
        const timer = setTimeout(() => setShowInsight(true), 2000);
        return () => clearTimeout(timer);
      }, []);

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto">
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
            <span className="inline-block px-3 py-1 rounded-full text-xs font-semibold mb-3" style={{ background: 'rgba(251, 191, 36, 0.1)', color: '#fbbf24' }}>Real Example</span>
            <h2 className="slide-title text-2xl md:text-3xl text-black">Porsche 911 vs Lamborghini Aventador</h2>
          </motion.div>

          <div className="grid md:grid-cols-2 gap-4 mb-6">
            <motion.div initial={{ opacity: 0, x: -30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.2 }}
              style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '20px', padding: '24px', position: 'relative', overflow: 'hidden' }}>
              <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: 'linear-gradient(90deg, transparent, #06b6d4, transparent)' }} />
              <div className="flex items-center gap-2 mb-3">
                <div style={{ width: '36px', height: '36px', borderRadius: '50%', background: 'rgba(6, 182, 212, 0.2)', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                  <Icons.Circle />
                </div>
                <span className="text-white font-bold">Porsche 911</span>
              </div>
              <div className="mb-3">
                <div className="text-2xl font-bold mb-1" style={{ color: '#06b6d4' }}>CURVES</div>
                <div className="text-neutral-400 text-sm">Rounded edges, flowing lines, soft curves</div>
              </div>
              <div style={{ background: 'rgba(6, 182, 212, 0.1)', borderRadius: '12px', padding: '12px', border: '1px solid rgba(6, 182, 212, 0.2)' }}>
                <div className="text-xs text-neutral-500 mb-1">Emotion Triggered</div>
                <div className="text-white font-semibold">Elegant, Timeless, Refined</div>
                <div className="text-xs mt-1" style={{ color: '#06b6d4' }}>"Sophisticated performance"</div>
              </div>
            </motion.div>

            <motion.div initial={{ opacity: 0, x: 30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.3 }}
              style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '4px', padding: '24px', position: 'relative', overflow: 'hidden' }}>
              <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: 'linear-gradient(90deg, transparent, #ef4444, transparent)' }} />
              <div className="flex items-center gap-2 mb-3">
                <div style={{ width: '36px', height: '36px', borderRadius: '4px', background: 'rgba(239, 68, 68, 0.2)', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                  <Icons.Triangle />
                </div>
                <span className="text-white font-bold">Lamborghini Aventador</span>
              </div>
              <div className="mb-3">
                <div className="text-2xl font-bold mb-1" style={{ color: '#ef4444' }}>ANGLES</div>
                <div className="text-neutral-400 text-sm">Sharp edges, aggressive lines, angular body</div>
              </div>
              <div style={{ background: 'rgba(239, 68, 68, 0.1)', borderRadius: '4px', padding: '12px', border: '1px solid rgba(239, 68, 68, 0.2)' }}>
                <div className="text-xs text-neutral-500 mb-1">Emotion Triggered</div>
                <div className="text-white font-semibold">Dominant, Fierce, Powerful</div>
                <div className="text-xs mt-1" style={{ color: '#ef4444' }}>"Raw aggression"</div>
              </div>
            </motion.div>
          </div>

          <AnimatePresence>
            {showInsight && (
              <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }}
                style={{ background: 'linear-gradient(135deg, #fbbf24, #f59e0b)', borderRadius: '12px', padding: '16px', textAlign: 'center' }}>
                <div className="flex items-center justify-center gap-2 text-black font-bold">
                  <Icons.Lightbulb />
                  <span>Same category (supercars). Opposite shapes. Opposite customer emotions.</span>
                </div>
              </motion.div>
            )}
          </AnimatePresence>
        </div>
      );
    };

    // Button Demo Slide - Interactive button radius demo
    const ButtonDemoSlide = () => {
      const [activeRadius, setActiveRadius] = useState(1);
      const buttons = [
        { radius: '20px', label: 'Rounded (20px)', message: '"This is safe, try it"', color: '#06b6d4', use: 'Wellness, lifestyle' },
        { radius: '8px', label: 'Medium (8px)', message: '"Professional but friendly"', color: '#8b5cf6', use: 'Balanced brands' },
        { radius: '2px', label: 'Sharp (2px)', message: '"This is serious, commit now"', color: '#ef4444', use: 'Tech, finance' }
      ];

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto">
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
            <span className="inline-block px-3 py-1 rounded-full text-xs font-semibold mb-3" style={{ background: 'rgba(6, 182, 212, 0.1)', color: '#06b6d4' }}>Interactive Demo</span>
            <h2 className="slide-title text-2xl md:text-3xl text-black">The Button Shape Test</h2>
            <p className="text-neutral-500 text-sm mt-2">Your CTA button shape is telling customers how to feel</p>
          </motion.div>

          <div className="flex flex-col md:flex-row gap-4 justify-center items-stretch mb-6">
            {buttons.map((btn, i) => (
              <motion.div key={i} initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 + i * 0.1 }}
                onClick={() => setActiveRadius(i)}
                style={{
                  background: i === activeRadius ? 'linear-gradient(135deg, #1a1a1a, #2d2d2d)' : '#f5f5f5',
                  borderRadius: '16px', padding: '24px', flex: 1, cursor: 'pointer', position: 'relative', overflow: 'hidden',
                  textAlign: 'center', transition: 'all 0.3s ease',
                  boxShadow: i === activeRadius ? `0 0 30px ${btn.color}30` : 'none'
                }}>
                {i === activeRadius && <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: `linear-gradient(90deg, transparent, ${btn.color}, transparent)` }} />}
                <button style={{ background: btn.color, color: 'white', padding: '12px 32px', borderRadius: btn.radius, border: 'none', fontWeight: 'bold', marginBottom: '16px', cursor: 'pointer' }}>
                  Buy Now
                </button>
                <div className="font-bold mb-1" style={{ color: i === activeRadius ? 'white' : '#171717' }}>{btn.label}</div>
                <div className="text-sm mb-2" style={{ color: btn.color }}>{btn.message}</div>
                <div className="text-xs" style={{ color: i === activeRadius ? '#a3a3a3' : '#737373' }}>{btn.use}</div>
              </motion.div>
            ))}
          </div>

          <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ delay: 0.5 }}
            className="text-center text-neutral-500 text-sm">
            The shape sets the tone before they read the copy
          </motion.div>
        </div>
      );
    };

    // Shape Stats Slide - AnimatedCounter stats
    const ShapeStatsSlide = () => {
      const stats = [
        { value: '50', suffix: 'ms', label: 'Shape Processing', subtext: 'Before reading any text', color: '#06b6d4' },
        { value: '2.6', suffix: 'x', label: 'Recall Boost', subtext: 'Curves for wellness brands', color: '#8b5cf6' },
        { value: '43', suffix: '%', label: 'Trust Increase', subtext: 'Angles for tech products', color: '#10b981' }
      ];

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto">
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
            <h2 className="slide-title text-2xl md:text-4xl text-black">Shape Psychology In Action</h2>
          </motion.div>

          <div className="grid md:grid-cols-3 gap-4">
            {stats.map((stat, i) => (
              <motion.div key={i} initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 + i * 0.15 }}
                style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '16px', padding: '28px', textAlign: 'center', position: 'relative', overflow: 'hidden' }}>
                <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: `linear-gradient(90deg, transparent, ${stat.color}, transparent)` }} />
                <div className="text-5xl md:text-6xl font-bold mb-2" style={{ color: stat.color }}>
                  <AnimatedCounter value={stat.value} suffix={stat.suffix} />
                </div>
                <div className="text-white font-semibold mb-1">{stat.label}</div>
                <div className="text-neutral-400 text-xs">{stat.subtext}</div>
              </motion.div>
            ))}
          </div>
        </div>
      );
    };

    // Brand Shapes Slide - Logo shape categories
    const BrandShapesSlide = () => {
      const [activeCategory, setActiveCategory] = useState(0);
      const categories = [
        { shape: <Icons.Circle />, label: 'Circle/Oval', meaning: 'Community, Unity, Inclusivity', brands: 'Target, Pepsi, BMW', color: '#06b6d4' },
        { shape: <Icons.Square />, label: 'Square/Rectangle', meaning: 'Stability, Trust, Reliability', brands: 'Microsoft, Adobe, American Express', color: '#8b5cf6' },
        { shape: <Icons.Triangle />, label: 'Triangle/Sharp', meaning: 'Innovation, Direction, Energy', brands: 'Adidas, Reebok, Delta', color: '#ef4444' }
      ];

      useEffect(() => {
        const timer = setInterval(() => setActiveCategory(i => (i + 1) % categories.length), 3000);
        return () => clearInterval(timer);
      }, []);

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto">
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
            <h2 className="slide-title text-2xl md:text-3xl text-black mb-2">The Logo Shape Rule</h2>
            <p className="text-neutral-500 text-sm">Your logo shape is your brand's first impression</p>
          </motion.div>

          <div className="flex justify-center gap-4 mb-6">
            {categories.map((cat, i) => (
              <motion.div key={i} initial={{ opacity: 0, scale: 0.9 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.1 + i * 0.1 }}
                onClick={() => setActiveCategory(i)}
                style={{
                  width: '80px', height: '80px', borderRadius: i === 0 ? '50%' : i === 1 ? '12px' : '4px',
                  background: i === activeCategory ? cat.color : '#e5e7eb',
                  display: 'flex', alignItems: 'center', justifyContent: 'center', cursor: 'pointer',
                  color: i === activeCategory ? 'white' : '#6b7280',
                  transform: i === activeCategory ? 'scale(1.15)' : 'scale(1)',
                  boxShadow: i === activeCategory ? `0 0 30px ${cat.color}40` : 'none',
                  transition: 'all 0.3s ease'
                }}>
                {cat.shape}
              </motion.div>
            ))}
          </div>

          <motion.div key={activeCategory} initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }}
            style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '16px', padding: '24px', textAlign: 'center', position: 'relative', overflow: 'hidden' }}>
            <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: `linear-gradient(90deg, transparent, ${categories[activeCategory].color}, transparent)` }} />
            <div className="text-2xl font-bold mb-2" style={{ color: categories[activeCategory].color }}>{categories[activeCategory].label}</div>
            <div className="text-white text-lg mb-2">{categories[activeCategory].meaning}</div>
            <div className="text-neutral-400 text-sm">{categories[activeCategory].brands}</div>
          </motion.div>
        </div>
      );
    };

    // App Comparison Slide - Headspace vs GitHub
    const AppComparisonSlide = () => {
      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto">
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
            <span className="inline-block px-3 py-1 rounded-full text-xs font-semibold mb-3" style={{ background: 'rgba(16, 185, 129, 0.1)', color: '#10b981' }}>Perfect Execution</span>
            <h2 className="slide-title text-2xl md:text-3xl text-black">Headspace vs GitHub</h2>
          </motion.div>

          <div className="grid md:grid-cols-2 gap-4">
            <motion.div initial={{ opacity: 0, x: -30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.2 }}
              style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '24px', padding: '24px', position: 'relative', overflow: 'hidden' }}>
              <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: 'linear-gradient(90deg, transparent, #f97316, transparent)' }} />
              <div className="text-center mb-4">
                <div className="inline-block px-4 py-2 rounded-full text-white font-bold text-sm" style={{ background: '#f97316' }}>Headspace</div>
              </div>
              <div className="space-y-2 mb-4">
                <div className="flex items-center gap-2 text-neutral-400 text-sm">
                  <Icons.Check /> Soft rounded buttons
                </div>
                <div className="flex items-center gap-2 text-neutral-400 text-sm">
                  <Icons.Check /> Circular icons
                </div>
                <div className="flex items-center gap-2 text-neutral-400 text-sm">
                  <Icons.Check /> Flowing shapes
                </div>
              </div>
              <div style={{ background: 'rgba(249, 115, 22, 0.1)', borderRadius: '16px', padding: '12px', textAlign: 'center', border: '1px solid rgba(249, 115, 22, 0.2)' }}>
                <div className="text-white font-semibold mb-1">Feeling: Calm, Safe, Inviting</div>
                <div className="text-xs" style={{ color: '#f97316' }}>Perfect for meditation app</div>
              </div>
            </motion.div>

            <motion.div initial={{ opacity: 0, x: 30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.3 }}
              style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '4px', padding: '24px', position: 'relative', overflow: 'hidden' }}>
              <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: 'linear-gradient(90deg, transparent, #6366f1, transparent)' }} />
              <div className="text-center mb-4">
                <div className="inline-block px-4 py-2 rounded text-white font-bold text-sm" style={{ background: '#6366f1', borderRadius: '4px' }}>GitHub</div>
              </div>
              <div className="space-y-2 mb-4">
                <div className="flex items-center gap-2 text-neutral-400 text-sm">
                  <Icons.Check /> Sharp buttons
                </div>
                <div className="flex items-center gap-2 text-neutral-400 text-sm">
                  <Icons.Check /> Angular UI
                </div>
                <div className="flex items-center gap-2 text-neutral-400 text-sm">
                  <Icons.Check /> Precise edges
                </div>
              </div>
              <div style={{ background: 'rgba(99, 102, 241, 0.1)', borderRadius: '4px', padding: '12px', textAlign: 'center', border: '1px solid rgba(99, 102, 241, 0.2)' }}>
                <div className="text-white font-semibold mb-1">Feeling: Technical, Efficient, Pro</div>
                <div className="text-xs" style={{ color: '#6366f1' }}>Perfect for code platform</div>
              </div>
            </motion.div>
          </div>

          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.5 }}
            className="mt-4 text-center text-neutral-500 text-sm">
            Both use shape psychology perfectly for their audience
          </motion.div>
        </div>
      );
    };

    // Application Grid Slide
    const ApplicationGridSlide = () => {
      const apps = [
        { icon: <Icons.Target />, title: 'CTAs & Buttons', curves: '16px+ radius', angles: '4-8px radius', tip: 'Match to brand emotion' },
        { icon: <Icons.Square />, title: 'Cards & Containers', curves: 'Soft rounded cards', angles: 'Subtle/sharp edges', tip: 'Consistency matters' },
        { icon: <Icons.Settings />, title: 'Icons & Graphics', curves: 'Human-focused products', angles: 'Tech/performance products', tip: 'Icons reinforce feeling' },
        { icon: <Icons.Monitor />, title: 'Overall Layout', curves: 'Organic flowing layouts', angles: 'Grid-based angular', tip: 'Structure = emotion' }
      ];

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto">
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
            <h2 className="slide-title text-2xl md:text-3xl text-black mb-2">Applying Shape Psychology</h2>
          </motion.div>

          <div className="grid grid-cols-2 gap-3">
            {apps.map((app, i) => (
              <motion.div key={i} initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 + i * 0.1 }}
                style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '12px', padding: '16px', position: 'relative', overflow: 'hidden' }}>
                <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '3px', background: `linear-gradient(90deg, transparent, ${i % 2 === 0 ? '#06b6d4' : '#8b5cf6'}, transparent)` }} />
                <div className="flex items-center gap-2 mb-3">
                  <div style={{ width: '32px', height: '32px', borderRadius: '8px', background: `rgba(${i % 2 === 0 ? '6, 182, 212' : '139, 92, 246'}, 0.2)`, display: 'flex', alignItems: 'center', justifyContent: 'center', color: i % 2 === 0 ? '#06b6d4' : '#8b5cf6' }}>
                    {app.icon}
                  </div>
                  <span className="text-white font-bold text-sm">{app.title}</span>
                </div>
                <div className="grid grid-cols-2 gap-2 mb-2">
                  <div style={{ background: 'rgba(6, 182, 212, 0.1)', borderRadius: '8px', padding: '8px', fontSize: '11px' }}>
                    <div style={{ color: '#06b6d4' }}>Curves</div>
                    <div className="text-neutral-400">{app.curves}</div>
                  </div>
                  <div style={{ background: 'rgba(139, 92, 246, 0.1)', borderRadius: '4px', padding: '8px', fontSize: '11px' }}>
                    <div style={{ color: '#8b5cf6' }}>Angles</div>
                    <div className="text-neutral-400">{app.angles}</div>
                  </div>
                </div>
                <div className="text-xs text-neutral-500">{app.tip}</div>
              </motion.div>
            ))}
          </div>
        </div>
      );
    };

    // Elite Insight Slide
    const EliteInsightSlide = () => {
      return (
        <div className="h-full flex flex-col justify-center items-center px-6 md:px-12 max-w-3xl mx-auto">
          <motion.div initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }}
            style={{ background: 'linear-gradient(135deg, #1a1a1a, #2d2d2d)', borderRadius: '20px', padding: '32px', width: '100%', position: 'relative', overflow: 'hidden', boxShadow: '0 0 60px rgba(6, 182, 212, 0.15)' }}>
            <div style={{ position: 'absolute', top: 0, left: 0, right: 0, height: '4px', background: 'linear-gradient(90deg, #06b6d4, #8b5cf6, #06b6d4)' }} />

            <div className="text-center mb-6">
              <div className="inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-semibold" style={{ background: 'rgba(6, 182, 212, 0.2)', color: '#06b6d4' }}>
                <Icons.Lightbulb />
                The Shape Insight
              </div>
            </div>

            <blockquote className="text-xl md:text-2xl text-white text-center font-medium mb-6 leading-relaxed">
              "Choose the emotion you want to trigger, then choose the shape. Not the other way around."
            </blockquote>

            <div className="grid grid-cols-4 gap-3">
              {[
                { icon: <Icons.Brain />, label: '50ms', subtext: 'Decision' },
                { icon: <Icons.Circle />, label: 'Curves', subtext: 'Safe' },
                { icon: <Icons.Triangle />, label: 'Angles', subtext: 'Power' },
                { icon: <Icons.Target />, label: 'Match', subtext: 'Emotion' }
              ].map((item, i) => (
                <motion.div key={i} initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.3 + i * 0.1 }}
                  style={{ background: 'rgba(255,255,255,0.05)', borderRadius: '12px', padding: '12px', textAlign: 'center' }}>
                  <div style={{ color: '#06b6d4', marginBottom: '4px' }}>{item.icon}</div>
                  <div className="text-white font-bold text-sm">{item.label}</div>
                  <div className="text-neutral-500 text-xs">{item.subtext}</div>
                </motion.div>
              ))}
            </div>
          </motion.div>
        </div>
      );
    };

    // ============ STANDARD SLIDES ============
    const WelcomeSlide = ({ data, onStart, userName, onShowGif, onHideGif }) => {
      const welcomeData = useMemo(() => getTimeBasedWelcome(), []);
      const gifSide = useMemo(() => Math.random() > 0.5 ? 'left' : 'right', []);

      useEffect(() => {
        onShowGif(welcomeData.gif, '65%', gifSide);
        return () => onHideGif();
      }, [welcomeData.gif, gifSide, onShowGif, onHideGif]);

      return (
        <div className="h-full w-full relative overflow-hidden">
          <div className="h-full flex flex-col items-center justify-center text-center px-6 py-4 relative z-20">
            <motion.h1 initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} className="title-font text-3xl sm:text-4xl md:text-5xl lg:text-6xl text-black mb-2 md:mb-3">{LESSON_CONFIG.title}</motion.h1>
            <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-neutral-600 text-base md:text-lg lg:text-xl mb-2 md:mb-3 max-w-lg leading-relaxed" dangerouslySetInnerHTML={{ __html: formatGreeting(welcomeData.greeting, `<span class="font-bold text-neutral-900">${userName}</span>`) }} />
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="flex items-center justify-center gap-1.5 text-neutral-400 text-[10px] md:text-xs mb-2 md:mb-3"><Icons.Clock /><span>{LESSON_CONFIG.duration}</span></motion.div>
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 }} className="bg-neutral-900 rounded-xl md:rounded-2xl p-3 md:p-5 mb-3 md:mb-4 max-w-sm w-full mx-auto">
              <p className="text-neutral-500 text-[9px] md:text-[11px] uppercase tracking-wider mb-2 md:mb-3">In this lesson</p>
              <ul className="space-y-1.5 md:space-y-2">
                {data.learningGoals.map((goal, i) => (
                  <motion.li key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.25 + i * 0.05 }} className="flex items-start gap-2 text-left">
                    <span className="w-5 h-5 rounded-md flex items-center justify-center text-[9px] font-bold text-white flex-shrink-0 mt-0.5" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>{i + 1}</span>
                    <span className="text-neutral-300 text-[11px] md:text-sm leading-snug">{goal}</span>
                  </motion.li>
                ))}
              </ul>
            </motion.div>
            <motion.button initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.45 }} onClick={onStart} whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }} className="px-6 md:px-7 py-2.5 md:py-3 rounded-xl text-white font-semibold text-sm md:text-base" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>Let's Go</motion.button>
          </div>
        </div>
      );
    };

    const HookSlide = ({ data }) => (
      <div className="h-full relative overflow-hidden">
        <div className="h-full flex flex-col justify-center px-6 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-8 md:py-10 relative z-10">
          <motion.div initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} className="mb-4 md:mb-6">
            <span className="inline-block px-3 py-1 rounded-full text-xs font-semibold mb-3 md:mb-4" style={{ background: `rgba(var(--accent-rgb), 0.1)`, color: 'var(--accent)' }}>The Hook</span>
            <h2 className="slide-title text-2xl md:text-4xl lg:text-5xl text-black leading-tight">{data.headline}</h2>
          </motion.div>
          <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="text-base md:text-xl text-neutral-600 leading-relaxed">{data.subtext}</motion.p>
        </div>
        {data.brandImage && (
          <motion.div initial={{ opacity: 0, x: 30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.3, duration: 0.5 }}
            className="absolute bottom-0 right-0 z-0 pointer-events-none hidden md:block" style={{ height: '30%', maxHeight: '200px', marginRight: '80px', marginBottom: '5%' }}>
            <img src={data.brandImage} alt={data.brandName || ''} className="h-full w-auto object-contain" style={{ opacity: 1 }} />
          </motion.div>
        )}
      </div>
    );

    const QuizSlide = ({ data, onShowGif, onHideGif }) => {
      const [selected, setSelected] = useState(null);
      const [showFeedback, setShowFeedback] = useState(false);
      const celebrationGif = useMemo(() => getRandomCelebrationGif(), []);
      const empathyGif = useMemo(() => getRandomEmpathyGif(), []);
      const gifSide = useMemo(() => Math.random() > 0.5 ? 'left' : 'right', []);
      const handleSelect = (index) => { if (showFeedback) return; setSelected(index); setShowFeedback(true); };
      const isCorrect = selected === data.correctIndex;

      useEffect(() => {
        if (showFeedback) {
          if (isCorrect) { onShowGif(celebrationGif, '60%', gifSide); } else { onShowGif(empathyGif, '60%', gifSide); }
        }
      }, [showFeedback, isCorrect, celebrationGif, empathyGif, gifSide, onShowGif]);

      useEffect(() => { return () => onHideGif(); }, [onHideGif]);

      return (
        <div className="h-full w-full relative overflow-hidden">
          <div className="h-full flex flex-col justify-center px-8 md:px-12 max-w-2xl mx-auto slide-scroll overflow-y-auto py-10 relative z-30">
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6 relative z-10">
              <p className="text-xs uppercase tracking-wider text-neutral-400 mb-3">Quick Check</p>
              <h2 className="slide-title text-xl md:text-2xl text-black leading-tight">{data.question}</h2>
            </motion.div>
            <div className="space-y-3 mb-6">
              {data.options.map((option, i) => (
                <motion.button key={i} initial={{ opacity: 0, x: -15 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.08 + i * 0.06 }} onClick={() => handleSelect(i)} disabled={showFeedback} className={`w-full p-4 rounded-xl text-left transition-all border-2 ${showFeedback ? i === data.correctIndex ? 'border-green-500 bg-green-50' : i === selected ? 'border-red-400 bg-red-50' : 'border-neutral-200 bg-white opacity-40' : 'border-neutral-200 bg-white hover:border-neutral-300'}`}>
                  <div className="flex items-center gap-3">
                    <span className={`w-8 h-8 rounded-lg flex items-center justify-center text-sm font-bold transition-all ${showFeedback && i === data.correctIndex ? 'bg-green-500 text-white' : showFeedback && i === selected && !isCorrect ? 'bg-red-400 text-white' : 'bg-neutral-100 text-neutral-500'}`}>
                      {showFeedback && i === data.correctIndex ? <Icons.Check /> : showFeedback && i === selected && !isCorrect ? <Icons.X /> : String.fromCharCode(65 + i)}
                    </span>
                    <span className="text-neutral-700 text-sm md:text-base">{option}</span>
                  </div>
                </motion.button>
              ))}
            </div>
            <AnimatePresence>
              {showFeedback && (
                <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className={`p-5 rounded-xl ${isCorrect ? 'bg-green-50 border border-green-200' : 'bg-amber-50 border border-amber-200'}`}>
                  <p className={`text-sm leading-relaxed ${isCorrect ? 'text-green-800' : 'text-amber-800'}`}>{isCorrect ? data.feedback.correct : data.feedback.incorrect}</p>
                </motion.div>
              )}
            </AnimatePresence>
          </div>
        </div>
      );
    };

    const CompletionSlide = () => (
      <div className="h-full flex flex-col items-center justify-center text-center px-8 slide-scroll overflow-y-auto py-10">
        <motion.div initial={{ opacity: 0, scale: 0 }} animate={{ opacity: 1, scale: 1 }} transition={{ type: 'spring', duration: 0.5 }} className="w-20 h-20 rounded-xl flex items-center justify-center mb-6 text-white" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))`, boxShadow: `0 6px 24px rgba(var(--accent-rgb), 0.35)` }}><Icons.Check /></motion.div>
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="slide-title text-3xl md:text-4xl text-black mb-4">Lesson Complete</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.25 }} className="text-neutral-500 text-base mb-8 max-w-md leading-relaxed">You now understand Shape Psychology. Use curves for warmth and safety. Use angles for precision and power. Match shapes to emotions.</motion.p>
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.35 }} className="bg-neutral-900 rounded-xl p-6 max-w-md w-full">
          <p className="text-neutral-500 text-xs uppercase tracking-wider mb-3">Up Next</p>
          <h3 className="text-white font-bold text-xl mb-2">{LESSON_CONFIG.nextLesson.title}</h3>
          <p className="text-neutral-400 text-sm">{LESSON_CONFIG.nextLesson.teaser}</p>
        </motion.div>
      </div>
    );

    // ============ MAIN APP ============
    const LessonApp = () => {
      const [currentSlide, setCurrentSlide] = useState(0);
      const [direction, setDirection] = useState(1);
      const userName = useMemo(() => getUserName(), []);
      const currentSlideRef = React.useRef(0);
      const [gifConfig, setGifConfig] = useState(null);
      const [isAnimating, setIsAnimating] = useState(false);

      const showGif = useCallback((url, height, side) => setGifConfig({ url, height, side }), []);
      const hideGif = useCallback(() => setGifConfig(null), []);

      React.useEffect(() => { currentSlideRef.current = currentSlide; }, [currentSlide]);

      useEffect(() => {
        window.parent.postMessage({
          type: 'LESSON_SLIDE_UPDATE',
          slideIndex: currentSlide,
          slideType: slides[currentSlide]?.type,
          lessonSlug: LESSON_CONFIG.id
        }, '*');
      }, [currentSlide]);

      const goToSlide = useCallback((newSlide) => {
        if (isAnimating || newSlide < 0 || newSlide >= slides.length) return;
        setIsAnimating(true);
        setDirection(newSlide > currentSlideRef.current ? 1 : -1);
        setCurrentSlide(newSlide);
      }, [isAnimating]);

      const nextSlide = useCallback(() => { if (currentSlideRef.current + 1 < slides.length) goToSlide(currentSlideRef.current + 1); }, [goToSlide]);
      const prevSlide = useCallback(() => { if (currentSlideRef.current - 1 >= 0) goToSlide(currentSlideRef.current - 1); }, [goToSlide]);

      useEffect(() => {
        const handleKeyDown = (e) => {
          if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); nextSlide(); }
          if (e.key === 'ArrowLeft') { e.preventDefault(); prevSlide(); }
        };
        window.addEventListener('keydown', handleKeyDown);
        return () => window.removeEventListener('keydown', handleKeyDown);
      }, [nextSlide, prevSlide]);

      const slideVariants = {
        enter: (dir) => ({ x: dir > 0 ? '100%' : '-100%', opacity: 0 }),
        center: { x: 0, opacity: 1 },
        exit: (dir) => ({ x: dir > 0 ? '-100%' : '100%', opacity: 0 })
      };

      const renderSlide = (slide) => {
        switch (slide.type) {
          case 'welcome': return <WelcomeSlide data={slide} onStart={nextSlide} userName={userName} onShowGif={showGif} onHideGif={hideGif} />;
          case 'hook': return <HookSlide data={slide} />;
          case 'brain-speed': return <BrainSpeedSlide />;
          case 'shape-spectrum': return <ShapeSpectrumSlide />;
          case 'curves-industries': return <CurvesIndustriesSlide />;
          case 'angles-industries': return <AnglesIndustriesSlide />;
          case 'car-battle': return <CarBattleSlide />;
          case 'button-demo': return <ButtonDemoSlide />;
          case 'shape-stats': return <ShapeStatsSlide />;
          case 'brand-shapes': return <BrandShapesSlide />;
          case 'app-comparison': return <AppComparisonSlide />;
          case 'application-grid': return <ApplicationGridSlide />;
          case 'elite-insight': return <EliteInsightSlide />;
          case 'quiz': return <QuizSlide data={slide} onShowGif={showGif} onHideGif={hideGif} />;
          case 'completion': return <CompletionSlide />;
          default: return null;
        }
      };

      const showPrev = currentSlide > 0;
      const showNext = currentSlide < slides.length - 1 && slides[currentSlide].type !== 'welcome';

      return (
        <div className="w-full h-screen bg-white flex flex-col relative">
          <div className="flex-1 relative overflow-hidden z-20">
            <AnimatePresence mode="wait" custom={direction} onExitComplete={() => setIsAnimating(false)}>
              <motion.div key={currentSlide} custom={direction} variants={slideVariants} initial="enter" animate="center" exit="exit" transition={{ duration: 0.3, ease: [0.25, 0.1, 0.25, 1] }} className="absolute inset-0">
                {renderSlide(slides[currentSlide])}
                <AdminSlideReportButton slideIndex={currentSlide} slideType={slides[currentSlide].type} />
              </motion.div>
            </AnimatePresence>
            {showPrev && <button onClick={prevSlide} className="absolute left-5 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-500 hover:text-neutral-700 transition-all z-10"><Icons.ArrowLeft /></button>}
            {showNext && <button onClick={nextSlide} className="absolute right-5 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-500 hover:text-neutral-700 transition-all z-10"><Icons.ArrowRight /></button>}
          </div>
          <div className="px-6 md:px-8 py-5 border-t border-neutral-100 flex-shrink-0 relative z-10">
            <div className="flex items-center justify-center gap-2.5">
              {slides.map((_, i) => <button key={i} onClick={() => goToSlide(i)} className="w-2.5 h-2.5 rounded-full transition-all duration-300" style={{ background: i === currentSlide ? 'var(--accent)' : '#d4d4d4', transform: i === currentSlide ? 'scale(1.3)' : 'scale(1)' }} />)}
            </div>
          </div>
          <AnimatePresence>
            {gifConfig && (
              <motion.div initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: 30 }} transition={{ type: 'spring', stiffness: 100 }} className={`absolute ${gifConfig.side === 'left' ? 'left-4 md:left-8' : 'right-4 md:right-8'} bottom-0 pointer-events-none`} style={{ zIndex: 15, height: gifConfig.height }}>
                <video autoPlay loop muted playsInline className="h-full w-auto object-contain object-bottom" style={{ background: 'transparent', border: 'none', boxShadow: 'none' }}>
                  <source src={gifConfig.url} type="video/mp4" />
                </video>
              </motion.div>
            )}
          </AnimatePresence>
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<LessonApp />);
  </script>
</body>
</html>
