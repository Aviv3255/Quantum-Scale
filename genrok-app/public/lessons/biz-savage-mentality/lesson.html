<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Savage Mentality | Quantum Scale</title>
  <script src="https://cdn.tailwindcss.com" defer></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" defer></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" defer></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js" defer></script>
  <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js" defer></script>
  <script src="../shared/greetings.js" defer></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://unpkg.com" crossorigin>
  <link rel="preconnect" href="https://cdn.tailwindcss.com" crossorigin>
  <link rel="preconnect" href="https://pqvvrljykfvhpyvxmwzb.supabase.co" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;500;600;700;800;900&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root { --accent: #EF4444; --accent-dark: #DC2626; --accent-light: #F87171; --accent-rgb: 239, 68, 68; }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Inter', sans-serif; background: transparent; -webkit-font-smoothing: antialiased; }
    .title-font { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    h1, h2, h3, .slide-title { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    ::selection { background: var(--accent); color: white; }
    .slide-scroll::-webkit-scrollbar { display: none; }
    .slide-scroll { -ms-overflow-style: none; scrollbar-width: none; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { motion, AnimatePresence } = window.Motion;
    const { useState, useEffect, useCallback, useMemo } = React;

    const getUserName = () => { const params = new URLSearchParams(window.location.search); return params.get('userName') || 'Builder'; };

    const LESSON_CONFIG = {
      id: 'biz-savage-mentality',
      title: 'The Savage Mentality',
      description: 'Action over cope - the elite entrepreneur mindset',
      accentColor: '#EF4444',
      duration: '6 min',
      nextLesson: { id: 'biz-high-margin-fortress', title: 'The High Margin Fortress', teaser: 'Why selling cheap is a death sentence for eCommerce.' }
    };

    const celebrationGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_doing_a_quick_victory_dance_move_high_energy_c_d03b798b-a518-4e6c-bcae-d69b2dd50486_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_jumping_in_the_air_arms_raised_high_YESSS_cele_201477e8-3df4-405a-bc81-81d1747e5c6c_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_playing_air_guitar_light_headbanging_rockstar__0702007e-9e84-4d9e-8f99-8ee23d0b65f8_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_doing_the_running_man_dance_move_vintage_cool__25682b0f-cf4c-4e93-8dcb-6c3dac8135cd_0.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_standing_and_clapping_enthusiastically_mouth_o_992ac4fd-9a0e-4963-bbcc-a5271f25f4fd_3.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_clapping_very_fast_huge_smile_extreme_exciteme_9a4dde09-55ca-4173-a47d-613bc2924230_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_clapping_above_head_world_champion_celebration_484bd560-f049-41ca-b3d1-c03d7468ab56_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_starting_with_slow_clap_accelerating_to_fast_c_ee478a38-0ee7-437d-bd13-d687f7dd624a_0.mp4'
    ];
    const getRandomCelebrationGif = () => celebrationGifs[Math.floor(Math.random() * celebrationGifs.length)];

    const empathyGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_thumbs_down_with_encouraging_nod_close_keep_go_613e541f-c072-436f-aee7-f99cd6f834fc_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_shaking_head_side_to_side_sadly_disappointed_e_c4a4be22-6a70-4738-8612-3039454fef37_1.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_covering_face_with_palm_facepalm_gesture_disap_211b0566-078f-4d42-9c41-547b14f5827c_0.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_looking_down_sadly_shoulders_slumped_disappoin_790d48bd-e49e-40ea-9979-d3e86fa3a422_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_wiping_away_a_small_tear_sad_but_gentle_disapp_8d78571b-3c36-4502-abee-81683255843c_1.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_sighing_sadly_exhaling_with_disappointment_hea_f6014f2a-3a99-4378-a2a8-414e16b3e72d_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_slouching_with_disappointment_body_curling_inw_caedddbe-413c-492a-9fdf-1e8433f5e2a8_2%20(1).mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_placing_hand_on_forehead_sadly_eyes_closed_fru_3e048895-f365-4ff2-9e88-0d0a35b2a9e1_3.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_nodding_slowly_with_sadness_what_a_shame_expre_377f67ca-63da-41aa-9072-4926fc2f6e82_3.mp4'
    ];
    const getRandomEmpathyGif = () => empathyGifs[Math.floor(Math.random() * empathyGifs.length)];

    const slides = [
      { type: 'welcome', learningGoals: ['The "Cope" trap that kills progress', 'How elite entrepreneurs respond to adversity', 'The brutal grind stories behind billion-dollar brands'] },
      { type: 'hook', headline: 'Most entrepreneurs cope with failure. Elite entrepreneurs get pissed off and take action.', subtext: 'The algorithm changed. Tariffs hit. Ads stopped working. Most people blame external forces. They cope. They complain. They make excuses. Elite entrepreneurs don\'t cope. They take massive, immediate action. This mindset difference separates winners from wishers.' , brandImage: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/Meta_Platforms_Inc._logo_(cropped).svg.png', brandName: 'Facebook' },
      { type: 'cope-vs-action', title: 'Cope vs Action: The Split', copeResponse: { label: 'THE COPE RESPONSE', items: ['Blame the algorithm', 'Complain about tariffs', 'Say the market is saturated', 'Wait for conditions to improve', 'Make excuses'], color: '#6B7280', icon: 'MessageCircle' }, actionResponse: { label: 'THE ACTION RESPONSE', items: ['F*** that, make 10 new creatives', 'Test different products immediately', 'Launch new campaigns today', 'Adapt strategy in real-time', 'Refuse to be a victim'], color: '#EF4444', icon: 'Zap' } },
      { type: 'cope-examples', title: 'What "Cope" Sounds Like', examples: [
        { quote: 'The algorithm hates me.', reality: 'Your creative sucks. The algorithm is neutral.' },
        { quote: 'Tariffs destroyed my margins.', reality: 'You chose low-margin products. Pivot or die.' },
        { quote: 'The market is too saturated now.', reality: 'Winners adapt. Losers complain about competition.' },
        { quote: 'Facebook ads don\'t work anymore.', reality: 'They work for people who test 50 creatives.' }
      ] },
      { type: 'savage-response', title: 'The Savage Response', quote: 'They\'re like "f*** that" and they just start doing more creatives or they make better creatives...', source: 'From The E-commerce Cheat Code', responses: [
        { trigger: 'Slow sales day', action: 'Launch 5 new ad variations immediately', result: 'Find the winning angle' },
        { trigger: 'Ad account shut down', action: 'Spin up backup accounts, test new platforms', result: 'Diversified traffic sources' },
        { trigger: 'Product margins squeezed', action: 'Test premium positioning or find new suppliers', result: 'Better margins or better product' }
      ] },
      { type: 'grind-stories', title: 'The Grind Is The Price of Entry', stories: [
        { name: 'Ben Francis', brand: 'Gymshark', worth: '$1.3B valuation', grind: 'University classes during the day. Pizza Hut delivery driver at night. Built a fitness empire from a garage with zero sleep and maximum hustle.', color: '#3B82F6', image: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/channels4_profile__2_-removebg-preview.png' },
        { name: 'Christian Guzman', brand: 'Alphalete', worth: '$10M+ brand', grind: 'Opened a 1,500 sq ft gym. Failed in 10 months. Slept on a futon. Ate ramen. Refused to quit. Now runs a premium activewear empire.', color: '#8B5CF6', image: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/image.webp' },
        { name: 'Hudson Leogrande', brand: 'Comfrt', worth: '$500M/year', grind: 'Homeless at 16. Living in a drug dealer\'s studio apartment. Started selling hoodies. Now runs a $500M/year blanket empire. Zero excuses.', color: '#F59E0B', image: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/584271bU03giJ3-removebg-preview.png' }
      ] },
      { type: 'highlight-box', title: 'Success Isn\'t A Fantasy', body: 'Every billion-dollar brand started in a garage, a dorm room, or a shitty apartment. The founders weren\'t special. They didn\'t have advantages. They had problems. They had setbacks. They had every reason to quit. But they didn\'t cope. They didn\'t blame external conditions. They took action. They adapted. They refused to be victims.', highlight: 'Success isn\'t a fantasy. It\'s forged in failure.' },
      { type: 'mindset-audit', title: 'Your Mindset Audit', scenarios: [
        { situation: 'Your best product gets banned on Facebook Ads.', cope: 'Give up on paid ads entirely', action: 'Test Google, TikTok, Pinterest same day' },
        { situation: 'A competitor undercuts your price by 40%.', cope: 'Lower your price to compete', action: 'Double down on premium positioning' },
        { situation: 'Your sales drop 50% overnight.', cope: 'Panic and wait for them to recover', action: 'Launch 20 new creatives and test 3 new offers' }
      ] },
      { type: 'action-checklist', title: 'The Action Protocol', checklist: [
        { action: 'When sales slow, launch 10 new creatives within 24 hours', category: 'Ads' },
        { action: 'When margins compress, test premium positioning immediately', category: 'Pricing' },
        { action: 'When traffic sources fail, activate 2 backup platforms', category: 'Traffic' },
        { action: 'When competitors attack, improve your offer and double down', category: 'Competition' },
        { action: 'When self-doubt creeps in, remember: you control the effort', category: 'Mindset' }
      ] },
      { type: 'quiz', question: 'What is the elite entrepreneur response to a slow sales day?', options: ['Blame the algorithm and wait for it to improve', 'Lower prices to compete with cheaper competitors', 'Get pissed off and launch 10 new creatives immediately', 'Take a break and hope sales recover naturally'], correctIndex: 2, feedback: { correct: 'Exactly. Elite entrepreneurs refuse to be victims. They don\'t cope. They don\'t wait. They take massive, immediate action. Slow day? F*** that. Launch 10 new creatives. Test new angles. Find what works. This is the savage mentality that separates winners from wishers.', incorrect: 'Not quite. Elite entrepreneurs don\'t cope or wait for external conditions to improve. They get pissed off and take massive action. Slow day = personal challenge. Launch 10 new creatives immediately. Test new angles. Adapt in real-time. Action over cope, always.' }},
      { type: 'completion', sources: [] }
    ];

    // Icons
    const Icons = {
      Clock: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
      Check: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><polyline points="20 6 9 17 4 12"/></svg>,
      X: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
      ArrowLeft: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>,
      ArrowRight: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>,
      Zap: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
      ExternalLink: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>,
      Link: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>,
      MessageCircle: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/></svg>,
      Target: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>,
      Flame: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/></svg>,
      Users: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>,
      Award: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>,
      Layers: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="12 2 2 7 12 12 22 7 12 2"/><polyline points="2 17 12 22 22 17"/><polyline points="2 12 12 17 22 12"/></svg>,
      CheckCircle: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>,
    };

    // NEW: Cope vs Action Slide - Split comparison
    const CopeVsActionSlide = ({ data }) => {
      const getIcon = (iconName) => {
        const iconMap = { MessageCircle: Icons.MessageCircle, Zap: Icons.Zap };
        return iconMap[iconName] || Icons.Check;
      };

      const CopeIcon = getIcon(data.copeResponse.icon);
      const ActionIcon = getIcon(data.actionResponse.icon);

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-8 slide-scroll overflow-y-auto">
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
            <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-3" style={{ background: 'rgba(var(--accent-rgb), 0.1)', color: 'var(--accent)' }}>
              <Icons.Target size={14} color="var(--accent)" />
              <span>Mindset Split</span>
            </div>
            <h2 className="slide-title text-2xl md:text-3xl text-black">{data.title}</h2>
          </motion.div>

          <div className="grid md:grid-cols-2 gap-6">
            {/* Cope Response */}
            <motion.div
              initial={{ opacity: 0, x: -30 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ delay: 0.2 }}
              className="relative"
            >
              <div className="absolute -top-3 left-4 px-3 py-1 text-xs font-bold rounded-full z-10" style={{ background: data.copeResponse.color, color: 'white' }}>
                {data.copeResponse.label}
              </div>
              <div className="rounded-2xl p-6 pt-8 relative overflow-hidden" style={{ background: '#0a0a0a', border: `1px solid ${data.copeResponse.color}` }}>
                <div className="absolute top-0 right-0 w-32 h-32 rounded-full blur-3xl -mr-16 -mt-16" style={{ background: `${data.copeResponse.color}20` }} />
                <div className="relative z-10">
                  <div className="w-12 h-12 rounded-xl mx-auto mb-4 flex items-center justify-center" style={{ background: `${data.copeResponse.color}20`, border: `1px solid ${data.copeResponse.color}40` }}>
                    <CopeIcon size={24} color={data.copeResponse.color} />
                  </div>
                  <ul className="space-y-3">
                    {data.copeResponse.items.map((item, i) => (
                      <motion.li
                        key={i}
                        initial={{ opacity: 0, x: -10 }}
                        animate={{ opacity: 1, x: 0 }}
                        transition={{ delay: 0.3 + i * 0.1 }}
                        className="flex items-start gap-2 text-sm text-neutral-400"
                      >
                        <Icons.X />
                        <span>{item}</span>
                      </motion.li>
                    ))}
                  </ul>
                </div>
              </div>
            </motion.div>

            {/* Action Response */}
            <motion.div
              initial={{ opacity: 0, x: 30 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ delay: 0.4 }}
              className="relative"
            >
              <div className="absolute -top-3 left-4 px-3 py-1 text-xs font-bold rounded-full z-10" style={{ background: data.actionResponse.color, color: 'white', boxShadow: `0 0 15px ${data.actionResponse.color}60` }}>
                {data.actionResponse.label}
              </div>
              <div className="rounded-2xl p-6 pt-8 relative overflow-hidden" style={{ background: '#0a0a0a', border: `1px solid ${data.actionResponse.color}`, boxShadow: `0 0 30px ${data.actionResponse.color}20` }}>
                <div className="absolute top-0 right-0 w-32 h-32 rounded-full blur-3xl -mr-16 -mt-16" style={{ background: `${data.actionResponse.color}30` }} />
                <div className="relative z-10">
                  <div className="w-12 h-12 rounded-xl mx-auto mb-4 flex items-center justify-center" style={{ background: `${data.actionResponse.color}30`, border: `1px solid ${data.actionResponse.color}`, boxShadow: `0 0 15px ${data.actionResponse.color}40` }}>
                    <ActionIcon size={24} color={data.actionResponse.color} />
                  </div>
                  <ul className="space-y-3">
                    {data.actionResponse.items.map((item, i) => (
                      <motion.li
                        key={i}
                        initial={{ opacity: 0, x: 10 }}
                        animate={{ opacity: 1, x: 0 }}
                        transition={{ delay: 0.5 + i * 0.1 }}
                        className="flex items-start gap-2 text-sm text-white font-medium"
                      >
                        <Icons.Check />
                        <span>{item}</span>
                      </motion.li>
                    ))}
                  </ul>
                </div>
              </div>
            </motion.div>
          </div>
        </div>
      );
    };

    // NEW: Cope Examples Slide - Dark cards with quote/reality
    const CopeExamplesSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto py-8 slide-scroll overflow-y-auto">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
          <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-3" style={{ background: 'rgba(var(--accent-rgb), 0.1)', color: 'var(--accent)' }}>
            <Icons.MessageCircle size={14} color="var(--accent)" />
            <span>Cope Patterns</span>
          </div>
          <h2 className="slide-title text-2xl md:text-3xl text-black">{data.title}</h2>
        </motion.div>

        <div className="space-y-4">
          {data.examples.map((example, i) => (
            <motion.div
              key={i}
              initial={{ opacity: 0, x: -20 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ delay: 0.2 + i * 0.15 }}
              className="rounded-xl overflow-hidden"
              style={{ background: '#0a0a0a', border: '1px solid #6B7280' }}
            >
              <div className="p-4">
                <p className="text-neutral-300 text-base mb-2 italic">"{example.quote}"</p>
                <div className="flex items-start gap-2">
                  <div className="w-1 h-full rounded-full flex-shrink-0 mt-1" style={{ background: 'var(--accent)', height: '16px' }} />
                  <p className="text-sm" style={{ color: 'var(--accent)' }}><strong>Reality:</strong> {example.reality}</p>
                </div>
              </div>
            </motion.div>
          ))}
        </div>

        <motion.p
          initial={{ opacity: 0, y: 15 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.8 }}
          className="text-center text-neutral-500 text-sm mt-6"
        >
          Recognize these patterns? You're coping. Time to take action.
        </motion.p>
      </div>
    );

    // NEW: Savage Response Slide
    const SavageResponseSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto py-8 slide-scroll overflow-y-auto">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
          <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-3" style={{ background: 'rgba(var(--accent-rgb), 0.1)', color: 'var(--accent)' }}>
            <Icons.Flame size={14} color="var(--accent)" />
            <span>Elite Mindset</span>
          </div>
          <h2 className="slide-title text-2xl md:text-3xl text-black mb-4">{data.title}</h2>
        </motion.div>

        {/* Quote block */}
        <motion.div
          initial={{ opacity: 0, scale: 0.95 }}
          animate={{ opacity: 1, scale: 1 }}
          transition={{ delay: 0.2 }}
          className="rounded-2xl p-6 mb-6 text-center relative overflow-hidden"
          style={{ background: '#0a0a0a', border: '1px solid var(--accent)', boxShadow: '0 0 30px rgba(var(--accent-rgb), 0.2)' }}
        >
          <div className="absolute top-0 left-1/2 -translate-x-1/2 w-40 h-40 rounded-full blur-3xl -mt-20" style={{ background: 'var(--accent)', opacity: 1 }} />
          <p className="text-white text-lg md:text-xl font-bold italic relative z-10">"{data.quote}"</p>
          <p className="text-neutral-500 text-xs mt-3 relative z-10">{data.source}</p>
        </motion.div>

        {/* Response examples */}
        <div className="space-y-3">
          {data.responses.map((response, i) => (
            <motion.div
              key={i}
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ delay: 0.3 + i * 0.15 }}
              className="rounded-xl p-4"
              style={{ background: '#0a0a0a', border: '1px solid #333' }}
            >
              <div className="flex items-start gap-3">
                <div className="w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0" style={{ background: 'var(--accent)', boxShadow: '0 0 10px rgba(var(--accent-rgb), 0.4)' }}>
                  <Icons.Zap />
                </div>
                <div className="flex-1">
                  <div className="text-neutral-500 text-xs mb-1">{response.trigger}</div>
                  <div className="text-white font-semibold text-sm mb-1">{response.action}</div>
                  <div className="text-xs" style={{ color: 'var(--accent)' }}>→ {response.result}</div>
                </div>
              </div>
            </motion.div>
          ))}
        </div>
      </div>
    );

    // NEW: Grind Stories Slide - 3 founder cards with images
    const GrindStoriesSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-4 slide-scroll overflow-y-auto">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-4">
          <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-2" style={{ background: 'rgba(var(--accent-rgb), 0.1)', color: 'var(--accent)' }}>
            <Icons.Users size={14} color="var(--accent)" />
            <span>Founder Stories</span>
          </div>
          <h2 className="slide-title text-xl md:text-2xl text-black">{data.title}</h2>
        </motion.div>

        <div className="grid md:grid-cols-3 gap-4">
          {data.stories.map((story, i) => (
            <motion.div
              key={i}
              initial={{ opacity: 0, y: 30 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ delay: 0.2 + i * 0.15 }}
              className="flex flex-col"
            >
              {/* Story Card */}
              <div className="rounded-2xl p-4 relative overflow-hidden flex-1" style={{ background: '#0a0a0a', border: `1px solid ${story.color}40`, boxShadow: `0 0 20px ${story.color}10` }}>
                <div className="absolute top-0 right-0 w-24 h-24 rounded-full blur-3xl -mr-12 -mt-12" style={{ background: `${story.color}30` }} />
                <div className="relative z-10">
                  <div className="w-8 h-8 rounded-lg mb-2 flex items-center justify-center" style={{ background: `${story.color}30`, border: `1px solid ${story.color}` }}>
                    <Icons.Award size={16} color={story.color} />
                  </div>
                  <h3 className="text-white font-bold text-sm mb-1">{story.name}</h3>
                  <div className="flex items-center gap-2 mb-2">
                    <span className="text-[10px] font-semibold" style={{ color: story.color }}>{story.brand}</span>
                    <span className="text-[8px] text-neutral-600">•</span>
                    <span className="text-[10px] text-neutral-500">{story.worth}</span>
                  </div>
                  <p className="text-neutral-400 text-[11px] leading-relaxed">{story.grind}</p>
                </div>
              </div>
              {/* Founder Image */}
              {story.image && (
                <motion.div
                  initial={{ opacity: 0, scale: 0.8 }}
                  animate={{ opacity: 1, scale: 1 }}
                  transition={{ delay: 0.5 + i * 0.15 }}
                  className="flex justify-center mt-3"
                >
                  <img
                    src={story.image}
                    alt={story.name}
                    className="h-20 w-auto object-contain"
                    style={{ filter: 'drop-shadow(0 4px 12px rgba(0,0,0,0.3))' }}
                  />
                </motion.div>
              )}
            </motion.div>
          ))}
        </div>

        <motion.p
          initial={{ opacity: 0, y: 15 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.8 }}
          className="text-center text-neutral-500 text-xs mt-3"
        >
          Zero advantages. Maximum struggle. Billion-dollar outcomes.
        </motion.p>
      </div>
    );

    // NEW: Mindset Audit Slide
    const MindsetAuditSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto py-8 slide-scroll overflow-y-auto">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
          <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-3" style={{ background: 'rgba(var(--accent-rgb), 0.1)', color: 'var(--accent)' }}>
            <Icons.Target size={14} color="var(--accent)" />
            <span>Self-Audit</span>
          </div>
          <h2 className="slide-title text-2xl md:text-3xl text-black">{data.title}</h2>
          <p className="text-neutral-600 text-sm mt-2">How would you respond?</p>
        </motion.div>

        <div className="space-y-5">
          {data.scenarios.map((scenario, i) => (
            <motion.div
              key={i}
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ delay: 0.2 + i * 0.2 }}
              className="rounded-xl overflow-hidden"
              style={{ background: '#0a0a0a', border: '1px solid #333' }}
            >
              <div className="p-4 bg-neutral-900">
                <p className="text-white font-semibold text-sm">{scenario.situation}</p>
              </div>
              <div className="p-4 space-y-3">
                <div className="flex items-start gap-3">
                  <div className="w-6 h-6 rounded-lg bg-red-500/20 flex items-center justify-center flex-shrink-0">
                    <Icons.X />
                  </div>
                  <div>
                    <div className="text-[10px] text-neutral-600 uppercase mb-0.5">Cope Response</div>
                    <p className="text-neutral-400 text-sm">{scenario.cope}</p>
                  </div>
                </div>
                <div className="flex items-start gap-3">
                  <div className="w-6 h-6 rounded-lg flex items-center justify-center flex-shrink-0" style={{ background: 'var(--accent)', boxShadow: '0 0 10px rgba(var(--accent-rgb), 0.4)' }}>
                    <Icons.Check />
                  </div>
                  <div>
                    <div className="text-[10px] uppercase mb-0.5" style={{ color: 'var(--accent)' }}>Action Response</div>
                    <p className="text-white text-sm font-medium">{scenario.action}</p>
                  </div>
                </div>
              </div>
            </motion.div>
          ))}
        </div>
      </div>
    );

    // NEW: Action Checklist Slide
    const ActionChecklistSlide = ({ data }) => {
      const categories = [...new Set(data.checklist.map(item => item.category))];
      const categoryColors = {
        'Ads': '#3B82F6',
        'Pricing': '#8B5CF6',
        'Traffic': '#F59E0B',
        'Competition': '#EF4444',
        'Mindset': '#22C55E'
      };

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto py-8 slide-scroll overflow-y-auto">
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
            <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-3" style={{ background: 'rgba(var(--accent-rgb), 0.1)', color: 'var(--accent)' }}>
              <Icons.Layers size={14} color="var(--accent)" />
              <span>Action Framework</span>
            </div>
            <h2 className="slide-title text-2xl md:text-3xl text-black">{data.title}</h2>
          </motion.div>

          <div className="space-y-3">
            {data.checklist.map((item, i) => {
              const color = categoryColors[item.category] || '#6B7280';
              return (
                <motion.div
                  key={i}
                  initial={{ opacity: 0, x: -20 }}
                  animate={{ opacity: 1, x: 0 }}
                  transition={{ delay: 0.15 + i * 0.1 }}
                  className="rounded-xl p-4 flex items-start gap-3"
                  style={{ background: '#0a0a0a', border: `1px solid ${color}40` }}
                >
                  <div className="w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0" style={{ background: `${color}20`, border: `1px solid ${color}40` }}>
                    <Icons.CheckCircle size={18} color={color} />
                  </div>
                  <div className="flex-1">
                    <div className="flex items-center gap-2 mb-1">
                      <span className="text-[10px] font-bold px-2 py-0.5 rounded" style={{ background: color, color: 'white' }}>{item.category}</span>
                    </div>
                    <p className="text-white text-sm leading-relaxed">{item.action}</p>
                  </div>
                </motion.div>
              );
            })}
          </div>

          <motion.div
            initial={{ opacity: 0, y: 15 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.8 }}
            className="rounded-xl p-4 text-center mt-6"
            style={{ background: 'linear-gradient(135deg, var(--accent), var(--accent-dark))', boxShadow: '0 0 30px rgba(var(--accent-rgb), 0.3)' }}
          >
            <p className="text-white text-sm font-semibold">Save this. Reference it daily. Action over cope, always.</p>
          </motion.div>
        </div>
      );
    };

    const WelcomeSlide = ({ data, onStart, userName, onShowGif, onHideGif }) => {
      const welcomeData = useMemo(() => getTimeBasedWelcome(), []);
      const gifSide = useMemo(() => Math.random() > 0.5 ? 'left' : 'right', []);
      useEffect(() => { onShowGif(welcomeData.gif, '65%', gifSide); return () => onHideGif(); }, [welcomeData.gif, gifSide, onShowGif, onHideGif]);

      return (
        <div className="h-full w-full relative overflow-hidden">
          <div className="h-full flex flex-col items-center justify-center text-center px-6 py-4 relative z-20">
            <motion.h1 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="title-font text-3xl sm:text-4xl md:text-5xl lg:text-6xl text-black mb-2 md:mb-3">{LESSON_CONFIG.title}</motion.h1>
            <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-neutral-600 text-base md:text-lg lg:text-xl mb-2 md:mb-3 max-w-lg leading-relaxed" dangerouslySetInnerHTML={{ __html: formatGreeting(welcomeData.greeting, `<span class="font-bold text-neutral-900">${userName}</span>`) }} />
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="flex items-center justify-center gap-1.5 text-neutral-400 text-[10px] md:text-xs mb-2 md:mb-3"><Icons.Clock /><span>{LESSON_CONFIG.duration}</span></motion.div>
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 }} className="bg-neutral-900 rounded-xl md:rounded-2xl p-3 md:p-5 mb-3 md:mb-4 max-w-sm w-full mx-auto">
              <p className="text-neutral-500 text-[9px] md:text-[11px] uppercase tracking-wider mb-2 md:mb-3">In this lesson</p>
              <ul className="space-y-1.5 md:space-y-2">
                {data.learningGoals.map((goal, i) => (
                  <motion.li key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.25 + i * 0.05 }} className="flex items-start gap-2 text-left">
                    <span className="w-5 h-5 rounded-md flex items-center justify-center text-[9px] font-bold text-white flex-shrink-0 mt-0.5" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>{i + 1}</span>
                    <span className="text-neutral-300 text-[11px] md:text-sm leading-snug">{goal}</span>
                  </motion.li>
                ))}
              </ul>
            </motion.div>
            <motion.button initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.45 }} onClick={onStart} whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }} className="px-6 md:px-7 py-2.5 md:py-3 rounded-xl text-white font-semibold text-sm md:text-base" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>Let's Go</motion.button>
          </div>
        </div>
      );
    };

    const HookSlide = ({ data }) => (
      <div className="h-full relative overflow-hidden">
        <div className="h-full flex flex-col justify-center px-8 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-10 relative z-10">
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="mb-6">
            <span className="inline-block px-3 py-1 rounded-full text-xs font-semibold mb-4" style={{ background: `rgba(var(--accent-rgb), 0.1)`, color: 'var(--accent)' }}>The Hook</span>
            <h2 className="slide-title text-3xl md:text-4xl lg:text-5xl text-black leading-tight">{data.headline}</h2>
          </motion.div>
          <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="text-lg md:text-xl text-neutral-600 leading-relaxed">{data.subtext}</motion.p>
        </div>
        {data.brandImage && (
          <motion.div initial={{ opacity: 0, x: 30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.3, duration: 0.5 }}
            className="absolute bottom-0 right-0 z-0 pointer-events-none" style={{ height: '30%', maxHeight: '200px', marginRight: '3%', marginBottom: '5%' }}>
            <img src={data.brandImage} alt={data.brandName || ''} className="h-full w-auto object-contain" style={{ opacity: 1 }} />
          </motion.div>
        )}
      </div>
    );

    const ContentSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-8 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-10">
        <motion.h2 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl lg:text-4xl text-black mb-6">{data.title}</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-base md:text-lg text-neutral-600 leading-relaxed">{data.body}</motion.p>
      </div>
    );

    const HighlightBoxSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-8 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-10">
        <motion.h2 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl lg:text-4xl text-black mb-6">{data.title}</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-base md:text-lg text-neutral-600 leading-relaxed mb-6">{data.body}</motion.p>
        <motion.div initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.2 }} className="rounded-xl p-6 text-center" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))`, boxShadow: '0 0 30px rgba(var(--accent-rgb), 0.3)' }}>
          <p className="text-white text-lg font-bold">{data.highlight}</p>
        </motion.div>
      </div>
    );

    const QuizSlide = ({ data, onAnswer, selectedOption, isAnswered, onShowGif, onHideGif }) => {
      const handleAnswer = (index) => {
        const isCorrect = index === data.correctIndex;
        const gifUrl = isCorrect ? getRandomCelebrationGif() : getRandomEmpathyGif();
        const gifSize = isCorrect ? '90%' : '70%';
        onShowGif(gifUrl, gifSize, 'center');
        setTimeout(() => onHideGif(), 3000);
        onAnswer(index);
      };

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-3xl mx-auto py-8 slide-scroll overflow-y-auto">
          {!isAnswered ? (
            <>
              <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
                <span className="inline-block px-3 py-1 rounded-full text-xs font-semibold mb-4" style={{ background: 'rgba(var(--accent-rgb), 0.1)', color: 'var(--accent)' }}>Knowledge Check</span>
                <h2 className="slide-title text-2xl md:text-3xl text-black">{data.question}</h2>
              </motion.div>
              <div className="space-y-3">
                {data.options.map((option, i) => (
                  <motion.button
                    key={i}
                    initial={{ opacity: 0, x: -20 }}
                    animate={{ opacity: 1, x: 0 }}
                    transition={{ delay: 0.1 + i * 0.1 }}
                    onClick={() => handleAnswer(i)}
                    whileHover={{ scale: 1.02 }}
                    whileTap={{ scale: 0.98 }}
                    className="w-full text-left p-4 rounded-xl border-2 border-neutral-200 hover:border-neutral-400 transition-all bg-white"
                  >
                    <span className="text-neutral-700 font-medium">{option}</span>
                  </motion.button>
                ))}
              </div>
            </>
          ) : (
            <motion.div initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} className="text-center">
              <div className="w-16 h-16 rounded-full mx-auto mb-4 flex items-center justify-center" style={{ background: selectedOption === data.correctIndex ? '#22C55E' : '#EF4444' }}>
                {selectedOption === data.correctIndex ? <Icons.Check /> : <Icons.X />}
              </div>
              <h3 className="text-2xl font-bold text-black mb-4">{selectedOption === data.correctIndex ? 'Correct!' : 'Not quite!'}</h3>
              <p className="text-neutral-600 text-base leading-relaxed">{selectedOption === data.correctIndex ? data.feedback.correct : data.feedback.incorrect}</p>
            </motion.div>
          )}
        </div>
      );
    };

    const CompletionSlide = ({ onNext }) => (
      <div className="h-full flex flex-col items-center justify-center px-6 py-10 text-center">
        <motion.div initial={{ scale: 0 }} animate={{ scale: 1 }} transition={{ type: 'spring', stiffness: 200, damping: 15 }}>
          <div className="w-20 h-20 rounded-full mx-auto mb-6 flex items-center justify-center" style={{ background: 'linear-gradient(135deg, var(--accent), var(--accent-dark))' }}>
            <Icons.Check />
          </div>
        </motion.div>
        <motion.h2 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 }} className="slide-title text-3xl md:text-4xl text-black mb-4">Lesson Complete!</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.3 }} className="text-neutral-600 text-lg mb-8 max-w-lg">You've unlocked the savage mentality. Now go take action.</motion.p>
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.4 }} className="w-full max-w-md">
          <div className="bg-neutral-900 rounded-2xl p-6 mb-4">
            <p className="text-neutral-500 text-xs uppercase tracking-wider mb-3">Up Next</p>
            <h3 className="text-white font-bold text-lg mb-2">{LESSON_CONFIG.nextLesson.title}</h3>
            <p className="text-neutral-400 text-sm mb-4">{LESSON_CONFIG.nextLesson.teaser}</p>
            <button onClick={onNext} className="w-full px-6 py-3 rounded-xl text-white font-semibold" style={{ background: 'linear-gradient(135deg, var(--accent), var(--accent-dark))' }}>Continue Learning</button>
          </div>
        </motion.div>
      </div>
    );

    const LessonApp = () => {
      const [currentSlide, setCurrentSlide] = useState(0);
      const [selectedOption, setSelectedOption] = useState(null);
      const [isAnswered, setIsAnswered] = useState(false);
      const [gifState, setGifState] = useState({ show: false, url: '', size: '70%', position: 'right' });
      const userName = getUserName();

      const handleAnswer = (index) => { setSelectedOption(index); setIsAnswered(true); };
      const handleNext = () => { if (currentSlide < slides.length - 1) { setCurrentSlide(currentSlide + 1); setIsAnswered(false); setSelectedOption(null); } };
      const handlePrev = () => { if (currentSlide > 0) { setCurrentSlide(currentSlide - 1); setIsAnswered(false); setSelectedOption(null); } };
      const handleStart = () => setCurrentSlide(1);
      const showGif = useCallback((url, size, position) => setGifState({ show: true, url, size, position }), []);
      const hideGif = useCallback(() => setGifState(prev => ({ ...prev, show: false })), []);
      const handleNextLesson = () => { window.location.href = `/learn/${LESSON_CONFIG.nextLesson.id}?userName=${encodeURIComponent(userName)}`; };

      const currentSlideData = slides[currentSlide];
      const isFirstSlide = currentSlide === 0;
      const isLastSlide = currentSlide === slides.length - 1;

      const getGifPositionStyle = () => {
        const baseStyle = { position: 'fixed', top: '50%', transform: 'translateY(-50%)', zIndex: 30, pointerEvents: 'none', height: gifState.size };
        if (gifState.position === 'left') return { ...baseStyle, left: '2%' };
        if (gifState.position === 'right') return { ...baseStyle, right: '2%' };
        return { ...baseStyle, left: '50%', transform: 'translate(-50%, -50%)' };
      };

      const renderSlide = () => {
        switch (currentSlideData.type) {
          case 'welcome': return <WelcomeSlide data={currentSlideData} onStart={handleStart} userName={userName} onShowGif={showGif} onHideGif={hideGif} />;
          case 'hook': return <HookSlide data={currentSlideData} />;
          case 'cope-vs-action': return <CopeVsActionSlide data={currentSlideData} />;
          case 'cope-examples': return <CopeExamplesSlide data={currentSlideData} />;
          case 'savage-response': return <SavageResponseSlide data={currentSlideData} />;
          case 'grind-stories': return <GrindStoriesSlide data={currentSlideData} />;
          case 'mindset-audit': return <MindsetAuditSlide data={currentSlideData} />;
          case 'action-checklist': return <ActionChecklistSlide data={currentSlideData} />;
          case 'highlight-box': return <HighlightBoxSlide data={currentSlideData} />;
          case 'quiz': return <QuizSlide data={currentSlideData} onAnswer={handleAnswer} selectedOption={selectedOption} isAnswered={isAnswered} onShowGif={showGif} onHideGif={hideGif} />;
          case 'completion': return <CompletionSlide onNext={handleNextLesson} />;
          default: return <ContentSlide data={currentSlideData} />;
        }
      };

      useEffect(() => {
        const handleKeyDown = (e) => {
          if (e.key === 'ArrowRight' && !isLastSlide) handleNext();
          if (e.key === 'ArrowLeft' && !isFirstSlide) handlePrev();
        };
        window.addEventListener('keydown', handleKeyDown);
        return () => window.removeEventListener('keydown', handleKeyDown);
      }, [currentSlide, isLastSlide, isFirstSlide]);

      return (
        <div className="w-screen h-screen bg-white overflow-hidden relative">
          <AnimatePresence mode="wait">
            <motion.div key={currentSlide} initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} transition={{ duration: 0.3 }} className="w-full h-full">
              {renderSlide()}
            </motion.div>
          </AnimatePresence>

          <AnimatePresence>
            {gifState.show && (
              <motion.video
                key={gifState.url}
                src={gifState.url}
                autoPlay
                loop
                muted
                playsInline
                initial={{ opacity: 0, scale: 0.8 }}
                animate={{ opacity: 1, scale: 1 }}
                exit={{ opacity: 0, scale: 0.8 }}
                transition={{ duration: 0.3 }}
                style={getGifPositionStyle()}
              />
            )}
          </AnimatePresence>

          {!isFirstSlide && !isLastSlide && (
            <div className="fixed bottom-6 left-1/2 -translate-x-1/2 flex items-center gap-4 z-40">
              <button onClick={handlePrev} disabled={isFirstSlide} className="w-10 h-10 rounded-full bg-white border-2 border-neutral-200 flex items-center justify-center disabled:opacity-30 hover:bg-neutral-50 transition-all" style={{ boxShadow: '0 2px 8px rgba(0,0,0,0.1)' }}><Icons.ArrowLeft /></button>
              <div className="px-4 py-2 rounded-full bg-white border border-neutral-200 text-xs font-semibold text-neutral-600" style={{ boxShadow: '0 2px 8px rgba(0,0,0,0.1)' }}>{currentSlide} / {slides.length - 1}</div>
              <button onClick={handleNext} disabled={isLastSlide || (currentSlideData.type === 'quiz' && !isAnswered)} className="w-10 h-10 rounded-full flex items-center justify-center text-white disabled:opacity-30 hover:opacity-90 transition-all" style={{ background: 'linear-gradient(135deg, var(--accent), var(--accent-dark))', boxShadow: '0 2px 12px rgba(var(--accent-rgb), 0.3)' }}><Icons.ArrowRight /></button>
            </div>
          )}
        </div>
      );
    };

    ReactDOM.render(<LessonApp />, document.getElementById('root'));
  </script>
</body>
</html>
