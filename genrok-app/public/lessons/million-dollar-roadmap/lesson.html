<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Roadmap to $1M/Month | Quantum Scale</title>
  <script src="https://cdn.tailwindcss.com" defer></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" defer></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" defer></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js" defer></script>
  <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js" defer></script>
  <script src="../shared/greetings.js" defer></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://unpkg.com" crossorigin>
    <link rel="preconnect" href="https://cdn.tailwindcss.com" crossorigin>
    <link rel="preconnect" href="https://pqvvrljykfvhpyvxmwzb.supabase.co" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;500;600;700;800;900&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root { --accent: #6366f1; --accent-dark: #4f46e5; --accent-light: #818cf8; --accent-rgb: 99, 102, 241; }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Inter', sans-serif; background: transparent; -webkit-font-smoothing: antialiased; }
    .title-font { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    h1, h2, h3, .slide-title { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    ::selection { background: var(--accent); color: white; }
    .slide-scroll::-webkit-scrollbar { display: none; }
    .slide-scroll { -ms-overflow-style: none; scrollbar-width: none; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { motion, AnimatePresence } = window.Motion;
    const { useState, useEffect, useCallback, useMemo } = React;

    const getUserName = () => { const params = new URLSearchParams(window.location.search); return params.get('userName') || 'Builder'; };

    // Animated Counter Component
    const AnimatedCounter = ({ target, suffix = '', duration = 2000 }) => {
      const [count, setCount] = useState(0);
      useEffect(() => {
        let start = 0;
        const increment = target / (duration / 16);
        const timer = setInterval(() => {
          start += increment;
          if (start >= target) { setCount(target); clearInterval(timer); }
          else { setCount(Math.floor(start)); }
        }, 16);
        return () => clearInterval(timer);
      }, [target, duration]);
      return <span>{count}{suffix}</span>;
    };

    // TypewriterText Component
    const TypewriterText = ({ text, speed = 50, className = '' }) => {
      const [displayedText, setDisplayedText] = useState('');
      useEffect(() => {
        let i = 0;
        const timer = setInterval(() => {
          if (i < text.length) {
            setDisplayedText(text.substring(0, i + 1));
            i++;
          } else {
            clearInterval(timer);
          }
        }, speed);
        return () => clearInterval(timer);
      }, [text, speed]);
      return <span className={className}>{displayedText}</span>;
    };

    // CircularProgress Component
    const CircularProgress = ({ percentage, size = 120, strokeWidth = 8, color = 'var(--accent)', label = '' }) => {
      const [progress, setProgress] = useState(0);
      useEffect(() => {
        const timer = setTimeout(() => setProgress(percentage), 100);
        return () => clearTimeout(timer);
      }, [percentage]);
      const radius = (size - strokeWidth) / 2;
      const circumference = radius * 2 * Math.PI;
      const offset = circumference - (progress / 100) * circumference;
      return (
        <div className="flex flex-col items-center">
          <svg width={size} height={size} className="transform -rotate-90">
            <circle cx={size / 2} cy={size / 2} r={radius} stroke="#e5e7eb" strokeWidth={strokeWidth} fill="none" />
            <motion.circle initial={{ strokeDashoffset: circumference }} animate={{ strokeDashoffset: offset }} transition={{ duration: 1.5, ease: "easeOut" }} cx={size / 2} cy={size / 2} r={radius} stroke={color} strokeWidth={strokeWidth} fill="none" strokeDasharray={circumference} strokeLinecap="round" />
          </svg>
          <div className="mt-2 text-center">
            <div className="text-2xl font-bold" style={{ color }}>{percentage}%</div>
            {label && <div className="text-xs text-neutral-500 mt-1">{label}</div>}
          </div>
        </div>
      );
    };

    // DramaticReveal Component
    const DramaticReveal = ({ children, delay = 0 }) => {
      return (
        <motion.div initial={{ opacity: 0, scale: 0.8, y: 20 }} animate={{ opacity: 1, scale: 1, y: 0 }} transition={{ delay, duration: 0.6, ease: [0.16, 1, 0.3, 1] }}>
          {children}
        </motion.div>
      );
    };

    // Progress Bar Component
    const ProgressBar = ({ percentage, label, color = 'var(--accent)', delay = 0 }) => {
      const [width, setWidth] = useState(0);
      useEffect(() => {
        const timer = setTimeout(() => setWidth(percentage), delay);
        return () => clearTimeout(timer);
      }, [percentage, delay]);
      return (
        <div className="mb-4">
          <div className="flex justify-between mb-1">
            <span className="text-sm font-medium text-neutral-700">{label}</span>
            <span className="text-sm font-medium" style={{ color }}>{percentage}%</span>
          </div>
          <div className="h-3 bg-neutral-200 rounded-full overflow-hidden">
            <motion.div initial={{ width: 0 }} animate={{ width: `${width}%` }} transition={{ duration: 1.5, ease: "easeOut", delay: delay/1000 }} className="h-full rounded-full" style={{ background: color }} />
          </div>
        </div>
      );
    };

    // Metric Dashboard Component
    const MetricDashboard = ({ metrics }) => (
      <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
        {metrics.map((metric, i) => (
          <motion.div key={i} initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 + i * 0.1 }} className="bg-white border-2 border-neutral-200 rounded-xl p-4 text-center">
            <div className="text-3xl font-bold mb-1" style={{ color: metric.color || 'var(--accent)' }}>
              <AnimatedCounter target={metric.value} suffix={metric.suffix} duration={1500 + i * 300} />
            </div>
            <div className="text-xs text-neutral-500 uppercase tracking-wider">{metric.label}</div>
          </motion.div>
        ))}
      </div>
    );

    const LESSON_CONFIG = {
      id: 'million-dollar-roadmap',
      title: 'The Roadmap to $1M/Month',
      description: 'The exact 4-step system to reach $1 million monthly revenue - no guesswork, just math.',
      accentColor: '#6366f1',
      duration: '9 min',
      nextLesson: { id: 'next-lesson', title: 'Next Growth Strategy', teaser: 'Continue your journey to $100M business mastery.' }
    };

    // welcomeAnimations and getTimeBasedWelcome are loaded from ../shared/greetings.js

    const celebrationGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_doing_a_quick_victory_dance_move_high_energy_c_d03b798b-a518-4e6c-bcae-d69b2dd50486_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_jumping_in_the_air_arms_raised_high_YESSS_cele_201477e8-3df4-405a-bc81-81d1747e5c6c_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_playing_air_guitar_light_headbanging_rockstar__0702007e-9e84-4d9e-8f99-8ee23d0b65f8_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_doing_the_running_man_dance_move_vintage_cool__25682b0f-cf4c-4e93-8dcb-6c3dac8135cd_0.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_standing_and_clapping_enthusiastically_mouth_o_992ac4fd-9a0e-4963-bbcc-a5271f25f4fd_3.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_clapping_very_fast_huge_smile_extreme_exciteme_9a4dde09-55ca-4173-a47d-613bc2924230_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_clapping_above_head_world_champion_celebration_484bd560-f049-41ca-b3d1-c03d7468ab56_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_starting_with_slow_clap_accelerating_to_fast_c_ee478a38-0ee7-437d-bd13-d687f7dd624a_0.mp4'
    ];
    const getRandomCelebrationGif = () => celebrationGifs[Math.floor(Math.random() * celebrationGifs.length)];

    const empathyGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_thumbs_down_with_encouraging_nod_close_keep_go_613e541f-c072-436f-aee7-f99cd6f834fc_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_shaking_head_side_to_side_sadly_disappointed_e_c4a4be22-6a70-4738-8612-3039454fef37_1.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_covering_face_with_palm_facepalm_gesture_disap_211b0566-078f-4d42-9c41-547b14f5827c_0.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_looking_down_sadly_shoulders_slumped_disappoin_790d48bd-e49e-40ea-9979-d3e86fa3a422_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_wiping_away_a_small_tear_sad_but_gentle_disapp_8d78571b-3c36-4502-abee-81683255843c_1.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_sighing_sadly_exhaling_with_disappointment_hea_f6014f2a-3a99-4378-a2a8-414e16b3e72d_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_slouching_with_disappointment_body_curling_inw_caedddbe-413c-492a-9fdf-1e8433f5e2a8_2%20(1).mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_placing_hand_on_forehead_sadly_eyes_closed_fru_3e048895-f365-4ff2-9e88-0d0a35b2a9e1_3.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_nodding_slowly_with_sadness_what_a_shame_expre_377f67ca-63da-41aa-9072-4926fc2f6e82_3.mp4'
    ];
    const getRandomEmpathyGif = () => empathyGifs[Math.floor(Math.random() * empathyGifs.length)];

    const slides = [
      { type: 'welcome', learningGoals: ['Why $1M/month is just math - not magic', 'The 4-step roadmap proven to work', 'Typical metrics you need at each stage'] },
      { type: 'hook', headline: '$1,000,000 per month. Sounds impossible? It\'s just 33 customers per day.', subtext: 'Most entrepreneurs overcomplicate the path to seven figures. They chase vanity metrics, test random tactics, and hope something works. But $1M/month isn\'t a miracle. It\'s a formula. And once you understand the math, the roadmap becomes crystal clear.' , brandImage: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/Geo%20Convert%20(18).jpg', brandName: 'DataDrew'},
      { type: 'dramaticNumber', title: 'The Number That Changes Everything', number: '$1M', description: 'per month. It\'s not magic. It\'s a roadmap with four critical waypoints.' },
      { type: 'content', title: 'The Million-Dollar Truth', body: 'Here\'s what nobody tells you: reaching $1M/month has nothing to do with luck and everything to do with understanding four simple levers. Most stores never hit this milestone because they optimize the wrong things. They obsess over traffic when their conversion rate is broken. They chase cheaper ads when their LTV is too low. The roadmap to $1M/month is deceptively simple - but only if you build it in the right order. Fix LTV first. Build infrastructure second. Then optimize conversion. Finally, test and scale. This order is non-negotiable - skip a step and you plateau.' },
      { type: 'metricDashboard', title: 'The Million-Dollar Formula', metrics: [
        { value: 1000, suffix: '', label: 'LTV per customer', color: '#6366f1' },
        { value: 1000, suffix: '', label: 'customers/month', color: '#22c55e' },
        { value: 33, suffix: '', label: 'sales per day', color: '#f59e0b' },
        { value: 1, suffix: 'M', label: 'monthly revenue', color: '#ef4444' }
      ]},
      { type: 'roadmapStep', stepNumber: 1, totalSteps: 4, title: 'Building LTV', description: '$1,000-$2,000 for top spenders. Measure via RFM/Top Spenders in DataDrew. This is your foundation - everything else depends on it.' },
      { type: 'content', title: 'Step 1: The Foundation', body: 'This is where most entrepreneurs fail. They try to scale before they have a profitable customer. You can\'t buy your way to $1M/month if each customer is only worth $50. The math simply doesn\'t work. Before you spend a dollar on ads, build a system that generates $1000+ in lifetime value per customer. When your LTV is $1000, customer acquisition cost becomes almost irrelevant. You can afford to pay $100, $200, even $300 to acquire a customer and still print money.' },
      { type: 'beforeAfter', scenario: 'LTV Transformation', before: { label: 'Broken Model', items: ['AOV: $45', 'Repeat rate: 8%', 'LTV: $48', 'CAC: $35', 'Profit per customer: $13', 'To reach $1M/month: need 76,923 customers'], result: 'Impossible to scale' }, after: { label: 'Fixed Model', items: ['AOV: $85', 'Repeat rate: 65%', 'LTV: $1,020', 'CAC: $95', 'Profit per customer: $925', 'To reach $1M/month: need 1,000 customers (33/day)'], result: 'Achievable' }, insight: 'Fix LTV first. Everything else becomes exponentially easier.' },
      { type: 'visual', title: 'Why LTV Changes Everything', visualType: 'comparison', data: {
        left: { label: 'Low LTV Store', value: '$50', result: 'CAC must be under $15', color: '#ef4444' },
        right: { label: 'High LTV Store', value: '$1000', result: 'CAC can be $300+', color: '#22c55e' },
        center: { label: 'Result', value: '20x', result: 'More ad budget flexibility', color: '#6366f1' }
      }},
      { type: 'circularStats', title: 'The LTV Building Blocks', stats: [
        { percentage: 80, label: 'AOV Target', color: '#6366f1' },
        { percentage: 60, label: 'Repeat Rate', color: '#22c55e' },
        { percentage: 100, label: 'Customer Lifespan', color: '#f59e0b' }
      ]},
      { type: 'toolIntegrated', stepContext: 'Step 1: Building LTV', toolName: 'Abandoned Checkout Finisher', toolUrl: 'https://quantum-scale.co/pages/test3', body: 'Recover typical 15-30% of abandoned carts automatically with SMS and email sequences. This single automation can add $200-400 to your LTV.', benefit: 'Turn abandoned browsers into repeat customers. Manual recovery takes hours daily. This system runs 24/7.' },
      { type: 'dataDrewIntro', title: 'Track LTV for Free with DataDrew', body: 'DataDrew is a FREE Shopify app that shows you exactly who your highest-value customers are. Track LTV by customer, export your top spenders for LookAlike audiences, and see RFM scores instantly. No spreadsheets, no manual calculations - just install and see your real LTV metrics immediately.', screenshot: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/46.webp', toolUrl: 'https://apps.shopify.com/customer-lifetime-value?mref=lsbqcbva' },
      { type: 'revealSteps', title: 'Copy the automatic system to get $1,000 Per customer', steps: [
        'Increase AOV through bundles and upsells ($80-120 per order)',
        'Boost repeat rate with email/SMS automation (60%+ rebuy)',
        'Extend lifespan through exceptional experience (12+ months)',
        'Result: Customer worth $85 â†’ $1,020+ over lifetime'
      ], hasButton: true, buttonText: 'Copy the automatic system to get $1,000 Per customer', buttonUrl: '/courses' },
      { type: 'roadmapStep', stepNumber: 2, totalSteps: 4, title: 'Setting Strong Roots', description: 'Email system, abandoned checkout recovery, and private agent. The boring infrastructure that lets you scale without chaos.' },
      { type: 'content', title: 'Step 2: The Boring Part Everyone Skips', body: 'Once your LTV is $1000+, you need infrastructure to support growth. This is the boring part everyone skips - and why they plateau at $100K/month. You need email and SMS automation running 24/7 to nurture customers. You need abandoned checkout recovery to recapture lost revenue automatically. And you need a private agent managing supplier relationships and inventory so you can focus on growth. Without infrastructure, growth creates chaos. With it, scaling becomes systematic.' },
      { type: 'progressBars', title: 'The Infrastructure Health Check', bars: [
        { label: 'Customer Support Response Time', percentage: 85, color: '#22c55e' },
        { label: 'Cart Abandonment Recovery Rate', percentage: 70, color: '#6366f1' },
        { label: 'Email/SMS Automation Coverage', percentage: 90, color: '#f59e0b' },
        { label: 'Supplier Relationship Management', percentage: 75, color: '#14b8a6' }
      ]},
      { type: 'toolIntegrated', stepContext: 'Step 2: Infrastructure', toolName: 'Private Agent System', toolUrl: 'https://erp.matedropshipping.com/login?invite_id=915', body: 'Managing suppliers manually becomes impossible at scale. A private agent handles sourcing, quality control, and inventory - freeing you to focus on growth.', benefit: 'Manual supplier management: 4-6 hours daily. Private agent: fully automated. Your choice.' },
      { type: 'roadmapStep', stepNumber: 3, totalSteps: 4, title: 'Attracting Only Top RFM', description: 'Target ONLY $1,000-$2,000 customers. Export top spenders from DataDrew, create LookAlike audiences, and attract high-value buyers.' },
      { type: 'content', title: 'Step 3: The RFM Targeting Strategy', body: 'Now that your LTV is high and infrastructure is solid, it\'s time to attract MORE of your best customers. Use DataDrew to export your top spenders - the customers worth $1,000-$2,000+. Upload them to Facebook/TikTok as LookAlike audiences. The algorithm will find people who MATCH your highest-value customers. You\'re not targeting "everyone interested in fashion" - you\'re targeting people who BUY LIKE YOUR BEST CUSTOMERS. This is how you scale profitably: attract only high-LTV buyers from day one.' },
      { type: 'metricDashboard', title: 'The 6% Website Math', metrics: [
        { value: 550, suffix: '', label: 'visitors/day', color: '#6366f1' },
        { value: 33, suffix: '', label: 'sales/day', color: '#22c55e' },
        { value: 385, suffix: '$', label: 'daily ad spend', color: '#f59e0b' },
        { value: 11550, suffix: '$', label: 'monthly ad cost', color: '#ef4444' }
      ]},
      { type: 'beforeAfter', scenario: 'Website Conversion Impact', before: { label: '2% Conversion (Average)', items: ['Need 1,650 visitors/day for 33 sales', 'Typical CAC = $1,155/day budget', '$34,650/month ad spend', 'Hard to scale profitably'], result: 'Limited growth ceiling' }, after: { label: '6% Conversion (Optimized)', items: ['Need 550 visitors/day for 33 sales', 'Typical CAC = $385/day budget', '$11,550/month ad spend', '3x more profitable'], result: 'Easy to scale' }, insight: 'Conversion rate isn\'t vanity. It\'s the difference between profitable and impossible.' },
      { type: 'revealSteps', title: 'How to Hit 5-7% Conversion', steps: [
        'Build instant trust (social proof, guarantees, reviews)',
        'Eliminate friction (fast load times, simple checkout)',
        'Create honest urgency (limited inventory, seasonal offers)',
        'Result: 5-7% conversion rate vs 1-2% industry average'
      ]},
      { type: 'roadmapStep', stepNumber: 4, totalSteps: 4, title: '33 Customers/Day with Unlimited CAC', description: 'When LTV is $1,000-$2,000, you can spend $300+ per customer. High ceiling means no fear. Scale becomes simple math.' , characterVideo: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_drawing_a_strategy_whiteboardplanning_100_pure_95302861-8c44-460f-bcd1-7faa302067c4_3.mp4', characterPosition: 'right'},
      { type: 'content', title: 'Step 4: The Infinite Game', body: 'You have $1,000-$2,000 LTV. Infrastructure runs automatically. You\'re attracting high-RFM customers only. Now the game becomes infinite. You can spend $300, $400, even $500 to acquire a customer and STILL profit massively. Most competitors can\'t spend more than $50 per customer - they\'re stuck. You? You have unlimited ceiling. Need 33 customers per day for $1M/month? Just increase budget until you hit it. Test products, offers, creatives, and audiences. Double down on winners. The math works at any scale because your LTV is untouchable.' },
      { type: 'cards', title: 'The Testing Framework', items: [
        { title: 'Product Testing', description: 'Launch new products monthly. Track contribution margin. Double down on top performers. Cut the losers.' },
        { title: 'Offer Testing', description: 'Test bundle pricing, discount depths, shipping thresholds. Small changes can create big revenue swings.' },
        { title: 'Creative Testing', description: 'Launch multiple new ad creatives weekly. Kill losers after 48 hours. Scale winners aggressively.' },
        { title: 'Audience Testing', description: 'Test broad vs interest vs lookalike. Let the algorithm find your buyers. Follow the data.' }
      ]},
      { type: 'pyramid', title: 'The Complete Roadmap', levels: [
        'Step 1: Build $1,000-$2,000 LTV (Track in DataDrew)',
        'Step 2: Set Strong Roots (Email, Checkout, Private Agent)',
        'Step 3: Attract Only Top RFM ($1,000-$2,000 LookAlikes)',
        'Step 4: Scale to 33/day with Unlimited CAC',
        'Step 5: The Game is Easy and Infinite'
      ]},
      { type: 'quiz', question: 'According to the roadmap, what is the FIRST step to $1M/month?', options: ['Get more traffic to your website', 'Build $1,000-$2,000 LTV per customer (tracked in DataDrew)', 'Run more Facebook ads', 'Improve website conversion rate'], correctIndex: 1, feedback: { correct: 'Exactly! You can\'t scale profitably without high LTV. When your top spenders are worth $1,000-$2,000 (tracked in DataDrew), you can afford $300+ CAC and suddenly $1M/month becomes simple math: 33 customers per day. Use DataDrew to export these top RFM customers and create LookAlike audiences. Everything else gets exponentially easier when you start with high-value customers.', incorrect: 'Not quite. The first step is building $1,000-$2,000 LTV for your top spenders, tracked via DataDrew. Without high LTV, scaling is impossible. You need profitable customers FIRST (Step 1), then infrastructure (Step 2), then RFM targeting (Step 3), then scale with unlimited CAC (Step 4). LTV is the foundation everything else is built on.' }},
      { type: 'completion', sources: [
        { name: 'Get DataDrew FREE (Track LTV & Export Top RFM)', url: 'https://apps.shopify.com/customer-lifetime-value?mref=lsbqcbva' },
        { name: 'The $1000 LTV System', url: 'https://quantum-scale.co/pages/test1' },
        { name: 'Abandoned Checkout Finisher', url: 'https://quantum-scale.co/pages/test3' },
        { name: 'Connect Private Agent', url: 'https://erp.matedropshipping.com/login?invite_id=915' }
      ]}
    ];

    const Icons = {
      Clock: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
      Check: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><polyline points="20 6 9 17 4 12"/></svg>,
      X: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
      ArrowLeft: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>,
      ArrowRight: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>,
      Zap: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
      ExternalLink: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>,
      Link: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>,
    };

    const WelcomeSlide = ({ data, onStart, userName, onShowGif, onHideGif }) => {
      const welcomeData = useMemo(() => getTimeBasedWelcome(), []);
      const gifSide = useMemo(() => Math.random() > 0.5 ? 'left' : 'right', []);
      useEffect(() => { onShowGif(welcomeData.gif, '65%', gifSide); return () => onHideGif(); }, [welcomeData.gif, gifSide, onShowGif, onHideGif]);

      return (
        <div className="h-full w-full relative overflow-hidden">
          <div className="h-full flex flex-col items-center justify-center text-center px-6 py-4 relative z-20">
            <motion.h1 initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} className="title-font text-3xl sm:text-4xl md:text-5xl lg:text-6xl text-black mb-2 md:mb-3">{LESSON_CONFIG.title}</motion.h1>
            <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-neutral-600 text-base md:text-lg lg:text-xl mb-2 md:mb-3 max-w-lg leading-relaxed" dangerouslySetInnerHTML={{ __html: formatGreeting(welcomeData.greeting, `<span class="font-bold text-neutral-900">${userName}</span>`) }} />
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="flex items-center justify-center gap-1.5 text-neutral-400 text-[10px] md:text-xs mb-2 md:mb-3"><Icons.Clock /><span>{LESSON_CONFIG.duration}</span></motion.div>
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 }} className="bg-neutral-900 rounded-xl md:rounded-2xl p-3 md:p-5 mb-3 md:mb-4 max-w-sm w-full mx-auto">
              <p className="text-neutral-500 text-[9px] md:text-[11px] uppercase tracking-wider mb-2 md:mb-3">In this lesson</p>
              <ul className="space-y-1.5 md:space-y-2">
                {data.learningGoals.map((goal, i) => (
                  <motion.li key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.25 + i * 0.05 }} className="flex items-start gap-2 text-left">
                    <span className="w-5 h-5 rounded-md flex items-center justify-center text-[9px] font-bold text-white flex-shrink-0 mt-0.5" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>{i + 1}</span>
                    <span className="text-neutral-300 text-[11px] md:text-sm leading-snug">{goal}</span>
                  </motion.li>
                ))}
              </ul>
            </motion.div>
            <motion.button initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.45 }} onClick={onStart} whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }} className="px-6 md:px-7 py-2.5 md:py-3 rounded-xl text-white font-semibold text-sm md:text-base" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>Let\'s Go</motion.button>
          </div>
        </div>
      );
    };

    const HookSlide = ({ data }) => (
      <div className="h-full relative overflow-hidden">
        <div className="h-full flex flex-col justify-center px-8 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-10 relative z-10">
          <motion.div initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} className="mb-6">
            <span className="inline-block px-3 py-1 rounded-full text-xs font-semibold mb-4" style={{ background: `rgba(var(--accent-rgb), 0.1)`, color: 'var(--accent)' }}>The Hook</span>
            <h2 className="slide-title text-3xl md:text-4xl lg:text-5xl text-black leading-tight">{data.headline}</h2>
          </motion.div>
          <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="text-lg md:text-xl text-neutral-600 leading-relaxed">{data.subtext}</motion.p>
        </div>
        {data.brandImage && (
          <motion.div initial={{ opacity: 0, x: 30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.3, duration: 0.5 }}
            className="absolute bottom-0 right-0 z-0 pointer-events-none" style={{ height: '30%', maxHeight: '200px', marginRight: '3%', marginBottom: '5%' }}>
            <img src={data.brandImage} alt={data.brandName || ''} className="h-full w-auto object-contain" style={{ opacity: 1 }} />
          </motion.div>
        )}
      </div>
    );

    const ContentSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-8 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-10">
        <motion.h2 initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl lg:text-4xl text-black mb-6 relative z-10">{data.title}</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-base md:text-lg text-neutral-600 leading-relaxed relative z-10">{data.body}</motion.p>
      
        {data.characterVideo && (
          <motion.div
            initial={{ opacity: 0, y: 40 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: 0.4, duration: 0.6 }}
            className={`absolute bottom-0 ${data.characterPosition === 'left' ? 'left-6' : 'right-6'} z-0 pointer-events-none`}
            style={{ height: '35%', maxHeight: '280px' }}>
            <video autoPlay loop muted playsInline className="h-full w-auto object-contain object-bottom">
              <source src={data.characterVideo} type="video/mp4" />
            </video>
          </motion.div>
        )}
      </div>
    );

    const BeforeAfterSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
          <span className="inline-block px-3 py-1 rounded-full text-xs font-semibold mb-2" style={{ background: `rgba(var(--accent-rgb), 0.1)`, color: 'var(--accent)' }}>Transformation</span>
          <h2 className="slide-title text-xl md:text-2xl text-black">{data.scenario}</h2>
        </motion.div>
        <div className="grid md:grid-cols-2 gap-4 mb-6 relative z-10">
          <motion.div initial={{ opacity: 0, x: -20 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.1 }} className="bg-red-50 border-2 border-red-200 rounded-xl p-5">
            <div className="flex items-center gap-2 mb-3">
              <div className="w-6 h-6 rounded-full bg-red-500 flex items-center justify-center text-white"><Icons.X /></div>
              <span className="font-semibold text-red-700 text-sm">{data.before.label}</span>
            </div>
            <ul className="space-y-1.5 mb-3">
              {data.before.items.map((item, i) => (
                <li key={i} className="text-neutral-700 text-xs leading-relaxed">{item}</li>
              ))}
            </ul>
            <div className="text-red-600 text-xs font-semibold italic">{data.before.result}</div>
          </motion.div>
          <motion.div initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.2 }} className="bg-green-50 border-2 border-green-200 rounded-xl p-5">
            <div className="flex items-center gap-2 mb-3">
              <div className="w-6 h-6 rounded-full bg-green-500 flex items-center justify-center text-white"><Icons.Check /></div>
              <span className="font-semibold text-green-700 text-sm">{data.after.label}</span>
            </div>
            <ul className="space-y-1.5 mb-3">
              {data.after.items.map((item, i) => (
                <li key={i} className="text-neutral-700 text-xs leading-relaxed">{item}</li>
              ))}
            </ul>
            <div className="text-green-600 text-xs font-semibold italic">{data.after.result}</div>
          </motion.div>
        </div>
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.3 }} className="bg-neutral-900 rounded-xl p-4 text-center">
          <p className="text-neutral-300 text-sm"><Icons.Zap className="inline mr-2" />{data.insight}</p>
        </motion.div>
      </div>
    );

    const VisualSlide = ({ data }) => {
      if (data.visualType === 'comparison') {
        return (
          <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8">
            <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">{data.title}</motion.h2>
            <div className="grid grid-cols-3 gap-3 md:gap-6">
              <motion.div initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="bg-neutral-100 rounded-xl p-4 md:p-6 text-center">
                <div className="text-3xl md:text-4xl font-bold mb-2" style={{ color: data.data.left.color }}>{data.data.left.value}</div>
                <div className="text-xs md:text-sm font-semibold text-neutral-700 mb-2">{data.data.left.label}</div>
                <div className="text-[10px] md:text-xs text-neutral-500">{data.data.left.result}</div>
              </motion.div>
              <motion.div initial={{ opacity: 0, scale: 0.9 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.2 }} className="rounded-xl p-4 md:p-6 text-center transform scale-105 shadow-lg" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>
                <div className="text-3xl md:text-4xl font-bold text-white mb-2">{data.data.center.value}</div>
                <div className="text-xs md:text-sm font-semibold text-white/90 mb-2">{data.data.center.label}</div>
                <div className="text-[10px] md:text-xs text-white/70">{data.data.center.result}</div>
              </motion.div>
              <motion.div initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.3 }} className="bg-neutral-100 rounded-xl p-4 md:p-6 text-center">
                <div className="text-3xl md:text-4xl font-bold mb-2" style={{ color: data.data.right.color }}>{data.data.right.value}</div>
                <div className="text-xs md:text-sm font-semibold text-neutral-700 mb-2">{data.data.right.label}</div>
                <div className="text-[10px] md:text-xs text-neutral-500">{data.data.right.result}</div>
              </motion.div>
            </div>
          </div>
        );
      }
      if (data.visualType === 'stats') {
        return (
          <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8">
            <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">{data.title}</motion.h2>
            <div className="grid md:grid-cols-3 gap-4">
              {data.data.map((stat, i) => (
                <motion.div key={i} initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 + i * 0.1 }} className="bg-neutral-900 rounded-xl p-6 text-center">
                  <div className="text-4xl md:text-5xl font-bold mb-2" style={{ color: 'var(--accent)' }}>{stat.value}</div>
                  <div className="text-sm font-semibold text-white mb-1">{stat.label}</div>
                  <div className="text-xs text-neutral-400">{stat.subtext}</div>
                </motion.div>
              ))}
            </div>
          </div>
        );
      }
      return null;
    };

    const CardsSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8">
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-6">{data.title}</motion.h2>
        <div className={`grid gap-3 relative z-10 ${data.items.length === 5 ? 'md:grid-cols-3' : data.items.length === 3 ? 'md:grid-cols-3' : data.items.length === 4 ? 'md:grid-cols-2' : 'md:grid-cols-2'}`}>
          {data.items.map((item, i) => (
            <motion.div key={i} initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 + i * 0.06 }} className="bg-white border-2 border-neutral-200 rounded-xl p-4 hover:border-neutral-300 transition-colors">
              <h3 className="font-bold text-neutral-900 mb-2 text-sm md:text-base">{item.title}</h3>
              <p className="text-neutral-600 text-xs md:text-sm leading-relaxed">{item.description}</p>
            </motion.div>
          ))}
        </div>
      </div>
    );

    const DramaticNumberSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center items-center px-6 md:px-12 text-center py-8">
        <motion.h2 initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} className="text-neutral-600 text-lg md:text-xl mb-6">{data.title}</motion.h2>
        <DramaticReveal delay={0.3}>
          <div className="text-7xl md:text-9xl font-bold mb-4" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))`, WebkitBackgroundClip: 'text', WebkitTextFillColor: 'transparent', backgroundClip: 'text' }}>
            <TypewriterText text={data.number} speed={100} />
          </div>
        </DramaticReveal>
        <motion.p initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.8 }} className="text-neutral-600 text-base md:text-lg max-w-lg">{data.description}</motion.p>
      </div>
    );

    const RoadmapStepSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-3xl mx-auto py-8">
        <motion.div initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
          <div className="flex items-center justify-center gap-2 mb-6">
            {Array.from({ length: data.totalSteps }).map((_, i) => (
              <div key={i} className={`w-12 h-12 rounded-full flex items-center justify-center text-white font-bold transition-all ${i + 1 === data.stepNumber ? 'scale-125' : 'opacity-40'}`} style={{ background: i + 1 === data.stepNumber ? `linear-gradient(135deg, var(--accent), var(--accent-dark))` : '#d4d4d4' }}>
                {i + 1}
              </div>
            ))}
          </div>
          <h2 className="slide-title text-3xl md:text-4xl text-black mb-4">{data.title}</h2>
          <p className="text-neutral-600 text-base md:text-lg max-w-xl mx-auto">{data.description}</p>
        </motion.div>
        <motion.div initial={{ opacity: 0, scaleX: 0 }} animate={{ opacity: 1, scaleX: 1 }} transition={{ delay: 0.4, duration: 0.8 }} className="h-2 rounded-full mx-auto" style={{ width: `${(data.stepNumber / data.totalSteps) * 100}%`, background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }} />
      </div>
    );

    const CircularStatsSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto py-8">
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">{data.title}</motion.h2>
        <div className="grid md:grid-cols-3 gap-8">
          {data.stats.map((stat, i) => (
            <motion.div key={i} initial={{ opacity: 0, scale: 0.8 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.2 + i * 0.15 }}>
              <CircularProgress percentage={stat.percentage} label={stat.label} color={stat.color} />
            </motion.div>
          ))}
        </div>
      </div>
    );

    const ToolIntegratedSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-3xl mx-auto slide-scroll overflow-y-auto py-8">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="mb-6">
          <span className="inline-block px-3 py-1 rounded-full text-xs font-semibold mb-3" style={{ background: `rgba(var(--accent-rgb), 0.1)`, color: 'var(--accent)' }}>{data.stepContext}</span>
          <h3 className="text-xl md:text-2xl font-bold text-black mb-3">{data.toolName}</h3>
          <p className="text-neutral-600 text-sm md:text-base leading-relaxed mb-4">{data.body}</p>
        </motion.div>
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="bg-neutral-50 border border-neutral-200 rounded-xl p-4 mb-4">
          <p className="text-neutral-700 text-sm italic">{data.benefit}</p>
        </motion.div>
        <motion.a initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.25 }} href={data.toolUrl} target="_blank" rel="noopener noreferrer" className="inline-flex items-center justify-center gap-2 px-5 py-2.5 rounded-xl text-white font-semibold text-sm transition-all hover:scale-[1.02]" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>
          <span>Learn More</span>
          <Icons.ExternalLink />
        </motion.a>
      </div>
    );

    const QuizSlide = ({ data, onShowGif, onHideGif }) => {
      const [selected, setSelected] = useState(null);
      const [showFeedback, setShowFeedback] = useState(false);
      const celebrationGif = useMemo(() => getRandomCelebrationGif(), []);
      const empathyGif = useMemo(() => getRandomEmpathyGif(), []);
      const gifSide = useMemo(() => Math.random() > 0.5 ? 'left' : 'right', []);
      const handleSelect = (index) => { if (showFeedback) return; setSelected(index); setShowFeedback(true); };
      const isCorrect = selected === data.correctIndex;

      useEffect(() => { if (showFeedback) { if (isCorrect) { onShowGif(celebrationGif, '60%', gifSide); } else { onShowGif(empathyGif, '60%', gifSide); } } }, [showFeedback, isCorrect, celebrationGif, empathyGif, gifSide, onShowGif]);
      useEffect(() => { return () => onHideGif(); }, [onHideGif]);

      return (
        <div className="h-full w-full relative overflow-hidden">
          <div className="h-full flex flex-col justify-center px-8 md:px-12 max-w-2xl mx-auto slide-scroll overflow-y-auto py-10 relative z-30">
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
              <p className="text-xs uppercase tracking-wider text-neutral-400 mb-3">Quick Check</p>
              <h2 className="slide-title text-xl md:text-2xl text-black leading-tight">{data.question}</h2>
            </motion.div>
            <div className="space-y-3 mb-6">
              {data.options.map((option, i) => (
                <motion.button key={i} initial={{ opacity: 0, x: -15 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.08 + i * 0.06 }} onClick={() => handleSelect(i)} disabled={showFeedback} className={`w-full p-4 rounded-xl text-left transition-all border-2 ${showFeedback ? i === data.correctIndex ? 'border-green-500 bg-green-50' : i === selected ? 'border-red-400 bg-red-50' : 'border-neutral-200 bg-white opacity-40' : 'border-neutral-200 bg-white hover:border-neutral-300'}`}>
                  <div className="flex items-center gap-3">
                    <span className={`w-8 h-8 rounded-lg flex items-center justify-center text-sm font-bold transition-all ${showFeedback && i === data.correctIndex ? 'bg-green-500 text-white' : showFeedback && i === selected && !isCorrect ? 'bg-red-400 text-white' : 'bg-neutral-100 text-neutral-500'}`}>
                      {showFeedback && i === data.correctIndex ? <Icons.Check /> : showFeedback && i === selected && !isCorrect ? <Icons.X /> : String.fromCharCode(65 + i)}
                    </span>
                    <span className="text-neutral-700 text-sm md:text-base">{option}</span>
                  </div>
                </motion.button>
              ))}
            </div>
            <AnimatePresence>
              {showFeedback && (
                <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className={`p-5 rounded-xl ${isCorrect ? 'bg-green-50 border border-green-200' : 'bg-amber-50 border border-amber-200'}`}>
                  <p className={`text-sm leading-relaxed ${isCorrect ? 'text-green-800' : 'text-amber-800'}`}>{isCorrect ? data.feedback.correct : data.feedback.incorrect}</p>
                </motion.div>
              )}
            </AnimatePresence>
          </div>
        </div>
      );
    };

    const PyramidSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-3xl mx-auto py-8">
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">{data.title}</motion.h2>
        <div className="space-y-3">
          {data.levels.map((level, i) => (
            <motion.div key={i} initial={{ opacity: 0, scaleX: 0 }} animate={{ opacity: 1, scaleX: 1 }} transition={{ delay: 0.2 + i * 0.12 }} className="mx-auto rounded-xl p-3 md:p-4 text-center text-white font-semibold text-xs md:text-base" style={{ width: `${100 - i * 12}%`, background: `linear-gradient(135deg, var(--accent), var(--accent-dark))`, opacity: 1 - i * 0.12 }}>
              {level}
            </motion.div>
          ))}
        </div>
      </div>
    );

    const RevealStepsSlide = ({ data }) => {
      const [revealed, setRevealed] = useState(0);
      useEffect(() => {
        const timer = setInterval(() => {
          setRevealed(r => r < data.steps.length ? r + 1 : r);
        }, 800);
        return () => clearInterval(timer);
      }, [data.steps.length]);
      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-3xl mx-auto slide-scroll overflow-y-auto py-8">
          <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">{data.title}</motion.h2>
          <div className="space-y-4 mb-6">
            {data.steps.map((step, i) => (
              <motion.div key={i} initial={{ opacity: 0, height: 0 }} animate={{ opacity: i < revealed ? 1 : 0.3, height: 'auto' }} className="bg-white border-2 rounded-xl p-4" style={{ borderColor: i < revealed ? 'var(--accent)' : '#e5e5e5' }}>
                <div className="flex items-center gap-3">
                  <span className="w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-bold" style={{ background: i < revealed ? 'var(--accent)' : '#d4d4d4' }}>{i + 1}</span>
                  <span className="font-semibold text-sm md:text-base">{step}</span>
                </div>
              </motion.div>
            ))}
          </div>
          {data.hasButton && (
            <motion.a initial={{ opacity: 0, y: 40 }} animate={{ opacity: revealed >= data.steps.length ? 1 : 0, y: revealed >= data.steps.length ? 0 : 20 }} transition={{ delay: 0.3 }} href={data.buttonUrl} className="inline-flex items-center justify-center gap-2 px-6 py-3 rounded-xl text-white font-semibold text-sm md:text-base transition-all hover:scale-[1.02] mx-auto" style={{ background: 'linear-gradient(135deg, #8b5cf6, #7c3aed)', boxShadow: '0 4px 12px rgba(139, 92, 246, 0.3)' }}>
              <span>{data.buttonText}</span>
              <Icons.ArrowRight />
            </motion.a>
          )}
        </div>
      );
    };

    const MetricDashboardSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto py-8">
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">{data.title}</motion.h2>
        <MetricDashboard metrics={data.metrics} />
      </div>
    );

    const ProgressBarsSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-3xl mx-auto py-8">
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">{data.title}</motion.h2>
        <div>
          {data.bars.map((bar, i) => (
            <ProgressBar key={i} percentage={bar.percentage} label={bar.label} color={bar.color} delay={i * 200} />
          ))}
        </div>
      </div>
    );

    const DataDrewIntroSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="mb-6">
          <span className="inline-block px-3 py-1.5 rounded-full text-xs font-semibold mb-4" style={{ background: 'rgba(139, 92, 246, 0.1)', color: '#8b5cf6' }}>FREE Tool</span>
          <h2 className="slide-title text-2xl md:text-3xl text-black mb-4">{data.title}</h2>
          <p className="text-neutral-600 text-base md:text-lg leading-relaxed mb-6">{data.body}</p>
        </motion.div>
        <motion.div initial={{ opacity: 0, y: 40 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 }} className="bg-neutral-50 border-2 border-neutral-200 rounded-xl p-4 mb-6 overflow-hidden">
          <img src={data.screenshot} alt="DataDrew Dashboard" className="w-full h-auto rounded-lg" />
        </motion.div>
        <motion.a initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.3 }} href={data.toolUrl} target="_blank" rel="noopener noreferrer" className="inline-flex items-center justify-center gap-2 px-6 py-3 rounded-xl text-white font-semibold text-sm md:text-base transition-all hover:scale-[1.02] mx-auto" style={{ background: 'linear-gradient(135deg, #8b5cf6, #7c3aed)', boxShadow: '0 4px 12px rgba(139, 92, 246, 0.3)' }}>
          <span>Get DataDrew Free</span>
          <Icons.ExternalLink />
        </motion.a>
      </div>
    );

    const CompletionSlide = ({ data }) => (
      <div className="h-full flex flex-col items-center justify-center text-center px-8 slide-scroll overflow-y-auto py-8">
        <motion.div initial={{ opacity: 0, scale: 0 }} animate={{ opacity: 1, scale: 1 }} transition={{ type: 'spring', duration: 0.5 }} className="w-16 h-16 rounded-xl flex items-center justify-center mb-4 text-white" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))`, boxShadow: `0 6px 24px rgba(var(--accent-rgb), 0.35)` }}><Icons.Check /></motion.div>
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="slide-title text-2xl md:text-3xl text-black mb-3">Lesson Complete</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.25 }} className="text-neutral-500 text-sm mb-5 max-w-md leading-relaxed">You now have the complete roadmap: Build $1,000-$2,000 LTV (track in DataDrew). Set strong roots with email, checkout recovery, and private agent. Attract only top RFM customers via LookAlikes. Scale to 33/day with unlimited CAC. The game becomes easy and infinite. $1M/month isn\'t magic. It\'s math.</motion.p>
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.35 }} className="bg-neutral-900 rounded-xl p-5 max-w-md w-full mb-4">
          <p className="text-neutral-500 text-xs uppercase tracking-wider mb-2">Up Next</p>
          <h3 className="text-white font-bold text-lg mb-1">{LESSON_CONFIG.nextLesson.title}</h3>
          <p className="text-neutral-400 text-xs">{LESSON_CONFIG.nextLesson.teaser}</p>
        </motion.div>
        {data?.sources && data.sources.length > 0 && (
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.45 }} className="bg-neutral-50 border border-neutral-200 rounded-xl p-4 max-w-md w-full">
            <p className="text-neutral-400 text-xs uppercase tracking-wider mb-2 flex items-center justify-center gap-1"><Icons.Link /> Relevant Sources</p>
            <div className="space-y-1.5">
              {data.sources.map((source, i) => (
                <a key={i} href={source.url} target="_blank" rel="noopener noreferrer" className="flex items-center justify-center gap-2 text-sm font-medium transition-colors hover:underline" style={{ color: 'var(--accent)' }}>
                  {source.name}
                  <Icons.ExternalLink />
                </a>
              ))}
            </div>
          </motion.div>
        )}
      </div>
    );

    const LessonApp = () => {
      const [currentSlide, setCurrentSlide] = useState(0);
      const [direction, setDirection] = useState(1);
      const userName = useMemo(() => getUserName(), []);
      const currentSlideRef = React.useRef(0);
      const [gifConfig, setGifConfig] = useState(null);
      const [isAnimating, setIsAnimating] = useState(false);

      const showGif = useCallback((url, height, side) => setGifConfig({ url, height, side }), []);
      const hideGif = useCallback(() => setGifConfig(null), []);

      React.useEffect(() => { currentSlideRef.current = currentSlide; }, [currentSlide]);

      const goToSlide = useCallback((newSlide) => {
        if (isAnimating || newSlide < 0 || newSlide >= slides.length) return;
        setIsAnimating(true);
        setDirection(newSlide > currentSlideRef.current ? 1 : -1);
        setCurrentSlide(newSlide);
      }, [isAnimating]);

      const nextSlide = useCallback(() => { if (currentSlideRef.current + 1 < slides.length) goToSlide(currentSlideRef.current + 1); }, [goToSlide]);
      const prevSlide = useCallback(() => { if (currentSlideRef.current - 1 >= 0) goToSlide(currentSlideRef.current - 1); }, [goToSlide]);

      useEffect(() => {
        const handleKeyDown = (e) => {
          if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); nextSlide(); }
          if (e.key === 'ArrowLeft') { e.preventDefault(); prevSlide(); }
        };
        window.addEventListener('keydown', handleKeyDown);
        return () => window.removeEventListener('keydown', handleKeyDown);
      }, [nextSlide, prevSlide]);

      const slideVariants = {
        enter: (dir) => ({ x: dir > 0 ? '100%' : '-100%', opacity: 0 }),
        center: { x: 0, opacity: 1 },
        exit: (dir) => ({ x: dir > 0 ? '-100%' : '100%', opacity: 0 })
      };

      const renderSlide = (slide) => {
        switch (slide.type) {
          case 'welcome': return <WelcomeSlide data={slide} onStart={nextSlide} userName={userName} onShowGif={showGif} onHideGif={hideGif} />;
          case 'hook': return <HookSlide data={slide} />;
          case 'content': return <ContentSlide data={slide} />;
          case 'beforeAfter': return <BeforeAfterSlide data={slide} />;
          case 'visual': return <VisualSlide data={slide} />;
          case 'cards': return <CardsSlide data={slide} />;
          case 'dramaticNumber': return <DramaticNumberSlide data={slide} />;
          case 'roadmapStep': return <RoadmapStepSlide data={slide} />;
          case 'circularStats': return <CircularStatsSlide data={slide} />;
          case 'toolIntegrated': return <ToolIntegratedSlide data={slide} />;
          case 'quiz': return <QuizSlide data={slide} onShowGif={showGif} onHideGif={hideGif} />;
          case 'pyramid': return <PyramidSlide data={slide} />;
          case 'revealSteps': return <RevealStepsSlide data={slide} />;
          case 'metricDashboard': return <MetricDashboardSlide data={slide} />;
          case 'progressBars': return <ProgressBarsSlide data={slide} />;
          case 'dataDrewIntro': return <DataDrewIntroSlide data={slide} />;
          case 'completion': return <CompletionSlide data={slide} />;
          default: return null;
        }
      };

      const showPrev = currentSlide > 0;
      const showNext = currentSlide < slides.length - 1 && slides[currentSlide].type !== 'welcome';

      return (
        <div className="w-full h-screen bg-white flex flex-col relative">
          <div className="flex-1 relative overflow-hidden z-20">
            <AnimatePresence mode="wait" custom={direction} onExitComplete={() => setIsAnimating(false)}>
              <motion.div key={currentSlide} custom={direction} variants={slideVariants} initial="enter" animate="center" exit="exit" transition={{ duration: 0.3, ease: [0.25, 0.1, 0.25, 1] }} className="absolute inset-0">
                {renderSlide(slides[currentSlide])}
              </motion.div>
            </AnimatePresence>
            {showPrev && <button onClick={prevSlide} className="absolute left-5 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-500 hover:text-neutral-700 transition-all z-10"><Icons.ArrowLeft /></button>}
            {showNext && <button onClick={nextSlide} className="absolute right-5 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-500 hover:text-neutral-700 transition-all z-10"><Icons.ArrowRight /></button>}
          </div>
          <div className="px-6 md:px-8 py-5 border-t border-neutral-100 flex-shrink-0 relative z-10">
            <div className="flex items-center justify-center gap-2.5">
              {slides.map((_, i) => <button key={i} onClick={() => goToSlide(i)} className="w-2.5 h-2.5 rounded-full transition-all duration-300" style={{ background: i === currentSlide ? 'var(--accent)' : '#d4d4d4', transform: i === currentSlide ? 'scale(1.3)' : 'scale(1)' }} />)}
            </div>
          </div>
          <AnimatePresence>
            {gifConfig && (
              <motion.div initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: 30 }} transition={{ type: 'spring', stiffness: 100 }} className={`absolute ${gifConfig.side === 'left' ? 'left-4 md:left-8' : 'right-4 md:right-8'} bottom-0 pointer-events-none`} style={{ zIndex: 15, height: gifConfig.height }}>
                <video autoPlay loop muted playsInline className="h-full w-auto object-contain object-bottom" style={{ background: 'transparent', border: 'none', boxShadow: 'none' }}>
                  <source src={gifConfig.url} type="video/mp4" />
                </video>
              </motion.div>
            )}
          </AnimatePresence>
        </div>
      );
    };

    ReactDOM.render(<LessonApp />, document.getElementById('root'));
  </script>
</body>
</html>
