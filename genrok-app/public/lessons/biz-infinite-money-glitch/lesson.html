<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Infinite Money Glitch | Quantum Scale</title>
  <script src="https://cdn.tailwindcss.com" defer></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" defer></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" defer></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js" defer></script>
  <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js" defer></script>
  <script src="../shared/greetings.js" defer></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;500;600;700;800;900&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root { --accent: #22C55E; --accent-dark: #16A34A; --accent-light: #4ADE80; --accent-rgb: 34, 197, 94; }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Inter', sans-serif; background: transparent; -webkit-font-smoothing: antialiased; }
    .title-font { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    h1, h2, h3, .slide-title { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    ::selection { background: var(--accent); color: white; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { motion, AnimatePresence } = window.Motion;
    const { useState, useEffect, useCallback, useMemo } = React;

    const getUserName = () => { const params = new URLSearchParams(window.location.search); return params.get('userName') || 'Builder'; };

    const LESSON_CONFIG = {
      id: 'biz-infinite-money-glitch',
      title: 'The Infinite Money Glitch',
      description: 'The self-fueling growth engine that scales forever',
      accentColor: '#22C55E',
      duration: '5 min',
      nextLesson: { id: 'biz-price-anchoring', title: 'Price Anchoring Power', teaser: 'Why premium offers multiply everything.' }
    };

    const celebrationGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_jumping_in_the_air_arms_raised_high_YESSS_cele_201477e8-3df4-405a-bc81-81d1747e5c6c_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_doing_a_victory_fist_pump_arms_flexed_strong_p_b7635e9d-ceed-45f2-b5f3-ea32a689e200_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_nodding_approvingly_arms_crossed_confident_sta_75d6baae-3620-48c5-a3f1-fecbdb6543a4_1.mp4'
    ];
    const getRandomCelebrationGif = () => celebrationGifs[Math.floor(Math.random() * celebrationGifs.length)];

    const empathyGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_thumbs_down_with_encouraging_nod_close_keep_go_613e541f-c072-436f-aee7-f99cd6f834fc_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_making_a_thinking_chin_scratch_like_hmm_lets_t_7d0403f7-08dd-4abb-9a7c-c3194f4548c2_2.mp4'
    ];
    const getRandomEmpathyGif = () => empathyGifs[Math.floor(Math.random() * empathyGifs.length)];

    const slides = [
      { type: 'welcome', learningGoals: ['The flywheel that funds itself', 'Why LTV > CAC unlocks infinite scaling', 'Building your money printing machine'] },
      { type: 'hook', headline: 'What if every customer you acquired funded the acquisition of two more?', subtext: 'That is not a fantasy. It is a flywheel. When your LTV significantly exceeds your CAC, something magical happens: your business becomes self-fueling. Each customer generates enough profit to acquire the next one. And the next. And the next. No external funding needed. No bootstrapping grind. Just a machine that prints money as long as you keep feeding it customers.', brandImage: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/REI_logo.svg.png', brandName: 'REI' },
      { type: 'flywheel-visual', title: 'The Infinite Money Flywheel', steps: [
        { label: 'Acquire Customer', description: 'Spend $50 to acquire', color: '#3B82F6' },
        { label: 'Generate LTV', description: 'Customer worth $200', color: '#22C55E' },
        { label: 'Pocket Profit', description: '$150 gross profit', color: '#F59E0B' },
        { label: 'Reinvest', description: 'Acquire 3 more customers', color: '#8B5CF6' }
      ]},
      { type: 'content', title: 'How The Glitch Works', body: 'The math is simple but powerful. If your LTV is $200 and your CAC is $50, every customer generates $150 in profit. Reinvest that $150 and you acquire 3 more customers. Each of those generates $150, giving you $450 to acquire 9 more. The flywheel spins faster and faster. As long as LTV stays above CAC, the machine never stops. This is how small stores become empires without raising a dime.' },
      { type: 'math-visual', title: 'The Compounding Effect', generations: [
        { round: 'Round 1', customers: 1, spend: '$50', profit: '$150', reinvest: '3 new customers' },
        { round: 'Round 2', customers: 3, spend: '$150', profit: '$450', reinvest: '9 new customers' },
        { round: 'Round 3', customers: 9, spend: '$450', profit: '$1,350', reinvest: '27 new customers' },
        { round: 'Round 4', customers: 27, spend: '$1,350', profit: '$4,050', reinvest: '81 new customers' }
      ]},
      { type: 'stat-countdown', title: 'The Flywheel Numbers', stats: [
        { value: 4, suffix: 'x', label: 'LTV:CAC Needed', subtext: 'For optimal flywheel speed' },
        { value: 3, suffix: 'x', label: 'Customer Growth', subtext: 'Per reinvestment round' },
        { value: 0, suffix: '', label: 'External Funding', subtext: 'Needed when flywheel spins' }
      ]},
      { type: 'content', title: 'The Two Requirements', body: 'For the infinite money glitch to work, you need two things. First, your LTV must significantly exceed CAC - at least 3:1, ideally 4:1 or higher. Second, you need reinvestment discipline. The temptation is to pocket profits. But every dollar you take out is three customers you do not acquire. The founders who build empires are the ones who keep feeding the flywheel until it is unstoppable.' },
      { type: 'requirements-visual', title: 'Glitch Requirements', requirements: [
        { number: 1, title: 'LTV > 3x CAC', description: 'Each customer must generate enough profit to fund 3+ new acquisitions. Below 3:1, the flywheel stalls.', color: '#22C55E', icon: 'DollarSign' },
        { number: 2, title: 'Reinvestment Discipline', description: 'Take minimal profits early. Let the flywheel compound. Scale first, extract later.', color: '#3B82F6', icon: 'RefreshCcw' }
      ]},
      { type: 'before-after', title: 'Without vs With The Glitch', before: ['Bootstrap grinding for years', 'Slow linear growth', 'Cash constrained', 'Fighting for every customer', 'Stagnation risk'], after: ['Self-fueling from day one', 'Exponential compounding growth', 'Cash generative machine', 'Customers fund more customers', 'Unstoppable momentum'] },
      { type: 'tool-integration', title: 'Calculate Your Flywheel Speed', subtitle: 'See if your business can activate the glitch', tool: { name: 'DataDrew', description: 'Free Shopify app that shows your real LTV by customer segment', image: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/46.webp', link: 'https://apps.shopify.com/customer-lifetime-value?mref=lsbqcbva', features: ['Calculate true LTV', 'See LTV:CAC ratio', 'Find your best segments', '100% free forever'] } },
      { type: 'highlight-box', title: 'The Glitch Mindset', body: 'The infinite money glitch is not about finding a cheat code. It is about building a machine with fundamentals so strong that growth becomes automatic. Get LTV high through retention, upsells, and loyalty. Get CAC low through efficient channels and strong creative. Then reinvest relentlessly. The founders who understand this build businesses that grow while they sleep.', highlight: 'Build fundamentals so strong that growth becomes automatic. Then reinvest relentlessly.' },
      { type: 'quiz', question: 'What makes the infinite money glitch work?', options: ['External funding and investors', 'LTV significantly exceeding CAC with reinvestment', 'Lowering prices to increase volume', 'Cutting all marketing spend'], correctIndex: 1, feedback: { correct: 'Exactly. The glitch works when LTV significantly exceeds CAC (at least 3:1) and you reinvest profits into acquiring more customers. Each customer funds the next batch, creating a self-fueling flywheel that compounds forever.', incorrect: 'Not quite. The infinite money glitch works when your LTV significantly exceeds your CAC (3:1 or higher) and you reinvest profits to acquire more customers. Each customer funds the next ones, creating a self-fueling growth machine.' }},
      { type: 'completion', sources: [] }
    ];

    const Icons = {
      Clock: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
      Check: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><polyline points="20 6 9 17 4 12"/></svg>,
      X: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
      ArrowLeft: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>,
      ArrowRight: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>,
      Zap: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
      ExternalLink: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>,
      DollarSign: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>,
      RefreshCcw: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"/><path d="M16 16h5v5"/></svg>,
      TrendingUp: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>,
      Infinity: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2"><path d="M18.178 8c5.096 0 5.096 8 0 8-5.095 0-7.133-8-12.739-8-4.585 0-4.585 8 0 8 5.606 0 7.644-8 12.74-8z"/></svg>,
    };

    const AnimatedCounter = ({ target, suffix = '', duration = 2000 }) => {
      const [count, setCount] = useState(0);
      useEffect(() => {
        let start = 0;
        const increment = target / (duration / 16);
        const timer = setInterval(() => { start += increment; if (start >= target) { setCount(target); clearInterval(timer); } else { setCount(Math.floor(start)); } }, 16);
        return () => clearInterval(timer);
      }, [target, duration]);
      return <span>{count}{suffix}</span>;
    };

    // Flywheel Visual
    const FlywheelVisualSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto py-8">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
          <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-4" style={{ background: 'rgba(34, 197, 94, 0.1)', color: '#22C55E' }}>
            <Icons.Infinity size={14} color="#22C55E" />
            <span>The Flywheel</span>
          </div>
          <h2 className="slide-title text-2xl md:text-3xl text-black">{data.title}</h2>
        </motion.div>

        <motion.div initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.2 }} className="rounded-2xl p-8" style={{ background: '#0a0a0a', border: '1px solid #222' }}>
          <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
            {data.steps.map((step, i) => (
              <motion.div key={i} initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.3 + i * 0.15 }} className="text-center">
                <div className="w-16 h-16 rounded-full mx-auto mb-3 flex items-center justify-center text-2xl font-bold text-white" style={{ background: `${step.color}30`, border: `2px solid ${step.color}` }}>
                  {i + 1}
                </div>
                <div className="text-sm font-bold text-white mb-1">{step.label}</div>
                <div className="text-xs text-neutral-400">{step.description}</div>
                {i < data.steps.length - 1 && (
                  <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ delay: 0.5 + i * 0.15 }} className="text-green-400 mt-3 hidden md:block">→</motion.div>
                )}
              </motion.div>
            ))}
          </div>
          <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ delay: 1 }} className="mt-6 text-center">
            <div className="inline-flex items-center gap-2 text-green-400 text-sm">
              <Icons.RefreshCcw size={16} color="#22C55E" />
              <span>Repeat forever</span>
            </div>
          </motion.div>
        </motion.div>
      </div>
    );

    // Math Visual
    const MathVisualSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto py-8">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
          <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-4" style={{ background: 'rgba(34, 197, 94, 0.1)', color: '#22C55E' }}>
            <Icons.TrendingUp size={14} color="#22C55E" />
            <span>Watch It Compound</span>
          </div>
          <h2 className="slide-title text-2xl md:text-3xl text-black">{data.title}</h2>
        </motion.div>

        <div className="space-y-3">
          {data.generations.map((gen, i) => (
            <motion.div key={i} initial={{ opacity: 0, x: -30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.2 + i * 0.15 }} className="rounded-xl p-4" style={{ background: '#0a0a0a', border: '1px solid #222' }}>
              <div className="grid grid-cols-5 gap-4 items-center text-center text-sm">
                <div className="font-bold text-green-400">{gen.round}</div>
                <div><span className="text-neutral-400 text-xs block">Customers</span><span className="text-white font-bold">{gen.customers}</span></div>
                <div><span className="text-neutral-400 text-xs block">Spend</span><span className="text-white">{gen.spend}</span></div>
                <div><span className="text-neutral-400 text-xs block">Profit</span><span className="text-green-400 font-bold">{gen.profit}</span></div>
                <div><span className="text-neutral-400 text-xs block">→</span><span className="text-blue-400">{gen.reinvest}</span></div>
              </div>
            </motion.div>
          ))}
        </div>
      </div>
    );

    // Requirements Visual
    const RequirementsVisualSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto py-8">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
          <h2 className="slide-title text-2xl md:text-3xl text-black">{data.title}</h2>
        </motion.div>

        <div className="space-y-4">
          {data.requirements.map((req, i) => {
            const IconComponent = req.icon === 'DollarSign' ? Icons.DollarSign : Icons.RefreshCcw;
            return (
              <motion.div key={i} initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 + i * 0.15 }} className="rounded-xl p-6" style={{ background: '#0a0a0a', border: `1px solid ${req.color}30` }}>
                <div className="flex items-start gap-4">
                  <div className="w-14 h-14 rounded-xl flex items-center justify-center flex-shrink-0" style={{ background: `${req.color}20` }}>
                    <IconComponent size={28} color={req.color} />
                  </div>
                  <div>
                    <h3 className="text-white font-bold text-lg mb-1" style={{ color: req.color }}>{req.title}</h3>
                    <p className="text-neutral-400 text-sm leading-relaxed">{req.description}</p>
                  </div>
                </div>
              </motion.div>
            );
          })}
        </div>
      </div>
    );

    // Tool Integration
    const ToolIntegrationSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto py-8">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
          <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-4" style={{ background: 'rgba(34, 197, 94, 0.1)', color: '#22C55E' }}>
            <Icons.Zap />
            <span>Recommended Tool</span>
          </div>
          <h2 className="slide-title text-2xl md:text-3xl text-black mb-2">{data.title}</h2>
          <p className="text-neutral-500 text-sm">{data.subtitle}</p>
        </motion.div>

        <motion.div initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.2 }} className="rounded-2xl p-6 md:p-8" style={{ background: '#0a0a0a', border: '1px solid #222' }}>
          <div className="flex flex-col md:flex-row gap-6 items-center">
            <div className="w-full md:w-2/5">
              <img src={data.tool.image} alt={data.tool.name} className="w-full rounded-xl" style={{ border: '1px solid #333' }} />
            </div>
            <div className="w-full md:w-3/5">
              <h3 className="text-2xl font-bold text-white mb-2">{data.tool.name}</h3>
              <p className="text-neutral-400 text-sm mb-4">{data.tool.description}</p>
              <div className="space-y-2 mb-6">
                {data.tool.features.map((f, i) => (
                  <motion.div key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.4 + i * 0.1 }} className="flex items-center gap-2 text-sm">
                    <span className="text-green-500"><Icons.Check /></span>
                    <span className="text-neutral-300">{f}</span>
                  </motion.div>
                ))}
              </div>
              <a href={data.tool.link} target="_blank" rel="noopener noreferrer" className="inline-flex items-center gap-2 px-5 py-3 rounded-xl font-semibold text-white text-sm transition-all hover:scale-105" style={{ background: 'linear-gradient(135deg, #22C55E, #16A34A)' }}>Get {data.tool.name} Free<Icons.ExternalLink /></a>
            </div>
          </div>
        </motion.div>
      </div>
    );

    // Stat Countdown
    const StatCountdownSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-8">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-10"><h2 className="slide-title text-2xl md:text-3xl text-black">{data.title}</h2></motion.div>
        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
          {data.stats.map((stat, i) => (
            <motion.div key={i} initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 + i * 0.15 }} className="rounded-2xl p-6 text-center" style={{ background: '#0a0a0a', border: '1px solid #222' }}>
              <div className="text-5xl md:text-6xl font-bold mb-2" style={{ color: '#22C55E' }}><AnimatedCounter target={stat.value} suffix={stat.suffix} duration={2000} /></div>
              <div className="text-white font-medium mb-1">{stat.label}</div>
              <div className="text-neutral-500 text-sm">{stat.subtext}</div>
            </motion.div>
          ))}
        </div>
      </div>
    );

    // Before/After
    const BeforeAfterSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-8">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8"><h2 className="slide-title text-2xl md:text-3xl text-black">{data.title}</h2></motion.div>
        <div className="grid md:grid-cols-2 gap-6">
          <motion.div initial={{ opacity: 0, x: -30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.2 }} className="rounded-2xl p-6" style={{ background: '#0a0a0a', border: '1px solid rgba(107, 114, 128, 0.3)' }}>
            <div className="flex items-center gap-2 mb-4"><div className="w-8 h-8 rounded-full flex items-center justify-center" style={{ background: 'rgba(107, 114, 128, 0.2)' }}><Icons.X /></div><span className="text-neutral-400 font-semibold uppercase text-sm">Without Glitch</span></div>
            <div className="space-y-3">{data.before.map((item, i) => (<motion.div key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.3 + i * 0.1 }} className="flex items-start gap-3 text-neutral-400 text-sm"><span className="text-neutral-600 mt-0.5">-</span><span>{item}</span></motion.div>))}</div>
          </motion.div>
          <motion.div initial={{ opacity: 0, x: 30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.3 }} className="rounded-2xl p-6" style={{ background: '#0a0a0a', border: '1px solid rgba(34, 197, 94, 0.3)', boxShadow: '0 0 30px rgba(34, 197, 94, 0.1)' }}>
            <div className="flex items-center gap-2 mb-4"><div className="w-8 h-8 rounded-full flex items-center justify-center" style={{ background: 'rgba(34, 197, 94, 0.2)' }}><Icons.Check /></div><span className="text-green-400 font-semibold uppercase text-sm">With Glitch</span></div>
            <div className="space-y-3">{data.after.map((item, i) => (<motion.div key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.4 + i * 0.1 }} className="flex items-start gap-3 text-neutral-300 text-sm"><span className="text-green-500 mt-0.5">+</span><span>{item}</span></motion.div>))}</div>
          </motion.div>
        </div>
      </div>
    );

    // Highlight Box
    const HighlightBoxSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto py-8">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8"><h2 className="slide-title text-2xl md:text-3xl text-black">{data.title}</h2></motion.div>
        <motion.div initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.2 }} className="rounded-2xl p-8 md:p-10" style={{ background: '#0a0a0a', border: '1px solid rgba(34, 197, 94, 0.3)', boxShadow: '0 0 40px rgba(34, 197, 94, 0.1)' }}>
          <p className="text-neutral-300 text-lg leading-relaxed mb-6">{data.body}</p>
          <motion.div initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.5 }} className="rounded-xl p-4" style={{ background: 'linear-gradient(135deg, rgba(34, 197, 94, 0.15), rgba(34, 197, 94, 0.05))', borderLeft: '4px solid #22C55E' }}>
            <p className="text-white font-medium text-lg italic">"{data.highlight}"</p>
          </motion.div>
        </motion.div>
      </div>
    );

    // Content
    const ContentSlide = ({ data }) => (<div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-3xl mx-auto py-8"><motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }}><h2 className="slide-title text-2xl md:text-3xl text-black mb-6">{data.title}</h2><p className="text-neutral-600 text-lg leading-relaxed">{data.body}</p></motion.div></div>);

    // Welcome - With GIF overlay integration
    const WelcomeSlide = ({ data, onStart, userName, onShowGif, onHideGif }) => {
      const welcomeData = useMemo(() => getTimeBasedWelcome(), []);
      const gifSide = useMemo(() => Math.random() > 0.5 ? 'left' : 'right', []);

      useEffect(() => {
        onShowGif(welcomeData.gif, '65%', gifSide);
        return () => onHideGif();
      }, [welcomeData.gif, gifSide, onShowGif, onHideGif]);

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-3xl mx-auto py-8">
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }}>
            <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-6" style={{ background: 'rgba(34, 197, 94, 0.1)', color: '#22C55E' }}><Icons.Zap /><span>Growth Engine</span></div>
            <h1 className="slide-title text-3xl md:text-4xl lg:text-5xl text-black mb-4">{formatGreeting(welcomeData.greeting, userName)}</h1>
            <p className="text-neutral-500 text-lg mb-8">Here's what you'll discover:</p>
            <div className="space-y-3">{data.learningGoals.map((goal, i) => (<motion.div key={i} initial={{ opacity: 0, x: -20 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.3 + i * 0.1 }} className="flex items-center gap-3 p-4 rounded-xl" style={{ background: '#fafafa', border: '1px solid #eee' }}><div className="w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-bold" style={{ background: '#22C55E' }}>{i + 1}</div><span className="text-neutral-700 font-medium">{goal}</span></motion.div>))}</div>
          </motion.div>
        </div>
      );
    };

    // Hook
    const HookSlide = ({ data }) => (
      <div className="h-full relative overflow-hidden">
        <div className="h-full flex flex-col justify-center px-8 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-10 relative z-10">
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="mb-6">
            <span className="inline-block px-3 py-1 rounded-full text-xs font-semibold mb-4" style={{ background: `rgba(var(--accent-rgb), 0.1)`, color: 'var(--accent)' }}>The Hook</span>
            <h2 className="slide-title text-3xl md:text-4xl lg:text-5xl text-black leading-tight">{data.headline}</h2>
          </motion.div>
          <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="text-lg md:text-xl text-neutral-600 leading-relaxed">{data.subtext}</motion.p>
        </div>
        {data.brandImage && (
          <motion.div initial={{ opacity: 0, x: 30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.3, duration: 0.5 }}
            className="absolute bottom-0 right-0 z-0 pointer-events-none" style={{ height: '30%', maxHeight: '200px', marginRight: '3%', marginBottom: '5%' }}>
            <img src={data.brandImage} alt={data.brandName || ''} className="h-full w-auto object-contain" style={{ opacity: 1 }} />
          </motion.div>
        )}
      </div>
    );
      const totalSlides = slides.length;

      const showGif = useCallback((src, maxHeight = '60%', side = 'right') => {
        setGifConfig({ visible: true, src, maxHeight, side });
      }, []);

      const hideGif = useCallback(() => {
        setGifConfig(prev => ({ ...prev, visible: false }));
      }, []);

      const goNext = useCallback(() => { if (currentSlide < totalSlides - 1) setCurrentSlide(prev => prev + 1); }, [currentSlide, totalSlides]);
      const goPrev = useCallback(() => { if (currentSlide > 0) setCurrentSlide(prev => prev - 1); }, [currentSlide]);

      useEffect(() => {
        const handleKeyDown = (e) => {
          if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); goNext(); }
          else if (e.key === 'ArrowLeft') { e.preventDefault(); goPrev(); }
        };
        window.addEventListener('keydown', handleKeyDown);
        return () => window.removeEventListener('keydown', handleKeyDown);
      }, [goNext, goPrev]);

      const showPrev = currentSlide > 0;
      const showNext = currentSlide < totalSlides - 1 && slides[currentSlide].type !== 'welcome';

      return (
        <div className="w-full h-screen bg-white flex flex-col relative">
          <div className="flex-1 relative overflow-hidden z-20">
            <AnimatePresence mode="wait">
              <motion.div key={currentSlide} initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }} exit={{ opacity: 0, x: -20 }} transition={{ duration: 0.3, ease: [0.25, 0.1, 0.25, 1] }} className="absolute inset-0">
                {renderSlide(slides[currentSlide], { onShowGif: showGif, onHideGif: hideGif, userName })}
              </motion.div>
            </AnimatePresence>
            {showPrev && <button onClick={goPrev} className="absolute left-5 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-500 hover:text-neutral-700 transition-all z-10"><Icons.ArrowLeft /></button>}
            {showNext && <button onClick={goNext} className="absolute right-5 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-500 hover:text-neutral-700 transition-all z-10"><Icons.ArrowRight /></button>}
          </div>
          <div className="px-6 md:px-8 py-5 border-t border-neutral-100 flex-shrink-0 relative z-10">
            <div className="flex items-center justify-center gap-2.5">
              {slides.map((_, i) => <button key={i} onClick={() => setCurrentSlide(i)} className="w-2.5 h-2.5 rounded-full transition-all duration-300" style={{ background: i === currentSlide ? '#22C55E' : '#d4d4d4', transform: i === currentSlide ? 'scale(1.3)' : 'scale(1)' }} />)}
            </div>
          </div>
          <AnimatePresence>
            {gifConfig.visible && (
              <motion.div initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: 30 }} transition={{ type: 'spring', stiffness: 100 }} className={`absolute ${gifConfig.side === 'left' ? 'left-4 md:left-8' : 'right-4 md:right-8'} bottom-0 pointer-events-none`} style={{ zIndex: 15, maxHeight: gifConfig.maxHeight }}>
                <video autoPlay loop muted playsInline className="h-full w-auto object-contain object-bottom" style={{ background: 'transparent', border: 'none', boxShadow: 'none', maxHeight: gifConfig.maxHeight }}>
                  <source src={gifConfig.src} type="video/mp4" />
                </video>
              </motion.div>
            )}
          </AnimatePresence>
        </div>
      );
    };

    ReactDOM.render(<LessonApp />, document.getElementById('root'));
  </script>
</body>
</html>
