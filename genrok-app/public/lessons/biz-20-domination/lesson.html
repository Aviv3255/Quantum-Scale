<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The 20% Domination Strategy | Quantum Scale</title>
  <script src="https://cdn.tailwindcss.com" defer></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" defer></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" defer></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js" defer></script>
  <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js" defer></script>
  <script src="../shared/greetings.js" defer></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://unpkg.com" crossorigin>
  <link rel="preconnect" href="https://cdn.tailwindcss.com" crossorigin>
  <link rel="preconnect" href="https://pqvvrljykfvhpyvxmwzb.supabase.co" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;500;600;700;800;900&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root { --accent: #10B981; --accent-dark: #059669; --accent-light: #34D399; --accent-rgb: 16, 185, 129; }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Inter', sans-serif; background: transparent; -webkit-font-smoothing: antialiased; }
    .title-font { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    h1, h2, h3, .slide-title { font-family: 'Fraunces', serif; font-weight: 900; letter-spacing: -0.02em; line-height: 1.1; }
    ::selection { background: var(--accent); color: white; }
    .slide-scroll::-webkit-scrollbar { display: none; }
    .slide-scroll { -ms-overflow-style: none; scrollbar-width: none; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { motion, AnimatePresence } = window.Motion;
    const { useState, useEffect, useCallback, useMemo } = React;

    const getUserName = () => { const params = new URLSearchParams(window.location.search); return params.get('userName') || 'Builder'; };

    const LESSON_CONFIG = {
      id: 'biz-20-domination',
      title: 'The 20% Domination Strategy',
      description: 'Why serving everyone is killing your profits',
      accentColor: '#10B981',
      duration: '5 min',
      nextLesson: { id: 'biz-channel-mix-formula', title: 'The 50/20/20/10 Formula', teaser: 'The exact paid media mix of 9-figure brands.' }
    };

    const celebrationGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_doing_a_quick_victory_dance_move_high_energy_c_d03b798b-a518-4e6c-bcae-d69b2dd50486_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_jumping_in_the_air_arms_raised_high_YESSS_cele_201477e8-3df4-405a-bc81-81d1747e5c6c_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_playing_air_guitar_light_headbanging_rockstar__0702007e-9e84-4d9e-8f99-8ee23d0b65f8_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_doing_the_running_man_dance_move_vintage_cool__25682b0f-cf4c-4e93-8dcb-6c3dac8135cd_0.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_standing_and_clapping_enthusiastically_mouth_o_992ac4fd-9a0e-4963-bbcc-a5271f25f4fd_3.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_clapping_very_fast_huge_smile_extreme_exciteme_9a4dde09-55ca-4173-a47d-613bc2924230_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_clapping_above_head_world_champion_celebration_484bd560-f049-41ca-b3d1-c03d7468ab56_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_starting_with_slow_clap_accelerating_to_fast_c_ee478a38-0ee7-437d-bd13-d687f7dd624a_0.mp4'
    ];
    const getRandomCelebrationGif = () => celebrationGifs[Math.floor(Math.random() * celebrationGifs.length)];

    const empathyGifs = [
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_thumbs_down_with_encouraging_nod_close_keep_go_613e541f-c072-436f-aee7-f99cd6f834fc_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_shaking_head_side_to_side_sadly_disappointed_e_c4a4be22-6a70-4738-8612-3039454fef37_1.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_covering_face_with_palm_facepalm_gesture_disap_211b0566-078f-4d42-9c41-547b14f5827c_0.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_looking_down_sadly_shoulders_slumped_disappoin_790d48bd-e49e-40ea-9979-d3e86fa3a422_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_wiping_away_a_small_tear_sad_but_gentle_disapp_8d78571b-3c36-4502-abee-81683255843c_1.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_sighing_sadly_exhaling_with_disappointment_hea_f6014f2a-3a99-4378-a2a8-414e16b3e72d_2.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_slouching_with_disappointment_body_curling_inw_caedddbe-413c-492a-9fdf-1e8433f5e2a8_2%20(1).mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_placing_hand_on_forehead_sadly_eyes_closed_fru_3e048895-f365-4ff2-9e88-0d0a35b2a9e1_3.mp4',
      'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/aviv3255_He_is_nodding_slowly_with_sadness_what_a_shame_expre_377f67ca-63da-41aa-9072-4926fc2f6e82_3.mp4'
    ];
    const getRandomEmpathyGif = () => empathyGifs[Math.floor(Math.random() * empathyGifs.length)];

    const slides = [
      { type: 'welcome', learningGoals: ['The private equity playbook for growth', 'Why 80% of customers hurt your business', 'How to identify & dominate your top 20%'] },
      { type: 'hook', headline: 'Private equity firms buy companies and instantly 3X their value.', subtext: 'Their secret? They fire 80% of the customers. Sounds insane. But it works every single time. They identify the top 20% who generate 80% of profit. Then they rebuild the entire business to serve only those people. The rest get cut. Revenue stays the same. Profit triples. This is the 20% domination strategy.', brandImage: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/Geo%20Convert%20(18).jpg', brandName: 'DataDrew' },
      { type: 'pareto-visual', title: 'The Pareto Principle in Action', subtitle: 'This is not theory. This is math.' },
      { type: 'content', title: 'The Private Equity Playbook', body: 'PE firms have a playbook. They acquire a company and analyze its customer base. They identify the top 20% of customers who generate 80% of the revenue and profit. Then they do something most founders never would. They stop all marketing aimed at the other 80%. They rebuild the entire business to exclusively serve the top 20%. The result? Higher LTV. Higher margins. Lower churn. Explosive growth.' },
      { type: 'comparison-cards', title: 'Focus on the 20% That Matter', left: { label: 'THE 80%', iconComponent: 'Users', value: '80%', subtext: 'of your customers', percentage: '20%', items: ['Generate only 20% of profit', 'High support costs', 'Price sensitive buyers', 'Cut them loose'], color: 'gray' }, right: { label: 'THE 20%', iconComponent: 'Crown', value: '20%', subtext: 'of your customers', percentage: '80%', items: ['Generate 80% of profit', 'Low maintenance', 'Pay premium prices', 'Dominate this niche'], color: 'green' } },
      { type: 'ltv-scenario', title: 'The Math That Changes Everything', scenarios: [
        { segment: 'Top 25% Customers', ltv: 796, color: '#22C55E', label: 'WHALES' },
        { segment: 'Middle 50%', ltv: 245, color: '#F59E0B', label: 'AVERAGE' },
        { segment: 'Bottom 25%', ltv: 89, color: '#6B7280', label: 'ONE-TIMERS' }
      ], insight: 'Your top customers are worth 9x more than your bottom. Yet most stores treat them exactly the same.' },
      { type: 'before-after', title: 'Before vs After Domination', before: [
        'Serving everyone dilutes value',
        'Spread thin across all customers',
        'Generic marketing to all',
        'Low LTV from price shoppers',
        'High churn from mismatched fit'
      ], after: [
        'Serving top 20% creates depth',
        'Deep focus on best customers',
        'Tailored everything for them',
        'High LTV from perfect fit',
        'Low churn from loyal fans'
      ]},
      { type: 'strategy-steps', title: 'The 3-Step Domination Strategy', steps: [
        { number: 1, title: 'IDENTIFY', icon: 'Target', color: '#3B82F6', description: 'Define the psychographics, demographics, and behaviors of your best customers. Who are they? What do they value? Use DataDrew to find your top 25% spenders.' },
        { number: 2, title: 'EXPORT & TARGET', icon: 'Download', color: '#8B5CF6', description: 'Export your whale customers from DataDrew. Upload to Meta as a custom audience. Create a 1% lookalike to find more customers exactly like your best ones.' },
        { number: 3, title: 'DOMINATE', icon: 'Crown', color: '#22C55E', description: 'Focus ALL marketing on attracting and retaining high-LTV customers. Improve their experience. Increase their LTV. Let the bottom 80% go to your competitors.' }
      ]},
      { type: 'tool-integration', title: 'How to Find Your Top 20%', subtitle: 'Step 1: See who your whales actually are', tool: { name: 'DataDrew', description: 'Free Shopify app that shows your customer lifetime value and segments', image: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/46.webp', link: 'https://apps.shopify.com/customer-lifetime-value?mref=lsbqcbva', features: ['See LTV by customer segment', 'Identify your top 25% spenders', 'RFM segmentation built-in', '100% free to use'] } },
      { type: 'tool-integration-export', title: 'Export & Target Your Best Customers', subtitle: 'Step 2: Build lookalike audiences from your whales', tool: { name: 'DataDrew', description: 'Export your top customer segments to create Meta lookalikes', image: 'https://pqvvrljykfvhpyvxmwzb.supabase.co/storage/v1/object/public/images/Screenshot%202025-12-19%20144624.png', features: ['Export top 25% as CSV', 'Upload to Meta as custom audience', 'Create 1% lookalike of your whales', 'Watch CAC drop, LTV rise'] } },
      { type: 'lookalike-creation', title: 'Step 3: Create Your Lookalike Audience', subtitle: 'Now Meta finds MORE customers just like your best ones', topLtv: '$800-1,200', dataDrewLink: 'https://apps.shopify.com/customer-lifetime-value?mref=lsbqcbva' },
      { type: 'customer-tiers', title: 'Your Customer Value Pyramid', tiers: [
        { name: 'VIP WHALES', percentage: '5%', revenue: '35%', ltv: '$1,200+', color: '#22C55E', icon: 'Crown' },
        { name: 'LOYAL BUYERS', percentage: '15%', revenue: '45%', ltv: '$400-800', color: '#3B82F6', icon: 'Star' },
        { name: 'OCCASIONAL', percentage: '30%', revenue: '15%', ltv: '$100-250', color: '#F59E0B', icon: 'User' },
        { name: 'ONE-TIMERS', percentage: '50%', revenue: '5%', ltv: '<$100', color: '#6B7280', icon: 'UserMinus' }
      ], insight: 'The top 20% (VIP + Loyal) generate 80% of your revenue. Focus here.' },
      { type: 'stat-countdown', title: 'The 20% Rule', stats: [
        { value: 20, suffix: '%', label: 'Customers Who Matter', subtext: 'The top performers in your base' },
        { value: 80, suffix: '%', label: 'Of Your Profit', subtext: 'Comes from that 20%' },
        { value: 9, suffix: 'x', label: 'LTV Difference', subtext: 'Top vs bottom customers' }
      ]},
      { type: 'highlight-box', title: 'Become Indispensable', body: 'By serving your ideal customers more specifically, you become indispensable to the people who matter most. And when you are indispensable, they spend more with you over time. Their LTV goes up. Their referrals go up. Their loyalty goes up. You win by going narrow. Not wide.', highlight: 'You become indispensable to the people who matter mostâ€”and they spend more with you over time.' },
      { type: 'quiz', question: 'What is the first step in the private equity playbook?', options: ['Fire all customers', 'Identify the top 20% who generate 80% of profit', 'Raise prices immediately', 'Cut all marketing spend'], correctIndex: 1, feedback: { correct: 'Exactly right. The first step is to identify your top 20% of customers who generate 80% of your profit. You define their psychographics, demographics, and behaviors. Then you focus exclusively on serving them. This is how private equity firms 3X company value. Narrow focus. Deep value.', incorrect: 'Not quite. The first step is to identify the top 20% of customers who generate 80% of profit. You need to know who they are before you can serve them exclusively. Define their psychographics, demographics, and behaviors. Then rebuild everything to serve only them. That is the playbook.' }},
      { type: 'completion', sources: [] }
    ];

    // Icons
    const Icons = {
      Clock: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
      Check: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><polyline points="20 6 9 17 4 12"/></svg>,
      X: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
      ArrowLeft: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>,
      ArrowRight: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>,
      Zap: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
      ExternalLink: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>,
      Link: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>,
      // Premium icons
      Users: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>,
      Trophy: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>,
      TrendingDown: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="23 18 13.5 8.5 8.5 13.5 1 6"/><polyline points="17 18 23 18 23 12"/></svg>,
      Target: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>,
      Crown: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14"/></svg>,
      Star: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>,
      User: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>,
      UserMinus: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="8.5" cy="7" r="4"/><line x1="23" y1="11" x2="17" y2="11"/></svg>,
      DollarSign: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>,
      PieChart: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21.21 15.89A10 10 0 1 1 8 2.83"/><path d="M22 12A10 10 0 0 0 12 2v10z"/></svg>,
      Database: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></svg>,
      Download: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>,
      TrendingUp: ({ size = 24, color = 'currentColor' }) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>,
    };

    // Animated Components
    const AnimatedCounter = ({ target, suffix = '', prefix = '', duration = 2000 }) => {
      const [count, setCount] = useState(0);
      useEffect(() => {
        let start = 0;
        const increment = target / (duration / 16);
        const timer = setInterval(() => {
          start += increment;
          if (start >= target) { setCount(target); clearInterval(timer); }
          else { setCount(Math.floor(start)); }
        }, 16);
        return () => clearInterval(timer);
      }, [target, duration]);
      return <span>{prefix}{count}{suffix}</span>;
    };

    // Animated Donut Chart for Pareto Principle
    const AnimatedDonutChart = ({ percent1 = 20, percent2 = 80, label1 = 'Customers', label2 = 'Profit', color1 = '#6B7280', color2 = '#22C55E' }) => {
      const [animated, setAnimated] = useState(false);
      useEffect(() => { const timer = setTimeout(() => setAnimated(true), 300); return () => clearTimeout(timer); }, []);
      const radius = 80;
      const circumference = 2 * Math.PI * radius;
      const strokeWidth = 24;

      return (
        <div className="flex items-center justify-center gap-12">
          {/* 20% Customers Circle */}
          <div className="relative">
            <svg width="200" height="200" className="transform -rotate-90">
              <circle cx="100" cy="100" r={radius} fill="none" stroke="#1f1f1f" strokeWidth={strokeWidth} />
              <motion.circle cx="100" cy="100" r={radius} fill="none" stroke={color1} strokeWidth={strokeWidth} strokeLinecap="round"
                initial={{ strokeDasharray: circumference, strokeDashoffset: circumference }}
                animate={animated ? { strokeDashoffset: circumference - (circumference * percent1 / 100) } : {}}
                transition={{ duration: 1.5, ease: 'easeOut' }}
                style={{ filter: `drop-shadow(0 0 8px ${color1})` }}
              />
            </svg>
            <div className="absolute inset-0 flex flex-col items-center justify-center">
              <span className="text-4xl font-bold text-white">{animated ? percent1 : 0}%</span>
              <span className="text-xs text-neutral-400 uppercase tracking-wider">{label1}</span>
            </div>
          </div>

          {/* Arrow */}
          <div className="flex flex-col items-center gap-2">
            <motion.div initial={{ opacity: 0, x: -20 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.8 }} className="text-neutral-500">
              <svg width="48" height="24" viewBox="0 0 48 24" fill="none">
                <path d="M0 12H44M44 12L34 2M44 12L34 22" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
              </svg>
            </motion.div>
            <span className="text-xs text-neutral-500">generates</span>
          </div>

          {/* 80% Profit Circle */}
          <div className="relative">
            <svg width="200" height="200" className="transform -rotate-90">
              <circle cx="100" cy="100" r={radius} fill="none" stroke="#1f1f1f" strokeWidth={strokeWidth} />
              <motion.circle cx="100" cy="100" r={radius} fill="none" stroke={color2} strokeWidth={strokeWidth} strokeLinecap="round"
                initial={{ strokeDasharray: circumference, strokeDashoffset: circumference }}
                animate={animated ? { strokeDashoffset: circumference - (circumference * percent2 / 100) } : {}}
                transition={{ duration: 1.5, ease: 'easeOut', delay: 0.3 }}
                style={{ filter: `drop-shadow(0 0 12px ${color2})` }}
              />
            </svg>
            <div className="absolute inset-0 flex flex-col items-center justify-center">
              <span className="text-4xl font-bold text-white">{animated ? percent2 : 0}%</span>
              <span className="text-xs text-neutral-400 uppercase tracking-wider">{label2}</span>
            </div>
          </div>
        </div>
      );
    };

    // Pareto Visual Slide
    const ParetoVisualSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-8">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
          <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-4" style={{ background: 'rgba(34, 197, 94, 0.1)', color: '#22C55E' }}>
            <Icons.PieChart size={14} color="#22C55E" />
            <span>The 80/20 Rule</span>
          </div>
          <h2 className="slide-title text-2xl md:text-3xl lg:text-4xl text-black mb-2">{data.title}</h2>
          <p className="text-neutral-500 text-sm">{data.subtitle}</p>
        </motion.div>

        <motion.div initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.2 }} className="rounded-2xl p-8 md:p-12" style={{ background: '#0a0a0a', border: '1px solid #222', boxShadow: '0 0 40px rgba(34, 197, 94, 0.1)' }}>
          <AnimatedDonutChart percent1={20} percent2={80} label1="Customers" label2="Profit" color1="#6B7280" color2="#22C55E" />
        </motion.div>

        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.6 }} className="text-center text-neutral-600 text-sm mt-6 max-w-md mx-auto">
          20% of your customers generate 80% of your profit. The math doesn't lie.
        </motion.p>
      </div>
    );

    // LTV Scenario Slide with animated bars
    const LtvScenarioSlide = ({ data }) => {
      const maxLtv = Math.max(...data.scenarios.map(s => s.ltv));

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto py-8">
          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
            <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-4" style={{ background: 'rgba(34, 197, 94, 0.1)', color: '#22C55E' }}>
              <Icons.DollarSign size={14} color="#22C55E" />
              <span>Real Numbers</span>
            </div>
            <h2 className="slide-title text-2xl md:text-3xl text-black mb-2">{data.title}</h2>
          </motion.div>

          <div className="space-y-4 mb-8">
            {data.scenarios.map((scenario, i) => (
              <motion.div key={i} initial={{ opacity: 0, x: -30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.15 + i * 0.15 }} className="rounded-xl p-5 relative overflow-hidden" style={{ background: '#0a0a0a', border: `1px solid ${scenario.color}30` }}>
                <div className="flex items-center justify-between mb-3 relative z-10">
                  <div className="flex items-center gap-3">
                    <span className="px-2 py-0.5 rounded text-[10px] font-bold tracking-wider" style={{ background: `${scenario.color}20`, color: scenario.color }}>{scenario.label}</span>
                    <span className="text-white font-medium text-sm">{scenario.segment}</span>
                  </div>
                  <div className="text-right">
                    <span className="text-2xl font-bold" style={{ color: scenario.color }}>
                      $<AnimatedCounter target={scenario.ltv} duration={1500 + i * 300} />
                    </span>
                    <span className="text-neutral-500 text-xs ml-1">LTV</span>
                  </div>
                </div>
                {/* Animated bar */}
                <div className="h-3 rounded-full overflow-hidden relative z-10" style={{ background: '#1f1f1f' }}>
                  <motion.div
                    initial={{ width: 0 }}
                    animate={{ width: `${(scenario.ltv / maxLtv) * 100}%` }}
                    transition={{ duration: 1.2, ease: 'easeOut', delay: 0.4 + i * 0.15 }}
                    className="h-full rounded-full"
                    style={{ background: `linear-gradient(90deg, ${scenario.color}, ${scenario.color}80)`, boxShadow: `0 0 15px ${scenario.color}50` }}
                  />
                </div>
              </motion.div>
            ))}
          </div>

          <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.8 }} className="rounded-xl p-4 text-center" style={{ background: 'linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(34, 197, 94, 0.05))', border: '1px solid rgba(34, 197, 94, 0.2)' }}>
            <p className="text-neutral-700 text-sm font-medium">{data.insight}</p>
          </motion.div>
        </div>
      );
    };

    // Strategy Steps Slide with visual cards
    const StrategyStepsSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-8">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-8">
          <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-4" style={{ background: 'rgba(34, 197, 94, 0.1)', color: '#22C55E' }}>
            <Icons.Zap />
            <span>The Playbook</span>
          </div>
          <h2 className="slide-title text-2xl md:text-3xl lg:text-4xl text-black">{data.title}</h2>
        </motion.div>

        <div className="grid md:grid-cols-3 gap-4">
          {data.steps.map((step, i) => {
            const StepIcon = Icons[step.icon] || Icons.Zap;
            return (
              <motion.div
                key={i}
                initial={{ opacity: 0, y: 30 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ delay: 0.15 + i * 0.15 }}
                className="rounded-2xl p-5 relative overflow-hidden group"
                style={{ background: '#0a0a0a', border: `1px solid ${step.color}40`, boxShadow: `0 0 30px ${step.color}15` }}
              >
                {/* Glow effect */}
                <div className="absolute top-0 left-0 w-full h-1 opacity-80" style={{ background: `linear-gradient(90deg, transparent, ${step.color}, transparent)` }}></div>
                <div className="absolute top-0 right-0 w-24 h-24 rounded-full blur-3xl opacity-20" style={{ background: step.color }}></div>

                {/* Step number badge */}
                <div className="flex items-center gap-3 mb-4">
                  <div className="w-10 h-10 rounded-xl flex items-center justify-center text-lg font-bold" style={{ background: `${step.color}20`, border: `1px solid ${step.color}`, color: step.color }}>
                    {step.number}
                  </div>
                  <div className="w-10 h-10 rounded-xl flex items-center justify-center" style={{ background: `${step.color}15` }}>
                    <StepIcon size={20} color={step.color} />
                  </div>
                </div>

                {/* Title */}
                <h3 className="text-xl font-bold text-white mb-3" style={{ textShadow: `0 0 20px ${step.color}30` }}>{step.title}</h3>

                {/* Description */}
                <p className="text-neutral-400 text-sm leading-relaxed">{step.description}</p>

                {/* Connecting arrow (except last) */}
                {i < data.steps.length - 1 && (
                  <div className="hidden md:block absolute -right-4 top-1/2 -translate-y-1/2 z-10">
                    <motion.div initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.5 + i * 0.2 }} className="text-neutral-600">
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                        <path d="M5 12h14M12 5l7 7-7 7" />
                      </svg>
                    </motion.div>
                  </div>
                )}
              </motion.div>
            );
          })}
        </div>

        {/* Bottom insight */}
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.8 }} className="mt-6 text-center">
          <p className="text-neutral-500 text-sm">By serving your ideal customers more specifically, you become <span className="font-semibold text-neutral-800">indispensable</span>.</p>
        </motion.div>
      </div>
    );

    // Tool Integration Slide - Large image focus
    const ToolIntegrationSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-10 max-w-6xl mx-auto py-6 slide-scroll overflow-y-auto">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-4">
          <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-2" style={{ background: 'rgba(59, 130, 246, 0.1)', color: '#3B82F6' }}>
            <Icons.Database size={14} color="#3B82F6" />
            <span>How To Apply This</span>
          </div>
          <h2 className="slide-title text-2xl md:text-3xl text-black mb-1">{data.title}</h2>
          <p className="text-neutral-500 text-sm">{data.subtitle}</p>
        </motion.div>

        <div className="flex flex-col md:flex-row gap-5 items-stretch">
          {/* Large Tool Screenshot */}
          <motion.div initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.2 }} className="flex-1 rounded-2xl overflow-hidden relative" style={{ background: '#0a0a0a', border: '1px solid #333', boxShadow: '0 0 40px rgba(0,0,0,0.3)' }}>
            <div className="absolute top-3 left-3 px-2 py-1 rounded-lg text-[10px] font-bold uppercase tracking-wider z-10" style={{ background: 'rgba(34, 197, 94, 0.9)', color: 'white' }}>Live Preview</div>
            <img src={data.tool.image} alt={data.tool.name} className="w-full h-auto" style={{ minHeight: '280px', maxHeight: '400px', objectFit: 'contain', objectPosition: 'center' }} />
          </motion.div>

          {/* Compact Tool Info */}
          <motion.div initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.3 }} className="md:w-72 rounded-xl p-5 flex flex-col" style={{ background: '#0a0a0a', border: '1px solid #22C55E30', boxShadow: '0 0 30px rgba(34, 197, 94, 0.08)' }}>
            <div className="flex items-center gap-3 mb-3">
              <div className="w-10 h-10 rounded-lg flex items-center justify-center" style={{ background: 'rgba(34, 197, 94, 0.15)', border: '1px solid #22C55E' }}>
                <Icons.Database size={20} color="#22C55E" />
              </div>
              <div>
                <h3 className="text-white font-bold text-sm">{data.tool.name}</h3>
                <span className="text-[10px] px-2 py-0.5 rounded-full" style={{ background: 'rgba(34, 197, 94, 0.2)', color: '#22C55E' }}>FREE</span>
              </div>
            </div>
            <p className="text-neutral-400 text-xs mb-3">{data.tool.description}</p>
            <ul className="space-y-1.5 mb-4 flex-1">
              {data.tool.features.map((feature, i) => (
                <motion.li key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.4 + i * 0.08 }} className="flex items-center gap-2 text-neutral-300 text-xs">
                  <Icons.Check />
                  {feature}
                </motion.li>
              ))}
            </ul>
            <a href={data.tool.link} target="_blank" rel="noopener noreferrer" className="inline-flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg text-sm font-semibold transition-all hover:opacity-90 w-full" style={{ background: 'linear-gradient(135deg, #22C55E, #16A34A)', color: 'white' }}>
              <span>Try Free</span>
              <Icons.ExternalLink />
            </a>
          </motion.div>
        </div>
      </div>
    );

    // Tool Integration Export Slide
    const ToolIntegrationExportSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-8 slide-scroll overflow-y-auto">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
          <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-3" style={{ background: 'rgba(59, 130, 246, 0.1)', color: '#3B82F6' }}>
            <Icons.Download size={14} color="#3B82F6" />
            <span>Take Action</span>
          </div>
          <h2 className="slide-title text-2xl md:text-3xl text-black mb-2">{data.title}</h2>
          <p className="text-neutral-500 text-sm">{data.subtitle}</p>
        </motion.div>

        <div className="grid md:grid-cols-2 gap-6 items-start">
          {/* Export Screenshot */}
          <motion.div initial={{ opacity: 0, x: -20 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.2 }} className="rounded-xl overflow-hidden" style={{ background: '#0a0a0a', border: '1px solid #333' }}>
            <img src={data.tool.image} alt="Export customers" className="w-full h-auto" style={{ maxHeight: '320px', objectFit: 'contain', objectPosition: 'top' }} />
          </motion.div>

          {/* Action Steps */}
          <motion.div initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.3 }} className="rounded-xl p-6" style={{ background: '#0a0a0a', border: '1px solid #3B82F630', boxShadow: '0 0 30px rgba(59, 130, 246, 0.08)' }}>
            <div className="flex items-center gap-3 mb-4">
              <div className="w-10 h-10 rounded-lg flex items-center justify-center" style={{ background: 'rgba(59, 130, 246, 0.15)', border: '1px solid #3B82F6' }}>
                <Icons.TrendingUp size={20} color="#3B82F6" />
              </div>
              <h3 className="text-white font-bold">The Whale Targeting Strategy</h3>
            </div>
            <p className="text-neutral-400 text-sm mb-4">{data.tool.description}</p>
            <ul className="space-y-3 mb-5">
              {data.tool.features.map((feature, i) => (
                <motion.li key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.4 + i * 0.1 }} className="flex items-start gap-3">
                  <span className="w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5" style={{ background: 'linear-gradient(135deg, #3B82F6, #2563EB)', color: 'white' }}>{i + 1}</span>
                  <span className="text-neutral-300 text-sm">{feature}</span>
                </motion.li>
              ))}
            </ul>
            <div className="p-3 rounded-lg" style={{ background: 'rgba(34, 197, 94, 0.1)', border: '1px solid rgba(34, 197, 94, 0.2)' }}>
              <p className="text-xs text-center" style={{ color: '#22C55E' }}>Result: Lower CAC + Higher LTV = More profit per customer</p>
            </div>
          </motion.div>
        </div>
      </div>
    );

    // Step 3: Lookalike Creation Slide with Meta visualization - CENTERED PROPERLY
    const LookalikeCreationSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-6 slide-scroll overflow-y-auto">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-4">
          <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-2" style={{ background: 'rgba(59, 130, 246, 0.1)', color: '#3B82F6' }}>
            <Icons.Users size={14} color="#3B82F6" />
            <span>Step 3: The Magic</span>
          </div>
          <h2 className="slide-title text-2xl md:text-3xl text-black mb-1">{data.title}</h2>
          <p className="text-neutral-500 text-sm">{data.subtitle}</p>
        </motion.div>

        {/* Meta Lookalike Visualization - Grid layout for perfect centering */}
        <motion.div
          initial={{ opacity: 0, scale: 0.95 }}
          animate={{ opacity: 1, scale: 1 }}
          transition={{ delay: 0.2 }}
          className="rounded-2xl p-6 md:p-8 mb-5 relative overflow-hidden"
          style={{ background: '#0a0a0a', border: '1px solid #333' }}
        >
          <div className="absolute inset-0 opacity-15" style={{ background: 'radial-gradient(ellipse at center, #3B82F6 0%, transparent 70%)' }}></div>

          {/* 5-column grid for perfect symmetry */}
          <div className="relative z-10 grid grid-cols-5 items-center gap-2 md:gap-4">
            {/* Column 1: Your Whales */}
            <div className="flex flex-col items-center col-span-1">
              <p className="text-neutral-500 text-[10px] mb-2 uppercase tracking-wider text-center">Your Whales</p>
              <div className="flex flex-col gap-1.5">
                {[1, 2, 3].map((i) => (
                  <motion.div
                    key={i}
                    initial={{ opacity: 0, x: -10 }}
                    animate={{ opacity: 1, x: 0 }}
                    transition={{ delay: 0.3 + i * 0.1 }}
                    className="w-10 h-10 md:w-11 md:h-11 rounded-full flex items-center justify-center mx-auto"
                    style={{ background: 'linear-gradient(135deg, #22C55E, #16A34A)', boxShadow: '0 0 12px rgba(34, 197, 94, 0.4)' }}
                  >
                    <Icons.User size={16} color="white" />
                  </motion.div>
                ))}
              </div>
            </div>

            {/* Column 2: Arrow */}
            <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ delay: 0.6 }} className="flex items-center justify-center col-span-1">
              <svg width="40" height="20" viewBox="0 0 40 20" fill="none">
                <path d="M0 10H36M36 10L28 4M36 10L28 16" stroke="#3B82F6" strokeWidth="2" strokeLinecap="round"/>
              </svg>
            </motion.div>

            {/* Column 3: Meta (CENTER) */}
            <motion.div
              initial={{ opacity: 0, scale: 0.8 }}
              animate={{ opacity: 1, scale: 1 }}
              transition={{ delay: 0.7 }}
              className="flex flex-col items-center col-span-1"
            >
              <div className="w-16 h-16 md:w-20 md:h-20 rounded-2xl flex items-center justify-center mb-2 relative" style={{ background: 'linear-gradient(135deg, #1877F2, #0D47A1)', boxShadow: '0 0 30px rgba(24, 119, 242, 0.5)' }}>
                <svg width="32" height="32" viewBox="0 0 40 40" fill="none">
                  <path d="M20 5L35 12.5V27.5L20 35L5 27.5V12.5L20 5Z" stroke="white" strokeWidth="2" fill="none"/>
                  <circle cx="20" cy="20" r="5" fill="white"/>
                </svg>
                <motion.div
                  className="absolute inset-0 rounded-2xl"
                  style={{ border: '2px solid rgba(255,255,255,0.3)' }}
                  animate={{ scale: [1, 1.15, 1], opacity: [0.5, 0, 0.5] }}
                  transition={{ duration: 2, repeat: Infinity }}
                />
              </div>
              <span className="text-blue-400 text-xs font-semibold">Meta AI</span>
              <span className="text-neutral-500 text-[9px]">Finds patterns</span>
            </motion.div>

            {/* Column 4: Arrow */}
            <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ delay: 0.8 }} className="flex items-center justify-center col-span-1">
              <svg width="40" height="20" viewBox="0 0 40 20" fill="none">
                <path d="M0 10H36M36 10L28 4M36 10L28 16" stroke="#22C55E" strokeWidth="2" strokeLinecap="round"/>
              </svg>
            </motion.div>

            {/* Column 5: New Customers */}
            <div className="flex flex-col items-center col-span-1">
              <p className="text-neutral-500 text-[10px] mb-2 uppercase tracking-wider text-center">New Matches</p>
              <div className="grid grid-cols-2 gap-1">
                {[1, 2, 3, 4, 5, 6].map((i) => (
                  <motion.div
                    key={i}
                    initial={{ opacity: 0, scale: 0 }}
                    animate={{ opacity: 1, scale: 1 }}
                    transition={{ delay: 0.9 + i * 0.06, type: 'spring' }}
                    className="w-8 h-8 md:w-9 md:h-9 rounded-full flex items-center justify-center"
                    style={{ background: 'linear-gradient(135deg, #22C55E, #16A34A)', boxShadow: '0 0 8px rgba(34, 197, 94, 0.3)' }}
                  >
                    <Icons.User size={12} color="white" />
                  </motion.div>
                ))}
              </div>
            </div>
          </div>
        </motion.div>

        {/* Key Message */}
        <motion.div
          initial={{ opacity: 0, y: 15 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 1.2 }}
          className="rounded-xl p-5 text-center mb-4"
          style={{ background: 'linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(59, 130, 246, 0.1))', border: '1px solid rgba(34, 197, 94, 0.2)' }}
        >
          <p className="text-neutral-700 text-sm leading-relaxed mb-2">
            Now you attract <span className="font-bold text-black">ONLY</span> new customers worth{' '}
            <span className="font-bold text-green-600">{data.topLtv}</span>/year.
          </p>
          <p className="text-neutral-500 text-xs">
            Check your top 10%/25% LTV for free{' '}
            <a href={data.dataDrewLink} target="_blank" rel="noopener noreferrer" className="underline font-semibold hover:text-blue-600" style={{ color: '#3B82F6' }}>here</a>.
          </p>
        </motion.div>

        {/* CTA Button */}
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 1.4 }} className="text-center">
          <a
            href={data.dataDrewLink}
            target="_blank"
            rel="noopener noreferrer"
            className="inline-flex items-center justify-center gap-2 px-6 py-3 rounded-xl text-sm font-semibold transition-all hover:scale-105"
            style={{ background: '#000000', color: 'white', boxShadow: '0 4px 20px rgba(0,0,0,0.3)' }}
          >
            <Icons.Database size={18} color="white" />
            <span>Check Your LTV & Export for Free</span>
            <Icons.ExternalLink />
          </a>
        </motion.div>
      </div>
    );

    // Customer Tiers Slide - Clean pyramid with simple bracket indicators
    const CustomerTiersSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto py-8">
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
          <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold mb-3" style={{ background: 'rgba(139, 92, 246, 0.1)', color: '#8B5CF6' }}>
            <Icons.Crown size={14} color="#8B5CF6" />
            <span>Customer Segments</span>
          </div>
          <h2 className="slide-title text-2xl md:text-3xl text-black">{data.title}</h2>
        </motion.div>

        {/* Main layout with side annotations */}
        <div className="flex items-start gap-4 md:gap-6">
          {/* Left annotation - TARGET bracket */}
          <motion.div
            initial={{ opacity: 0, x: -20 }}
            animate={{ opacity: 1, x: 0 }}
            transition={{ delay: 0.7 }}
            className="hidden md:flex flex-col items-end pt-2"
            style={{ width: '80px' }}
          >
            <div className="flex items-center gap-2">
              <div className="text-right">
                <p className="text-[11px] font-medium text-neutral-800 tracking-wide">TARGET</p>
                <p className="text-[10px] text-neutral-500">these</p>
              </div>
              <div className="flex flex-col items-center">
                <svg width="12" height="110" viewBox="0 0 12 110" fill="none">
                  <path d="M10 4 L6 4 L6 106 L10 106" stroke="#1a1a1a" strokeWidth="1.5" fill="none" strokeLinecap="round" strokeLinejoin="round"/>
                </svg>
              </div>
            </div>
          </motion.div>

          {/* Pyramid tiers */}
          <div className="flex-1 space-y-2.5">
            {data.tiers.map((tier, i) => {
              const TierIcon = Icons[tier.icon] || Icons.User;
              const widthPercent = 100 - (i * 10);
              const isTargetTier = i < 2;

              return (
                <motion.div
                  key={i}
                  initial={{ opacity: 0, y: 20, scaleX: 0.8 }}
                  animate={{ opacity: 1, y: 0, scaleX: 1 }}
                  transition={{ delay: 0.15 + i * 0.1 }}
                  className="mx-auto rounded-xl p-3.5 relative overflow-hidden"
                  style={{
                    width: `${widthPercent}%`,
                    background: '#0a0a0a',
                    border: isTargetTier ? `2px solid ${tier.color}` : `1px solid ${tier.color}30`,
                    boxShadow: isTargetTier ? `0 0 20px ${tier.color}20` : 'none'
                  }}
                >
                  {isTargetTier && (
                    <div className="absolute top-0 left-0 w-full h-0.5" style={{ background: `linear-gradient(90deg, transparent, ${tier.color}, transparent)` }}></div>
                  )}

                  <div className="flex items-center justify-between relative z-10">
                    <div className="flex items-center gap-2.5">
                      <div className="w-7 h-7 rounded-lg flex items-center justify-center" style={{ background: `${tier.color}20`, border: `1px solid ${tier.color}` }}>
                        <TierIcon size={14} color={tier.color} />
                      </div>
                      <div>
                        <span className="text-white font-bold text-xs">{tier.name}</span>
                        <span className="text-neutral-500 text-[10px] ml-1.5">({tier.percentage})</span>
                      </div>
                    </div>

                    <div className="flex items-center gap-4 md:gap-6 text-right">
                      <div>
                        <div className="text-lg font-bold" style={{ color: tier.color }}>{tier.revenue}</div>
                        <div className="text-[10px] text-neutral-500 uppercase">Revenue</div>
                      </div>
                      <div>
                        <div className="text-lg font-bold text-white">{tier.ltv}</div>
                        <div className="text-[10px] text-neutral-500 uppercase">LTV</div>
                      </div>
                    </div>
                  </div>
                </motion.div>
              );
            })}
          </div>

          {/* Right annotation - 80% PROFIT bracket */}
          <motion.div
            initial={{ opacity: 0, x: 20 }}
            animate={{ opacity: 1, x: 0 }}
            transition={{ delay: 0.8 }}
            className="hidden md:flex flex-col items-start pt-2"
            style={{ width: '80px' }}
          >
            <div className="flex items-center gap-2">
              <div className="flex flex-col items-center">
                <svg width="12" height="110" viewBox="0 0 12 110" fill="none">
                  <path d="M2 4 L6 4 L6 106 L2 106" stroke="#1a1a1a" strokeWidth="1.5" fill="none" strokeLinecap="round" strokeLinejoin="round"/>
                </svg>
              </div>
              <div className="text-left">
                <p className="text-[11px] font-medium text-neutral-800 tracking-wide">80%</p>
                <p className="text-[10px] text-neutral-500">profit</p>
              </div>
            </div>
          </motion.div>
        </div>

        {/* Bottom insight */}
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.9 }} className="mt-5 rounded-xl p-4 text-center" style={{ background: '#fafafa', border: '1px solid #e5e5e5' }}>
          <p className="text-neutral-700 text-sm">The top <span className="font-bold text-black">20%</span> (VIP + Loyal) generate <span className="font-bold text-black">80%</span> of your revenue. Focus here.</p>
        </motion.div>
      </div>
    );

    const WelcomeSlide = ({ data, onStart, userName, onShowGif, onHideGif }) => {
      const welcomeData = useMemo(() => getTimeBasedWelcome(), []);
      const gifSide = useMemo(() => Math.random() > 0.5 ? 'left' : 'right', []);
      useEffect(() => { onShowGif(welcomeData.gif, '65%', gifSide); return () => onHideGif(); }, [welcomeData.gif, gifSide, onShowGif, onHideGif]);

      return (
        <div className="h-full w-full relative overflow-hidden">
          <div className="h-full flex flex-col items-center justify-center text-center px-6 py-4 relative z-20">
            <motion.h1 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="title-font text-3xl sm:text-4xl md:text-5xl lg:text-6xl text-black mb-2 md:mb-3">{LESSON_CONFIG.title}</motion.h1>
            <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-neutral-600 text-base md:text-lg lg:text-xl mb-2 md:mb-3 max-w-lg leading-relaxed" dangerouslySetInnerHTML={{ __html: formatGreeting(welcomeData.greeting, `<span class="font-bold text-neutral-900">${userName}</span>`) }} />
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="flex items-center justify-center gap-1.5 text-neutral-400 text-[10px] md:text-xs mb-2 md:mb-3"><Icons.Clock /><span>{LESSON_CONFIG.duration}</span></motion.div>
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 }} className="bg-neutral-900 rounded-xl md:rounded-2xl p-3 md:p-5 mb-3 md:mb-4 max-w-sm w-full mx-auto">
              <p className="text-neutral-500 text-[9px] md:text-[11px] uppercase tracking-wider mb-2 md:mb-3">In this lesson</p>
              <ul className="space-y-1.5 md:space-y-2">
                {data.learningGoals.map((goal, i) => (
                  <motion.li key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.25 + i * 0.05 }} className="flex items-start gap-2 text-left">
                    <span className="w-5 h-5 rounded-md flex items-center justify-center text-[9px] font-bold text-white flex-shrink-0 mt-0.5" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>{i + 1}</span>
                    <span className="text-neutral-300 text-[11px] md:text-sm leading-snug">{goal}</span>
                  </motion.li>
                ))}
              </ul>
            </motion.div>
            <motion.button initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.45 }} onClick={onStart} whileHover={{ scale: 1.02 }} whileTap={{ scale: 0.98 }} className="px-6 md:px-7 py-2.5 md:py-3 rounded-xl text-white font-semibold text-sm md:text-base" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>Let's Go</motion.button>
          </div>
        </div>
      );
    };

    const HookSlide = ({ data }) => (
      <div className="h-full relative overflow-hidden">
        <div className="h-full flex flex-col justify-center px-8 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-10 relative z-10">
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="mb-6">
            <span className="inline-block px-3 py-1 rounded-full text-xs font-semibold mb-4" style={{ background: `rgba(var(--accent-rgb), 0.1)`, color: 'var(--accent)' }}>The Hook</span>
            <h2 className="slide-title text-3xl md:text-4xl lg:text-5xl text-black leading-tight">{data.headline}</h2>
          </motion.div>
          <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="text-lg md:text-xl text-neutral-600 leading-relaxed">{data.subtext}</motion.p>
        </div>
        {data.brandImage && (
          <motion.div initial={{ opacity: 0, x: 30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.3, duration: 0.5 }}
            className="absolute bottom-0 right-0 z-0 pointer-events-none" style={{ height: '30%', maxHeight: '200px', marginRight: '3%', marginBottom: '5%' }}>
            <img src={data.brandImage} alt={data.brandName || ''} className="h-full w-auto object-contain" style={{ opacity: 0.2 }} />
          </motion.div>
        )}
      </div>
    );

    const ContentSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-8 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-10">
        <motion.h2 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl lg:text-4xl text-black mb-6">{data.title}</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-base md:text-lg text-neutral-600 leading-relaxed">{data.body}</motion.p>
      </div>
    );

    const StatCountdownSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto slide-scroll overflow-y-auto py-8">
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">{data.title}</motion.h2>
        <div className="grid md:grid-cols-3 gap-6">
          {data.stats.map((stat, i) => (
            <motion.div key={i} initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 + i * 0.15 }} className="bg-neutral-900 rounded-xl p-6 text-center">
              <div className="text-5xl font-bold mb-2" style={{ color: 'var(--accent)' }}>
                <AnimatedCounter target={stat.value} suffix={stat.suffix} prefix={stat.prefix} />
              </div>
              <div className="text-sm font-semibold text-white mb-1">{stat.label}</div>
              <div className="text-xs text-neutral-400">{stat.subtext}</div>
            </motion.div>
          ))}
        </div>
      </div>
    );

    const MockupSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto slide-scroll overflow-y-auto py-8">
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-6">{data.title}</motion.h2>
        <motion.div initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.1 }} className="bg-white border-2 border-neutral-200 rounded-2xl p-8 mb-4">
          <div dangerouslySetInnerHTML={{ __html: data.svgContent }} />
        </motion.div>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.2 }} className="text-neutral-600 text-sm text-center max-w-2xl mx-auto">{data.caption}</motion.p>
      </div>
    );

    const HighlightBoxSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-8 md:px-16 max-w-3xl mx-auto slide-scroll overflow-y-auto py-10">
        <motion.h2 initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl lg:text-4xl text-black mb-6">{data.title}</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="text-base md:text-lg text-neutral-600 leading-relaxed mb-6">{data.body}</motion.p>
        <motion.div initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} transition={{ delay: 0.2 }} className="rounded-xl p-6 text-center" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))` }}>
          <p className="text-white text-lg font-bold">{data.highlight}</p>
        </motion.div>
      </div>
    );

    const BeforeAfterSlide = ({ data }) => (
      <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-4xl mx-auto py-8">
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">{data.title}</motion.h2>
        <div className="grid md:grid-cols-2 gap-6">
          {/* BEFORE Card - Dark with red border */}
          <motion.div initial={{ opacity: 0, x: -30 }} animate={{ opacity: 1, x: 0 }} className="relative">
            <div className="absolute -top-3 left-4 px-3 py-1 text-xs font-bold rounded-full z-10" style={{ background: '#EF4444', color: 'white', boxShadow: '0 0 10px rgba(239, 68, 68, 0.4)' }}>BEFORE</div>
            <div className="rounded-2xl p-6 pt-8 relative overflow-hidden" style={{ background: '#0a0a0a', border: '1px solid #EF4444', boxShadow: '0 0 25px rgba(239, 68, 68, 0.12)' }}>
              <div className="absolute top-0 left-0 w-32 h-32 rounded-full blur-3xl -ml-16 -mt-16" style={{ background: 'rgba(239, 68, 68, 0.08)' }}></div>
              <ul className="space-y-3 relative z-10">
                {data.before.map((item, i) => (
                  <motion.li key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.2 + i * 0.08 }} className="flex items-start gap-3">
                    <span className="flex-shrink-0 w-5 h-5 rounded-full flex items-center justify-center mt-0.5" style={{ background: 'rgba(239, 68, 68, 0.15)', border: '1px solid #EF4444' }}><Icons.X /></span>
                    <span className="text-sm text-neutral-300">{item}</span>
                  </motion.li>
                ))}
              </ul>
            </div>
          </motion.div>
          {/* AFTER Card - Dark with green border */}
          <motion.div initial={{ opacity: 0, x: 30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.15 }} className="relative">
            <div className="absolute -top-3 left-4 px-3 py-1 text-xs font-bold rounded-full z-10" style={{ background: '#22C55E', color: 'white', boxShadow: '0 0 10px rgba(34, 197, 94, 0.4)' }}>AFTER</div>
            <div className="rounded-2xl p-6 pt-8 relative overflow-hidden" style={{ background: '#0a0a0a', border: '1px solid #22C55E', boxShadow: '0 0 25px rgba(34, 197, 94, 0.12)' }}>
              <div className="absolute top-0 right-0 w-32 h-32 rounded-full blur-3xl -mr-16 -mt-16" style={{ background: 'rgba(34, 197, 94, 0.08)' }}></div>
              <ul className="space-y-3 relative z-10">
                {data.after.map((item, i) => (
                  <motion.li key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.35 + i * 0.08 }} className="flex items-start gap-3">
                    <span className="flex-shrink-0 w-5 h-5 rounded-full flex items-center justify-center mt-0.5" style={{ background: 'rgba(34, 197, 94, 0.15)', border: '1px solid #22C55E' }}><Icons.Check /></span>
                    <span className="text-sm text-neutral-300">{item}</span>
                  </motion.li>
                ))}
              </ul>
            </div>
          </motion.div>
        </div>
      </div>
    );

    const ComparisonCardsSlide = ({ data }) => {
      const LeftIcon = data.left.iconComponent ? Icons[data.left.iconComponent] : null;
      const RightIcon = data.right.iconComponent ? Icons[data.right.iconComponent] : null;

      return (
        <div className="h-full flex flex-col justify-center px-6 md:px-12 max-w-5xl mx-auto py-8">
          <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="slide-title text-2xl md:text-3xl text-black text-center mb-8">{data.title}</motion.h2>
          <div className="grid md:grid-cols-2 gap-6">
            {/* LEFT Card - Dark with gray/neutral border */}
            <motion.div initial={{ opacity: 0, x: -30 }} animate={{ opacity: 1, x: 0 }} className="rounded-2xl p-6 relative overflow-hidden" style={{ background: '#0a0a0a', border: '1px solid #6B7280', boxShadow: '0 0 25px rgba(107, 114, 128, 0.12)' }}>
              <div className="absolute top-0 left-0 w-32 h-32 rounded-full blur-3xl -ml-16 -mt-16" style={{ background: 'rgba(107, 114, 128, 0.1)' }}></div>
              <div className="relative z-10">
                <div className="flex items-center justify-between mb-4">
                  <span className="text-xs font-bold tracking-wider" style={{ color: '#9CA3AF' }}>{data.left.label}</span>
                  {LeftIcon && <div className="w-10 h-10 rounded-xl flex items-center justify-center" style={{ background: 'rgba(107, 114, 128, 0.15)', border: '1px solid #6B7280' }}><LeftIcon size={20} color="#9CA3AF" /></div>}
                </div>
                <div className="mb-4">
                  <div className="text-4xl font-bold text-white mb-1">{data.left.value}</div>
                  <div className="text-neutral-500 text-sm">{data.left.subtext}</div>
                </div>
                {/* Animated Progress Bar */}
                {data.left.percentage && (
                  <div className="mb-4">
                    <div className="flex justify-between text-xs mb-1">
                      <span className="text-neutral-500">Profit contribution</span>
                      <span style={{ color: '#9CA3AF' }}>{data.left.percentage}</span>
                    </div>
                    <div className="h-2 rounded-full overflow-hidden" style={{ background: '#1f1f1f' }}>
                      <motion.div initial={{ width: 0 }} animate={{ width: data.left.percentage }} transition={{ duration: 1.2, ease: 'easeOut', delay: 0.3 }} className="h-full rounded-full" style={{ background: 'linear-gradient(90deg, #6B7280, #4B5563)', boxShadow: '0 0 10px rgba(107, 114, 128, 0.5)' }} />
                    </div>
                  </div>
                )}
                <div className="border-t pt-4" style={{ borderColor: 'rgba(107, 114, 128, 0.3)' }}>
                  <ul className="space-y-2">
                    {data.left.items.map((item, i) => (
                      <motion.li key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.4 + i * 0.08 }} className="flex items-center gap-2 text-neutral-400 text-sm">
                        <span className="w-1.5 h-1.5 rounded-full" style={{ background: '#6B7280' }}></span>
                        {item}
                      </motion.li>
                    ))}
                  </ul>
                </div>
              </div>
            </motion.div>
            {/* RIGHT Card - Dark with green border */}
            <motion.div initial={{ opacity: 0, x: 30 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.15 }} className="rounded-2xl p-6 relative overflow-hidden" style={{ background: '#0a0a0a', border: '1px solid #22C55E', boxShadow: '0 0 30px rgba(34, 197, 94, 0.15), inset 0 1px 0 rgba(255,255,255,0.03)' }}>
              <div className="absolute top-0 right-0 w-32 h-32 rounded-full blur-3xl -mr-16 -mt-16" style={{ background: 'rgba(34, 197, 94, 0.1)' }}></div>
              <div className="relative z-10">
                <div className="flex items-center justify-between mb-4">
                  <span className="text-xs font-bold tracking-wider" style={{ color: '#22C55E' }}>{data.right.label}</span>
                  {RightIcon && <div className="w-10 h-10 rounded-xl flex items-center justify-center" style={{ background: 'rgba(34, 197, 94, 0.15)', border: '1px solid #22C55E' }}><RightIcon size={20} color="#22C55E" /></div>}
                </div>
                <div className="mb-4">
                  <div className="text-4xl font-bold text-white mb-1">{data.right.value}</div>
                  <div className="text-neutral-500 text-sm">{data.right.subtext}</div>
                </div>
                {/* Animated Progress Bar */}
                {data.right.percentage && (
                  <div className="mb-4">
                    <div className="flex justify-between text-xs mb-1">
                      <span className="text-neutral-500">Profit contribution</span>
                      <span style={{ color: '#22C55E' }}>{data.right.percentage}</span>
                    </div>
                    <div className="h-2 rounded-full overflow-hidden" style={{ background: '#1f1f1f' }}>
                      <motion.div initial={{ width: 0 }} animate={{ width: data.right.percentage }} transition={{ duration: 1.2, ease: 'easeOut', delay: 0.5 }} className="h-full rounded-full" style={{ background: 'linear-gradient(90deg, #22C55E, #16A34A)', boxShadow: '0 0 10px rgba(34, 197, 94, 0.5)' }} />
                    </div>
                  </div>
                )}
                <div className="border-t pt-4" style={{ borderColor: 'rgba(34, 197, 94, 0.3)' }}>
                  <ul className="space-y-2">
                    {data.right.items.map((item, i) => (
                      <motion.li key={i} initial={{ opacity: 0, x: -10 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.6 + i * 0.08 }} className="flex items-center gap-2 text-neutral-300 text-sm">
                        <span className="w-1.5 h-1.5 rounded-full" style={{ background: '#22C55E' }}></span>
                        {item}
                      </motion.li>
                    ))}
                  </ul>
                </div>
              </div>
            </motion.div>
          </div>
        </div>
      );
    };

    const QuizSlide = ({ data, onShowGif, onHideGif }) => {
      const [selected, setSelected] = useState(null);
      const [showFeedback, setShowFeedback] = useState(false);
      const celebrationGif = useMemo(() => getRandomCelebrationGif(), []);
      const empathyGif = useMemo(() => getRandomEmpathyGif(), []);
      const gifSide = useMemo(() => Math.random() > 0.5 ? 'left' : 'right', []);
      const handleSelect = (index) => { if (showFeedback) return; setSelected(index); setShowFeedback(true); };
      const isCorrect = selected === data.correctIndex;

      useEffect(() => { if (showFeedback) { if (isCorrect) { onShowGif(celebrationGif, '60%', gifSide); } else { onShowGif(empathyGif, '60%', gifSide); } } }, [showFeedback, isCorrect, celebrationGif, empathyGif, gifSide, onShowGif]);
      useEffect(() => { return () => onHideGif(); }, [onHideGif]);

      return (
        <div className="h-full w-full relative overflow-hidden">
          <div className="h-full flex flex-col justify-center px-8 md:px-12 max-w-2xl mx-auto slide-scroll overflow-y-auto py-10 relative z-30">
            <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="text-center mb-6">
              <p className="text-xs uppercase tracking-wider text-neutral-400 mb-3">Quick Check</p>
              <h2 className="slide-title text-xl md:text-2xl text-black leading-tight">{data.question}</h2>
            </motion.div>
            <div className="space-y-3 mb-6">
              {data.options.map((option, i) => (
                <motion.button key={i} initial={{ opacity: 0, x: -15 }} animate={{ opacity: 1, x: 0 }} transition={{ delay: 0.08 + i * 0.06 }} onClick={() => handleSelect(i)} disabled={showFeedback} className={`w-full p-4 rounded-xl text-left transition-all border-2 ${showFeedback ? i === data.correctIndex ? 'border-green-500 bg-green-50' : i === selected ? 'border-red-400 bg-red-50' : 'border-neutral-200 bg-white opacity-40' : 'border-neutral-200 bg-white hover:border-neutral-300'}`}>
                  <div className="flex items-center gap-3">
                    <span className={`w-8 h-8 rounded-lg flex items-center justify-center text-sm font-bold transition-all ${showFeedback && i === data.correctIndex ? 'bg-green-500 text-white' : showFeedback && i === selected && !isCorrect ? 'bg-red-400 text-white' : 'bg-neutral-100 text-neutral-500'}`}>
                      {showFeedback && i === data.correctIndex ? <Icons.Check /> : showFeedback && i === selected && !isCorrect ? <Icons.X /> : String.fromCharCode(65 + i)}
                    </span>
                    <span className="text-neutral-700 text-sm md:text-base">{option}</span>
                  </div>
                </motion.button>
              ))}
            </div>
            <AnimatePresence>
              {showFeedback && (
                <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className={`p-5 rounded-xl ${isCorrect ? 'bg-green-50 border border-green-200' : 'bg-amber-50 border border-amber-200'}`}>
                  <p className={`text-sm leading-relaxed ${isCorrect ? 'text-green-800' : 'text-amber-800'}`}>{isCorrect ? data.feedback.correct : data.feedback.incorrect}</p>
                </motion.div>
              )}
            </AnimatePresence>
          </div>
        </div>
      );
    };

    const CompletionSlide = ({ data }) => (
      <div className="h-full flex flex-col items-center justify-center text-center px-8 slide-scroll overflow-y-auto py-8">
        <motion.div initial={{ opacity: 0, scale: 0 }} animate={{ opacity: 1, scale: 1 }} transition={{ type: 'spring', duration: 0.5 }} className="w-16 h-16 rounded-xl flex items-center justify-center mb-4 text-white" style={{ background: `linear-gradient(135deg, var(--accent), var(--accent-dark))`, boxShadow: `0 6px 24px rgba(var(--accent-rgb), 0.35)` }}><Icons.Check /></motion.div>
        <motion.h2 initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.15 }} className="slide-title text-2xl md:text-3xl text-black mb-3">Lesson Complete</motion.h2>
        <motion.p initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.25 }} className="text-neutral-500 text-sm mb-5 max-w-md leading-relaxed">You now understand the private equity playbook. Identify your top 20% who generate 80% of profit. Stop marketing to the other 80%. Rebuild everything to serve only the 20%. Become indispensable to the people who matter most. Their LTV goes up. Your profit triples. Dominate by niching down.</motion.p>
        <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.35 }} className="bg-neutral-900 rounded-xl p-5 max-w-md w-full mb-4">
          <p className="text-neutral-500 text-xs uppercase tracking-wider mb-2">Up Next</p>
          <h3 className="text-white font-bold text-lg mb-1">{LESSON_CONFIG.nextLesson.title}</h3>
          <p className="text-neutral-400 text-xs">{LESSON_CONFIG.nextLesson.teaser}</p>
        </motion.div>
      </div>
    );

    const LessonApp = () => {
      const [currentSlide, setCurrentSlide] = useState(0);
      const [direction, setDirection] = useState(1);
      const userName = useMemo(() => getUserName(), []);
      const currentSlideRef = React.useRef(0);
      const [gifConfig, setGifConfig] = useState(null);
      const [isAnimating, setIsAnimating] = useState(false);

      const showGif = useCallback((url, height, side) => setGifConfig({ url, height, side }), []);
      const hideGif = useCallback(() => setGifConfig(null), []);

      React.useEffect(() => { currentSlideRef.current = currentSlide; }, [currentSlide]);

      const goToSlide = useCallback((newSlide) => {
        if (isAnimating || newSlide < 0 || newSlide >= slides.length) return;
        setIsAnimating(true);
        setDirection(newSlide > currentSlideRef.current ? 1 : -1);
        setCurrentSlide(newSlide);
      }, [isAnimating]);

      const nextSlide = useCallback(() => { if (currentSlideRef.current + 1 < slides.length) goToSlide(currentSlideRef.current + 1); }, [goToSlide]);
      const prevSlide = useCallback(() => { if (currentSlideRef.current - 1 >= 0) goToSlide(currentSlideRef.current - 1); }, [goToSlide]);

      useEffect(() => {
        const handleKeyDown = (e) => {
          if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); nextSlide(); }
          if (e.key === 'ArrowLeft') { e.preventDefault(); prevSlide(); }
        };
        window.addEventListener('keydown', handleKeyDown);
        return () => window.removeEventListener('keydown', handleKeyDown);
      }, [nextSlide, prevSlide]);

      const slideVariants = {
        enter: (dir) => ({ x: dir > 0 ? '100%' : '-100%', opacity: 0 }),
        center: { x: 0, opacity: 1 },
        exit: (dir) => ({ x: dir > 0 ? '-100%' : '100%', opacity: 0 })
      };

      const renderSlide = (slide) => {
        switch (slide.type) {
          case 'welcome': return <WelcomeSlide data={slide} onStart={nextSlide} userName={userName} onShowGif={showGif} onHideGif={hideGif} />;
          case 'hook': return <HookSlide data={slide} />;
          case 'content': return <ContentSlide data={slide} />;
          case 'pareto-visual': return <ParetoVisualSlide data={slide} />;
          case 'ltv-scenario': return <LtvScenarioSlide data={slide} />;
          case 'tool-integration': return <ToolIntegrationSlide data={slide} />;
          case 'tool-integration-export': return <ToolIntegrationExportSlide data={slide} />;
          case 'lookalike-creation': return <LookalikeCreationSlide data={slide} />;
          case 'customer-tiers': return <CustomerTiersSlide data={slide} />;
          case 'strategy-steps': return <StrategyStepsSlide data={slide} />;
          case 'stat-countdown': return <StatCountdownSlide data={slide} />;
          case 'mockup': return <MockupSlide data={slide} />;
          case 'highlight-box': return <HighlightBoxSlide data={slide} />;
          case 'before-after': return <BeforeAfterSlide data={slide} />;
          case 'comparison-cards': return <ComparisonCardsSlide data={slide} />;
          case 'quiz': return <QuizSlide data={slide} onShowGif={showGif} onHideGif={hideGif} />;
          case 'completion': return <CompletionSlide data={slide} />;
          default: return null;
        }
      };

      const showPrev = currentSlide > 0;
      const showNext = currentSlide < slides.length - 1 && slides[currentSlide].type !== 'welcome';

      return (
        <div className="w-full h-screen bg-white flex flex-col relative">
          <div className="flex-1 relative overflow-hidden z-20">
            <AnimatePresence mode="wait" custom={direction} onExitComplete={() => setIsAnimating(false)}>
              <motion.div key={currentSlide} custom={direction} variants={slideVariants} initial="enter" animate="center" exit="exit" transition={{ duration: 0.3, ease: [0.25, 0.1, 0.25, 1] }} className="absolute inset-0">
                {renderSlide(slides[currentSlide])}
              </motion.div>
            </AnimatePresence>
            {showPrev && <button onClick={prevSlide} className="absolute left-5 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-500 hover:text-neutral-700 transition-all z-10"><Icons.ArrowLeft /></button>}
            {showNext && <button onClick={nextSlide} className="absolute right-5 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-neutral-100 hover:bg-neutral-200 flex items-center justify-center text-neutral-500 hover:text-neutral-700 transition-all z-10"><Icons.ArrowRight /></button>}
          </div>
          <div className="px-6 md:px-8 py-5 border-t border-neutral-100 flex-shrink-0 relative z-10">
            <div className="flex items-center justify-center gap-2.5">
              {slides.map((_, i) => <button key={i} onClick={() => goToSlide(i)} className="w-2.5 h-2.5 rounded-full transition-all duration-300" style={{ background: i === currentSlide ? 'var(--accent)' : '#d4d4d4', transform: i === currentSlide ? 'scale(1.3)' : 'scale(1)' }} />)}
            </div>
          </div>
          <AnimatePresence>
            {gifConfig && (
              <motion.div initial={{ opacity: 0, y: 30 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: 30 }} transition={{ type: 'spring', stiffness: 100 }} className={`absolute ${gifConfig.side === 'left' ? 'left-4 md:left-8' : 'right-4 md:right-8'} bottom-0 pointer-events-none`} style={{ zIndex: 15, height: gifConfig.height }}>
                <video autoPlay loop muted playsInline className="h-full w-auto object-contain object-bottom" style={{ background: 'transparent', border: 'none', boxShadow: 'none' }}>
                  <source src={gifConfig.url} type="video/mp4" />
                </video>
              </motion.div>
            )}
          </AnimatePresence>
        </div>
      );
    };

    ReactDOM.render(<LessonApp />, document.getElementById('root'));
  </script>
</body>
</html>
